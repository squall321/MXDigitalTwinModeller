
================================================================================
PAGE 1
================================================================================

 
 
 
 
 
 
 
 
 
 
 
 
 
 
ANSYS LS-DYNA® 
KEYWORD USER'S MANUAL 
 
VOLUME III 
 
 
Multiphysics Solvers 
 
 
 
R16@bdccd6d07 (03/10/25) 
LS-DYNA R16 
 
 
 
 
 
ANSYS 

================================================================================
PAGE 2
================================================================================

 
 
Websites 
https://lsdyna.ansys.com 
https://support.ansys.com  
Address 
ANSYS, Inc. 
Southpointe 
2600 Ansys Drive 
Canonsburg, PA 15317  
http://www.ansys.com 
(T) 724-746-3304 
(F) 724-514-9494 
Copyright and Trademark Information 
© 2025 ANSYS, Inc.  Unauthorized use, distribution or duplication is prohibited. 
 
ANSYS, Ansys Workbench, AUTODYN, CFX, FLUENT and any and all ANSYS, Inc.  
brand, product, service and feature names, logos and slogans are registered trademarks 
or trademarks of ANSYS, Inc.  or its subsidiaries located in the United States or other 
countries.  ICEM CFD is a trademark used by ANSYS, Inc.  under license.  CFX is a trade-
mark of Sony Corporation in Japan.  All other brand, product, service and feature names 
or trademarks are the property of their respective owners.  FLEXlm and FLEXnet are 
trademarks of Flexera Software LLC. 
Disclaimer Notice 
THIS ANSYS SOFTWARE PRODUCT AND PROGRAM DOCUMENTATION IN-
CLUDE TRADE SECRETS AND ARE CONFIDENTIAL AND PROPRIETARY PROD-
UCTS OF ANSYS, INC., ITS SUBSIDIARIES, OR LICENSORS. The software products and 
documentation are furnished by ANSYS, Inc., its subsidiaries, or aﬃliates under a soft-
ware license agreement that contains provisions concerning non-disclosure, copying, 
length and nature of use, compliance with exporting laws, warranties, disclaimers, limi-
tations of liability, and remedies, and other provisions.  The software products and doc-
umentation may be used, disclosed, transferred, or copied only in accordance with the 
terms and conditions of that software license agreement. 
 
ANSYS, Inc.  and ANSYS Europe, Ltd.  are UL registered ISO 9001: 2015 companies. 
U.S. Government Rights 
For U.S. Government users, except as speciﬁcally granted by the ANSYS, Inc.  software 
license agreement, the use, duplication, or disclosure by the United States Government is 
subject to restrictions stated in the ANSYS, Inc.  software license agreement and FAR 
12.212 (for non-DOD licenses). 

================================================================================
PAGE 3
================================================================================

 
 
Third-Party Software 
See the legal information in the product help ﬁles for the complete Legal Notice for AN-
SYS proprietary software and third-party software.  If you are unable to access the Legal 
Notice, contact ANSYS, Inc. 
 
Published in the U.S.A.

================================================================================
PAGE 4
================================================================================

TABLE OF CONTENTS 
 
0-4 (TABLE OF CONTENTS) 
R16@bdccd6d07 (03/10/25) 
TABLE OF CONTENTS 
TABLE OF CONTENTS .............................................................................................................................. 0-4 
INTRODUCTION ........................................................................................................................................ 1-1 
*BATTERY .................................................................................................................................................. 2-1 
*BATTERY_DATABASE_HISTORY_ALLNDS_ON_ELESET ......................................................... 2-2 
*BATTERY_DATABASE_HISTORY_NODELIST_ON_ELESET ...................................................... 2-3 
*BATTERY_DATABASE_HISTORY_GLOBALS ............................................................................. 2-5 
*BATTERY_ECHEM_CELL_GEOMETRY ...................................................................................... 2-6 
*BATTERY_ECHEM_CONTROL_SOLVER ................................................................................... 2-8 
*BATTERY_ECHEM_INITIAL ....................................................................................................... 2-15 
*BATTERY_ECHEM_MAT_ANODE ............................................................................................. 2-16 
*BATTERY_ECHEM_MAT_CATHODE ........................................................................................ 2-18 
*BATTERY_ECHEM_MAT_ELECTROLYTE ................................................................................ 2-20 
*BATTERY_ECHEM_THERMAL .................................................................................................. 2-22 
*CESE ......................................................................................................................................................... 3-1 
*CESE_BOUNDARY_AXISYMMETRIC ......................................................................................... 3-3 
*CESE_BOUNDARY_BLAST_LOAD ............................................................................................. 3-6 
*CESE_BOUNDARY_CONJ_HEAT ............................................................................................... 3-9 
*CESE_BOUNDARY_CYCLIC ..................................................................................................... 3-12 
*CESE_BOUNDARY_FSI............................................................................................................. 3-18 
*CESE_BOUNDARY_NON_REFLECTIVE ................................................................................... 3-21 
*CESE_BOUNDARY_PRESCRIBED ........................................................................................... 3-24 
*CESE_BOUNDARY_PRESCRIBED_VN ..................................................................................... 3-30 
*CESE_BOUNDARY_REFLECTIVE ............................................................................................. 3-35 
*CESE_BOUNDARY_SLIDING .................................................................................................... 3-38 
*CESE_BOUNDARY_SOLID_WALL ............................................................................................ 3-41 
*CESE_CHEMISTRY_D3PLOT ................................................................................................... 3-49 
*CESE_CONTROL_LIMITER ....................................................................................................... 3-50 
*CESE_CONTROL_MESH_MOV................................................................................................. 3-51 
*CESE_CONTROL_SOLVER ....................................................................................................... 3-52 
*CESE_CONTROL_TIMESTEP ................................................................................................... 3-54 
*CESE_DATABASE_ELOUT ........................................................................................................ 3-55 
*CESE_DATABASE_FLUXAVG ................................................................................................... 3-57 

================================================================================
PAGE 5
================================================================================

 
TABLE OF CONTENTS 
R16@bdccd6d07 (03/10/25) 
0-5 (TABLE OF CONTENTS) 
*CESE_DATABASE_FSIDRAG .................................................................................................... 3-59 
*CESE_DATABASE_POINTOUT ................................................................................................. 3-60 
*CESE_DATABASE_SSETDRAG ................................................................................................ 3-62 
*CESE_DEFINE_NONINERTIAL ................................................................................................ 3-64 
*CESE_DEFINE_POINT .............................................................................................................. 3-66 
*CESE_DRAG ............................................................................................................................. 3-67 
*CESE_EOS_CAV_HOMOG_EQUILIB ........................................................................................ 3-68 
*CESE_EOS_IDEAL_GAS ........................................................................................................... 3-69 
*CESE_EOS_INFLATOR1 ........................................................................................................... 3-70 
*CESE_EOS_INFLATOR2 ........................................................................................................... 3-72 
*CESE_FSI_EXCLUDE ............................................................................................................... 3-75 
*CESE_INITIAL ............................................................................................................................ 3-76 
*CESE_INITIAL ............................................................................................................................ 3-77 
*CESE_INITIAL_CHEMISTRY ..................................................................................................... 3-78 
*CESE_INITIAL_CHEMISTRY_ELEMENT ................................................................................... 3-80 
*CESE_INITIAL_CHEMISTRY_PART .......................................................................................... 3-82 
*CESE_INITIAL_CHEMISTRY_SET ............................................................................................. 3-84 
*CESE_MAT_000 ........................................................................................................................ 3-86 
*CESE_MAT_001( _GAS) ............................................................................................................ 3-87 
*CESE_MAT_002 ........................................................................................................................ 3-88 
*CESE_PART ............................................................................................................................... 3-90 
*CESE_SURFACE_MECHSSID_D3PLOT ................................................................................. 3-91 
*CESE_SURFACE_MECHVARS_D3PLOT ................................................................................ 3-92 
*CHEMISTRY ............................................................................................................................................. 4-1 
*CHEMISTRY_BATTERY .............................................................................................................. 4-3 
*CHEMISTRY_COMPOSITION ..................................................................................................... 4-4 
*CHEMISTRY_CONTROL_0D ....................................................................................................... 4-5 
*CHEMISTRY_CONTROL_1D ....................................................................................................... 4-7 
*CHEMISTRY_CONTROL_CSP .................................................................................................... 4-9 
*CHEMISTRY_CONTROL_FULL ................................................................................................. 4-10 
*CHEMISTRY_CONTROL_INFLATOR ....................................................................................... 4-11 
*CHEMISTRY_CONTROL_TBX .................................................................................................. 4-14 
*CHEMISTRY_CONTROL_ZND .................................................................................................. 4-15 
*CHEMISTRY_DET_INITIATION .................................................................................................. 4-17 
*CHEMISTRY_INFLATOR_PROPERTIES ................................................................................. 4-19 
*CHEMISTRY_MODEL ................................................................................................................ 4-24 

================================================================================
PAGE 6
================================================================================

TABLE OF CONTENTS 
 
0-6 (TABLE OF CONTENTS) 
R16@bdccd6d07 (03/10/25) 
*CHEMISTRY_PATH ................................................................................................................... 4-26 
*DUALCESE ............................................................................................................................................... 5-1 
*DUALCESE_BOUNDARY_AXISYMMETRIC ................................................................................ 5-9 
*DUALCESE_BOUNDARY_CYCLIC ........................................................................................... 5-11 
*DUALCESE_BOUNDARY_FSI ................................................................................................... 5-15 
*DUALCESE_BOUNDARY_NON_REFLECTIVE.......................................................................... 5-18 
*DUALCESE_BOUNDARY_PRESCRIBED .................................................................................. 5-20 
*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID .................................................................. 5-25 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MACHNUM ................................................. 5-32 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MFRATE ...................................................... 5-36 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_PRESSURE ................................................. 5-40 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_EXMFRATE .............................................. 5-44 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_FARFIELD ................................................ 5-48 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_PRESSURE ............................................. 5-52 
*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE ................................................... 5-56 
*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE .......................................................... 5-62 
*DUALCESE_BOUNDARY_PRESCRIBED_VN ........................................................................... 5-67 
*DUALCESE_BOUNDARY_REFLECTIVE ................................................................................... 5-71 
*DUALCESE_BOUNDARY_SOLID_WALL .................................................................................. 5-73 
*DUALCESE_CONTROL_LIMITER ............................................................................................. 5-78 
*DUALCESE_CONTROL_MESH_MOV ....................................................................................... 5-79 
*DUALCESE_CONTROL_SOLVER ............................................................................................. 5-80 
*DUALCESE_CONTROL_TIMESTEP .......................................................................................... 5-82 
*DUALCESE_DARCY-FORCHHEIMER_EQ ................................................................................ 5-83 
*DUALCESE_DATABASE_HISTORY_DRAG_LIFT ..................................................................... 5-85 
*DUALCESE_DATABASE_HISTORY_ELEMENT_SET................................................................ 5-88 
*DUALCESE_DATABASE_HISTORY_GLOBALS ........................................................................ 5-89 
*DUALCESE_DATABASE_HISTORY_NODE_SET ...................................................................... 5-90 
*DUALCESE_DATABASE_HISTORY_POINT_SET ..................................................................... 5-91 
*DUALCESE_DATABASE_HISTORY_SEGMENT_SET ............................................................... 5-92 
*DUALCESE_D3PLOT ................................................................................................................. 5-94 
*DUALCESE_D3PLOT_FLUID_SSID ........................................................................................... 5-96 
*DUALCESE_ELE2D ................................................................................................................... 5-98 
*DUALCESE_ELE3D ................................................................................................................... 5-99 
*DUALCESE_ELEMENTSET ..................................................................................................... 5-101 
*DUALCESE_EOS_CAV_HOMOG_EQUILIB ............................................................................ 5-102 

================================================================================
PAGE 7
================================================================================

 
TABLE OF CONTENTS 
R16@bdccd6d07 (03/10/25) 
0-7 (TABLE OF CONTENTS) 
*DUALCESE_EOS_COCHRAN_CHAN ..................................................................................... 5-103 
*DUALCESE_EOS_COOLPROP ............................................................................................... 5-105 
*DUALCESE_EOS_IDEAL_GAS ................................................................................................ 5-109 
*DUALCESE_EOS_INFLATOR1 ................................................................................................ 5-110 
*DUALCESE_EOS_INFLATOR2 ................................................................................................ 5-112 
*DUALCESE_EOS_JWL ............................................................................................................ 5-115 
*DUALCESE_EOS_NASG ......................................................................................................... 5-117 
*DUALCESE_EOS_REFPROP ................................................................................................... 5-119 
*DUALCESE_EOS_REFPROP_PATH ....................................................................................... 5-123 
*DUALCESE_EOS_SET ............................................................................................................. 5-124 
*DUALCESE_EOS_STIFFENED_GAS ....................................................................................... 5-125 
*DUALCESE_EOS_VAN_DER_WAALS_GENERALIZED .......................................................... 5-126 
*DUALCESE_FSI_EXCLUDE ..................................................................................................... 5-128 
*DUALCESE_FSI_EXCLUDE_PARTSET ................................................................................... 5-129 
*DUALCESE_GRAVITY ............................................................................................................. 5-130 
*DUALCESE_INCLUDE_MODEL .............................................................................................. 5-131 
*DUALCESE_INITIAL................................................................................................................. 5-132 
*DUALCESE_INITIAL_SET ........................................................................................................ 5-133 
*DUALCESE_INITIAL_HYBRID ................................................................................................. 5-135 
*DUALCESE_INITIAL_HYBRID_SET ......................................................................................... 5-137 
*DUALCESE_INITIAL_PHASE_CHANGE .................................................................................. 5-139 
*DUALCESE_INITIAL_PHASE_CHANGE_SET ......................................................................... 5-141 
*DUALCESE_INITIAL_TWO-PHASE ......................................................................................... 5-143 
*DUALCESE_INITIAL_TWO-PHASE_SET ................................................................................. 5-145 
*DUALCESE_MAT_GAS............................................................................................................ 5-147 
*DUALCESE_MAT_GAS_0 ........................................................................................................ 5-149 
*DUALCESE_MAT_GAS_2 ........................................................................................................ 5-150 
*DUALCESE_MAT_LIQUID ....................................................................................................... 5-152 
*DUALCESE_MESH_GEOMETRY ............................................................................................ 5-153 
*DUALCESE_MESH_PART ....................................................................................................... 5-155 
*DUALCESE_MODEL ............................................................................................................... 5-156 
*DUALCESE_NODE2D .............................................................................................................. 5-157 
*DUALCESE_NODE3D .............................................................................................................. 5-158 
*DUALCESE_NODESET ............................................................................................................ 5-159 
*DUALCESE_PART ................................................................................................................... 5-160 
*DUALCESE_PART_MULTIPHASE ........................................................................................... 5-162 
*DUALCESE_POINTSET ........................................................................................................... 5-164 

================================================================================
PAGE 8
================================================================================

TABLE OF CONTENTS 
 
0-8 (TABLE OF CONTENTS) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_POINT_SOURCE ................................................................................................. 5-165 
*DUALCESE_POINT_SOURCE_TWO-PHASE.......................................................................... 5-168 
*DUALCESE_POINT_SOURCE_STRUCTNODE_SET .............................................................. 5-172 
*DUALCESE_POROUS_MODEL ............................................................................................... 5-173 
*DUALCESE_POROUS_SPECIFY_JUMP ................................................................................. 5-174 
*DUALCESE_REACTION_RATE_IG .......................................................................................... 5-175 
*DUALCESE_REACTION_RATE_IG_REDUCED ....................................................................... 5-177 
*DUALCESE_REACTION_RATE_P_DEPEND ........................................................................... 5-178 
*DUALCESE_SEGMENTSET .................................................................................................... 5-179 
*DUALCESE_SOLVER_SELECTION ......................................................................................... 5-181 
*DUALCESE_SOLVER_CAV_EQNS .......................................................................................... 5-182 
*DUALCESE_SOLVER_EULER_EQNS ..................................................................................... 5-183 
*DUALCESE_SOLVER_HYBRID_MULTIPHASE ....................................................................... 5-184 
*DUALCESE_SOLVER_NAVIER_STOKES ................................................................................ 5-186 
*DUALCESE_SOLVER_PHASE_CHANGE ................................................................................ 5-187 
*DUALCESE_SOLVER_TWO-PHASE_MULTIPHASE ............................................................... 5-188 
*EM ............................................................................................................................................................. 6-1 
*EM_2DAXI .................................................................................................................................... 6-5 
*EM_BOUNDARY .......................................................................................................................... 6-6 
*EM_BOUNDARY_PRESCRIBED ................................................................................................. 6-7 
*EM_CIRCUIT ................................................................................................................................ 6-9 
*EM_CIRCUIT_CONNECT .......................................................................................................... 6-14 
*EM_CIRCUIT_ROGO ................................................................................................................. 6-15 
*EM_CIRCUIT_SOURCE ............................................................................................................. 6-17 
*EM_CONTACT ........................................................................................................................... 6-20 
*EM_CONTACT_RESISTANCE ................................................................................................... 6-22 
*EM_CONTACT_SUBDOM ......................................................................................................... 6-25 
*EM_CONTROL ........................................................................................................................... 6-27 
*EM_CONTROL_CONTACT ........................................................................................................ 6-30 
*EM_CONTROL_COUPLING ...................................................................................................... 6-32 
*EM_CONTROL_EROSION ......................................................................................................... 6-36 
*EM_CONTROL_MAGNET .......................................................................................................... 6-37 
*EM_CONTROL_SOLUTION ....................................................................................................... 6-38 
*EM_CONTROL_SWITCH ........................................................................................................... 6-41 
*EM_CONTROL_SWITCH_CONTACT ........................................................................................ 6-42 
*EM_CONTROL_TIMESTEP ....................................................................................................... 6-43 

================================================================================
PAGE 9
================================================================================

 
TABLE OF CONTENTS 
R16@bdccd6d07 (03/10/25) 
0-9 (TABLE OF CONTENTS) 
*EM_DATABASE_CIRCUIT ......................................................................................................... 6-46 
*EM_DATABASE_CIRCUIT0D ..................................................................................................... 6-48 
*EM_DATABASE_CIRCUITSOURCE .......................................................................................... 6-49 
*EM_DATABASE_ELOUT ............................................................................................................ 6-50 
*EM_DATABASE_FIELDLINE .................................................................................................... 6-51 
*EM_DATABASE_GLOBALENERGY .......................................................................................... 6-54 
*EM_DATABASE_NODOUT ........................................................................................................ 6-55 
*EM_DATABASE_PARTDATA ..................................................................................................... 6-56 
*EM_DATABASE_POINTOUT ..................................................................................................... 6-57 
*EM_DATABASE_ROGO ............................................................................................................. 6-58 
*EM_DATABASE_TIMESTEP ..................................................................................................... 6-59 
*EM_EP_CELLMODEL_DEFINE_FUNCTION ............................................................................. 6-60 
*EM_EP_CELLMODEL_FENTONKARMA ................................................................................... 6-63 
*EM_EP_CELLMODEL_FITZHUGHNAGUMO ............................................................................ 6-66 
*EM_EP_CELLMODEL_TENTUSSCHER .................................................................................... 6-68 
*EM_EP_CELLMODEL_TOMEK .................................................................................................. 6-77 
*EM_EP_CELLMODEL_TOR_ORD ............................................................................................. 6-78 
*EM_EP_CELLMODEL_USERMAT ............................................................................................. 6-79 
*EM_EP_CREATEFIBERORIENTATION ...................................................................................... 6-80 
*EM_EP_ECG .............................................................................................................................. 6-82 
*EM_EP_EIKONAL ...................................................................................................................... 6-83 
*EM_EP_ISOCH .......................................................................................................................... 6-85 
*EM_EP_LAPLACE_DIRICHLET ................................................................................................. 6-86 
*EM_EP_PURKINJE_NETWORK ................................................................................................ 6-87 
*EM_EP_TENTUSSCHER_STIMULUS ....................................................................................... 6-89 
*EM_EOS_BURGESS .................................................................................................................. 6-90 
*EM_EOS_MEADON ................................................................................................................... 6-94 
*EM_EOS_PERMEABILITY ......................................................................................................... 6-97 
*EM_EOS_TABULATED1 .......................................................................................................... 6-100 
*EM_EOS_TABULATED2 .......................................................................................................... 6-101 
*EM_EXTERNAL_FIELD ............................................................................................................ 6-103 
*EM_ISOPOTENTIAL................................................................................................................. 6-105 
*EM_ISOPOTENTIAL_CONNECT ............................................................................................. 6-106 
*EM_ISOPOTENTIAL_ROGO .................................................................................................. 6-110 
*EM_MAT_001 .......................................................................................................................... 6-111 
*EM_MAT_002 .......................................................................................................................... 6-114 
*EM_MAT_003 .......................................................................................................................... 6-117 

================================================================================
PAGE 10
================================================================================

TABLE OF CONTENTS 
 
0-10 (TABLE OF CONTENTS) 
R16@bdccd6d07 (03/10/25) 
*EM_MAT_004 .......................................................................................................................... 6-121 
*EM_MAT_005 .......................................................................................................................... 6-124 
*EM_MAT_006 .......................................................................................................................... 6-129 
*EM_OUTPUT ........................................................................................................................... 6-131 
*EM_OUTPUT_FORCES ........................................................................................................... 6-133 
*EM_OUTPUT_VTK ................................................................................................................... 6-135 
*EM_PERMANENT_MAGNET ................................................................................................... 6-136 
*EM_POINT_SET ....................................................................................................................... 6-141 
*EM_RANDLES ......................................................................................................................... 6-143 
*EM_RANDLES_BATMAC ........................................................................................... 6-146 
*EM_RANDLES_EXOTHERMIC_REACTION ............................................................... 6-153 
*EM_RANDLES_MESHLESS ....................................................................................... 6-154 
*EM_RANDLES_TSHELL ............................................................................................. 6-159 
*EM_RANDLES_SHORT .............................................................................................. 6-165 
*EM_RANDLES_SOLID ................................................................................................ 6-168 
*EM_ROTATION_AXIS .............................................................................................................. 6-175 
*EM_SOLVER_BEM .................................................................................................................. 6-177 
*EM_SOLVER_BEMMAT ........................................................................................................... 6-179 
*EM_SOLVER_FEM ................................................................................................................... 6-180 
*EM_SOLVER_FEMBEM ........................................................................................................... 6-182 
*EM_SOLVER_FEMBEM_MONOLITHIC................................................................................... 6-183 
*ICFD .......................................................................................................................................................... 7-1 
*ICFD_BOUNDARY_CONJ_HEAT ................................................................................................ 7-6 
*ICFD_BOUNDARY_CONVECTION_TEMP ................................................................................. 7-7 
*ICFD_BOUNDARY_FLUX_TEMP ................................................................................................. 7-8 
*ICFD_BOUNDARY_FREESLIP .................................................................................................... 7-9 
*ICFD_BOUNDARY_FSI .............................................................................................................. 7-10 
*ICFD_BOUNDARY_FSI_EXCLUDE............................................................................................ 7-11 
*ICFD_BOUNDARY_FSI_FIXED .................................................................................................. 7-12 
*ICFD_BOUNDARY_FSI_ONEWAY ............................................................................................ 7-13 
*ICFD_BOUNDARY_FSWAVE .................................................................................................... 7-14 
*ICFD_BOUNDARY_GROUND ................................................................................................... 7-17 
*ICFD_BOUNDARY_NAVIERSLIP ............................................................................................... 7-18 
*ICFD_BOUNDARY_NONSLIP ................................................................................................... 7-19 
*ICFD_BOUNDARY_PERIODIC .................................................................................................. 7-20 
*ICFD_BOUNDARY_PRESCRIBED_LEVELSET ......................................................................... 7-22 

================================================================================
PAGE 11
================================================================================

 
TABLE OF CONTENTS 
R16@bdccd6d07 (03/10/25) 
0-11 (TABLE OF CONTENTS) 
*ICFD_BOUNDARY_PRESCRIBED_MOVEMESH ...................................................................... 7-23 
*ICFD_BOUNDARY_PRESCRIBED_PRE .................................................................................... 7-25 
*ICFD_BOUNDARY_PRESCRIBED_SPTRANSP_CONC ........................................................... 7-27 
*ICFD_BOUNDARY_PRESCRIBED_TEMP ................................................................................. 7-28 
*ICFD_BOUNDARY_PRESCRIBED_TURBULENCE ................................................................... 7-29 
*ICFD_BOUNDARY_PRESCRIBED_VEL .................................................................................... 7-32 
*ICFD_BOUNDARY_PRESCRIBED_VISCOELASTIC ................................................................. 7-34 
*ICFD_BOUNDARY_WEAKVEL .................................................................................................. 7-35 
*ICFD_BOUNDARY_WINDKESSEL ............................................................................................ 7-36 
*ICFD_CONTROL_ADAPT .......................................................................................................... 7-40 
*ICFD_CONTROL_ADAPT_SIZE ................................................................................................. 7-42 
*ICFD_CONTROL_ADVECTION .................................................................................................. 7-44 
*ICFD_CONTROL_BACKFLOW .................................................................................................. 7-46 
*ICFD_CONTROL_CONJ ............................................................................................................ 7-47 
*ICFD_CONTROL_DEM_COUPLING .......................................................................................... 7-48 
*ICFD_CONTROL_EMBEDSHELL .............................................................................................. 7-50 
*ICFD_CONTROL_FSI ................................................................................................................. 7-51 
*ICFD_CONTROL_GAP ............................................................................................................... 7-54 
*ICFD_CONTROL_GENERAL ..................................................................................................... 7-56 
*ICFD_CONTROL_IMPOSED_MOVE.......................................................................................... 7-58 
*ICFD_CONTROL_LEVELSET ..................................................................................................... 7-63 
*ICFD_CONTROL_LOAD ............................................................................................................ 7-65 
*ICFD_CONTROL_MESH ............................................................................................................ 7-66 
*ICFD_CONTROL_MESH_MOV .................................................................................................. 7-68 
*ICFD_CONTROL_MONOLITHIC ............................................................................................... 7-69 
*ICFD_CONTROL_OUTPUT ....................................................................................................... 7-70 
*ICFD_CONTROL_OUTPUT_SUBDOM ...................................................................................... 7-73 
*ICFD_CONTROL_OUTPUT_VAR ............................................................................................... 7-75 
*ICFD_CONTROL_PARTITION ................................................................................................... 7-77 
*ICFD_CONTROL_POROUS ....................................................................................................... 7-78 
*ICFD_CONTROL_STEADY ....................................................................................................... 7-79 
*ICFD_CONTROL_SURFMESH .................................................................................................. 7-80 
*ICFD_CONTROL_TAVERAGE ................................................................................................... 7-81 
*ICFD_CONTROL_TIME .............................................................................................................. 7-82 
*ICFD_CONTROL_TRANSIENT ................................................................................................. 7-86 
*ICFD_CONTROL_TURBULENCE .............................................................................................. 7-87 
*ICFD_CONTROL_TURB_SYNTHESIS ....................................................................................... 7-97 

================================================================================
PAGE 12
================================================================================

TABLE OF CONTENTS 
 
0-12 (TABLE OF CONTENTS) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_AVERAGE .................................................................................................... 7-98 
*ICFD_DATABASE_DRAG_{OPTION} ......................................................................................... 7-99 
*ICFD_DATABASE_FLUX .......................................................................................................... 7-101 
*ICFD_DATABASE_FLUX_SURF .............................................................................................. 7-102 
*ICFD_DATABASE_FORCE_DEM ............................................................................................. 7-103 
*ICFD_DATABASE_GOA ........................................................................................................... 7-104 
*ICFD_DATABASE_HTC ........................................................................................................... 7-105 
*ICFD_DATABASE_NODEAVG ................................................................................................ 7-107 
*ICFD_DATABASE_NODOUT ................................................................................................... 7-108 
*ICFD_DATABASE_NTEMPOUT ............................................................................................... 7-109 
*ICFD_DATABASE_POINTAVG ................................................................................................ 7-110 
*ICFD_DATABASE_POINTOUT ................................................................................................ 7-111 
*ICFD_DATABASE_RESIDUALS ............................................................................................... 7-113 
*ICFD_DATABASE_SSOUT ...................................................................................................... 7-114 
*ICFD_DATABASE_SSOUT_EXCLUDE .................................................................................... 7-115 
*ICFD_DATABASE_TEMP......................................................................................................... 7-116 
*ICFD_DATABASE_TIMESTEP ................................................................................................ 7-117 
*ICFD_DATABASE_TPD ............................................................................................................ 7-118 
*ICFD_DATABASE_TWINBUILDER .......................................................................................... 7-120 
*ICFD_DATABASE_UINDEX ..................................................................................................... 7-122 
*ICFD_DATABASE_WETNESS ................................................................................................. 7-123 
*ICFD_DEFINE_HEATSOURCE ................................................................................................ 7-124 
*ICFD_DEFINE_POROUS_REGION .......................................................................................... 7-126 
*ICFD_DEFINE_RESIDENCETIMESOURCE ............................................................................. 7-129 
*ICFD_DEFINE_SOURCE .......................................................................................................... 7-130 
*ICFD_DEFINE_SPTRANSPSOURCE ....................................................................................... 7-131 
*ICFD_DEFINE_TRANSFORM .................................................................................................. 7-132 
*ICFD_DEFINE_TURBSOURCE ................................................................................................ 7-133 
*ICFD_DEFINE_POINT .............................................................................................................. 7-135 
*ICFD_DEFINE_NONINERTIAL ................................................................................................. 7-137 
*ICFD_DEFINE_WAVE_DAMPING ............................................................................................ 7-139 
*ICFD_INITIAL ........................................................................................................................... 7-141 
*ICFD_INITIAL_LEVELSET ........................................................................................................ 7-142 
*ICFD_INITIAL_SPTRANSP....................................................................................................... 7-144 
*ICFD_INITIAL_TEMPNODE ..................................................................................................... 7-145 
*ICFD_INITIAL_TURBULENCE ................................................................................................. 7-146 
*ICFD_MAT................................................................................................................................ 7-147 

================================================================================
PAGE 13
================================================================================

 
TABLE OF CONTENTS 
R16@bdccd6d07 (03/10/25) 
0-13 (TABLE OF CONTENTS) 
*ICFD_MODEL_NONNEWT ...................................................................................................... 7-150 
*ICFD_MODEL_POROUS ......................................................................................................... 7-154 
*ICFD_MODEL_SPECIES_TRANSPORT .................................................................................. 7-163 
*ICFD_MODEL_VISCOELASTIC ............................................................................................... 7-164 
*ICFD_PART .............................................................................................................................. 7-165 
*ICFD_PART_VOL ..................................................................................................................... 7-166 
*ICFD_SECTION ........................................................................................................................ 7-168 
*ICFD_SET_NODE_LIST ........................................................................................................... 7-169 
*ICFD_SOLVER_SPLIT ............................................................................................................. 7-170 
*ICFD_SOLVER_TOL_FSI ......................................................................................................... 7-171 
*ICFD_SOLVER_TOL_LSET ...................................................................................................... 7-172 
*ICFD_SOLVER_TOL_MMOV ................................................................................................... 7-173 
*ICFD_SOLVER_TOL_MOM..................................................................................................... 7-174 
*ICFD_SOLVER_TOL_MONOLITHIC ....................................................................................... 7-175 
*ICFD_SOLVER_TOL_PRE ........................................................................................................ 7-176 
*ICFD_SOLVER_TOL_TEMP ..................................................................................................... 7-177 
*MESH ........................................................................................................................................................ 8-1 
*MESH_BL .................................................................................................................................... 8-2 
*MESH_BL_SYM ........................................................................................................................... 8-6 
*MESH_EMBEDSHELL ................................................................................................................. 8-7 
*MESH_INTERF ............................................................................................................................. 8-8 
*MESH_NODE ............................................................................................................................... 8-9 
*MESH_SIZE ............................................................................................................................... 8-10 
*MESH_SIZE_SHAPE .................................................................................................................. 8-11 
*MESH_SURFACE_ELEMENT .................................................................................................... 8-17 
*MESH_SURFACE_NODE .......................................................................................................... 8-19 
*MESH_SURFACE_NULL ........................................................................................................... 8-20 
*MESH_VOLUME ........................................................................................................................ 8-21 
*MESH_VOLUME_ELEMENT ...................................................................................................... 8-22 
*MESH_VOLUME_NODE ............................................................................................................ 8-23 
*MESH_VOLUME_PART ............................................................................................................. 8-24 
*STOCHASTIC ........................................................................................................................................... 9-1 
*STOCHASTIC_SPRAY_PARTICLES ........................................................................................... 9-2 
*STOCHASTIC_TBX_PARTICLES ................................................................................................. 9-7 
*LSO ......................................................................................................................................................... 10-1 
*LSO_DOMAIN ............................................................................................................................ 10-2 

================================================================================
PAGE 14
================================================================================

TABLE OF CONTENTS 
 
0-14 (TABLE OF CONTENTS) 
R16@bdccd6d07 (03/10/25) 
*LSO_ID_SET .............................................................................................................................. 10-5 
*LSO_POINT_SET ....................................................................................................................... 10-7 
*LSO_TIME_SEQUENCE ............................................................................................................ 10-9 
*LSO_VARIABLE_GROUP ........................................................................................................ 10-12 

================================================================================
PAGE 15
================================================================================

*INTRODUCTION 
*INTRODUCTION 
R16@bdccd6d07 (03/10/25) 
1-1 (INTRODUCTION) 
LS-DYNA MULTIPHYSICS USER’S MANUAL 
INTRODUCTION 
 
In this manual, there are ﬁve main solvers:  two compressible ﬂow solvers, an incom-
pressible ﬂow solver, an electromagnetism solver, and a battery electrochemistry solver.  
Each of them implements coupling with the structural solver in LS-DYNA. 
 
The keywords covered in this manual ﬁt into one of three categories.  In the ﬁrst category 
are the keyword cards that provide input to each of the multiphysics solvers that in turn 
couple with the structural solver.  In the second category are keyword cards involving 
extensions to the basic solvers.  Presently, the chemistry and stochastic particle solvers 
are the two solvers in this category, and they are used in conjunction with the *CESE 
compressible ﬂow solver discussed below.  In the third category are keyword cards for 
support facilities.  A volume mesher that creates volume tetrahedral element meshes 
from bounding surface meshes is one of these tools.  Another is a data output mechanism 
for a limited set of variables from some of the solvers in this manual.  This mechanism is 
accessed through *LSO keyword cards. 
 
The CESE solver is a compressible ﬂow solver based upon the Conservation Element/So-
lution Element (CE/SE) method, originally proposed by Chang of the NASA Glenn Re-
search Center.  This method is a novel numerical framework for conservation laws.  It 
has many non-traditional features, including a uniﬁed treatment of space and time, the 
introduction of separate conservation elements (CE) and solution elements (SE), and a 
novel shock capturing strategy without using a Riemann solver.  This method has been 
used to solve many types of ﬂow problems, such as detonation waves, shock/acoustic 
wave interaction, cavitating ﬂows, supersonic liquid jets, and chemically reacting ﬂows.  
In LS-DYNA, it has been extended to also solve ﬂuid-structure interaction (FSI) problems.  
It does this with two approaches.  The ﬁrst approach solves the compressible ﬂow equa-
tions on an Eulerian mesh while the structural mechanics is solved on a moving mesh 
that moves through the ﬁxed CE/SE mesh.  In the second approach (new with this ver-
sion), the CE/SE mesh moves in a fashion such that its FSI boundary surface matches the 
corresponding FSI boundary surface of the moving structural mechanics mesh.  This sec-
ond approach is more accurate for FSI problems, especially with boundary layers ﬂows.  
Another feature with the CESE moving mesh solver is conjugate heat transfer coupling 
with the solid thermal solver.  The chemistry and stochastic particle solvers are two ad-
don solvers that extend the CESE solver. 
 
The dual CESE solver is another compressible ﬂow solver that is also based upon the 
Conservation Element/Solution Element (CE/SE) method, but with improvements re-
lated to accuracy and robustness.  This method follows a similar novel numerical 

================================================================================
PAGE 16
================================================================================

*INTRODUCTION 
*INTRODUCTION 
1-2 (INTRODUCTION) 
R16@bdccd6d07 (03/10/25) 
framework for conservation laws.  In LS-DYNA, the dual CESE solver also include ﬂuid-
structure interaction (FSI) capabilities.  It also does this with two approaches.  The ﬁrst 
approach solves the compressible ﬂow equations on an Eulerian mesh while the struc-
tural mechanics is solved on a moving mesh that moves through the ﬁxed dual CE/SE 
mesh.  In the second approach.  the dual CE/SE mesh moves in a fashion such that its FSI 
boundary surface matches the corresponding FSI boundary surface of the moving struc-
tural mechanics mesh.  This second approach is more accurate for FSI problems, espe-
cially with boundary layers ﬂows.  One of the advances in these FSI computations with 
the dual CESE solver as compared with the older CESE solver is that each FSI approach 
(or ﬁxed mesh Eulerian solver) may be employed in diﬀerent subregions of the ﬂuid mesh 
in the same problem.  Unlike the *CESE solvers, the dual CESE solvers do not have con-
jugate heat transfer coupling with the solid thermal solver, nor coupling with the chem-
istry or stochastic particle solvers.  It is not clear if these *CESE capabilities will be added 
to dual CESE solver.  On the other hand, another advance capability available only with 
the dual CESE solvers is the availability of equations of state for pure and pseudo-pure 
ﬂuids of industrial interest in the REFPROP and COOLPROP EOS libraries.  These com-
plex EOSes are generally expensive to evaluate, so a bi-cubic table look-up mechanism 
has been developed that greatly accelerates their use. 
 
The third solver is the incompressible ﬂow solver (ICFD) that is fully coupled with the 
solid mechanics solver.  This coupling permits robust FSI analysis via either an explicit 
technique when the FSI is weak, or using an implicit coupling when the FSI coupling is 
strong.  In addition to being able to handle free surface ﬂows, there is also a bi-phasic 
ﬂow capability that involves modeling using a conservative Lagrangian interface track-
ing technique.  Basic turbulence models are also supported.  This solver is the ﬁrst in LS-
DYNA to make use of a new volume mesher that takes surface meshes bounding the ﬂuid 
domain as input (*MESH keywords).  In addition, during the time advancement of the 
incompressible ﬂow, the solution is adaptively re-meshed as an automatic feature of the 
solver.  Another important feature of the mesher is the ability to create boundary layer 
meshes.  These anisotropic meshes become a crucial part of the model when shear stresses 
are to be calculated near ﬂuid walls.  The ICFD solver is also coupled to the solid thermal 
solver using a monolithic approach for conjugate heat transfer problems. 
 
The fourth solver is an electromagnetics (EM) solver.  This module solves the Maxwell 
equations in the Eddy current (induction-diﬀusion) approximation.  This is suitable for 
cases where the propagation of electromagnetic waves in air (or vacuum) can be consid-
ered as instantaneous.  Therefore, the wave propagation is not solved.  The main appli-
cations are Magnetic Metal Forming, bending or welding, induced heating, ring 
expansions and so forth.  The EM module allows the introduction of a source of electrical 
current into solid conductors and the computation of the associated magnetic ﬁeld, elec-
tric ﬁeld, as well as induced currents.  The EM solver is coupled with the structural me-
chanics solver (the Lorentz forces are added to the mechanics equations of motion), and 
with the structural thermal solver (the ohmic heating is added to the thermal solver as an 
extra source of heat).  The EM ﬁelds are solved using a Finite Element Method (FEM) for 

================================================================================
PAGE 17
================================================================================

*INTRODUCTION 
*INTRODUCTION 
R16@bdccd6d07 (03/10/25) 
1-3 (INTRODUCTION) 
the conductors and a Boundary Element Method (BEM) for the surrounding air/insula-
tors.  Thus no air mesh is necessary. 
 
The ﬁfth solver is a battery electrochemistry solver.  At this time, the available capability 
involves a one-dimensional electrochemistry solver that is coupled to the structural me-
chanics and structural thermal solver in each structural element identiﬁed as being part 
of a battery cell.  It solves these one-dimensional models implicitly so as to be able to run 
simulations for very long physical times that are typical of battery-structure interaction 
problems. 
 
As stated above, the *CHEMISTRY and *STOCHASTIC cards are only used in the CESE 
solver at this time.

================================================================================
PAGE 18
================================================================================


================================================================================
PAGE 19
================================================================================

 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-1 (BATTERY) 
*BATTERY 
 
The keyword *BATTERY provides input data for the electrochemistry solver: 
*BATTERY_DATABASE_HISTORY_ALLNDS_ON_ELESET 
*BATTERY_DATABASE_HISTORY_GLOBALS 
*BATTERY_DATABASE_HISTORY_NODELIST_ON_ELESET 
*BATTERY_ECHEM_CELL_GEOMETRY 
*BATTERY_ECHEM_CONTROL_SOLVER 
*BATTERY_ECHEM_INITIAL 
*BATTERY_ECHEM_MAT_ANODE 
*BATTERY_ECHEM_MAT_CATHODE 
*BATTERY_ECHEM_MAT_ELECTROLYTE 
*BATTERY_ECHEM_THERMAL 
 
For now, the available capability involves a one-dimensional electrochemistry solver that 
is coupled to the structural mechanics and structural thermal solver in each structural 
element identiﬁed as being part of a battery cell.

================================================================================
PAGE 20
================================================================================

*BATTERY 
*BATTERY_DATABASE_HISTORY_ALLNDS_ON_ELESET 
2-2 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
*BATTERY_DATABASE_HISTORY_ALLNDS_ON_ELESET 
Purpose:  Enable output of battery electrochemistry solver data for all one-dimensional 
battery mesh nodes on each element in an element set.  The output goes to binary data-
base binout. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
LCUR 
IOOPT 
ESID 
 
 
 
 
Type 
F 
I 
I 
I 
 
 
 
 
Default 
0.0 
0 
0 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve; the abscissa is time, and 
the ordinate is time interval between outputs. 
IOOPT 
Flag to govern behavior of the output frequency load curve deﬁned 
by LCUR: 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 
ESID 
ID of a *SET_SOLID element set to use for the binout operation. 
The selected elements in the element set of volume structural ele-
ments must also be battery electrochemistry elements. 

================================================================================
PAGE 21
================================================================================

*BATTERY_DATABASE_HISTORY_NODELIST_ON_ELESET 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-3 (BATTERY) 
*BATTERY_DATABASE_HISTORY_NODELIST_ON_ELESET 
Purpose:  Enable output of battery electrochemistry solver data for a speciﬁed set of one-
dimensional battery mesh nodes on each element in an element set.  The output goes to 
binary database binout. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
LCUR 
IOOPT 
ESID 
 
 
 
 
Type 
F 
I 
I 
I 
 
 
 
 
Default 
0.0 
0 
0 
none 
 
 
 
 
 
Node ID Cards. Battery mesh nodes to select for battery data output in the elements 
selected by ESID in Card 1.  Include as many cards as needed.  This input ends at the next 
keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID1 
NID2 
NID3 
NID4 
NID5 
NID6 
NID7 
NID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
 
 VARIABLE  
 
DESCRIPTION 
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve; the abscissa is time, and 
the ordinate is time interval between outputs. 
IOOPT 
Flag to govern behavior of the output frequency load curve deﬁned 
by LCUR: 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 

================================================================================
PAGE 22
================================================================================

*BATTERY 
*BATTERY_DATABASE_HISTORY_NODELIST_ON_ELESET 
2-4 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 
ESID 
ID of a *SET_SOLID element set to use for the binout operation. 
The selected elements in the element set of volume structural ele-
ments must also be battery electrochemistry elements. 
NIDi 
Node ID i 

================================================================================
PAGE 23
================================================================================

*BATTERY_DATABASE_HISTORY_GLOBALS 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-5 (BATTERY) 
*BATTERY_DATABASE_HISTORY_GLOBALS 
Purpose:  Enable output of battery electrochemistry solver data.  The output goes to bi-
nary database binout. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
LCUR 
IOOPT 
 
 
 
 
 
Type 
F 
I 
I 
 
 
 
 
 
Default 
0.0 
0 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve; the abscissa is time, and 
the ordinate is time interval between outputs. 
IOOPT 
Flag to govern behavior of the output frequency load curve deﬁned 
by LCUR: 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 

================================================================================
PAGE 24
================================================================================

*BATTERY 
*BATTERY_ECHEM_CELL_GEOMETRY 
2-6 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
*BATTERY_ECHEM_CELL_GEOMETRY 
Purpose:  Set general-purpose geometry variables for a single cell BATTERY model. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IMODEL 
ALEN 
SLEN 
CLEN 
ACCLEN 
CCCLEN 
 
 
Type 
I 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NELEA 
NELES 
NELEC 
NELECCA
NELECCC
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
IMODEL 
Battery model identiﬁer (see Remark 1) 
ALEN 
Length of the anode side electrode 
SLEN 
Length of the separator 
CLEN 
Length of the cathode side electrode  
ACCLEN 
Length of the negative current collector 
CCCLEN 
Length of the positive current collector 
NELEA 
Number of elements in the anode electrode 
NELES 
Number of elements in the separator 
NELEC 
Number of elements in the cathode electrode  
NELECCA 
Number of elements in the anode current collector 

================================================================================
PAGE 25
================================================================================

*BATTERY_ECHEM_CELL_GEOMETRY 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-7 (BATTERY) 
 VARIABLE  
 
DESCRIPTION 
NELECCC 
Number of elements in the cathode current collector 
Remarks: 
1. 
Identiﬁer.  The battery model identiﬁer (IMODEL) should match the IMODEL 
value speciﬁed in the corresponding *BATTERY_ECHEM_CONTROL_-
SOLVER card.  If a diﬀerent value is given, the value on the *BATTERY_-
ECHEM_CONTROL_SOLVER card will be the default.

================================================================================
PAGE 26
================================================================================

*BATTERY 
*BATTERY_ECHEM_CONTROL_SOLVER 
2-8 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
*BATTERY_ECHEM_CONTROL_SOLVER 
Purpose:  Set general purpose control variables for a battery electrochemistry simulation. 
Card Summary: 
Card 1.  This card is required. 
IMODEL 
IDIMEN 
NCYCLE 
IAGING 
ITRA 
IGAS 
 
 
Card 2.  Include NCYCLE instances of this card, one for each cycle. 
CMODE 
CTYPE 
CEND 
TCUT 
VCUT 
RCURR 
 
 
Card 3.1. Include this card if IAGING = 1.  
SEIMW 
SEIRHO 
SEIBRUG 
SEIEPS 
SEIC0 
SEIT0 
 
 
Card 3.2.  Include this card if IAGING = 1. 
SEII0 
SEIRKA 
SEICON 
ECC0 
ECDFS 
 
 
 
Card 4.1.  Include this card if ITRA = 1. 
AFI 
EAT 
HOFEC 
HOFLI 
HOFLED 
 
 
 
Card 4.2.  Include this card if ITRA = 1. 
HOFC2H4 
HOFLC 
HOFCO2 
HOFO2 
 
 
 
 
Card 5.  Include this card if IGAS = 1. 
IC2H4 
IO2 
ICO2 
IH2O 
AG1 
AG2 
EG1 
EG2 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IMODEL 
IDIMEN 
NCYCLE 
IAGING 
ITRA 
IGAS 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
Default 
none 
none 
1 
1 
0 
0 
 
 

================================================================================
PAGE 27
================================================================================

*BATTERY_ECHEM_CONTROL_SOLVER 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-9 (BATTERY) 
 
 VARIABLE  
 
DESCRIPTION 
IMODEL 
Sets the battery model: 
EQ.1: Dual insertion model (Newman).  IAGING, ITRA, and 
IGAS must be set to 0.   
EQ.2: Multiphysics LIB model.  With IGAS = 0, the model in-
cludes thermal eﬀects while with IGAS = 1, the model in-
cludes both thermal and chemistry eﬀects.  Note that IAG-
ING and ITRA must be set to 1 for either case.  See Re-
mark 1. 
EQ.3: Lithium metal battery 
IDIMEN 
Sets the geometric dimension: 
EQ.1: 
1D LIB models 
EQ.101: 1D models with thermo-mechanical coupling (available 
for IMODEL = 1 and 2).  See Remark 2. 
NCYCLE 
Number of cycles to run.  Default is 1 cycle. 
IAGING 
Aging model ﬂag (see Remark 3): 
EQ.0: Oﬀ 
EQ.1: On  
ITRA 
Thermal runaway model ﬂag (see Remark 3): 
EQ.0: Oﬀ 
EQ.1: On 
IGAS 
Gas generation model ﬂag (see Remark 4): 
EQ.0: Oﬀ 
EQ.1: On  
 

================================================================================
PAGE 28
================================================================================

*BATTERY 
*BATTERY_ECHEM_CONTROL_SOLVER 
2-10 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
Cycle Card. Include NCYCLE instances of this card, that is, one for each cycle.  
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CMODE 
CTYPE 
CEND 
TCUT 
VCUT 
RCURR 
 
 
Type 
I 
I 
I 
F 
F 
F 
 
 
Default 
1 
0 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CMODE 
Battery running mode ﬂag: 
EQ.0: Galvanostatic run 
EQ.1: Potentiostatic run (This is under development and not rec-
ommended.) 
CTYPE 
Running current type: 
EQ.0: Constant current 
EQ.1: Variable current 
CEND 
Cause of battery cycle termination: 
EQ.1: Cycle run for a given time period. 
EQ.2: Cycle run until a given cut-oﬀ voltage. 
TCUT 
Total running time for the cycle 
VCUT 
Cut-oﬀ voltage for the cycle 
RCURR 
Cycle operating current in the case of constant current 
 

================================================================================
PAGE 29
================================================================================

*BATTERY_ECHEM_CONTROL_SOLVER 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-11 (BATTERY) 
Aging Card 1. Include this card if IAGING = 1. 
 Card 3.1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SEIMW 
SEIRHO 
SEIBRUG 
SEIEPS 
SEIC0 
SEIT0 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
0.0 
0.0 
0.0 
0.0 
0.0 
0.0 
 
 
 
Aging Card 2. Include this card if IAGING = 1. 
 Card 3.2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SEII0 
SEIRKA 
SEICON 
ECC0 
ECDFS 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0.0 
0.0 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SEIMW 
Molecular weight of the SEI 
SEIRHO 
Density of the SEI 
SEIBRUG 
The Bruggeman constant of the SEI 
SEIEPS 
Initial SEI porosity 
SEIC0 
Initial SEI concentration (units: mol/m3) 
SEIT0 
Initial thickness of the SEI layer (units: m) 
SEII0 
Exchange current density for the SEI reaction 
SEIRKA 
Reaction rate constant for the SEI reaction (ignored if SEII0 ≠ 0.0) 
SEICON 
Ionic conductivity (units: S/m) 
ECC0 
Initial concentration of EC (ethylene carbonate).  This ﬁeld is ig-
nored if SEII0 ≠ 0.0. 

================================================================================
PAGE 30
================================================================================

*BATTERY 
*BATTERY_ECHEM_CONTROL_SOLVER 
2-12 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
ECDFS 
Diﬀusion coeﬃcient of EC 
 
Thermal Runaway Card 1. Include this card if ITRA = 1. 
 Card 4.1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
AFI 
EAT 
HOFEC 
HOFLI 
HOFLED 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0.0 
0.0 
0.0 
0.0 
0.0 
 
 
 
 
Thermal Runaway Card 2. Include this card if ITRA = 1. 
 Card 4.2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
HOFC2H4
HOFLC 
HOFCO2 
HOFO2 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
0.0 
0.0 
0.0 
0.0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
AFI 
Frequency factor for the reaction 
EAT 
Activation energy for the reaction 
HOFEC 
Formation enthalpy of the EC (units: kJ/mol) 
HOFLI 
Formation enthalpy of the LI 
HOFLED 
Formation enthalpy of the SEI layer (units: kJ/mol) 
HOFC2H4 
Formation enthalpy of ethylene (units: kJ/mol) 
HOFLC 
Formation enthalpy of LC (Li2CO3; units: kJ/mol) 
HOFCO2 
Formation enthalpy of CO2 (units: kJ/mol) 
HOFO2 
Formation enthalpy of O2 (units: kJ/mol) 

================================================================================
PAGE 31
================================================================================

*BATTERY_ECHEM_CONTROL_SOLVER 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-13 (BATTERY) 
 
Gas Initial Conditions Card. Include this card if IGAS = 1. 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IC2H4 
IO2 
ICO2 
IH2O 
AG1 
AG2 
EG1 
EG2 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
0.0 
0.0 
0.0 
0.0 
3.426E26 5.028E-6
2.50e5 
2.51e5 
Remarks 
 
 
 
 
5 
5 
5 
5 
 
 VARIABLE  
 
DESCRIPTION 
IC2H4 
Initial concentration of C2H2 gas (units: mol/m3) 
IO2 
Initial concentration of O2 gas (units: mol/m3) 
ICO2 
Initial concentration of CO2 gas (units: mol/m3) 
IH2O 
Initial concentration of H2O gas (units: mol/m3) 
AG1 
Frequency factor for Ethylene oxidation (units: m/s) 
AG2 
Frequency factor for Lithium hydration (units: m/s) 
EG1 
Activation energy of Ethylene oxidation (units: J/mol) 
EG2 
Activation energy of Lithium hydration (units: J/mol) 
Remarks: 
1. 
Multiphysics Battery Models.  With IMODEL = 2, you can model a battery with 
thermal eﬀects or a battery with both thermal and chemistry eﬀects depending 
on the value of IGAS. These two battery models include battery aging, thermal 
runaway, and battery swelling.  The battery and chemistry eﬀects model addi-
tionally includes a gas generation model for modeling the chemistry eﬀects.  
2. 
Shutdown Key.  For coupled battery models (IDIMEN = 101) with IMODEL = 
1 or 2, the shutdown key will work if the minimum ignition energy in the battery 
system reaches the critical condition like pre-thermal-runaway. 
3. 
Input Requirements for Aging and Thermal Runaway Models. When IAG-
ING = 1, all the variables on Cards 3.1 and 3.2 must be ﬁlled.  A similar 

================================================================================
PAGE 32
================================================================================

*BATTERY 
*BATTERY_ECHEM_CONTROL_SOLVER 
2-14 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
requirement applies when ITRA = 1 in that all the variables of Cards 41 and 4.2 
must be ﬁlled.  For more details about these models, please see the Theory man-
ual. 
4. 
Battery Chemistry Files.  When IGAS = 1, *CHEMISTRY_BATTERY must be 
included in the input deck to provide the ﬁle names for the battery chemistry 
input ﬁle, the corresponding thermodynamics data ﬁle, and the transport prop-
erties ﬁle.  Please refer to the *CHEMISTRY chapter for further details about the 
*CHEMISTRY_BATTERY keyword. 
5. 
AG1, AG2, EG1, and EG2.  AG1, AG2, EG1, and EG2 are used to compute the 
rate of reaction based on Arrhenius equation as 
푟= 퐴푘푐푘푒
−EG푘
푅푇   . 
퐴푘 is the frequency factor for the reaction, 푐푘 is the concentration, EG푘 is the ac-
tivation energy for the reaction, 푅 is the universal gas constant, and 푇 is the tem-
perature.

================================================================================
PAGE 33
================================================================================

*BATTERY_ECHEM_INITIAL 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-15 (BATTERY) 
*BATTERY_ECHEM_INITIAL 
Purpose:  Initializes the composite electrodes and electrolyte in every element of the BAT-
TERY simulation mesh.   
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT0 
LICE 
PHI1 
LICS 
CURRIC 
FLUXIC 
PHI2 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
DT0 
Initial time step size 
LICE 
Initial concentration of lithium ions in the electrolyte 
PHI1 
Initial condition of the electrolyte potential 
LICS 
Initial concentration of lithium in the solid particles 
CURRIC 
Initial current of the cycle operation 
FLUXIC 
Initial pore wall ﬂux 
PHI2 
Initial condition of the electrode potential 

================================================================================
PAGE 34
================================================================================

*BATTERY 
*BATTERY_ECHEM_MAT_ANODE 
2-16 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
*BATTERY_ECHEM_MAT_ANODE 
Purpose:  Set the battery material variables for the anode side electrode. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PIDA 
IOCPA 
CAPTA 
SOCA 
RADA 
RATEA 
RANODE 
 
Type 
I 
I 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RHOEA 
RHOFA 
RHOCCA 
DFSA 
CONDA 
MWA 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VFEA 
VFPA 
VFFA 
VFGA 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PIDA 
Part ID 
IOCPA 
Material type for the OCP in the anode electrode: 
EQ.1: Sony carbon (petroleum coke) 
EQ.2: MCMB 2510 
EQ.3: MCMB 2528 

================================================================================
PAGE 35
================================================================================

*BATTERY_ECHEM_MAT_ANODE 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-17 (BATTERY) 
 VARIABLE  
 
DESCRIPTION 
EQ.4: KS6 graphite 
CAPTA 
Coulombic capacity of anode material (units: mAh/g) 
SOCA 
Initial lithium stoichiometric coeﬃcient of the anode side active
material.  For example, LixC6 (0 < x < 0.7). 
RADA 
Radius of spherical particles in the anode side active material 
(units: m) 
RATEA 
Reaction rate constant for the anode electrode 
RANODE 
Film resistance for the anode electrode 
RHOEA 
Density of anode insertion material (electrode particles) (kg/m3)
RHOFA 
Density of the inert ﬁller in the anode (units: kg/m3) 
RHOCCA 
Density of the current collector in the anode (units: kg/m3) 
DFSA 
Diﬀusion coeﬃcient of lithium ions in the anode electrode mate-
rial (units: m2/s) 
CONDA 
Eﬀective electronic conductivity of the anode porous electrode 
(units: S/m) 
MWA 
Molecular weight of the anode electrode (units: kg/mol) 
VFEA 
Volume fraction of electrolyte in the anode electrode 
VFPA 
Volume fraction of the polymer phase in the anode electrode 
VFFA 
Volume fraction of the inert ﬁller in the anode electrode 
VFGA 
Volume fraction of the gas in the anode electrode 

================================================================================
PAGE 36
================================================================================

*BATTERY 
*BATTERY_ECHEM_MAT_CATHODE 
2-18 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
*BATTERY_ECHEM_MAT_CATHODE 
Purpose:  Set the battery material variables for the positive electrode. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PIDC 
IOCPC 
CAPTC 
SOCC 
RADC 
RATEC 
RCATHDE
 
Type 
I 
I 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RHOEC 
RHOFC 
RHOCCC 
DFSC 
CONDC 
MWC 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VFEC 
VFPC 
VFFC 
VFGC 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PIDC 
Part ID 
IOCPC 
Material type for the open-circuit potential: 
EQ.1: Mn2O4(lower plateau) (1.1 < y < 1.99) 
EQ.2: Mn2O4 (upper plateau) (0.17 < y < 0.99) 
EQ.3: Cobalt dioxide 1, LiyCoO2 (0.0 < y < 0.99) 

================================================================================
PAGE 37
================================================================================

*BATTERY_ECHEM_MAT_CATHODE 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-19 (BATTERY) 
 VARIABLE  
 
DESCRIPTION 
EQ.4: Cobalt dioxide 2, LiyCoO2 (0.0 < y < 0.99) 
EQ.5: Mn2O4 (literature version) (0.17 < y < 0.99) 
EQ.6: NMC-111 
EQ.7: NMC-811 
CAPTC 
Coulombic capacity of the cathode material (units: mAh/g) 
SOCC 
Initial lithium stoichiometric coeﬃcient for the cathode side active 
material.  For example, LiyWO3 (0 < y < 0.67). 
RADC 
Radius of spherical particle in the cathode side active material.
(units: m) 
RATEC 
Reaction rate constant for the cathode electrode 
RCATH 
Film resistance for the cathode electrode 
RHOEC 
Density of the cathode insertion material (electrode particles). 
(units: kg/m3) 
RHOFC 
Density of the cathode side inert ﬁller (units: kg/m3) 
RHOCCC 
Density of the cathode side current collector (units: kg/m3) 
DFSC 
Diﬀusion coeﬃcient of lithium ions in the cathode insertion mate-
rial (units: m2/s) 
CONDC 
Eﬀective electronic conductivity of the cathode porous electrode 
(units: S/m). 
MWC 
Molecular weight of the cathode electrode (units: kg/mol) 
VFEC 
Volume fraction of electrolyte in the cathode electrode 
VFPC 
Volume fraction of the polymer phase in the cathode electrode 
VFFC 
Volume fraction of the inert ﬁller in the cathode electrode 
VFGC 
Volume fraction of the gas in the cathode electrode 

================================================================================
PAGE 38
================================================================================

*BATTERY 
*BATTERY_ECHEM_MAT_ELECTROLYTE 
2-20 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
*BATTERY_ECHEM_MAT_ELECTROLYTE 
Purpose:  Set the battery material variables for the electrolyte and separator. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PIDEL 
IOCPE 
IELTYPE 
RHOEL 
RHOP 
RHOS 
 
 
Type 
I 
I 
I 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VFES 
VFPS 
VFGS 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PIDEL 
Part ID 
IOPCE 
Material type for the open-circuit potential: 
EQ.1: LiPF6 in EC : DMC (1:1). 
EQ.2: LiPF6 in EC : DMC (2:1). 
EQ.3: LiPF6 in EC : DMC (1:2). 
EQ.4: LiPF6 in PC 
EQ.5: LiClO4 in PC 
Here, EC is ethylene carbonate, DMC is dimethyl carbonate, and 
PC is propylene carbonate. 
IELTYPE 
Type of electrolyte (units: kg/m3): 
EQ.0: Liquid electrolyte 
EQ.1: Polymer electrolyte  

================================================================================
PAGE 39
================================================================================

*BATTERY_ECHEM_MAT_ELECTROLYTE 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-21 (BATTERY) 
 VARIABLE  
 
DESCRIPTION 
RHOEL 
Density of the electrolyte (units: kg/m3) 
RHOP 
Density of the polymer phase (units: kg/m3) 
RHOS 
Density of the separator material (units: kg/m3) 
VFES 
Volume fraction of electrolyte in the separator 
VFPS 
Volume fraction of the polymer phase in the separator 
VFGS 
Volume fraction of the gas in the separator 

================================================================================
PAGE 40
================================================================================

*BATTERY 
*BATTERY_ECHEM_THERMAL 
2-22 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
*BATTERY_ECHEM_THERMAL 
Purpose:  Set parameters for the thermal treatment in a cell stack. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TNAME 
ITTYPE 
IPRT 
CP 
HCONV 
TEMP 
 
 
Type 
A 
I 
I 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
Remarks 
 
 
3 
2 
2 
2 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
TNAME 
Thermal material identiﬁer 
ITTYPE 
Flag for how temperature is determined: 
EQ.0: Constant temperature mode 
EQ.1: Isothermal temperature with time 
EQ.2: Thermal coupling with LS-DYNA thermal solver 
IPRT 
Data print in ASCII format: 
EQ.0: No data print out. 
EQ.1: Time versus heat ﬂux print out for thermal solver 
CP 
Speciﬁc heat coeﬃcient of the cell (units: J/(kg K)) 
HCONV 
Convective heat transfer coeﬃcient with external medium.  (units: 
W/(m2K)) 
TEMP 
Ambient temperature around the cell stack (K) 

================================================================================
PAGE 41
================================================================================

*BATTERY_ECHEM_THERMAL 
*BATTERY 
R16@bdccd6d07 (03/10/25) 
2-23 (BATTERY) 
 VARIABLE  
 
DESCRIPTION 
FILE 
Name of the battery cell output ﬁle (ASCII) 
Remarks: 
1. 
Battery Parts for Thermal-Mechanical Coupling.  In case of thermal-mechan-
ical coupling, the part number for the battery simulation must be speciﬁed, so 
only this part number is considered in the battery parts.  
2. 
Material Properties for Thermal-Mechanical Coupling. If ITTYPE is 2, the 
material properties are set through the thermal material card, including aniso-
tropic conductivities (see *MAT_THERMAL_ORTHOTROPIC).  CP, HCONV, 
and TEMP speciﬁed here are ignored. 
3. 
Heat Flux Output. If IPRT = 1, then the heat ﬂux generated by the battery solver 
is printed out.  
Example: 
The following is a partial example for 1D Electrochemisty. 
*Keyword 
$ 
*TITLE 
1D battery models 
$ 
*BATTERY_ECHEM_CONTROL_SOLVER 
$--------1---------2---------3---------4---------5---------6---------7 
$   imodel    idimen    ncycle    iaging      itra      igas 
         2         1         1         1         1         1 
$    cmode     ctype      cend      tcut      vcut     rcurr 
         0         0         2       0.0       3.0      8.75 
$ aging cards 
$    seimw    seirho   seibrug    seieps     seic0     seit0 
       0.0       0.0       0.0       0.0       0.0       0.0 
$    seii0    seirka    seicon      ecc0     ecdfs 
       0.0       0.0       0.0       0.0       0.0 
$ thermal runaway cards 
$      afi       eat     hofec     hofli    hofled 
       0.0       0.0       0.0       0.0       0.0 
$  hofc2h4     hoflc    hofco2     hofo2 
       0.0       0.0       0.0       0.0 
$ gas initial conditions card 
     ic2h4       io2      ico2      ih2o       ag1       ag2       eg1       eg2 
   1.0e-10   1.0e-10   1.0e-10   1.0e-10       0.0       0.0       0.0       0.0 
*CHEMISTRY_BATTERY 
  battery.inp 
  btherm.dat 
  btran.dat 
$ 
*BATTERY_ECHEM_INITIAL 
$--------1---------2---------3---------4---------5---------6---------7 
$      dt0      lice      phi1      lics    curric    fluxic      phi2 
      0.02    1000.0       0.0      0.05       0.0       5.0   -1.0e-7   
$ 

================================================================================
PAGE 42
================================================================================

*BATTERY 
*BATTERY_ECHEM_THERMAL 
2-24 (BATTERY) 
R16@bdccd6d07 (03/10/25) 
*BATTERY_ECHEM_CELL_GEOMETRY 
$--------1---------2---------3---------4---------5---------6---------7 
$   imodel      alen      slen     clen     acclen    ccclen 
         2    9.6e-5    2.5e-5   6.0e-5     1.0e-5    1.0e-5 
$    nelea     neles     nelec   
        40        40        80      
$ 
*BATTERY_ECHEM_MAT_ANODE 
$--------1---------2---------3---------4---------5---------6---------7 
$     pida     i0cpa     capta      soca      rada     ratea    ranode 
         2         3     372.0       0.6    8.0e-6    3.0e-9   0.35e-2 
$    rhoea     rhofa    rhocca      dfsa     conda       mwa 
    1800.0    1800.0    8954.0   7.0e-14     100.0     0.079 
$     vfec      vfpc      vffc      vfgc     
       0.4       0.0     0.064       0.0 
$ 
*BATTERY_ECHEM_MAT_CATHODE 
$--------1---------2---------3---------4---------5---------6---------7 
$     pidc     iocpc     captc      socc      radc     ratec   rcathde 
         2         3     274.0       0.8    5.0e-6    3.0e-9       0.0 
$    rhoec     rhofc    rhoccc      dfsc     condc       mwc 
    5010.0    1800.0    2707.0   3.0e-14       0.5    0.9787 
$    vfelc     vfplc     vffic     vfgsx     
      0.36       0.0     0.106       0.0 
$ 
*BATTERY_ECHEM_MAT_ELECTROLYTE 
$--------1---------2---------3---------4---------5---------6---------7 
$    pidel     iocpe   ieltype     rhoel      rhop      rhos     
         2         1         0    1324.0    1780.0     552.0     
$    vfels     vfpls     vfgss    
       0.4       0.0       0.0    
$ 
*BATTERY_ECHEM_THERMAL 
$--------1---------2---------3---------4---------5---------6---------7 
$    tname    ittype      iprt        cp     hconv      temp       
  hot_batt         1         0     500.0       0.0    298.15      
heat_discharg_lco.k 
$ 
*END

================================================================================
PAGE 43
================================================================================

 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-1 (CESE) 
*CESE 
 
The keyword *CESE provides input data for the Conservation Element/Solution Element 
(CESE) compressible ﬂuid solver: 
*CESE_BOUNDARY_AXISYMMETRIC_{OPTION} 
*CESE_BOUNDARY_BLAST_LOAD} 
*CESE_BOUNDARY_CONJ_HEAT_{OPTION} 
*CESE_BOUNDARY_CYCLIC_{OPTION} 
*CESE_BOUNDARY_FSI_{OPTION} 
*CESE_BOUNDARY_NON_REFLECTIVE_{OPTION} 
*CESE_BOUNDARY_PRESCRIBED_{OPTION} 
*CESE_BOUNDARY_REFLECTIVE_{OPTION} 
*CESE_BOUNDARY_SLIDING_{OPTION} 
*CESE_BOUNDARY_SOLID_WALL_{OPTION1}_{OPTION2} 
*CESE_CHEMISTRY_D3PLOT 
*CESE_CONTROL_LIMITER 
*CESE_CONTROL_MESH_MOV 
*CESE_CONTROL_SOLVER 
*CESE_CONTROL_TIMESTEP 
*CESE_DATABASE_ELOUT 
*CESE_DATABASE_FLUXAVG 
*CESE_DATABASE_FSIDRAG 
*CESE_DATABASE_POINTOUT 
*CESE_DATABASE_SSETDRAG 
*CESE_DEFINE_NONINERTIAL 
*CESE_DEFINE_POINT 

================================================================================
PAGE 44
================================================================================

*CESE 
 
3-2 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_DRAG 
*CESE_EOS_CAV_HOMOG_EQUILIB_ 
*CESE_EOS_IDEAL_GAS 
*CESE_EOS_INFLATOR1 
*CESE_EOS_INFLATOR2 
*CESE_FSI_EXCLUDE 
*CESE_INITIAL 
*CESE_INITIAL_{OPTION} 
*CESE_INITIAL_CHEMISTRY 
*CESE_INITIAL_CHEMISTRY_ELEMENT 
*CESE_INITIAL_CHEMISTRY_PART 
*CESE_INITIAL_CHEMISTRY_SET 
*CESE_MAT_000 
*CESE_MAT_001 (*CESE_MAT_GAS) 
*CESE_MAT_002 
*CESE_PART 
*CESE_SURFACE_MECHSSID_D3PLOT 
*CESE_SURFACE_MECHVARS_D3PLOT 
 
Note that when performing a chemistry calculation with the CESE solver, initialization 
should only be done with the *CESE_INITIAL_CHEMISTRY_… cards, not the *CESE_-
INITIAL… cards.

================================================================================
PAGE 45
================================================================================

*CESE_BOUNDARY_AXISYMMETRIC 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-3 (CESE) 
*CESE_BOUNDARY_AXISYMMETRIC_OPTION 
Available options are: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose: Deﬁne an axisymmetric boundary condition on the axisymmetric axis for the 
2D axisymmetric CESE compressible ﬂow solver.  
 
The MSURF and MSURF_SET options are used when the CESE mesh has been created 
using *MESH cards.  The SET and SEGMENT cards are used when *ELEMENT_SOLID 
cards are used to deﬁne the CESE mesh. 
Card Summary: 
Card 1a.  This card is included if the keyword option is MSURF. Provide as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
MSURFID 
 
 
 
 
 
 
 
Card 1b.  This card is included if the keyword option is MSURF_SET. Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
MSURF_S 
 
 
 
 
 
 
 
Card 1c.  This card is included if the keyword option is SET. Provide as many cards as 
necessary.  This input ends at the next keyword (“*”) card. 
SSID 
 
 
 
 
 
 
 
Card 1d.  This card is included if the keyword option is SEGMENT. Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
N1 
N2 
N3 
N4 
 
 
 
 

================================================================================
PAGE 46
================================================================================

*CESE 
*CESE_BOUNDARY_AXISYMMETRIC 
3-4 (CESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format used when the MSURF keyword option is active. 
Provide as many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced in *MESH_SURFACE_ELEMENT 
cards. 
 
Surface Part Set Card. Card 1 format used when the MSURF_SET keyword option is 
active.  Provide as many cards as necessary.  This input ends at the next keyword (“*”) 
card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
Identiﬁer of a set of mesh surface part IDs created with a *LSO_-
ID_SET card, where each mesh surface part ID in the set is refer-
enced in *MESH_SURFACE_ELEMENT cards. 
 

================================================================================
PAGE 47
================================================================================

*CESE_BOUNDARY_AXISYMMETRIC 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-5 (CESE) 
Set Card. Card 1 format used when the SET keyword option is active.  Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
 
Segment Cards. Card 1 format used when SEGMENT keyword option is active.  Include 
an additional card for each corresponding pair of segments.  This input ends at the next 
keyword (“*”) card. 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2, … 
Node IDs deﬁning a segment 
Remarks: 
1. 
Restrictions.  This boundary condition can only be used on the axisymmetric 
axis for the 2D axisymmetric CESE ﬂuid solver.

================================================================================
PAGE 48
================================================================================

*CESE 
*CESE_BOUNDARY_BLAST_LOAD 
3-6 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_BOUNDARY_BLAST_LOAD_OPTION 
Available options include: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose:  For the CESE compressible ﬂow solver, set boundary values for velocity, den-
sity, and pressure from a blast wave deﬁned by a *LOAD_BLAST_ENHANCED card.  
Boundary values are applied at the centroid of elements connected with this boundary.  
OPTION = SET and OPTION = SEGMENT are for user deﬁned meshes whereas OP-
TION = MSURF and OPTION = MSURF_SET are associated with the automatic volume 
mesher (See *MESH keywords).  In other words, the MSURF and MSURF_SET options 
are used when the CESE mesh has been created using *MESH cards.  The SET and SEG-
MENT cards are used when *ELEMENT_SOLID cards are used to deﬁne the CESE mesh. 
Card Summary: 
Card 1a.  This card is included if the keyword option is MSURF. 
BID 
MSURFID 
 
 
 
 
 
 
Card 1b.  This card is included if the keyword option is MSURF_SET. 
BID 
MSURF_S 
 
 
 
 
 
 
Card 1c.  This card is included if the keyword option is SET. 
BID 
SSID 
 
 
 
 
 
 
Card 1d. This card is included if the keyword option is SEGMENT.  
BID 
N1 
N2 
N3 
N4 
 
 
 

================================================================================
PAGE 49
================================================================================

*CESE_BOUNDARY_BLAST_LOAD 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-7 (CESE) 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format used when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BID 
MSURFID
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
BID 
Blast source ID (see *LOAD_BLAST_ENHANCED) 
MSURFID 
A mesh surface part ID referenced in *MESH_SURFACE_ELE-
MENT cards 
 
Surface Part Set Card. Card 1 format used when the MSURF_SET keyword option is 
active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BID 
MSURF_S
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
BID 
Blast source ID (see *LOAD_BLAST_ENHANCED) 
MSURF_S 
Identiﬁer of a set of mesh surface part IDs created with a *LSO_-
ID_SET card, where each mesh surface part ID in the set is refer-
enced in *MESH_SURFACE_ELEMENT cards. 
 

================================================================================
PAGE 50
================================================================================

*CESE 
*CESE_BOUNDARY_BLAST_LOAD 
3-8 (CESE) 
R16@bdccd6d07 (03/10/25) 
Set Card. Card 1 format used when the SET keyword option is active. 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BID 
SSID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
BID 
Blast source ID (see *LOAD_BLAST_ENHANCED) 
SSID 
Segment set ID 
 
Segment Card. Card 1 for SEGMENT keyword option is active. 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BID 
N1 
N2 
N3 
N4 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
BID 
Blast source ID (see *LOAD_BLAST_ENHANCED) 
N1, N2, … 
Node ID’s deﬁning a segment 

================================================================================
PAGE 51
================================================================================

*CESE_BOUNDARY_CONJ_HEAT 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-9 (CESE) 
*CESE_BOUNDARY_CONJ_HEAT_OPTION 
Available options are: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose: Deﬁne a conjugate heat transfer interface condition for CESE compressible 
ﬂows.  This condition identiﬁes those boundary faces of the CESE mesh that are in contact 
with non-moving structural parts and through which heat ﬂows.  This is only possible 
when the structural thermal solver is also being used in the structural parts. 
 
The MSURF and MSURF_SET options are used when the CESE mesh has been created 
using *MESH cards.  The SET and SEGMENT cards are used when *ELEMENT_SOLID 
cards are used to deﬁne the CESE mesh. 
Card Summary: 
Card 1a.  This card is included when the keyword option is MSURF. Include as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
MSURFID 
 
 
 
 
 
 
 
Card 1b.  This card is included when the keyword option is MSURF_SET. Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
MSURF_S 
 
 
 
 
 
 
 
Card 1c.  This card is included when the keyword option is SET. Include as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
SSID 
 
 
 
 
 
 
 
Card 1d.  This card is included when the keyword option is SEGMENT. Include as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
N1 
N2 
N3 
N4 
 
 
 
 

================================================================================
PAGE 52
================================================================================

*CESE 
*CESE_BOUNDARY_CONJ_HEAT 
3-10 (CESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
Surface Part Card.  Card 1 used when the MSURF keyword option is active.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced in *MESH_SURFACE_ELEMENT 
cards. 
 
Surface Part Set Card.  Card 1 used when the MSURF_SET keyword option is active. 
Include as many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
Identiﬁer of a set of mesh surface part IDs created with an *LSO_-
ID_SET card, where each mesh surface part ID in the set is refer-
enced in *MESH_SURFACE_ELEMENT cards. 
 

================================================================================
PAGE 53
================================================================================

*CESE_BOUNDARY_CONJ_HEAT 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-11 (CESE) 
Set Card.  Card 1 used when the SET keyword option is active.  Include as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
 
Segment Cards.  Card 1 used when SEGMENT keyword option is active.  Include an 
additional card for each corresponding pair of segments.  This input ends at the next 
keyword (“*”) card. 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2, … 
Node IDs deﬁning a segment 
Remarks: 
1. 
Restrictions. This boundary condition should only be imposed on a CESE mesh 
boundary that is in contact with non-moving structural parts.  An Eulerian CESE 
solver is required as is use of the structural thermal solver.

================================================================================
PAGE 54
================================================================================

*CESE 
*CESE_BOUNDARY_CYCLIC 
3-12 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_BOUNDARY_CYCLIC_OPTION 
Available options are: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose: Deﬁne a cyclic (periodic) boundary condition for CESE compressible ﬂows.  
This cyclic boundary condition can be used on periodic boundary surfaces. 
 
The MSURF and MSURF_SET options are used when the CESE mesh has been created 
using *MESH cards.  The SET and SEGMENT cards are used when *ELEMENT_SOLID 
cards are used to deﬁne the CESE mesh. 
Card Summary: 
Include as many sets of the following cards as needed.  This input ends at the next key-
word (“*”) card. 
Card 1a.  This card is included when the keyword option is set to MSURF. 
MSURFID1
MSURFID2
CYCTYP 
 
 
 
 
 
Card 1b.  This card is included when the keyword option is set to MSURF_SET. 
MSRF_S1 
MSRF_S2 
CYCTYP 
 
 
 
 
 
Card 1c.  This card is included when the keyword option is set to SET. 
SSID1 
SSID2 
CYCTYP 
 
 
 
 
 
Card 1d.  This card is included when the keyword option is set to SEGMENT. 
ND1 
ND2 
ND3 
ND4 
NP1 
NP2 
NP3 
NP4 
Card 2a.  This card is included for the MSURF, MSURF_SET, and SET options when 
CYCTYP = 1. 
AXISX1 
AXISY1 
AXISZ1 
DIRX 
DIRY 
DIRZ 
ROTANG 
 

================================================================================
PAGE 55
================================================================================

*CESE_BOUNDARY_CYCLIC 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-13 (CESE) 
Card 2b.  This card is included for the MSURF, MSURF_SET, and SET options when 
CYCTYP = 2. 
TRANSX 
TRANSY 
TRANSZ 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format when the MSURF keyword option is active 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable MSURFID1 MSURFID2
CYCTYP 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
0 
 
 
 
 
 
Remarks 
2 
2 
1 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID1, 
MSURFID2 
Mesh surface part IDs referenced in *MESH_SURFACE_ELE-
MENT cards.   
CYCTYP 
Relationship between the two cyclic boundary condition sur-
faces: 
EQ.0: None assumed (default) 
EQ.1: The ﬁrst surface is rotated about an axis to match the 
second surface. 
EQ.2: The faces of the ﬁrst surface are translated in a given di-
rection to obtain the corresponding faces on the second 
surface. 
 

================================================================================
PAGE 56
================================================================================

*CESE 
*CESE_BOUNDARY_CYCLIC 
3-14 (CESE) 
R16@bdccd6d07 (03/10/25) 
Surface Part Set Card. Card 1 format when the MSURF_SET keyword option is active 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSRF_S1 MSRF_S2
CYCTYP 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
0 
 
 
 
 
 
Remarks 
3 
3 
1 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSRF_S1, 
MSRF_S2 
Identiﬁers of two sets of mesh surface part IDs, each created with
a *LSO_ID_SET card, where each mesh surface part ID in each 
set is referenced in *MESH_SURFACE_ELEMENT cards. 
CYCTYP 
Relationship between the two cyclic boundary condition sur-
faces: 
EQ.0: None assumed (default) 
EQ.1: The ﬁrst surface is rotated about an axis to match the 
second surface. 
EQ.2: The faces of the ﬁrst surface are translated in a given di-
rection to obtain the corresponding faces on the second 
surface. 
 
Set Card. Card 1 format when the SET keyword option is active 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID1 
SSID2 
CYCTYP 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
0 
 
 
 
 
 
Remarks 
4 
4 
1 
 
 
 
 
 
 

================================================================================
PAGE 57
================================================================================

*CESE_BOUNDARY_CYCLIC 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-15 (CESE) 
 VARIABLE  
 
DESCRIPTION 
SSID1, SSID2 
A pair of segment set IDs.  
CYCTYP 
Relationship between the two cyclic boundary condition sur-
faces: 
EQ.0: None assumed (default) 
EQ.1: The ﬁrst surface is rotated about an axis to match the 
second surface. 
EQ.2: The faces of the ﬁrst surface are translated in a given di-
rection to obtain the corresponding faces on the second 
surface. 
 
Segment Card. Card 1 format when SEGMENT keyword option is active.  Include an 
additional card for each corresponding pair of segments.  This input ends at the next
keyword (“*”) card. 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ND1 
ND2 
ND3 
ND4 
NP1 
NP2 
NP3 
NP4 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
NDi, NPi 
Node IDs deﬁning a pair of segments: ND1, ND2, ND3, ND4 de-
ﬁne the ﬁrst segment, while NP1, NP2, NP3, NP4 deﬁne the sec-
ond segment.  This pair of segments must match either through 
a geometric translation or rotation. 
 

================================================================================
PAGE 58
================================================================================

*CESE 
*CESE_BOUNDARY_CYCLIC 
3-16 (CESE) 
R16@bdccd6d07 (03/10/25) 
Rotation Case Card. Additional card for the MSURF, MSURF_SET, and SET options 
when CYCTYP = 1. 
 Card 2a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
AXISX1 
AXISY1 
AXISZ1 
DIRX 
DIRY 
DIRZ 
ROTANG 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
0.0 
0.0 
0.0 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
AXIS[Z,Y,Z]1 
A point on the axis of rotation  
DIR[X,Y,Z] 
The direction which together with AXIS[X,Y,Z]1 deﬁnes the axis 
of rotation  
ROTANG 
The angle of rotation (in degrees) that transforms the centroid of 
each face on the ﬁrst surface to the centroid of the corresponding 
face on the second surface  
 
Translation Case Card. Additional card for the MSURF, MSURF_SET, and SET options 
when CYCTYP = 2. 
 Card 2b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TRANSX 
TRANSY 
TRANSZ 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
TRANS[X,Y,Z] 
The translation direction that enables the identiﬁcation of the 
segment in the second surface that matches a segment in the ﬁrst
surface  

================================================================================
PAGE 59
================================================================================

*CESE_BOUNDARY_CYCLIC 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-17 (CESE) 
Remarks: 
1. 
CYCTYP.  For the MSURF, MSURF_SET, or SET options with CYCTYP = 0, the 
code examines the geometry of two faces of the two surfaces in order to deter-
mine if the surfaces are approximately parallel (CYCTYP = 2) or related through 
a rotation (CYCTYP = 1).  The geometric parameters required are then com-
puted. 
2. 
MSURF.  For the MSURF option, the number of mesh surface elements must be 
the same in each mesh surface part.  The mesh surface elements in each mesh 
surface part are then internally ordered to match pairwise between the two mesh 
surface parts. 
3. 
MSURF_SET. For the MSURF_SET option, the number of mesh surface ele-
ments must be the same in each mesh surface part set.  The mesh surface ele-
ments in each mesh surface part set are then internally ordered to match 
pairwise between the two mesh surface part sets. 
4. 
SET.  For the SET option, the same number of segments must be in each set.  The 
segments in each set are then internally ordered to match pairwise between the 
two sets.

================================================================================
PAGE 60
================================================================================

*CESE 
*CESE_BOUNDARY_FSI 
3-18 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_BOUNDARY_FSI_OPTION 
Available options are: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose: Deﬁne an FSI boundary condition for the moving mesh CESE compressible ﬂow 
solver.  This card must not be combined with the immersed-boundary method CESE 
solver; doing so will result in an error termination condition. 
 
This boundary condition must be applied on a surface of the CESE computational domain 
that is co-located with surfaces of the outside boundary of the structural mechanics’ 
mesh.  The nodes of the two meshes will generally not be shared. 
 
The MSURF and MSURF_SET options are used when the CESE mesh has been created 
using *MESH cards.  The SET and SEGMENT cards are used when *ELEMENT_SOLID 
cards are used to deﬁne the CESE mesh. 
Card Summary: 
Card 1a.  This card is included if the keyword option is MSURF. Provide as many cards 
as necessary.  This input ends at the next keyword (“*”) card.  
MSURFID 
 
 
 
 
 
 
 
Card 1b.  This card is included if the keyword option is MSURF_SET. Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
MSURF_S 
 
 
 
 
 
 
 
Card 1c.  This card is included if the keyword option is SET. Provide as many cards as 
necessary.  This input ends at the next keyword (“*”) card. 
SSID 
 
 
 
 
 
 
 
Card 1d.  This card is included if the keyword option is SEGMENT. Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
N1 
N2 
N3 
N4 
 
 
 
 

================================================================================
PAGE 61
================================================================================

*CESE_BOUNDARY_FSI 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-19 (CESE) 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format used when the MSURF keyword option is active. 
Provide as many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced in *MESH_SURFACE_ELEMENT 
cards 
 
Surface Part Set Card. Card 1 format used when the MSURF_SET keyword option is 
active.  Provide as many cards as necessary.  This input ends at the next keyword (“*”) 
card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
Identiﬁer of a set of mesh surface part IDs created with a *LSO_-
ID_SET card, where each mesh surface part ID in the set is refer-
enced in *MESH_SURFACE_ELEMENT cards. 
 

================================================================================
PAGE 62
================================================================================

*CESE 
*CESE_BOUNDARY_FSI 
3-20 (CESE) 
R16@bdccd6d07 (03/10/25) 
Set Card. Card 1 format used when the SET keyword option is active.  Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
 
Segment Cards. Card 1 format used when SEGMENT keyword option is active.  Include 
an additional card for each corresponding pair of segments.  This input ends at the next 
keyword (“*”) card. 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, … 
Node IDs deﬁning a segment 
Remarks: 
1. 
Conjugate Heat Transfer Problems. This boundary condition card is also 
needed for conjugate heat transfer problems with the moving mesh CESE solver.

================================================================================
PAGE 63
================================================================================

*CESE_BOUNDARY_NON_REFLECTIVE 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-21 (CESE) 
*CESE_BOUNDARY_NON_REFLECTIVE_OPTION 
Available options are: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose: Deﬁne a passive boundary condition for CESE compressible ﬂows.  This non-
reﬂective boundary condition (NBC) provides an artiﬁcial computational boundary for 
an open boundary that is passive. 
 
Use the MSURF and MSURF_SET options when you use the *MESH cards to generate 
the CESE mesh.  Use the SET and SEGMENT cards when *ELEMENT_SOLID cards de-
ﬁne the CESE mesh. 
Card Summary: 
Card 1a.  Include this card for the MSURF keyword option.  Include as many cards as 
necessary.  This input ends at the next keyword (“*”) card. 
MSURFID 
 
 
 
 
 
 
 
Card 1b.  Include this card for the MSURF_SET keyword option.  Include as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
MSURF_S 
 
 
 
 
 
 
 
Card 1c.  Include this card for the SET keyword option.  Include as many cards as nec-
essary.  This input ends at the next keyword (“*”) card. 
SSID 
 
 
 
 
 
 
 
Card 1d.  Include this card for the SEGMENT keyword option.  Include an additional 
card for each corresponding pair of segments.  This input ends at the next keyword (“*”) 
card. 
N1 
N2 
N3 
N4 
 
 
 
 

================================================================================
PAGE 64
================================================================================

*CESE 
*CESE_BOUNDARY_NON_REFLECTIVE 
3-22 (CESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
Surface Part Card.  Card 1 used when the MSURF keyword option is active.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced by *MESH_SURFACE_ELEMENT 
cards 
 
Surface Part Set Card.  Card 1 used when the MSURF_SET keyword option is active. 
Include as many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
ID of a set of mesh surface parts created with an *LSO_ID_SET 
card, where each mesh surface part ID in the set is referenced by 
*MESH_SURFACE_ELEMENT cards. 
 

================================================================================
PAGE 65
================================================================================

*CESE_BOUNDARY_NON_REFLECTIVE 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-23 (CESE) 
Set Card.  Card 1 used when the SET keyword option is active.  Include as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
 
Segment Cards.  Card 1 used when the SEGMENT keyword option is active.  Include 
an additional card for each corresponding pair of segments.  This input ends at the next 
keyword (“*”) card. 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2, … 
Node IDs deﬁning a segment 
Remarks: 
1. 
Normal application of this boundary condition. We recommend imposing this 
boundary condition on an open surface far from the main disturbed ﬂow (the 
further away, the better), meaning an almost uniform ﬂow on the boundary sur-
face. 
2. 
Default boundary condition for CESE.  LS-DYNA automatically assigns the 
non-reﬂective boundary condition to any boundary segment not already as-
signed a boundary condition by any of the *CESE_BOUNDARY_… cards.

================================================================================
PAGE 66
================================================================================

*CESE 
*CESE_BOUNDARY_PRESCRIBED 
3-24 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_BOUNDARY_PRESCRIBED_OPTION 
Available options include: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose:  For the CESE compressible ﬂow solver, set boundary values for velocity, den-
sity, pressure, and temperature.  Boundary values are applied at the centroid of elements 
connected with this boundary.  Use keyword options SET or SEGMENT for user-deﬁned 
meshes, meaning mesh speciﬁed with *ELEMENT_SOLID card.  Use MSURF or 
MSURF_SET for meshes created with the automatic volume mesher, meaning meshes 
generated with the *MESH cards.  
Card Summary: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card 1a.  Include this card for the MSURF keyword option. 
MSURFID 
IDCOMP 
 
 
 
 
 
 
Card 1b.  Include this card for the MSURF_SET keyword option. 
MSURF_S 
IDCOMP 
 
 
 
 
 
 
Card 1c.  Include this card for the SET keyword option. 
SSID 
IDCOMP 
 
 
 
 
 
 
Card 1d.  Include this card for the SEGMENT keyword option. 
N1 
N1 
N3 
N4 
IDCOMP 
 
 
 

================================================================================
PAGE 67
================================================================================

*CESE_BOUNDARY_PRESCRIBED 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-25 (CESE) 
Card 2.  This card is required. 
LC_U 
LC_V 
LC_W 
LC_RHO 
LC_P 
LC_T 
 
 
Card 3.  This card is required. 
SF_U 
SF_V 
SF_W 
SF_RHO 
SF_P 
SF_T 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format for the MSURF keyword option 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
IDCOMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced in *MESH_SURFACE_ELEMENT 
cards 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, this ID references a *CHEMISTRY_COMPOSITION card 
that gives the chemical mixture of the ﬂuid entering the domain 
 
Surface Part Set Card. Card 1 format for the MSURF_SET keyword option 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
IDCOMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 

================================================================================
PAGE 68
================================================================================

*CESE 
*CESE_BOUNDARY_PRESCRIBED 
3-26 (CESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
ID of a set of mesh surface parts created with a *LSO_ID_SET card, 
where each mesh surface part ID in the set is referenced in 
*MESH_SURFACE_ELEMENT cards. 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, this ID references a *CHEMISTRY_COMPOSITION card 
that gives the chemical mixture of the ﬂuid entering the domain 
 
Set Card. Card 1 format for the SET keyword option 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IDCOMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, this ID references a *CHEMISTRY_COMPOSITION card 
that gives the chemical mixture of the ﬂuid entering the domain 
 
Segment Card. Card 1 for the SEGMENT keyword option 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N1 
N3 
N4 
IDCOMP 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2, … 
Node IDs deﬁning a segment 

================================================================================
PAGE 69
================================================================================

*CESE_BOUNDARY_PRESCRIBED 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-27 (CESE) 
 VARIABLE  
 
DESCRIPTION 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, this ID references a *CHEMISTRY_COMPOSITION card 
that gives the chemical mixture of the ﬂuid entering the domain 
 
Load Curve Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_U 
LC_V 
LC_W 
LC_RHO 
LC_P 
LC_T 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
Remarks 
1 
1 
1 
1 
1 
1 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_U 
Load curve ID to describe the 푥-component of the velocity as a 
function of time; see *DEFINE_CURVE. 
GT.0: Load curve ID 
EQ.0: Constant value of SF_U 
EQ.-1: Solver computes the boundary value for 푥-component of 
velocity 
LC_V 
Load curve ID to describe the 푦-component of the velocity as a 
function of time 
GT.0: Load curve ID 
EQ.0: Constant value of SF_V 
EQ.-1: Solver computes the boundary value for 푦-component of 
velocity 
LC_W 
Load curve ID to describe the 푧-component of the velocity as a 
function of time 
GT.0: Load curve ID 
EQ.0: Constant value of SF_W 
EQ.-1: Solver computes the boundary value for 푥-component of 
velocity 

================================================================================
PAGE 70
================================================================================

*CESE 
*CESE_BOUNDARY_PRESCRIBED 
3-28 (CESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
LC_RHO 
Load curve ID to describe the density as a function of time 
GT.0: Load curve ID 
EQ.0: Constant value of SF_RHO 
EQ.-1: Solver computes the boundary value for density 
LC_P 
Load curve ID to describe the pressure as a function of time 
GT.0: Load curve ID 
EQ.0: Constant value of SF_P 
EQ.-1: Solver computes the boundary value for pressure 
LC_T 
Load curve ID to describe the temperature as a function of time 
GT.0: Load curve ID 
EQ.0: Constant value of SF_T 
EQ.-1: Solver computes the boundary value for temperature 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_U 
SF_V 
SF_W 
SF_RHO 
SF_P 
SF_T 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_U 
Scale factor for LC_U  
SF_V 
Scale factor for LC_V 
SF_W 
Scale factor for LC_W 
SF_RHO 
Scale factor for LC_RHO 
SF_P 
Scale factor for LC_P  
SF_T 
Scale factor for LC_T  

================================================================================
PAGE 71
================================================================================

*CESE_BOUNDARY_PRESCRIBED 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-29 (CESE) 
Remarks: 
1. 
Well-posed boundaries. On each centroid or set of centroids, the variables (푣푥, 
푣푦, 푣푧, 휌, 푃, 푇) with provided values must be consistent and make the model well-
posed (that is, be such that the solution of the model exists, is unique, and is 
physical).

================================================================================
PAGE 72
================================================================================

*CESE 
*CESE_BOUNDARY_PRESCRIBED_VN 
3-30 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_BOUNDARY_PRESCRIBED_VN_OPTION 
Available options include: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose:  For the CESE compressible ﬂow solver, set boundary values for velocity, den-
sity, pressure, and temperature.  Boundary values are applied at the centroid of elements 
connected with this boundary.  Use keyword options SET or SEGMENT for user-deﬁned 
meshes, that is, meshes speciﬁed with *ELEMENT_SOLID cards.  Use MSURF or 
MSURF_SET for meshes generated with the automatic volume mesher, meaning created 
with *MESH cards.  
Card Summary: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition, include one set of cards.  This input ends at the next key-
word (“*”) card. 
Card 1a.  Include this card for the MSURF keyword option. 
MSURFID 
IDCOMP 
 
 
 
 
 
 
Card 1b.  Include this card for the MSURF_SET keyword option. 
MSURF_S 
IDCOMP 
 
 
 
 
 
 
Card 1c.  Include this card for the SET keyword option. 
SSID 
IDCOMP 
 
 
 
 
 
 
Card 1d.  Include this card for the SEGMENT keyword option. 
N1 
N1 
N3 
N4 
IDCOMP 
 
 
 

================================================================================
PAGE 73
================================================================================

*CESE_BOUNDARY_PRESCRIBED_VN 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-31 (CESE) 
Card 2.  This card is required. 
LC_VN 
 
 
LC_RHO 
LC_P 
LC_T 
 
 
Card 3.  This card is required. 
SF_VN 
 
 
SF_RHO 
SF_P 
SF_T 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format for the MSURF keyword option  
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
IDCOMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
A mesh surface part ID referenced in *MESH_SURFACE_ELE-
MENT cards 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, this ID references a *CHEMISTRY_COMPOSITION card 
that gives the chemical mixture of the ﬂuid entering the domain. 
. 
Surface Part Set Card. Card 1 format for the MSURF_SET keyword option  
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
IDCOMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 

================================================================================
PAGE 74
================================================================================

*CESE 
*CESE_BOUNDARY_PRESCRIBED_VN 
3-32 (CESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
ID of a set of mesh surface parts created with a *LSO_ID_SET card, 
where each mesh surface part ID in the set is referenced in 
*MESH_SURFACE_ELEMENT cards. 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, this ID references a *CHEMISTRY_COMPOSITION card 
that gives the chemical mixture of the ﬂuid entering the domain. 
 
Set Card. Card 1 format for the SET keyword option  
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IDCOMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, this ID references a *CHEMISTRY_COMPOSITION card 
that gives the chemical mixture of the ﬂuid entering the domain. 
 
Segment Card. Card 1 for the SEGMENT keyword option  
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N1 
N3 
N4 
IDCOMP 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2, … 
Node IDs deﬁning a segment 

================================================================================
PAGE 75
================================================================================

*CESE_BOUNDARY_PRESCRIBED_VN 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-33 (CESE) 
 VARIABLE  
 
DESCRIPTION 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, this ID references a *CHEMISTRY_COMPOSITION card 
that gives the chemical mixture of the ﬂuid entering the domain. 
 
Load Curve Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_VN 
 
 
LC_RHO 
LC_P 
LC_T 
 
 
Type 
I 
 
 
I 
I 
I 
 
 
Remarks 
1 
 
 
1 
1 
1 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_VN 
Load curve ID to describe the normal velocity as a function of time; 
see *DEFINE_CURVE. 
GT.0: Load curve ID 
EQ.0: Constant value of SF_VN 
EQ.-1: Solver determines the boundary value for the normal ve-
locity 
LC_RHO 
Load curve ID to describe the density as a function of time 
GT.0: Load curve ID 
EQ.0: Constant value of SF_RHO 
EQ.-1: Solver determines the boundary value for the density 
LC_P 
Load curve ID to describe the pressure as a function of time 
GT.0: Load curve ID 
EQ.0: Constant value of SF_P 
EQ.-1: Solver determines the boundary value for the pressure 
LC_T 
Load curve ID to describe the temperature as a function of time 
GT.0: Load curve ID 
EQ.0: Constant value of SF_T 

================================================================================
PAGE 76
================================================================================

*CESE 
*CESE_BOUNDARY_PRESCRIBED_VN 
3-34 (CESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.-1: Solver determines the boundary value for the tempera-
ture 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_VN 
 
 
SF_RHO 
SF_P 
SF_T 
 
 
Type 
F 
 
 
F 
F 
F 
 
 
Default 
1.0 
 
 
1.0 
1.0 
1.0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_VN 
Scale factor for LC_VN  
SF_RHO 
Scale factor for LC_RHO  
SF_P 
Scale factor for LC_P  
SF_T 
Scale factor for LC_T  
Remarks: 
1. 
Well-posed boundary conditions. On each centroid or set of centroids, the var-
iables ( 푉푁, 휌, 푃, 푇) with provided values must be consistent and make the model 
well-posed (that is, be such that the solution of the model exists, is unique and 
physical).

================================================================================
PAGE 77
================================================================================

*CESE_BOUNDARY_REFLECTIVE 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-35 (CESE) 
*CESE_BOUNDARY_REFLECTIVE_OPTION 
Available options are: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose: Deﬁne a reﬂective boundary condition for the CESE compressible ﬂow solver.  
You can apply this boundary condition on a symmetrical surface or a solid wall of the 
computational domain.  Use the MSURF or MSURF_SET keyword options when gener-
ating the CESE mesh with the *MESH cards.  Use the SET or SEGMENT keyword options 
cards when *ELEMENT_SOLID cards specify CESE mesh. 
Card Summary: 
Card 1a.  Include this card for the MSURF keyword option.  Provide as many cards as 
necessary.  This input ends at the next keyword (“*”) card. 
MSURFID 
 
 
 
 
 
 
 
Card 1b.  Include this card for the MSURF_SET keyword option.  Provide as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
MSURF_S 
 
 
 
 
 
 
 
Card 1c.  Include this card for the SET keyword option.  Provide as many cards as nec-
essary.  This input ends at the next keyword (“*”) card. 
SSID 
 
 
 
 
 
 
 
Card 1d.  Include this card for the SEGMENT keyword option.  Provide as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
N1 
N2 
N3 
N4 
 
 
 
 

================================================================================
PAGE 78
================================================================================

*CESE 
*CESE_BOUNDARY_REFLECTIVE 
3-36 (CESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format for the MSURF keyword option.  Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced in *MESH_SURFACE_ELEMENT 
cards. 
 
Surface Part Set Card. Card 1 format for the MSURF_SET keyword option.  Provide as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
ID of a set of mesh surface parts created with a *LSO_ID_SET card, 
where each mesh surface part ID in the set is referenced in 
*MESH_SURFACE_ELEMENT cards. 
 

================================================================================
PAGE 79
================================================================================

*CESE_BOUNDARY_REFLECTIVE 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-37 (CESE) 
Set Card. Card 1 format for the SET keyword option.  Provide as many cards as 
necessary.  This input ends at the next keyword (“*”) card. 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
 
Segment Cards. Card 1 format for the SEGMENT keyword option.  Include an 
additional card for each corresponding pair of segments.  This input ends at the next 
keyword (“*”) card. 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2, … 
Node IDs deﬁning a segment 
Remarks: 
1. 
Effect of the boundary condition. This boundary condition has the same eﬀect 
as a solid-wall boundary condition for inviscid ﬂows.

================================================================================
PAGE 80
================================================================================

*CESE 
*CESE_BOUNDARY_SLIDING 
3-38 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_BOUNDARY_SLIDING_OPTION 
Available options are: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
Purpose: Allows the nodes of a ﬂuid surface to translate in the main direction of the mesh 
movement.  This feature is useful in piston-type applications.  
 
Use the MSURF or MSURF_SET keyword options when generating the CESE mesh with 
*MESH cards.  Use the SET and SEGMENT keywords when *ELEMENT_SOLID cards 
specify the CESE mesh. 
Card Summary: 
Card 1a.  Include this card for the MSURF keyword option.  Provide as many cards as 
necessary.  This input ends at the next keyword (“*”) card. 
MSURFID 
 
 
 
 
 
 
 
Card 1b.  Include this card for the MSURF_SET keyword option.  Provide as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
MSURF_S 
 
 
 
 
 
 
 
Card 1c.  Include this card for the SET keyword option.  Provide as many cards as nec-
essary.  This input ends at the next keyword (“*”) card. 
SSID 
 
 
 
 
 
 
 
Card 1d.  Include this card for the SEGMENT keyword option.  Provide as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
N1 
N2 
N3 
N4 
 
 
 
 

================================================================================
PAGE 81
================================================================================

*CESE_BOUNDARY_SLIDING 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-39 (CESE) 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format for the MSURF keyword option.  Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced in *MESH_SURFACE_ELEMENT 
cards. 
 
Surface Part Set Card. Card 1 format used when the MSURF_SET keyword option is 
active.  Provide as many cards as necessary.  This input ends at the next keyword (“*”) 
card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
ID of a set of mesh surface parts created with a *LSO_ID_SET card, 
where each mesh surface part ID in the set is referenced in 
*MESH_SURFACE_ELEMENT cards. 
 

================================================================================
PAGE 82
================================================================================

*CESE 
*CESE_BOUNDARY_SLIDING 
3-40 (CESE) 
R16@bdccd6d07 (03/10/25) 
Set Card. Card 1 format used when the SET keyword option is active.  Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
 
Segment Cards. Card 1 format used when SEGMENT keyword option is active.  Include 
an additional card for each corresponding pair of segments.  This input ends at the next 
keyword (“*”) card. 
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2, … 
Node IDs deﬁning a segment 

================================================================================
PAGE 83
================================================================================

*CESE_BOUNDARY_SOLID_WALL 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-41 (CESE) 
*CESE_BOUNDARY_SOLID_WALL_OPTION1_{OPTION2} 
For OPTION1, the choices are: 
MSURF 
MSURF_SET 
SET 
SEGMENT 
For OPTION2, the choices are: 
<BLANK> 
ROTAT 
Purpose: Deﬁne a solid wall boundary condition for this CESE compressible ﬂow solver.  
This boundary condition models a solid boundary, that is, the physical boundary for the 
ﬂow ﬁeld.  This boundary condition is a slip boundary condition for inviscid ﬂows and a 
no-slip boundary condition for viscous ﬂows. 
 
Use the MSURF or MSURF_SET options when generating the CESE mesh through the 
*MESH cards.  Use the SET or SEGMENT keyword options cards when *ELEMENT_-
SOLID cards deﬁne the CESE mesh.  Use the ROTAT keyword option for a rotating solid 
boundary condition. 
Card Summary: 
Card Sets.  The following sequence of cards comprises a single set.  LS-DYNA continues 
reading *CESE_BOUNDARY_SOLID_WALL card sets until the next keyword (“*”) card. 
Card 1a.  Include this card when OPTION1 is MSURF and OPTION2 is not set 
(<BLANK>). 
MSURFID 
LCID 
VX 
VY 
VZ 
 
 
 
Card 1b.  Include this card when OPTION1 is MSURF and OPTION2 is ROTAT. 
MSURFID 
LCID 
VX 
VY 
VZ 
NX 
NY 
NZ 
Card 1c.  Include this card when OPTION1 is MSURF_SET and OPTION2 is not set 
(<BLANK>). 
MSURF_S 
LCID 
VX 
VY 
VZ 
 
 
 

================================================================================
PAGE 84
================================================================================

*CESE 
*CESE_BOUNDARY_SOLID_WALL 
3-42 (CESE) 
R16@bdccd6d07 (03/10/25) 
Card 1d.  Include this card when OPTION1 is MSURF_SET and OPTION2 is ROTAT. 
MSURF_S 
LCID 
VX 
VY 
VZ 
NX 
NY 
NZ 
Card 1e.  Include this card when OPTION1 is SET and OPTION2 is not set (<BLANK>).
SSID 
LCID 
VX 
VY 
VZ 
 
 
 
Card 1f.  Include this card when OPTION1 is SET and OPTION2 is ROTAT. 
SSID 
LCID 
VX 
VY 
VZ 
NX 
NY 
NZ 
Card 1g.  Include this card when OPTION1 is SEGMENT and OPTION2 is not set 
(<BLANK>). 
N1 
N2 
N3 
N4 
LCID 
VX 
VY 
VZ 
Card 1h.1.  Include this card when OPTION1 is SEGMENT and OPTION2 is ROTAT. 
N1 
N2 
N3 
N4 
LCID 
VX 
VY 
VZ 
Card 1h.2.  Include this card when OPTION1 is SEGMENT and OPTION2 is ROTAT. 
N1 
N2 
N3 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card (Non-Rotating Boundary).  Card 1 format used when the MSURF 
keyword option is active and the ROTAT keyword option is inactive.  
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
LCID 
VX 
VY 
VZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
Remarks 
 
2 
2 
2 
2 
 
 
 
 

================================================================================
PAGE 85
================================================================================

*CESE_BOUNDARY_SOLID_WALL 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-43 (CESE) 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced in *MESH_SURFACE_ELEMENT 
cards. 
LCID 
Load curve ID to deﬁne this solid wall boundary movement 
VX, VY, VZ 
Velocity vector of the solid wall: 
LCID.EQ.0: Vector deﬁned by (VX, VY, VZ). 
LCID.NE.0: Vector deﬁned by both the load curve and 
(VX, VY, VZ).
 
Surface Part Card (Rotating Boundary).  Card 1 format used when the MSURF 
keyword option is active and the ROTAT keyword option is active.   
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURFID
LCID 
VX 
VY 
VZ 
NX 
NY 
NZ 
Type 
I 
I 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
0.0 
0.0 
0.0 
0.0 
0.0 
0.0 
 
 VARIABLE  
 
DESCRIPTION 
MSURFID 
Mesh surface part ID referenced in *MESH_SURFACE_ELEMENT 
cards. 
LCID 
Load curve ID giving the rotating speed frequency (HZ).  LCID
must be speciﬁed. 
VX, VY, VZ 
푥, 푦, and 푧-coordinates of a point on the rotating axis 
NX, NY, NZ 
Unit vector of the rotating axis (not used for the 2D case) 
 

================================================================================
PAGE 86
================================================================================

*CESE 
*CESE_BOUNDARY_SOLID_WALL 
3-44 (CESE) 
R16@bdccd6d07 (03/10/25) 
Surface Part Set Card (Non-Rotating Boundary).  Card 1 format used when the 
MSURF_SET keyword option is active and the ROTAT keyword option is not active.  
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
LCID 
VX 
VY 
VZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
Remarks 
 
2 
2 
2 
2 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
ID of a set of mesh surface part IDs created with a *LSO_ID_SET 
card, where each mesh surface part ID in the set is referenced in
*MESH_SURFACE_ELEMENT cards. 
LCID 
Load curve ID to deﬁne this solid wall boundary movement 
VX, VY, VZ 
Velocity vector of the solid wall: 
LCID.EQ.0: Vector deﬁned by (VX, VY, VZ). 
LCID.NE.0: Vector deﬁned by both the load curve and 
(VX, VY, VZ). 
 
Surface Part Set Card (Rotating Boundary).  Card 1 format used when the MSURF_-
SET keyword option is active and the ROTAT keyword option is active.  
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSURF_S
LCID 
VX 
VY 
VZ 
NX 
NY 
NZ 
Type 
I 
I 
F 
F 
F 
F 
F 
F 
Default 
none 
0 
0.0 
0.0 
0.0 
0.0 
0.0 
0.0 
 

================================================================================
PAGE 87
================================================================================

*CESE_BOUNDARY_SOLID_WALL 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-45 (CESE) 
 VARIABLE  
 
DESCRIPTION 
MSURF_S 
ID of a set of mesh surface part IDs created with a *LSO_ID_SET 
card, where each mesh surface part ID in the set is referenced in
*MESH_SURFACE_ELEMENT cards. 
LCID 
Load curve ID giving the rotating speed frequency (HZ).  LCID
must be speciﬁed. 
VX, VY, VZ 
푥, 푦, and 푧-coordinates of a point on the rotating axis 
NX, NY, NZ 
Unit vector of the rotating axis (not used for the 2D case) 
 
Segment Set Card (Non-Rotating Boundary). Card 1 format used when the SET 
keyword option is active and the ROTAT keyword option is not active.  
 Card 1e 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
LCID 
VX 
VY 
VZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
0.0 
0.0 
0.0 
 
 
 
Remarks 
 
2 
2 
2 
2 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
LCID 
Load curve ID to deﬁne this solid wall boundary movement 
VX, VY, VZ 
Velocity vector of the solid wall: 
LCID.EQ.0: Vector deﬁned by (VX, VY, VZ). 
LCID.NE.0: Vector deﬁned by both the load curve and 
(VX, VY, VZ). 
 

================================================================================
PAGE 88
================================================================================

*CESE 
*CESE_BOUNDARY_SOLID_WALL 
3-46 (CESE) 
R16@bdccd6d07 (03/10/25) 
Segment Set Card (Rotating Boundary). Card 1 format used when the SET keyword 
option is active and the ROTAT keyword option is active. 
 Card 1f 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
LCID 
VX 
VY 
VZ 
NX 
NY 
NZ 
Type 
I 
I 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
0.0 
0.0 
0.0 
0.0 
0.0 
0.0 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID 
LCID 
Load curve ID giving the rotating speed frequency (HZ).  LCID
must be speciﬁed. 
VX, VY, VZ 
푥, 푦, and 푧-coordinates of a point on the rotating axis 
NX, NY, NZ 
Unit vector of the rotating axis (not used for the 2D case) 
 
Segment Card (Non-Rotating Boundary). Card 1 format used when the SEGMENT 
keyword option is active and the ROTAT keyword option is not active. 
 Card 1g 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
LCID 
VX 
VY 
VZ 
Type 
I 
I 
I 
I 
I 
F 
F 
F 
Default 
none 
none 
none 
none 
0 
0.0 
0.0 
0.0 
Remarks 
 
 
 
 
2 
2 
2 
2 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2,  
N3, N4 
Node IDs deﬁning a segment 
LCID 
Load curve ID to deﬁne this solid wall boundary movement 

================================================================================
PAGE 89
================================================================================

*CESE_BOUNDARY_SOLID_WALL 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-47 (CESE) 
 VARIABLE  
 
DESCRIPTION 
VX, VY, VZ 
Velocity vector of the solid wall: 
LCID.EQ.0: Vector deﬁned by (VX, VY, VZ). 
LCID.NE.0: Vector deﬁned by both the load curve and 
(VX, VY, VZ). 
 
Segment Card (Rotating Boundary). Card 1 format used when the SEGMENT keyword 
option is active and the ROTAT keyword option is active. 
Card 1h.1
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
LCID 
VX 
VY 
VZ 
Type 
I 
I 
I 
I 
I 
F 
F 
F 
Default 
none 
none 
none 
none 
0 
0.0 
0.0 
0.0 
 
Rotating Axis Card for Segment.  Additional card for the “Segment Card (Rotating 
Boundary)” case that is read when the ROTAT keyword option is used. 
Card 1h.2
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NX 
NY 
NZ 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
0.0 
0.0 
0.0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N1, N2,  
N3, N4 
Node IDs deﬁning a segment 
LCID 
Load curve ID giving the rotating speed frequency (HZ).  LCID
must be speciﬁed. 
VX, VY, VZ 
푥, 푦, and 푧-coordinates of a point on the rotating axis 
NX, NY, NZ 
Unit vector of the rotating axis (not used for the 2D case) 

================================================================================
PAGE 90
================================================================================

*CESE 
*CESE_BOUNDARY_SOLID_WALL 
3-48 (CESE) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
1. 
Boundary movement.  In this solid-wall condition, the boundary movement 
can only be in the tangential direction of the wall and should not aﬀect the ﬂuid 
domain size and mesh during the calculation. Otherwise, you should use an FSI 
or moving mesh solver.  Also, this moving solid boundary condition only aﬀects 
viscous ﬂows (no-slip BC). 
2. 
Regular solid wall boundary condition.  If LCID = 0 and VX = VY = VZ = 0.0 
(default), this boundary condition is a regular solid wall boundary condition.

================================================================================
PAGE 91
================================================================================

*CESE _CHEMISTRY_D3PLOT 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-49 (CESE) 
*CESE_CHEMISTRY_D3PLOT 
Purpose:  Cause mass fractions of the listed chemical species to be added to the CESE 
d3plot output.  This is only used when chemistry is being solved with the CESE solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MODELID
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Species Cards.  Include one card for each species to be included in the d3plot database. 
This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SPECIES 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
MODELID 
Identiﬁer of a Chemkin-compatible chemistry model. 
SPECIES 
Name of a chemical species that is deﬁned in the chemistry model 
identiﬁed by MODELID (see *CHEMISTRY_MODEL). 

================================================================================
PAGE 92
================================================================================

*CESE 
*CESE_CONTROL_LIMITER 
3-50 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_CONTROL_LIMITER 
Purpose: Sets some stability parameters used in the CESE scheme for this CESE com-
pressible ﬂow solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IDLMT 
ALFA 
BETA 
EPSR 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
0 
0.0 
0.0 
0.0 
 
 
 
 
Remarks 
 
1 
2 
3 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
IDLMT 
Set the stability limiter option (See CESE theory manual): 
EQ.0: limiter format 1 (Re-weighting). 
EQ.1: limiter format 2 (Relaxing). 
ALFA 
Re-weighting coeﬃcient (See CESE theory manual) 
BETA 
Numerical viscosity control coeﬃcient (See CESE theory manual)
EPSR 
Stability control coeﬃcient (See CESE theory manual) 
Remarks: 
1. 
훼≥0; larger values give more stability, but less accuracy.  Usually α = 2.0 or 4.0 
will be enough for normal shock problems. 
2. 
0 ≤훽≤1; larger values give more stability.  For problems with shock waves, 
β = 1.0 is recommended. 
3. 
휀≥0; larger values give more stability, but less accuracy.

================================================================================
PAGE 93
================================================================================

*CESE_CONTROL_MESH_MOV 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-51 (CESE) 
*CESE_CONTROL_MESH_MOV 
Purpose:  For moving mesh CESE, this keyword is used to choose the type of algorithm 
to be used for calculating mesh movement. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MMSH 
LIM_ITER
RELTOL 
 
 
 
 
 
Type 
I 
I 
F 
 
 
 
 
 
Default 
1 
100 
1.0e-3 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MMSH 
Mesh motion selector: 
EQ.1: mesh moves using an implicit ball-vertex spring method.
EQ.9: the IDW scheme is used to move the mesh. 
LIM_ITER 
Maximum number of linear solver iterations for the ball-vertex lin-
ear system. 
RELTOL 
Relative tolerance to use as a stopping criterion for the iterative lin-
ear solver (conjugate gradient solver with diagonal scaling precon-
ditioner). 
.

================================================================================
PAGE 94
================================================================================

*CESE 
*CESE_CONTROL_SOLVER 
3-52 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_CONTROL_SOLVER 
Purpose:  Set general purpose control variables for the CESE compressible ﬂow solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ICESE 
IFLOW 
IGEOM 
IFRAME 
MIXID 
IDC 
ISNAN 
 
Type 
I 
I 
I 
I 
I 
F 
I 
 
Default 
0 
0 
none 
0 
none 
0.25 
0 
 
Remarks 
 
 
1 
 
 
2 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ICESE 
Sets the framework of the CESE solver. 
EQ.0: 
Fixed Eulerian 
EQ.100: Moving Mesh FSI 
EQ.200: Immersed boundary FSI 
IFLOW 
Sets the compressible ﬂow types: 
EQ.0: Viscous ﬂows (laminar) 
EQ.1: Inviscid ﬂows 
IGEOM 
Sets the geometric dimension: 
EQ.2: 
Two-dimensional (2D) problem 
EQ.3: 
Three-dimensional (3D) problem 
EQ.101: 2D axisymmetric 
IFRAME 
Choose the frame of reference: 
EQ.0: 
Usual non-moving reference frame (default) 
EQ.1000: Non-inertial rotating reference frame 
MIXID 
Chemistry model ID that deﬁnes the chemical species to include in 
the mixing model (see *CHEMISTRY_MODEL).  The species infor-
mation is given through the model’s card specifying the Chemkin-
compatible input. 

================================================================================
PAGE 95
================================================================================

*CESE_CONTROL_SOLVER 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-53 (CESE) 
 VARIABLE  
 
DESCRIPTION 
IDC 
Contact interaction detection coeﬃcient (for FSI and conjugate heat 
transfer problems). 
ISNAN 
Flag to check for a NaN in the CESE solver solution arrays at the 
completion of each time step.  This option can be useful for debug-
ging purposes.  There is a cost overhead when this option is active.
EQ.0: No checking 
EQ.1: Checking is active. 
Remarks: 
1. 
2D Solvers and Mesh Geometry.  For the 2D (IGEOM = 2) or 2D axisymmetric 
(IGEOM = 101) solver, the mesh should only be distributed in the 푥-푦 plane with 
the boundary conditions given only at the 푥-푦 domain boundaries.  Otherwise, 
a warning message will be given, and the 3D solver will be triggered instead. 
The 2D axisymmetric case will work only if the 2D mesh and corresponding 
boundary conditions are properly deﬁned, with the 푥 and 푦 coordinates corre-
sponding to the radial and axial directions, respectively. 
2. 
Contact Interaction Detection Coefﬁcient.  IDC is the same type of variable 
that is input on the *ICFD_CONTROL_FSI card.  For an explanation, see Remark 
1 for the *ICFD_CONTROL_FSI card. 
3. 
CESE Solver and Restarts.  Restarts are supported for the CESE solver.  How-
ever, restarts do not currently work for simulations with conjugate heat transfer.

================================================================================
PAGE 96
================================================================================

*CESE 
*CESE_CONTROL_TIMESTEP 
3-54 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_CONTROL_TIMESTEP 
Purpose:  Sets the time-step control parameters for the CESE compressible ﬂow solver.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IDDT 
CFL 
DTINT 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
0 
0.9 
10-3 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
IDDT 
Sets the time step option: 
EQ.0: ﬁxed time step size (DTINT, meaning the given initial 
time step size) 
NE.0: the time step size will be calculated based on the given 
CFL-number and the ﬂow solution at the previous time 
step. 
CFL 
CFL number (Courant–Friedrichs–Lewy condition) 
(0.0 < CFL ≤ 1.0) 
DTINT 
Initial time step size 

================================================================================
PAGE 97
================================================================================

*CESE_DATABASE_ELOUT 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-55 (CESE) 
*CESE_DATABASE_ELOUT 
Purpose:  Enable the output of CESE data on elements.  If more than one element set is 
deﬁned, then several output ﬁles will be generated. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
Element Sets Card.  Include as many cards as needed.  This input ends at the next 
keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ELSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be created: 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle is generated. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the CESE timestep will be used. 
ELSID 
Solid elements set ID 
Remarks: 
1. 
Database File Name. The ﬁle name for this database is cese_elout.dat.  

================================================================================
PAGE 98
================================================================================

*CESE 
*CESE_DATABASE_ELOUT 
3-56 (CESE) 
R16@bdccd6d07 (03/10/25) 
2. 
Restrictions. The *CESE_DATABASE… cards (pointout/elout) are restricted to 
CFD-only problems.  They do not give correct results for chemically reacting 
flow where *CESE couples with *CHEMISTRY.

================================================================================
PAGE 99
================================================================================

*CESE_DATABASE_FLUXAVG 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-57 (CESE) 
*CESE_DATABASE_FLUXAVG 
Purpose:  Enable the output of CESE data on segment sets.  If more than one segment set 
is deﬁned, then several output ﬁles will be generated. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
Segment Sets Card. Include as many cards as needed.  This input ends at the next 
keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be created: 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle giving the average ﬂuxes is generated. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the CESE time step will be used. 
SSID 
Segment set ID 
Remarks: 
1. 
Database File Name.  The ﬁle name for this database is cese_ﬂuxavg.dat. 

================================================================================
PAGE 100
================================================================================

*CESE 
*CESE_DATABASE_FLUXAVG 
3-58 (CESE) 
R16@bdccd6d07 (03/10/25) 
2. 
Restrictions. The *CESE_DATABASE… cards (pointout/elout/…) are re-
stricted to CFD-only problems.  They do not give correct results for chemically 
reacting flow where *CESE couples with *CHEMISTRY.

================================================================================
PAGE 101
================================================================================

*CESE_DATABASE_FSIDRAG 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-59 (CESE) 
*CESE_DATABASE_FSIDRAG 
Purpose:  Enable the output of the total ﬂuid pressure force applied to solid parts in FSI 
problems at every time step. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be created: 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle giving the pressure forces is generated. 
Remarks: 
1. 
Database File Names. The ﬁle names for this database are cese_dragsol.dat, 
cese_dragshell.dat, cese_dragsol2D.dat and cese_dragbeam.dat, depending 
on what kind of solid is used.

================================================================================
PAGE 102
================================================================================

*CESE 
*CESE_DATABASE_POINTOUT 
3-60 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_DATABASE_POINTOUT 
Purpose:  Enable the output of CESE data at points. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PSID 
DTOUT 
PSTYPE 
VX 
VY 
VZ 
 
 
Type 
I 
F 
I 
F 
F 
F 
 
 
Default 
0 
0. 
0 
0. 
0. 
0. 
 
 
 
Point Speciﬁcation Card.  Include as many cards as needed.  This input ends at the next 
keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
X 
Y 
Z 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PSID 
Point set ID 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the CESE timestep will be used. 
PSTYPE 
Point set type: 
EQ.0: Fixed points 
EQ.1: Tracer points using prescribed velocity 
EQ.2: Tracer points using ﬂuid velocity 
VX, VY, VZ 
Constant velocities to be used when PSTYPE = 1 
PID 
Point ID 

================================================================================
PAGE 103
================================================================================

*CESE_DATABASE_POINTOUT 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-61 (CESE) 
 VARIABLE  
 
DESCRIPTION 
X, Y, Z 
Initial coordinates of the point 
Remarks: 
1. 
Database File Name.  The ﬁle name for this database is cese_pointout.dat.  
2. 
Restrictions. The *CESE_DATABASE… cards (pointout/elout) are restricted to 
CFD-only problems.  They do not give correct results for chemically reacting 
ﬂow where *CESE couples with *CHEMISTRY.

================================================================================
PAGE 104
================================================================================

*CESE 
*CESE_DATABASE_SSETDRAG 
3-62 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_DATABASE_SSETDRAG 
Purpose:  Enable the output of CESE drag forces on segment sets.  If more than one seg-
ment set is speciﬁed, then several output ﬁles will be generated. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
Segment Sets Card.  Include as many cards as needed.  This input ends at the next 
keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be created: 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle giving the average ﬂuxes is generated. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the CESE timestep will be used. 
SSID 
Segment set ID 
Remarks: 
1. 
Database File Name. The ﬁle name for this database is cese_ssetdrag.dat. 

================================================================================
PAGE 105
================================================================================

*CESE_DATABASE_SSETDRAG 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-63 (CESE) 
2. 
Friction Drag Results and Mesh Size.  For the friction drag to give consistent 
results, special care must be given to the mesh close to the solid wall boundary 
(good capturing of the boundary layer behavior).  We recommend a very ﬁne 
structured mesh.

================================================================================
PAGE 106
================================================================================

*CESE 
*CESE_DEFINE_NONINERTIAL 
3-64 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_DEFINE_NONINERTIAL 
Purpose: Deﬁne the CESE problem domain as a non-inertial rotating frame that rotates at 
a constant rate.  This is used in rotating problems such as spinning cylinders, wind tur-
bines and turbo machinery. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FREQ 
LCID 
PID 
Nx 
Ny 
Nz 
 
 
Type 
F 
I 
I 
F 
F 
F 
 
 
Default 
none 
0 
none 
none 
none 
none 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
L 
R 
RELV 
 
 
 
 
 
Type 
F 
F 
I 
 
 
 
 
 
Default 
none 
none 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
FREQ 
Frequency of rotation. 
LCID 
Load curve ID for scaling factor of FREQ. 
PID 
Starting point ID for the reference frame (See *CESE_DEFINE_-
POINT). 
Nx, Ny, Nz 
Rotating axis direction. 
L 
Length of rotating frame. 
R 
Radius of rotating frame. 

================================================================================
PAGE 107
================================================================================

*CESE_DEFINE_NONINERTIAL 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-65 (CESE) 
 VARIABLE  
 
DESCRIPTION 
RELV 
Velocity display mode: 
EQ.0: Relative velocity, only the non-rotating components of the 
velocity are output. 
EQ.1: Absolute velocity is output. 

================================================================================
PAGE 108
================================================================================

*CESE 
*CESE_POINT 
3-66 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_DEFINE_POINT 
Purpose: Deﬁne points to be used by the CESE solver. 
 
Point Cards.  Include one card for each point.  This input ends at the next keyword (“*”) 
card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID 
X 
Y 
Z 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID 
Identiﬁer for this point. 
X, Y, Z 
Coordinates of the point. 

================================================================================
PAGE 109
================================================================================

*CESE_DRAG 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-67 (CESE) 
*CESE_DRAG 
Purpose:  Provide the far-ﬁeld (or free-stream) ﬂuid pressure. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PRESS 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PRESS 
Value of the free-stream ﬂuid pressure (in units used by the current 
problem). 

================================================================================
PAGE 110
================================================================================

*CESE 
*CESE_EOS_CAV_HOMOG_EQUILIB 
3-68 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_EOS_CAV_HOMOG_EQUILIB 
Purpose: Deﬁne the coeﬃcients in the equation of state (EOS) for the homogeneous equi-
librium cavitation model. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
vap 
liq 
푎vap 
푎liq 
vap 
liq 
푃SatVap 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
0.8 
880.0 
334.0 
1386.0 1.435e-
5 
1.586e-
4 
1.2e+4 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state identiﬁer 
vap 
density of the saturated vapor 
liq 
density of the saturated liquid 
푎vap 
sound speed of the saturated vapor 
푎liq 
sound speed of the saturated liquid 
vap 
dynamic viscosity of the vapor 
liq 
dynamic viscosity of the liquid 
푃SatVap 
pressure of the saturated vapor 
Remarks: 
1. 
Once a cavitation EOS is used, the cavitation ﬂow solver will be triggered. 
2. 
In this homogeneous equilibrium cavitation model, a barotropic equation of 
state is used.  This model can be used in small scale & high speed cavitation 
ﬂows, and it is not good for large-scale, low-speed cavitation calculations.

================================================================================
PAGE 111
================================================================================

*CESE_EOS_IDEAL_GAS 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-69 (CESE) 
*CESE_EOS_IDEAL_GAS 
Purpose: Deﬁne the coeﬃcients Cv and Cp in the equation of state for an ideal gas in the 
CESE ﬂuid solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
Cv 
Cp 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
none 
717.5 
1004.5 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state identiﬁer 
Cv 
Speciﬁc heat at constant volume 
Cp 
Speciﬁc heat at constant pressure 
Remarks: 
1. 
Units.  As with other solvers in LS-DYNA, the user is responsible for unit con-
sistency.  For example, if a user wants to use dimensionless variables, Cv and 
Cp should also be replaced by the corresponding dimensionless ones.

================================================================================
PAGE 112
================================================================================

*CESE 
*CESE_EOS_INFLATOR1 
3-70 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_EOS_INFLATOR1 
Purpose:  To deﬁne an EOS using Cp and Cv thermodynamic expansions for an inﬂator 
gas mixture with a single temperature range. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Cp0 
Cp1 
Cp2 
Cp3 
Cp4 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Cv0 
Cv1 
Cv2 
Cv3 
Cv4 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state identiﬁer for the CESE solver. 
Cp0, …, Cp4 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
pressure 
Cp(T) = Cp0 + Cp1 T + Cp2 T2 + Cp3 T3 + Cp4 T4 

================================================================================
PAGE 113
================================================================================

*CESE_EOS_INFLATOR1 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-71 (CESE) 
 VARIABLE  
 
DESCRIPTION 
Cv0, …, Cv4 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
volume 
Cv(T) = Cv0 + Cv1 T + Cv2 T2 + Cv3 T3 + Cv4 T4 
Remark: 
1.These coeﬃcient expansions for the speciﬁc heats over the entire temperature range 
are generated by the 0-D inﬂator model solver.  See *CHEMISTRY_CONTROL_-
INFLATOR and *CHEMISTRY_INFLATOR_PROPERTIES for details related to 
running that solver.

================================================================================
PAGE 114
================================================================================

*CESE 
*CESE_EOS_INFLATOR2 
3-72 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_EOS_INFLATOR2 
Purpose:  To deﬁne an EOS using Cp and Cv thermodynamic expansions for an inﬂator 
gas mixture with two temperature ranges, one below 1000 degrees Kelvin, and the other 
above 1000 degrees Kelvin. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Card for the expansion of Speciﬁc Heat at Constant Pressure. Valid for T < 1000 0K 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Cp1_0 
Cp1_1 
Cp1_2 
Cp1_3 
Cp1_4 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
Card for the expansion of Speciﬁc Heat at Constant Pressure. Valid for T > 1000 0K. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Cp2_0 
Cp2_1 
Cp2_2 
Cp2_3 
Cp2_4 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
 
 

================================================================================
PAGE 115
================================================================================

*CESE_EOS_INFLATOR2 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-73 (CESE) 
Card for the expansion of Speciﬁc Heat at Constant Volume. Valid for T < 1000 0K 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Cv1_0 
Cv1_1 
Cv1_2 
Cv1_3 
Cv1_4 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
Card for the expansion of Speciﬁc Heat at Constant Volume. Valid for T > 1000 0K. 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Cv2_0 
Cv2_1 
Cv2_2 
Cv2_3 
Cv2_4 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state identiﬁer for the CESE solver. 
Cp1_0, …, 
Cp1_4 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
pressure valid for T < 1000 0K. 
Cp1(T) = Cp1_0 + Cp1_1 T + Cp1_2 T2 + Cp1_3 T3 + Cp1_4 T4 
Cp2_0, …, 
Cp2_4 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
pressure valid for T > 1000 0K. 
Cp2(T) = Cp2_0 + Cp2_1 T + Cp2_2 T2 + Cp2_3 T3 + Cp2_4 T4 
Cv1_0, …, 
Cv1_4 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
volume  valid for T < 1000 0K. 
Cv1(T) = Cv1_0 + Cv1_1 T + Cv1_2 T2 + Cv1_3 T3 + Cv1_4 T4 
Cv2_0, …, 
Cv2_4 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
volume valid for T > 1000 0K. 
Cv2(T) = Cv2_0 + Cv2_1 T + Cv2_2 T2 + Cv2_3 T3 + Cv2_4 T4 

================================================================================
PAGE 116
================================================================================

*CESE 
*CESE_EOS_INFLATOR2 
3-74 (CESE) 
R16@bdccd6d07 (03/10/25) 
Remark: 
2.These coeﬃcient expansions for the speciﬁc heats over two temperature ranges are 
generated by the 0-D inﬂator model solver.  See *CHEMISTRY_CONTROL_IN-
FLATOR and *CHEMISTRY_INFLATOR_PROPERTIES for details related to run-
ning that solver.

================================================================================
PAGE 117
================================================================================

*CESE_FSI_EXCLUDE 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-75 (CESE) 
*CESE_FSI_EXCLUDE 
Purpose: Provide a list of mechanics solver parts that are not involve in the CESE FSI 
calculation.  This is intended to be used as an eﬃciency measure for parts that will not 
involve signiﬁcant FSI interactions with the CESE compressible ﬂuid solver.. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
PID7 
PID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
PIDn 
IDs of mechanics parts that will be excluded from the FSI interac-
tion calculation with the CESE solver. 

================================================================================
PAGE 118
================================================================================

*CESE 
*CESE_INITIAL 
3-76 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_INITIAL 
Purpose: Specify constant initial conditions (ICs) for ﬂow variables at the centroid of each 
ﬂuid element.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
U 
V 
W 
RH 
P 
T 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
0 
0.0 
0.0 
1.225 
0.0 
0.0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
U, V, W 
푥-, 푦-, 푧-velocity components, respectively 
RHO 
Density, 휌 
P 
Pressure, 푃 
T 
Temperature,  
Remarks: 
1. 
Required Input.  Usually, only two of 휌, , and  need to be speciﬁed (besides 
the velocity).  If all three are given, only 휌 and 푃 will be used.  
2. 
Applicable Elements.  These initial conditions will be applied only in those el-
ements that have not been assigned a value by *CESE_INITIAL_OPTION cards 
for individual elements or sets of elements.

================================================================================
PAGE 119
================================================================================

*CESE_INITIAL 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-77 (CESE) 
*CESE_INITIAL_OPTION 
Available options include: 
SET 
ELEMENT 
Purpose: Specify initial conditions for the ﬂow variables at the centroid of each element 
in a set of elements or at the centroid of a single element. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EID/ESID 
U 
V 
W 
RHO 
P 
T 
 
Type 
I 
F 
F 
F 
F 
F 
F 
 
Default 
none 
0.0 
0.0 
0.0 
1.225 
0.0 
0.0 
 
Remarks 
 
 
 
 
1 
1 
1 
 
 
 VARIABLE  
 
DESCRIPTION 
EID/ESID 
Solid element ID (EID) or solid element set ID (ESID) 
U, V, W 
푥-, 푦-, 푧-velocity components, respectively 
RHO 
Density, 휌 
P 
Pressure, 푃 
T 
Temperature, 푇 
Remarks: 
1. 
Required Input.  Usually, only two of 휌, 푃, and 푇 need to be speciﬁed (along 
with the velocity).  If all three are given, only 휌 and 푃 will be used. 
2. 
Initial Condition Speciﬁcation Priority.  The priority of this card is higher than 
*CESE_INITIAL, meaning that if an element is assigned an initial value by this 
card, *CESE_INITIAL will no longer apply to that element.

================================================================================
PAGE 120
================================================================================

*CHEMISTRY 
*CESE_INITIAL_CHEMISTRY 
3-78 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_INITIAL_CHEMISTRY 
Purpose:  Initializes the chemistry and ﬂuid state in every element of the CESE mesh that 
has not already been initialized by one of the other *CESE_INITIAL_CHEMISTRY cards.  
This is only used when chemistry is being solved with the CESE solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CHEMID 
COMPID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
UIC 
VIC 
WIC 
RHOIC 
PIC 
TIC 
HIC 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
CHEMID 
Identiﬁer of chemistry control card to use 
COMPID 
Identiﬁer of chemical composition to use 
UIC 
푋-component of the ﬂuid velocity 
VIC 
푌-component of the ﬂuid velocity 
WIC 
푍-component of the ﬂuid velocity 
RHOIC 
Initial ﬂuid density 
PIC 
Initial ﬂuid pressure 
TIC 
Initial ﬂuid temperature 

================================================================================
PAGE 121
================================================================================

*CESE_INITIAL_CHEMISTRY 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
3-79 (CESE) 
 VARIABLE  
 
DESCRIPTION 
HIC 
Initial ﬂuid enthalpy.  However, when CHEMID refers to a ZND 
1-step reaction card, this is the progressive variable (degree of com-
bustion). 

================================================================================
PAGE 122
================================================================================

*CESE 
*CESE_INITIAL_CHEMISTRY_ELEMENT 
3-80 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_INITIAL_CHEMISTRY_ELEMENT 
Purpose:  Initialize the chemistry and ﬂuid state in every element of the list of CESE ele-
ments.  This keyword is only used when chemistry is being solved with the CESE solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CHEMID 
COMPID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
UIC 
VIC 
WIC 
RHOIC 
PIC 
TIC 
HIC 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
Element List Card.  Include as many cards as necessary.  This input ends at the next 
keyword (“*”) card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ELE1 
ELE2 
ELE3 
ELE4 
ELE5 
ELE6 
ELE7 
ELE8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
 
 VARIABLE  
 
DESCRIPTION 
CHEMID 
Identiﬁer of chemistry control card to use (see *CHEMISTRY_-
CONTROL._...) 
COMPID 
Identiﬁer of chemical composition to use (see *CHEMISTRY_-
COMPOSITION) 
UIC 
푋-component of the ﬂuid velocity 

================================================================================
PAGE 123
================================================================================

*CESE_INITIAL_CHEMISTRY_ELEMENT 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-81 (CESE) 
 VARIABLE  
 
DESCRIPTION 
VIC 
푌-component of the ﬂuid velocity 
WIC 
푍-component of the ﬂuid velocity 
RHOIC 
Initial ﬂuid density 
PIC 
Initial ﬂuid pressure 
TIC 
Initial ﬂuid temperature 
HIC 
Initial ﬂuid enthalpy.  However, when CHEMID refers to a ZND 
1-step reaction card (see *CHEMISTRY_CONTROL_ZND), this is
the progressive variable (degree of combustion).  
ELEi 
User element numbers to initialize 

================================================================================
PAGE 124
================================================================================

*CESE 
*CESE_INITIAL_CHEMISTRY_PART 
3-82 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_INITIAL_CHEMISTRY_PART 
Purpose:  Initialize the chemistry and ﬂuid state in every element of the speciﬁed CESE 
part that has not already been initialized by *CESE_INITIAL_CHEMISTRY_ELEMENT 
or *CESE_INITIAL_CHEMISTRY_SET cards.  This keyword is only used when chemistry 
is being solved with the CESE solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PARTID 
CHEMID 
COMPID 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
UIC 
VIC 
WIC 
RHOIC 
PIC 
TIC 
HIC 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
PARTID 
Identiﬁer of the CESE part on which to initialize (see *CESE_PART)
CHEMID 
Identiﬁer of the chemistry control card to use (see *CHEMISTRY_-
CONTROL._...) 
COMPID 
Identiﬁer of the chemical composition to use (see *CHEMISTRY_-
COMPOSITION) 
UIC 
푋-component of the ﬂuid velocity 
VIC 
푌-component of the ﬂuid velocity 
WIC 
푍-component of the ﬂuid velocity 
RHOIC 
Initial ﬂuid density 

================================================================================
PAGE 125
================================================================================

*CESE_INITIAL_CHEMISTRY_PART 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-83 (CESE) 
 VARIABLE  
 
DESCRIPTION 
PIC 
Initial ﬂuid pressure 
TIC 
Initial ﬂuid temperature 
HIC 
Initial ﬂuid enthalpy.  However, when CHEMID refers to a ZND 
1-step reaction card (see *CHEMISTRY_CONTROL_ZND), this is
the progressive variable (degree of combustion). 

================================================================================
PAGE 126
================================================================================

*CESE 
*CESE_INITIAL_CHEMISTRY_SET 
3-84 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_INITIAL_CHEMISTRY_SET 
Purpose:  Initializes the chemistry and ﬂuid state in every element of the speciﬁed ele-
ment set in the CESE mesh that has not already been initialized by *CESE_INITIAL_-
CHEMISTRY_ELEMENT cards.  This is only used when chemistry is being solved with 
the CESE solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SETID 
CHEMID 
COMPID 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
UIC 
VIC 
WIC 
RHOIC 
PIC 
TIC 
HIC 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
SETID 
Identiﬁer of the CESE element set to initialize 
CHEMID 
Identiﬁer of chemistry control card to use (see *CHEMISTRY_-
CONTROL._...) 
COMPID 
Identiﬁer of chemical composition to use (see *CHEMISTRY_-
COMPOSITION) 
UIC 
푋-component of the ﬂuid velocity 
VIC 
푌-component of the ﬂuid velocity 
WIC 
푍-component of the ﬂuid velocity 
RHOIC 
Initial ﬂuid density 

================================================================================
PAGE 127
================================================================================

*CESE_INITIAL_CHEMISTRY_SET 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-85 (CESE) 
 VARIABLE  
 
DESCRIPTION 
PIC 
Initial ﬂuid pressure 
TIC 
Initial ﬂuid temperature 
HIC 
Initial ﬂuid enthalpy.  However, when CHEMID refers to a ZND 
1-step reaction card (see *CHEMISTRY_CONTROL_ZND), this is 
the progressive variable (degree of combustion). 

================================================================================
PAGE 128
================================================================================

*CESE 
*CESE_INITIAL_CHEMISTRY_SET 
3-86 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_MAT_000 
Purpose: Deﬁne the ﬂuid (gas) properties in a viscous ﬂow for the CESE solver.  
 
Material Deﬁnition Cards.  Include one card for each instance of this material type.  This 
input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MU 
K 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material identiﬁer 
MU 
Fluid dynamic viscosity.  For Air at 15 °C, MU = 1.81 ×
10−5 kg
ms
⁄
 
K 
Thermal conductivity of the ﬂuid 
Remarks: 
1. 
The viscosity is only used viscous ﬂows, so for inviscid ﬂows, it is not necessary 
to deﬁne it.  The thermal conductivity is only used to calculate the heat transfer 
between the structure and the thermal solver when coupling is activated. 
2. 
As with other solvers in LS-DYNA, the user is responsible for unit consistency.  
For example, if dimensionless variables are used, MU should be replaced by the 
corresponding dimensionless one.

================================================================================
PAGE 129
================================================================================

*CESE_MAT_001 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-87 (CESE) 
*CESE_MAT_001( _GAS) 
Purpose: Deﬁne the ﬂuid (gas) properties in a viscous ﬂow for the CESE solver.  
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
C1 
C2 
PRND 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
1.458E-
6 
110.4 
0.72 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material identiﬁer 
C1, C2 
Two coeﬃcients in the Sutherland’s formula for viscosity, i.e., 
휇= 퐶1푇
3
2
푇+ 퐶2
 
where C1 and C2 are constants for a given gas.  For example, for air 
at moderate temperatures, 
퐶1 = 1.458 × 10−6 kg msK
1 2
⁄
⁄
,
퐶2 = 110.4 K
PRND 
The Prandtl Number (used to determine the coeﬃcient of thermal
conductivity).  It is approximately constant for most gases.  For air 
at standard conditions PRND = 0.72. 
Remarks: 
1. 
C1 and C2 are only used to calculate the viscosity in viscous ﬂows, so for inviscid 
ﬂows, this material card is not needed.  The Prandtl number is used to extract 
the thermal conductivity, which is used when thermal coupling with the struc-
ture is activated. 
2. 
As with other solvers in LS-DYNA, the user is responsible for unit consistency.  
For example, if dimensionless variables are used, C1 and C2 should be replaced 
by the corresponding dimensionless ones.

================================================================================
PAGE 130
================================================================================

*CESE 
*CESE_MAT_002 
3-88 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_MAT_002 
Purpose:  Deﬁne the ﬂuid (gas) properties in a viscous ﬂow for the CESE solver.  
 
Material Deﬁnition Cards.  Include one card for each instance of this material type.  This 
input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MU0 
SMU 
K0 
SK 
T0 
 
 
Type 
I 
F 
F 
F 
F 
F 
 
 
Default 
none 
1.716E-5
111. 
0.0241 
194.0 
273.0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material identiﬁer 
MU0 / SMU 
Two coeﬃcients appearing in the equation derived by combining 
Sutherland’s formula with the power law for dilute gases: 
휇
휇0
= ( 푇
푇0
)
3 2
⁄ 푇0 + 푆휇
푇+ 푆휇
  . 
휇0 is a reference value, and 푆휇 is an eﬀective temperature called the 
Sutherland constant, which is characteristic of the gas.  For air at 
moderate temperatures, 
휇0 = 1.716 × 10−5 Ns m2
⁄
,
푆휇= 111 K
K0/SK 
Two coeﬃcients appearing in the equation derived by combining 
Sutherland’s formula with the power law for dilute gases: 
푘
푘0
= ( 푇
푇0
)
3 2
⁄ 푇0 + 푆푘
푇+ 푆푘
  . 
Here 푘 is the thermal conductivity, 푘0 is a reference value, and 푆푘 is 
the Sutherland constant, which is characteristic of the gas.  For air
at moderate temperatures, 
푘0 = 0.0241 W m
⁄
,
푆푘= 194 K
T0 
Reference temperature, 푇0. The default value (273.0) is for air, in 
degrees K. 

================================================================================
PAGE 131
================================================================================

*CESE_MAT_002 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-89 (CESE) 
Remarks: 
1. 
Fields that Depend on Problem Physics.  The viscosity is only used for viscous 
ﬂow.  Therefore, for inviscid ﬂows, it is not necessary to deﬁne it.  The thermal 
conductivity is only used to calculate the heat transfer between the structure and 
the thermal solver when coupling is activated. 
2. 
Unit Consistency.  As with other solvers in LS-DYNA, the user is responsible 
for unit consistency.  For example, if dimensionless variables are used, MU 
should be replaced by the corresponding dimensionless one.

================================================================================
PAGE 132
================================================================================

*CESE 
*CESE_PART 
3-90 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_PART 
Purpose: Deﬁne CESE solver parts, meaning connect CESE material and EOS infor-
mation.  
 
Part Cards.  Include one card for each CESE part.  This input ends at the next keyword 
(“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
MID 
EOSID 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part identiﬁer (must be diﬀerent from any PID on a *PART card) 
MID 
Material identiﬁer deﬁned by a *CESE_MAT_… card 
EOSID 
Equation of state identiﬁer deﬁned by a *CESE_EOS_… card 
Remarks: 
1. 
Material for inviscid ﬂows. Since material coeﬃcients are only used in viscous 
ﬂows, the MID can be left blank for inviscid ﬂows.

================================================================================
PAGE 133
================================================================================

*CESE _SURFACE_MECHSSID_D3PLOT 
*CESE 
R16@bdccd6d07 (03/10/25) 
3-91 (CESE) 
*CESE_SURFACE_MECHSSID_D3PLOT 
Purpose:  Identify the surfaces to be used in generating surface D3PLOT output for the 
CESE solver.  These surfaces must be on the outside of volume element parts that are in 
contact with the CESE ﬂuid mesh.  The variables in question are part of the CESE FSI 
solution process or of the CESE conjugate heat transfer solver. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
SurfaceLabel 
Type 
I 
A 
Default 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Mechanics solver segment set ID that is in contact with the ﬂuid 
CESE mesh. 
SurfaceLabel 
Name to use in d3plot output to identify the SSID for the LSPP 
user. 

================================================================================
PAGE 134
================================================================================

*CESE 
*CESE _SURFACE_MECHSSID_D3PLOT 
3-92 (CESE) 
R16@bdccd6d07 (03/10/25) 
*CESE_SURFACE_MECHVARS_D3PLOT 
Purpose:  List of variables to output on the surfaces designated by the segment set IDs 
given in the *CESE_SURFACE_MECHSSID_D3PLOT cards.  Most of the allowed varia-
bles are deﬁned only on the ﬂuid-structure interface, and so the segment set IDs deﬁning 
a portion of the ﬂuid-structure interface must involve only segments (element faces) that 
are on the outside of volume element parts that are in contact with the CESE ﬂuid mesh. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Output Quantity 
Type 
A 
Default 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
Output 
Quantity 
Descriptive phrase for  the mechanics surface variable to output for
the LSPP user.  Output will be done on all SSIDs selected by the 
*CESE_SURFACE_MECHSSID_D3PLOT cards in the problem. 
Supported variables include: 
 
FLUID FSI FORCE 
FLUID FSI PRESSURE 
INTERFACE TEMPERATURE 
SOLID INTERFACE HEAT FLUX 
FLUID INTERFACE HEAT FLUX 
INTERFACE HEAT FLUX RATE 
SOLID INTERFACE DISPLACEMENT 
SOLID INTERFACE VELOCITY 
SOLID INTERFACE ACCELERATION 
 
Force, displacement, velocity, and acceleration are output as vector 
quantities.  The rest of the variables are scalar quantities.  The
ﬂuxes are in the normal direction to the ﬂuid/structure interface,
with the heat ﬂuxes relative to the normal pointing into the struc-
ture. 
 

================================================================================
PAGE 135
================================================================================

 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-1 (CHEMISTRY) 
*CHEMISTRY 
 
The keyword *CHEMISTRY is used to access chemistry databases that include Chemkin-
based descriptions of a chemical model, as well as to select a method of solving the model.  
The keyword cards in this section are deﬁned in alphabetical order: 
*CHEMISTRY_BATTERY† 
*CHEMISTRY_COMPOSITION 
*CHEMISTRY_CONTROL_0D 
*CHEMISTRY_CONTROL_1D† 
*CHEMISTRY_CONTROL_CSP 
*CHEMISTRY_CONTROL_FULL 
*CHEMISTRY_CONTROL_INFLATOR† 
*CHEMISTRY_CONTROL_TBX 
*CHEMISTRY_CONTROL_ZND† 
*CHEMISTRY_DET_INITIATION† 
*CHEMISTRY_INFLATOR_PROPERTIES† 
*CHEMISTRY_MODEL 
*CHEMISTRY_PATH 
†: Card may be used only once in a given model 
 
An additional option “_TITLE” may be appended to all *CHEMISTRY keywords.  If this 
option is used, then an 80 character string is read as a title from the ﬁrst card of that 
keyword's input.  At present, LS-DYNA does not make use of the title.  Inclusion of titles 
gives greater clarity to input decks. 
 
The *CHEMISTRY_BATTERY card is only intended to be used in battery electrochemis-
try models that involve *BATTERY_... cards.  Note that none of the comments below ap-
ply for this particular case. 
 

================================================================================
PAGE 136
================================================================================

*CHEMISTRY 
 
4-2 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
In order to use one of the chemistry solvers, the input must include at least one *CHEM-
ISTRY_MODEL card.  For each spatial region containing a diﬀerent chemical composi-
tion, at least one *CHEMISTRY_COMPOSITION card is required. 
 
The *CHEMISTRY_CONTROL_0D card is intended to be used in a standalone fashion to 
verify the validity of a given chemistry model.  This model includes the total number of 
species and all elementary reactions with their Arrhenius rate parameters.  For instance, 
this solver could be used to check the induction time of the model. 
 
The *CHEMISTRY_BLAST_INITIATION, *CHEMISTRY_CONTROL_1D, *CHEMIS-
TRY_DET_INITIATION, and *CHEMISTRY_CONTROL_ZND cards are intended to 
provide a one-dimensional initialization to a 2D or 3D chemically-reacting ﬂow. 
 
In order to perform a full, general purpose chemistry calculation in 2D or 3D, the *CHEM-
ISTRY_CONTROL_FULL card should be used. 
 
The *CHEMISTRY_CONTROL_CSP card is an option for reducing the number of species 
and reactions that are used in a general purpose chemistry calculation.  Other reduction 
mechanisms are planned for the future. 
 
An airbag inﬂator model is available with *CHEMISTRY_CONTROL_INFLATOR along 
with *CHEMISTRY_INFLATOR_PROPERTIES and a chemistry model that is referenced 
via three chemical compositions.  This involves zero-dimensional modeling, with pyro-
technic inﬂator, and cold and hot ﬂow hybrid inﬂator options. 
 
The *CHEMISTRY_CONTROL_TBX card is intended for use only in a stochastic particle 
model, where the *STOCHASTIC_TBX_PARTICLES card is used.

================================================================================
PAGE 137
================================================================================

*CHEMISTRY_BATTERY 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-3 (CHEMISTRY) 
*CHEMISTRY_BATTERY 
Purpose:  For the battery electrochemistry solver (*BATTERY), this card identiﬁes the ﬁles 
that deﬁne a Chemkin chemistry model for use with that solver. 
 
Battery Reaction and Species Input File Card (Chemkin-compatible). 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE1 
Type 
A 
 
Thermodynamics Database File Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE2 
Type 
A 
 
Transport Properties Database File Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE3 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
FILE1 
Name of the ﬁle containing the Chemkin-compatible input 
FILE2 
Name of the ﬁle containing the chemistry thermodynamics data-
base 
FILE3 
Name of the ﬁle containing the chemistry transport properties da-
tabase 

================================================================================
PAGE 138
================================================================================

*CHEMISTRY 
*CHEMISTRY_COMPOSITION 
4-4 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
*CHEMISTRY_COMPOSITION 
Purpose:  Provide a general way to specify a chemical composition via a list of species 
mole numbers in the context of a Chemkin database model. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
MODELID
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
Species List Card. Provide as many cards as necessary.  This input ends at the next 
keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MOLFR 
SPECIES 
Type 
F 
A 
Default 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
ID 
A unique identiﬁer among all chemistry compositions 
MODELID 
Identiﬁer of a Chemkin-compatible chemistry model (see *CHEM-
ISTRY_MODEL) 
MOLFR 
The number of moles corresponding to the species named in the
SPECIES ﬁeld.  But, if used with a *STOCHASTIC_TBX_PARTI-
CLES card, it is the molar concentration of the species (in units of 
moles/[length]3, where [length] is the user’s length unit). 
SPECIES 
The Chemkin-compatible name of a chemical species that is de-
ﬁned in the chemistry model identiﬁed by MODELID (see *CHEM-
ISTRY_MODEL) 

================================================================================
PAGE 139
================================================================================

*CHEMISTRY_CONTROL_0D 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-5 (CHEMISTRY) 
*CHEMISTRY_CONTROL_0D 
Purpose:  Performs a zero-dimensional isotropic chemistry calculation that operates 
standalone (does not call the CESE solver).  This is for ISOBARIC or ISOCHORIC cases. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
COMPID 
SOLTYP 
PLOTDT 
CSP_SEL
 
 
 
Type 
I 
I 
I 
F 
I 
 
 
 
Default 
none 
none 
none 
1.0e-6 
0 
 
 
 
Remarks 
 
 
 
 
1 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
TLIMIT 
TIC 
PIC 
RIC 
EIC 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
CSP Parameters Card. Include cards for each chemical species in the following format 
when CSP_SEL.GT.0. This input ends at the next keyword (“*”) card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
AMPL 
YCUT 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ID 
Identiﬁer for this 0D computation. 

================================================================================
PAGE 140
================================================================================

*CHEMISTRY 
*CHEMISTRY_CONTROL_0D 
4-6 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
COMPID 
Chemical composition identiﬁer of composition to use. 
SOLTYP 
Type of 0D calculation: 
EQ.1: Isochoric 
EQ.2: Isobaric 
PLOTDT 
Simulation time interval for output both to the screen and to the 
isocom.csv ﬁle.  This ﬁle can be loaded into LS-PREPOST for curve 
plotting using the x-y plot facility. 
CSP_SEL 
CSP solver option: 
EQ.0: Do not use the CSP solver, and ignore the AMPL and 
YCUT parameters (default). 
GT.0: Use the CSP solver, with the AMPL and YCUT parame-
ters. 
DT 
Initial time step 
TLIMIT 
Time limit for the simulation 
TIC 
Initial temperature 
PIC 
Initial pressure 
RIC 
Initial density 
EIC 
Initial internal energy 
AMPL 
Relative accuracy for the mass fraction of a chemical species in the 
Chemkin input ﬁle. 
YCUT 
Absolute accuracy for the mass fraction of a chemical species in the
Chemkin input ﬁle. 
Remarks: 
1. 
If CSP_SEL.GT.0, then instead of using the full chemistry solver, the computa-
tional singular perturbation (CSP) method solver is used.

================================================================================
PAGE 141
================================================================================

*CHEMISTRY_CONTROL_1D 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-7 (CHEMISTRY) 
*CHEMISTRY_CONTROL_1D 
Purpose:  Loads a previously-computed one-dimensional detonation.  It is then available 
for use in the CESE solver for initializing a computation.  In the product regions, this card 
overrides the initialization of the *CESE_INITIAL_CHEMISTRY_… cards. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
XYZD 
DETDIR 
CSP_SEL
 
 
 
 
Type 
I 
F 
I 
I 
 
 
 
 
Default 
none 
none 
none 
0 
 
 
 
 
Remarks 
 
 
 
1 
 
 
 
 
 
One-Dimensional Solution LSDA Input File Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE 
Type 
A 
 
CSP Parameters Card Include cards for each chemical species in the following format 
when CSP_SEL  >  0. This input ends at the next keyword (“*”) card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
AMPL 
YCUT 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ID 
Identiﬁer for this one-dimensional detonation solution. 
XYZD 
Position of the detonation front in the DETDIR direction. 

================================================================================
PAGE 142
================================================================================

*CHEMISTRY 
*CHEMISTRY_CONTROL_1D 
4-8 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
DETDIR 
Detonation propagation direction 
EQ.1: 푥 
EQ.2: 푦 
EQ.3: 푧 
CSP_SEL 
CSP solver option: 
EQ.0: Do not use the CSP solver, and ignore the AMPL and 
YCUT parameters (default). 
GT.0: Use the CSP solver, with the AMPL and YCUT parame-
ters. 
FILE 
Name of the LSDA ﬁle containing the one-dimensional solution. 
AMPL 
Relative accuracy for the mass fraction of a chemical species in the 
chemkin input ﬁle. 
YCUT 
Absolute accuracy for the mass fraction of a chemical species in the
chemkin input ﬁle. 
Remarks: 
1. 
If CSP_SEL > 0, then instead of using the full chemistry solver, the computa-
tional singular perturbation (CSP) method solver is used.

================================================================================
PAGE 143
================================================================================

*CHEMISTRY_CONTROL_CSP 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-9 (CHEMISTRY) 
*CHEMISTRY_CONTROL_CSP 
Purpose:  Computes reduced chemistry for a speciﬁed Chemkin chemistry model using 
the Computational Singular Perturbation (CSP) method.  This card can be used for gen-
eral-purpose chemical reaction calculations. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
IERROPT 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
CSP Parameters Card. Include cards for each chemical species in the following format 
as indicated by the value of IERROPT. This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
AMPL 
YCUT 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ID 
Identiﬁer for this computational singular perturbation solver. 
IERROPT 
Selector: 
EQ.0: AMPL and YCUT values for all chemical species are re-
quired. 
EQ.1: One CSP Parameter Card should be provided, and it will 
be used for all species. 
AMPL 
Relative accuracy for the mass fraction of a chemical species in the 
Chemkin input ﬁle. 
YCUT 
Absolute accuracy for the mass fraction of a chemical species in the
Chemkin input ﬁle. 

================================================================================
PAGE 144
================================================================================

*CHEMISTRY 
*CHEMISTRY_CONTROL_FULL 
4-10 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
*CHEMISTRY_CONTROL_FULL 
Purpose:  Computes the full chemistry speciﬁed by a Chemkin chemistry model.  This 
card can be used for general-purpose chemical reaction calculations. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
ERRLIM 
RHOMIN 
TMIN 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
none 
0.0 
0.0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ID 
Identiﬁer for this full chemistry calculation. 
ERRLIM 
Error tolerance for the full chemistry calculation. 
RHOMIN 
Minimum ﬂuid density above which chemical reactions are com-
puted. 
TMIN 
Minimum temperature above which chemical reactions are com-
puted. 

================================================================================
PAGE 145
================================================================================

*CHEMISTRY_CONTROL_INFLATOR 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-11 (CHEMISTRY) 
*CHEMISTRY_CONTROL_INFLATOR 
Purpose:  Provide the required properties of an inﬂator model for airbag inﬂation. 
 
Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MODEL OUT_TYPE TRUNTIM
DELT 
PTIME 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Remarks 
1 
2,4 
 
 
 
 
 
 
 
 
Inﬂator Output Database File (an ASCII ﬁle) Card. 
Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE 
Type 
A 
 
 
Densities for Condensed Species. Include as many cards as needed.  This input ends 
at the next keyword (“*”) card. 
Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DENSITY 
Species Name 
Type 
F 
A 
Default 
none 
none 
Remark 
 
3 
 

================================================================================
PAGE 146
================================================================================

*CHEMISTRY 
*CHEMISTRY_CONTROL_INFLATOR 
4-12 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
MODEL 
Type of inﬂator model to compute. 
EQ.1: 
Pyrotechnic model 
EQ.2: 
Hybrid model with cold ﬂow option in the gas 
chamber 
EQ.3: 
Hybrid model with heat ﬂow in the gas chamber 
EQ.4: 
Hybrid model with heat ﬂow in one additional gas 
chamber 
EQ.5: 
Hybrid model with heat ﬂow in two additional gas 
chambers 
OUT_TYPE 
Selects the output ﬁle format that will be used in an airbag simula-
tion. 
EQ.0: 
Screen output calibration output (see Remark 4) 
EQ.1: 
CESE compressible ﬂow solver (default) 
EQ.2: 
ALE solver 
EQ.3:  
CPM solver (with 2nd-order expansion of C p ) 
EQ.4:  
CPM solver (with 4th-order expansion of C p ) 
TRUNTIM 
Total run time. 
DELT 
Delta(t) to use in the model calculation. 
PTIME 
Time interval for output of time history data to FILE. 
FILE 
Name of the ASCII ﬁle in which to write the time history data and 
other data output by the inﬂator simulation. 
DENSITY 
Density of a condensed-phase species present in the inﬂator. 
Species 
Name 
Chemkin-compatible name of a condensed-phase species. 
 
Remarks: 
1. 
If MODEL = 3, the solution of an elementary reaction system is required for the 
ﬁnite-rate chemistry in the gas chamber. For MODEL = 4 and 5, the condensed 
phase is computed only in the combustion chamber. 

================================================================================
PAGE 147
================================================================================

*CHEMISTRY_CONTROL_INFLATOR 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-13 (CHEMISTRY) 
2. 
Output ﬁle includes all of the necessary thermodynamics variables and load 
curves for the species mass ﬂow rate, temperature, and density curve.  This will 
make it possible to generate the velocity curve which is required by each solver 
that carries out an airbag simulation. 
3. 
At least one of these cards will be input if condensed-phase species are present 
during the propellant combustion.  In this case, the user must specify each con-
densed-phase density.  This density is then used to compute the volume frac-
tions in both the combustion and gas chamber, where the energy equations are 
needed. 
4. 
If OUT_TYPE = 0, the propellant information will be displayed on the screen, 
including total mass, remaining mass percentage, and mass burning rate versus 
time, and the calibration data will be saved in the output ﬁle, including the time 
versus pressure, temperature, total mass ﬂow rate, and individual species mass 
fractions for all chambers.  With this option, the user can quickly see the eﬀect 
of changing the parameters on the ﬁrst three *CHEMISTRY_INFLATOR_PROP-
ERTIES cards.

================================================================================
PAGE 148
================================================================================

*CHEMISTRY 
*CHEMISTRY_CONTROL_HGI 
4-14 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
*CHEMISTRY_CONTROL_TBX 
Purpose:  Specify a chemistry solver for use in conjunction with stochastic TBX particles.  
This is intended only for modeling the second phase of an explosion where the explosive 
has embedded metal (aluminum) particles that are too large to have burned in the ﬁrst 
phase of the explosion. 
 
This chemistry card points to a *CHEMISTRY_MODEL card (via IDCHEM) with its as-
sociated *CHEMISTRY_COMPOSITION cards to set up the initial conditions.  That is, it 
establishes the spatial distribution of the species in the model. 
 
It is assumed that there is no chemical reaction rate information in the chemistry model 
ﬁles.  This is done since a special chemical reaction mechanism is implemented for TBX 
modeling.  If particles other than solid aluminum particles are embedded in the explo-
sive, then another burn model has to be implemented. 
 
Surface Part Card.  Card 1 format used when the PART keyword option is active. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IDCHEM 
USEPAR 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
1 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
IDCHEM 
Identiﬁer for this chemistry solver. 
USEPAR 
Coupling ﬂag indicating if a *STOCHASTIC_TBX_PARTICLES 
card is provided for this model: 
EQ.1: uses a *STOCHASTIC_TBX_PARTICLES card (default). 
EQ.0: does not use such a card. 

================================================================================
PAGE 149
================================================================================

*CHEMISTRY_CONTROL_ZND 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-15 (CHEMISTRY) 
*CHEMISTRY_CONTROL_ZND 
Purpose:  Compute the one-dimensional reduced chemistry of a ZND model.  It is then 
used in the initialization of the chemistry part of the CESE solver.  When this card is used, 
the *CESE_INITIAL_CHEMISTRY… cards must specify the progressive variable (degree 
of combustion) in the HIC ﬁeld. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
F 
EPLUS 
Q0 
GAM 
XYZD 
DETDIR 
 
 
Type 
F 
F 
F 
F 
F 
I 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ID 
Identiﬁer for this full chemistry calculation 
F 
Overdriven factor 
EPLUS 
EPLUS parameter of the ZND model 
Q0 
Q0 parameter of the ZND model 
GAM 
GAM parameter of the ZND model 
XYZD 
Position of the detonation front in the DETDIR direction 
DETDIR 
Detonation propagation direction: 
EQ.1: 푋-direction 
EQ.2: 푌-direction 

================================================================================
PAGE 150
================================================================================

*CHEMISTRY 
*CHEMISTRY_CONTROL_ZND 
4-16 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.3: 푍-direction

================================================================================
PAGE 151
================================================================================

*CHEMISTRY_DET_INITIATION 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-17 (CHEMISTRY) 
*CHEMISTRY_DET_INITIATION 
Purpose:  Performs a one-dimensional detonation calculation based upon a chemical 
composition and initial conditions.  It is then available for use immediately in the CESE 
solver for initializing a computation, or it can be subsequently used by the *CHEMIS-
TRY_CONTROL_1D card in a later run.  In the product regions, this card overrides the 
initialization of the *CESE_INITIAL_CHEMISTRY… cards. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
COMPID 
NMESH 
DLEN 
CFL 
TLIMIT 
XYZD 
DETDIR 
Type 
I 
I 
I 
F 
F 
F 
F 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
LSDA Output File Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
ID 
Identiﬁer for this one-dimensional detonation computation. 
COMPID 
Chemical composition identiﬁer of composition to use. 
NMESH 
Number of equal-width elements in the one-dimensional domain.
DLEN 
Length of the one-dimensional domain. 
CFL 
Time-step limiting factor. 
TLIMIT 
Time limit for the simulation 
XYZD 
Position of the detonation front in the DETDIR direction. 
DETDIR 
Detonation propagation direction (1 => X; 2 => Y; 3 => Z) 

================================================================================
PAGE 152
================================================================================

*CHEMISTRY 
*CHEMISTRY_DET_INITIATION 
4-18 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
FILE 
Name of the LSDA ﬁle in which to write the one-dimensional so-
lution. 

================================================================================
PAGE 153
================================================================================

*CHEMISTRY_INFLATOR_PROPERTIES 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-19 (CHEMISTRY) 
*CHEMISTRY_INFLATOR_PROPERTIES 
Purpose:  Provide the required properties of an inﬂator model. 
 
Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
COMP_ID
PDIA 
PHEIGHT 
PMASS 
TOTMASS
 
 
 
Type 
I 
F 
F 
F 
F 
 
 
 
Remarks 
1 
2 
2 
 
 
 
 
 
 
Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TFLAME 
PINDEX 
A0 
TDELAY 
RISETIME
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
none 
none 
none 
none 
None 
 
 
 
 
Combustion Chamber Parameter Card. 
Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
COMP1ID
VOL1 
AREA1 
CD1 
P1 
T1 
DELP1 
DELTI 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 

================================================================================
PAGE 154
================================================================================

*CHEMISTRY 
*CHEMISTRY_INFLATOR_PROPERTIES 
4-20 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
Gas Plenum Parameter Card. 
Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
COMP2ID
VOL2 
AREA2 
CD2 
P2 
T2 
DELP2 
DELT2 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
Tank Parameter Card. 
Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
COMP3ID
VOL3 
P3 
T3 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
Gas Chamber 1 (Optional, see Remark 3) Card. 
Card 6 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
COMP4ID 
VOL4 
AREA4 
CD4 
P4 
T4 
DELP4 
DELT4 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 

================================================================================
PAGE 155
================================================================================

*CHEMISTRY_INFLATOR_PROPERTIES 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-21 (CHEMISTRY) 
Gas Chamber 2 (Optional, see Remark 3) Card. 
Card 7 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
COMP5ID 
VOL5 
AREA5 
CD5 
P5 
T5 
DELP5 
DELT5 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
COMP_ID 
Chemical composition identiﬁer of the composition for the steady-
state propellant combustion (see Remark 1). 
PDIA 
Propellant diameter (see Remark 2). 
PHEIGHT 
Propellant height (see Remark 2). 
PMASS 
Individual cylinder (or sphere) propellant mass. 
TOTMASS 
Total propellant mass. 
TFLAME 
Adiabatic ﬂame (combustion) temperature. 
PINDEX  
Power of the pressure in rate of burn model. 
A0 
Steady-state constant. 
TDELAY  
Ignition time delay. 
RISETIME 
Rise time. 
COMP1ID 
Chemical composition identiﬁer of composition to use in the com-
bustion chamber. 
VOL1 
Volume of the combustion chamber. 
AREA1 
Area of the combustion chamber. 
CD1 
Discharge coeﬃcient of the combustion chamber. 
P1 
Pressure in the combustion chamber. 

================================================================================
PAGE 156
================================================================================

*CHEMISTRY 
*CHEMISTRY_INFLATOR_PROPERTIES 
4-22 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
T1 
Temperature in the combustion chamber. 
DELP1 
Rupture pressure in the combustion chamber. 
DELT1 
Elapsed time for breaking the burst disk between the chambers 
COMP2ID 
Chemical composition identiﬁer of composition to use in the gas
plenum. 
VOL2 
Volume of the gas plenum. 
AREA2 
Area of the gas plenum. 
CD2 
Discharge coeﬃcient of the gas plenum. 
P2 
Pressure in the gas plenum. 
T2 
Temperature in the gas plenum. 
DELP2 
Rupture pressure in the gas plenum. 
DELT2 
Elapsed time for breaking the burst disk between the chambers 
COMP3ID 
Chemical composition identiﬁer of composition to use in the tank.
VOL3 
Volume of the tank. 
P3 
Pressure in the tank. 
T3 
Temperature in the tank. 
COMP4ID 
Chemical composition identiﬁer of composition to use in the addi-
tional (second) gas chamber. 
VOL4 
Volume of the second gas chamber. 
P4 
Pressure in the second gas chamber. 
T4 
Temperature in the second gas chamber. 
DELP4 
Rupture pressure in the second gas chamber. 
DELT4 
Elapsed time for breaking the burst disk between the ﬁrst and sec-
ond gas chambers 
COMP5ID 
Chemical composition identiﬁer of composition to use in the addi-
tional (third) gas chamber. 

================================================================================
PAGE 157
================================================================================

*CHEMISTRY_INFLATOR_PROPERTIES 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-23 (CHEMISTRY) 
VOL5 
Volume of the third gas chamber. 
P5 
Pressure in the third gas chamber. 
T5 
Temperature in the third gas chamber. 
DELP5 
Rupture pressure in the third gas chamber. 
DELT5 
Elapsed time for breaking the burst disk between the second and 
third gas chambers 
 
Remarks: 
1. 
The propellant composition can be obtained by running a chemical equilibrium 
program such as NASA CEA, the CHEETAH code, or the PEP code.  LSTC pro-
vides a modiﬁed version of the PEP code along with documentation for users; it 
is available upon request. 
2. 
A spherical shape for the propellant particles can be chosen if an identical value 
for the diameter and height is given. 
3. 
To simulate a 4 or 5 chamber inﬂator, an additional chamber card can be used.  
In these cases of the inﬂator models, the condensed phase species are limited to 
the combustion chamber only if involved in the propellant combustion.

================================================================================
PAGE 158
================================================================================

*CHEMISTRY 
*CHEMISTRY_MODEL 
4-24 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
*CHEMISTRY_MODEL 
Purpose:  Identiﬁes the ﬁles that deﬁne a Chemkin chemistry model. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MODELID
JACSEL 
ERRLIM 
 
 
 
 
 
Type 
I 
I 
F 
 
 
 
 
 
Default 
none 
1 
1.0e-3 
 
 
 
 
 
 
Chemkin Input File Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE1 
Type 
A 
 
Thermodynamics Database File Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE2 
Type 
A 
 
Transport Properties Database File Card. 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILE3 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
MODELID 
Identiﬁer for this Chemkin-based chemistry model 

================================================================================
PAGE 159
================================================================================

*CHEMISTRY_MODEL 
*CHEMISTRY 
R16@bdccd6d07 (03/10/25) 
4-25 (CHEMISTRY) 
 VARIABLE  
 
DESCRIPTION 
JACSEL 
Selects the form of the Jacobian matrix for use in the source term:
EQ.1: Fully implicit (default) 
EQ.2: Simpliﬁed implicit 
ERRLIM 
Allowed error in element balance in a chemical reaction 
FILE1 
Name of the ﬁle containing the Chemkin-compatible input 
FILE2 
Name of the ﬁle containing the chemistry thermodynamics data-
base 
FILE3 
Name of the ﬁle containing the chemistry transport properties da-
tabase 

================================================================================
PAGE 160
================================================================================

*CHEMISTRY 
*CHEMISTRY_PATH 
4-26 (CHEMISTRY) 
R16@bdccd6d07 (03/10/25) 
*CHEMISTRY_PATH 
Purpose:  To specify one or more search paths to look for chemistry database ﬁles. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DIR 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
DIR 
Directory path to add to the search set. 

================================================================================
PAGE 161
================================================================================

 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-1 (DUALCESE) 
*DUALCESE 
 
The keyword *DUALCESE provides input data for the dual Conservation Element/So-
lution Element (dual CESE) compressible ﬂuid solver: 
*DUALCESE_BOUNDARY_AXISYMMETRIC_{OPTION} 
*DUALCESE_BOUNDARY_CYCLIC_{OPTION} 
*DUALCESE_BOUNDARY_FSI_{OPTION} 
*DUALCESE_BOUNDARY_NON_REFLECTIVE_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MACHNUM_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MFRATE_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_PRESSURE_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_EXMFRATE_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_FARFIELD_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_PRESSURE_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE_{OPTION} 
*DUALCESE_BOUNDARY_REFLECTIVE_{OPTION} 
*DUALCESE_BOUNDARY_SLIDING_{OPTION} 
*DUALCESE_BOUNDARY_SOLID_WALL_{OPTION1}_{OPTION2} 
*DUALCESE_CONTROL_LIMITER 
*DUALCESE_CONTROL_MESH_MOV 
*DUALCESE_CONTROL_SOLVER (deprecated as of R14) 
*DUALCESE_CONTROL_TIMESTEP 
*DUALCESE_DARCY-FORCHHEIMER_EQ 

================================================================================
PAGE 162
================================================================================

*DUALCESE 
 
5-2 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_DATABASE_HISTORY_DRAG_LIFT 
*DUALCESE_DATABASE_HISTORY_ELEMENT_SET 
*DUALCESE_DATABASE_HISTORY_GLOBALS 
*DUALCESE_DATABASE_HISTORY_NODE_SET 
*DUALCESE_DATABASE_HISTORY_POINT_SET 
*DUALCESE_DATABASE_HISTORY_SEGMENT_SET 
*DUALCESE_D3PLOT 
*DUALCESE_D3PLOT_FLUID_SSID 
*DUALCESE_ELE2D 
*DUALCESE_ELE3D 
*DUALCESE_ELEMENTSET 
*DUALCESE_EOS_CAV_HOMOG_EQUILIB 
*DUALCESE_EOS_COCHRAN_CHAN 
*DUALCESE_EOS_COOLPROP 
*DUALCESE_EOS_IDEAL_GAS 
*DUALCESE_EOS_INFLATOR1 
*DUALCESE_EOS_INFLATOR2 
*DUALCESE_EOS_JWL 
*DUALCESE_EOS_NASG 
*DUALCESE_EOS_REFPROP 
*DUALCESE_EOS_REFPROP_PATH 
*DUALCESE_EOS_SET (deprecated as of R14) 
*DUALCESE_EOS_STIFFENED_GAS 
*DUALCESE_EOS_VAN_DER_WAALS_GENERALIZED 
*DUALCESE_FSI_EXCLUDE 
*DUALCESE_FSI_EXCLUDE_PARTSET 

================================================================================
PAGE 163
================================================================================

 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-3 (DUALCESE) 
*DUALCESE_GRAVITY 
*DUALCESE_INCLUDE_MODEL 
*DUALCESE_INITIAL 
*DUALCESE_INITIAL_{OPTION} 
*DUALCESE_INITIAL_HYBRID 
*DUALCESE_INITIAL_HYBRID_SET 
*DUALCESE_INITIAL_PHASE_CHANGE 
*DUALCESE_INITIAL_PHASE_CHANGE_SET 
*DUALCESE_INITIAL_TWO-PHASE 
*DUALCESE_INITIAL_TWO-PHASE_SET 
*DUALCESE_MAT_GAS 
*DUALCESE_MAT_GAS_0 
*DUALCESE_MAT_GAS_2 
*DUALCESE_MAT_LIQUID 
*DUALCESE_MESH_GEOMETRY 
*DUALCESE_MESH_PART 
*DUALCESE_MODEL 
*DUALCESE_NODE2D 
*DUALCESE_NODE3D 
*DUALCESE_NODESET 
*DUALCESE_PART (deprecated as of R14) 
*DUALCESE_PART_MULTIPHASE (deprecated as of R14) 
*DUALCESE_POINT_SOURCE 
*DUALCESE_POINT_SOURCE_STRUCTNODE 
*DUALCESE_POINT_SOURCE_TWO-PHASE 
*DUALCESE_POINTSET 

================================================================================
PAGE 164
================================================================================

*DUALCESE 
 
5-4 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_POROUS_MODEL 
*DUALCESE_POROUS_SPECIFY_JUMP 
*DUALCESE_REACTION_RATE_IG 
*DUALCESE_REACTION_RATE_IG_REDUCED 
*DUALCESE_REACTION_RATE_P_DEPEND 
*DUALCESE_SEGMENTSET 
*DUALCESE_SOLVER_SELECTION 
*DUALCESE_SOLVER_CAV_EQNS 
*DUALCESE_SOLVER_EULER_EQNS 
*DUALCESE_SOLVER_HYBRID_MULTIPHASE 
*DUALCESE_SOLVER_NAVIER_STOKES 
*DUALCESE_SOLVER_PHASE_CHANGE 
*DUALCESE_SOLVER_TWO-PHASE_MULTIPHASE 
An additional keyword option TITLE may be appended to the *DUALCESE keywords.  
If this option is used, then an addition line is read for the DUALCESE card in 80a format 
which can be used to describe that particular DUALCESE card.  At present, the title serves 
no purpose other than to perhaps lend clarity to input decks. 
Dual CESE Keyword Deck Structure: 
The structure of the keyword setup for the *DUALCESE solvers is diﬀerent from the way 
most keyword input is handled in the LS-DYNA input phase.  This stems from the fact 
that there can be several *DUALCESE models in the same problem.  In order to deal with 
this, each such model is restricted to be speciﬁed with one ﬁle hierarchy that starts with 
the keyword ﬁle designated with the *DUALCESE_MODEL card.  
That keyword ﬁle can include any number of other keyword ﬁles with the *DUALCESE_-
INCLUDE_MODEL card, and each of those ﬁles can in turn include other keyword ﬁles, 
again with the *DUALCESE_INCLUDE_MODEL card.  Standard *INCLUDE cards are 
not allowed.  In fact, in each ﬁle in the ﬁle hierarchy of a *DUALCESE_MODEL card, only 
*DUALCESE cards may be used.  The only exception to this is when the ﬂuid mesh is 
deﬁned using *MESH cards; a fatal error will be encountered when using other non-*DU-
ALCESE keywords.  Any required non-*DUALCESE keyword cards should be deﬁned 

================================================================================
PAGE 165
================================================================================

 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-5 (DUALCESE) 
in some other place in the keyword input (outside the scope of the *DUALCESE_MODEL 
keyword card). 
The mesh for each dual CESE model must be deﬁned within the keyword input ﬁle hier-
archy for that model.  If a mesh created with *MESH cards is used, the *MESH cards for 
that mesh must all be deﬁned within the scope of the *DUALCESE_MODEL card. 
With R14, we introduce an updated, preferred way of specifying the dual CESE problem.  
The required or recommended keywords to use are: 
*DUALCESE_MESH_GEOMETRY 
*DUALCESE_MESH_PART 
*DUALCESE_SOLVER_SELECTION 
 
along with one of the following speciﬁc solver cards: 
*DUALCESE_SOLVER_CAV_EQNS 
*DUALCESE_SOLVER_EULER_EQNS 
*DUALCESE_SOLVER_HYBRID_MULTIPHASE 
*DUALCESE_SOLVER_NAVIER_STOKES 
*DUALCESE_SOLVER_PHASE_CHANGE (added in R15) 
*DUALCESE_SOLVER_TWO-PHASE_MULTIPHASE 
The following keywords are deprecated as of R14: 
*DUALCESE_CONTROL_SOLVER 
*DUALCESE_EOS_SET 
*DUALCESE_PART 
*DUALCESE_PART_MULTIPHASE 
We also added time history cards with R14 that cause certain output to the binout ﬁle: 
*DUALCESE_DATABASE_HISTORY_ELEMENT_SET 
*DUALCESE_DATABASE_HISTORY_GLOBALS 
*DUALCESE_DATABASE_HISTORY_NODE_SET 
*DUALCESE_DATABASE_HISTORY_POINT_SET 

================================================================================
PAGE 166
================================================================================

*DUALCESE 
 
5-6 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_DATABASE_HISTORY_SEGMENT_SET 
Another time history-type card is new with R15; it causes drag and lift-related quantities 
to be output to the binout ﬁle from the immersed boundary method (IBM) FSI-type dual 
CESE solvers. 
*DUALCESE_DATABASE_HISTORY_DRAG_LIFT 
We support two external equation-of-state (EOS) libraries, REFPROP and COOLPROP, 
for dual CESE. Including these libraries is complex, so we will clarify how to include them 
here.  Each of them is accessed through a shared library that has to be loaded into LS-
DYNA at runtime with *MODULE_LOAD like in the follwing: 
 
*MODULE_LOAD 
UserA                  DUALCESE REFPROP 
<path to the installed REFPROP shared library> 
Note that this *MODULE_LOAD card must not be given inside a keyword ﬁle in the ﬁle 
hierarchy of a *DUALCESE_MODEL card.  As discussed above, this is the case for all 
non-*DUALCESE keyword cards.  Note also that since *MODULE is not available in the 
Windows version of LS-DYNA, this capability cannot be used in that version. 
REFPROP and COOLPROP Libraries: 
While the REFPROP v10.0 version library and its directory of data sets is provided by 
ANSYS, COOLPROP libraries are not provided by ANSYS. 
For the COOLPROP shared library, you can ﬁnd the current production version here:  
https://sourceforge.net/projects/coolprop/ﬁles/CoolProp/6.3.0/shared_li-
brary/Linux/64bit/ 
Multiphase Capabilities: 
The multiphase capabilities added for R13 with modiﬁcations in R14 all have FSI capa-
bilities, including with structural element failure.  This includes the ‘hybrid’ multiphase, 
‘two-phase’ multiphase, and the cavitation solvers.  New with R15 is a ‘phase-change’ 
multiphase solver.  These keywords are involved with these capabilities: 
*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID 
*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE 
*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE 
*DUALCESE_EOS_CAV_HOMOG_EQUILIB 

================================================================================
PAGE 167
================================================================================

 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-7 (DUALCESE) 
*DUALCESE_EOS_COCHRAN_CHAN 
*DUALCESE_EOS_JWL 
*DUALCESE_EOS_NASG 
*DUALCESE_EOS_SET (deprecated as of R14; use one of the *DUALCESE_-
SOLVER_... cards instead) 
*DUALCESE_EOS_STIFFENED_GAS 
*DUALCESE_EOS_VAN_DER_WAALS_GENERALIZED 
*DUALCESE_INITIAL_HYBRID 
*DUALCESE_INITIAL_HYBRID_SET 
*DUALCESE_INITIAL_PHASE_CHANGE 
*DUALCESE_INITIAL_PHASE_CHANGE_SET 
*DUALCESE_INITIAL_TWO-PHASE 
*DUALCESE_INITIAL_TWO-PHASE_SET 
*DUALCESE_PART_MULTIPHASE (deprecated as of R14; use *DUALCESE_-
MESH_PART instead) 
*DUALCESE_REACTION_RATE_IG 
*DUALCESE_REACTION_RATE_IG_REDUCED 
*DUALCESE_REACTION_RATE_P_DEPEND 
*DUALCESE_SOLVER_HYBRID_MULTIPHASE (added in R14) 
*DUALCESE_SOLVER_PHASE_CHANGE  (added in R15) 
*DUALCESE_SOLVER_TWO-PHASE_MULTIPHASE (added in R14) 
Flow Inlet and Exit Boundary Conditions: 
The following prescribed inlet and prescribed outlet boundary condition cards are new 
with R14: 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MACHNUM_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MFRATE_{OPTION} 

================================================================================
PAGE 168
================================================================================

*DUALCESE 
 
5-8 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_PRESSURE_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_EXMFRATE_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_FARFIELD_{OPTION} 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_PRESSURE_{OPTION} 
Comparison to CESE: 
The capabilities implemented in the dual CESE solvers are only a part of what is available 
in the *CESE solvers, especially those that involve couplings with the *CHEMISTRY and 
*STOCHASTIC_PARTICLE solvers.  Another *CESE capability that is missing in the dual 
CESE solver is conjugate heat transfer.  Some capabilities are only in the newer dual CESE 
solvers, in particular, the multiphase solvers, the many added EOSes, the binout-based 
time history capabilities, and the point-source-type ﬂuid injection methods implemented 
in the single phase CFD solvers and the two-phase multiphase solvers.  Also, drag, lift, 
and related variables are only computed for the Dual CESE IBM FSI solvers (starting with 
R15).

================================================================================
PAGE 169
================================================================================

*DUALCESE_BOUNDARY_AXISYMMETRIC 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-9 (DUALCESE) 
*DUALCESE_BOUNDARY_AXISYMMETRIC_OPTION 
Available options are: 
MSURF 
SEGMENT_SET 
Purpose: Deﬁne an axisymmetric boundary condition on the axisymmetric axis for the 
2D axisymmetric dual CESE compressible ﬂow solver.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET option should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Summary: 
Card 1a.  This card is included for the MSURF keyword option.  Provide as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
MSPID 
 
 
 
 
 
 
 
Card 1b.  This card is included for the SEGMENT_SET keyword option.  Provide as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
SSID 
 
 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card.  Card 1 used when the MSURF keyword option is active.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 

================================================================================
PAGE 170
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_AXISYMMETRIC 
5-10 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
 
Set Card.  Card 1 used when the SEGMENT_SET keyword option is active.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID for the segment set created with *DUALCESE_-
SEGMENTSET 
Remarks: 
This boundary condition can only be used on the axisymmetric axis for the 2D axisym-
metric dual CESE ﬂuid solver.

================================================================================
PAGE 171
================================================================================

*DUALCESE_BOUNDARY_CYCLIC 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-11 (DUALCESE) 
*DUALCESE_BOUNDARY_CYCLIC_OPTION 
Available options are: 
MSURF 
SEGMENT_SET 
Purpose: Deﬁne a cyclic (periodic) boundary condition for dual CESE compressible ﬂows.  
This cyclic boundary condition can be used on periodic boundary surfaces. 
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET option should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Summary: 
Card Sets.  The following sequence of cards comprises a single set.  LS-DYNA will con-
tinue reading these cards sets until the next keyword (“*”) card is encountered. 
Card 1a.  This card is included if the MSURF keyword option is used. 
MSPID1 
MSPID2 
CYCTYP 
 
 
 
 
 
Card 1b.  This card is included if the SEGMENT_SET keyword option is used. 
SSID1 
SSID2 
CYCTYP 
 
 
 
 
 
Card 2a.  This card is included when CYCTYP = 1. 
AXISX1 
AXISY1 
AXISZ1 
DIRX 
DIRY 
DIRZ 
ROTANG 
 
Card 2b.  This card is included when CYCTYP = 2. 
TRANSX 
TRANSY 
TRANSZ 
 
 
 
 
 
 

================================================================================
PAGE 172
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_CYCLIC 
5-12 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format used when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID1 
MSPID2 
CYCTYP 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
0 
 
 
 
 
 
Remarks 
 
 
1, 2 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID1, 
MSPID2 
Mesh surface part IDs that are referenced by *MESH_SUR-
FACE_ELEMENT cards 
CYCTYP 
Relationship between the two cyclic boundary condition sur-
faces: 
EQ.0: Relationship determined by LS-DYNA (default) 
EQ.1: The ﬁrst surface is rotated about an axis to match the 
second surface. 
EQ.2: The faces of the ﬁrst surface are translated in a given di-
rection to obtain the corresponding faces on the second 
surface. 
 
Set Card. Card 1 format used when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID1 
SSID2 
CYCTYP 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
0 
 
 
 
 
 
Remarks 
 
 
1, 3 
 
 
 
 
 
 

================================================================================
PAGE 173
================================================================================

*DUALCESE_BOUNDARY_CYCLIC 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-13 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
SSID1, 
SSID2 
Segment set IDs for the segment sets created with *DUALCESE_-
SEGMENTSET 
CYCTYP 
Relationship between the two cyclic boundary condition sur-
faces: 
EQ.0: Relationship determined by LS-DYNA (default) 
EQ.1: The ﬁrst surface is rotated about an axis to match the 
second surface. 
EQ.2: The faces of the ﬁrst surface are translated in a given di-
rection to obtain the corresponding faces on the second 
surface. 
 
Rotation Case Card. Additional card when CYCTYP = 1. 
 Card 2a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
AXISX1 
AXISY1 
AXISZ1 
DIRX 
DIRY 
DIRZ 
ROTANG 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
0.0 
0.0 
0.0 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
AXIS[X,Y,Z]1 
A point on the axis of rotation for the transformation between the
surfaces 
DIR[X,Y,Z] 
The direction which together with AXIS[X,Y,Z]1 deﬁnes the axis 
of rotation for the transformation between the surfaces 
ROTANG 
The angle of rotation (in degrees) that transforms the centroid of 
each face on the ﬁrst surface to the centroid of the corresponding
face on the second surface  
 

================================================================================
PAGE 174
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_CYCLIC 
5-14 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Translation Case Card. Additional card when CYCTYP = 2. 
 Card 2b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TRANSX 
TRANSY 
TRANSZ 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
TRANS[X,Y,Z] 
The translation direction that enables the identiﬁcation of the 
segment in the second surface that matches a segment in the ﬁrst
surface  
Remarks: 
1. 
Unspeciﬁed Relationship between Surfaces. For the case CYCTYP = 0, LS-
DYNA examines the geometry of two faces of the two surfaces in order to deter-
mine if the surfaces are approximately parallel (CYCTYP = 2) or related through 
a rotation (CYCTYP = 1).  The geometric parameters required are then com-
puted. 
2. 
MSURF. For the MSURF option, each mesh surface part must contain the same 
number of mesh surface elements.  The mesh surface elements in each mesh sur-
face part are internally ordered for pairwise matching between the two mesh 
surface parts. 
3. 
SEGMENT_SET. For the SEGMENT_SET option, each segment set must contain 
the same number segments.  The segments in each set are internally ordered for 
pairwise matching between the two sets.

================================================================================
PAGE 175
================================================================================

*DUALCESE_BOUNDARY_FSI 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-15 (DUALCESE) 
*DUALCESE_BOUNDARY_FSI_OPTION 
Available options are: 
MSURF 
SEGMENT_SET 
Purpose: Deﬁne an FSI boundary condition for the moving mesh dual CESE compressible 
ﬂow solver.  This keyword must not be combined with the dual CESE immersed-bound-
ary method FSI solver in the same dual CESE part on the same dual CESE mesh.  Doing 
so will result in an error termination condition. 
 
This boundary condition must be applied on a surface of the dual CESE computational 
domain that is co-located with surfaces of the outside boundary of the structural mesh.  
The nodes of the two meshes will generally not be shared. 
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET option should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Summary: 
Card 1a.  Include this card for the MSURF keyword option.  Provide as many cards as 
necessary.  This input ends at the next keyword (“*”) card. 
MSPID 
REF_P 
 
 
 
 
 
 
Card 1b.  Include this card for the SEGMENT_SET keyword option.  Provide as many 
cards as necessary.  This input ends at the next keyword (“*”) card. 
SSID 
REF_P 
 
 
 
 
 
 

================================================================================
PAGE 176
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_FSI 
5-16 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
Surface Part Card.  Card 1 used when the MSURF keyword option is active.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
REF_P 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
0.0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
REF_P 
Ambient/reference pressure of the ﬂuid domain on the side oppo-
site this structural interface to the ﬂuid simulation domain.  This 
ambient pressure only needs to be speciﬁed in the case where the
FSI structural part(s) connected with this FSI interface are not im-
mersed in the dual CESE mesh.  This reference pressure defaults to
0.0 since moving mesh FSI calculations most often involve struc-
tures surrounded by the dual CESE mesh, and there is no need for 
a reference pressure in that case. 
 
Set Card.  Card 1 used when the SEGMENT_SET keyword option is active.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
REF_P 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
0.0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID for the segment set created with *DUALCESE_-
SEGMENTSET 

================================================================================
PAGE 177
================================================================================

*DUALCESE_BOUNDARY_FSI 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-17 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
REF_P 
Ambient/reference pressure of the ﬂuid domain on the side oppo-
site this structural interface to the ﬂuid simulation domain.  This 
ambient pressure only needs to be speciﬁed in the case where the
FSI structural part(s) connected with this FSI interface are not im-
mersed in the dual CESE mesh.  This reference pressure defaults to
0.0 since moving mesh FSI calculations most often involve struc-
tures surrounded by the dual CESE mesh, and there is no need for
a reference pressure in that case.. 
Remarks: 
This boundary condition card is also needed for conjugate heat transfer problems with 
the moving mesh dual CESE solver.  However, the conjugate heat transfer capability is 
not implemented in the dual CESE solver.

================================================================================
PAGE 178
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_NON_REFLECTIVE 
5-18 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_NON_REFLECTIVE_OPTION 
Available options are: 
MSURF 
SEGMENT_SET 
Purpose: Deﬁne a passive boundary condition for dual CESE compressible ﬂows.  This 
non-reﬂective boundary condition provides an artiﬁcial computational boundary for an 
open boundary that is passive. 
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET option should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards are used to specify the dual CESE mesh. 
Card Summary: 
Card 1a.  This card is included when the MSURF keyword option is used.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
MSPID 
DIRX 
DIRY 
DIRZ 
 
 
 
 
Card 1b.  This card is included when the SEGMENT_SET keyword option is used.  In-
clude as many cards as necessary.  This input ends at the next keyword (“*”) card. 
SSID 
DIRX 
DIRY 
DIRZ 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card.  Card 1 used when the MSURF keyword option is active.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
DIRX 
DIRY 
DIRZ 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
0.0 
0.0 
0.0 
 
 
 
 
 

================================================================================
PAGE 179
================================================================================

*DUALCESE_BOUNDARY_NON_REFLECTIVE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-19 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, then it is used as the prescribed ﬂow di-
rection. 
 
Set Card.  Card 1 used when the SET keyword option is active.  Include as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
DIRX 
DIRY 
DIRZ 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
0.0 
0.0 
0.0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID for the segment set created with *DUALCESE_-
SEGMENTSET 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, then it is used as the prescribed ﬂow di-
rection. 
Remarks: 
1. 
Boundary Surface Flow.  This boundary condition is usually imposed on an 
open surface that is far from the main disturbed ﬂow (the further away, the bet-
ter), meaning the ﬂow on the boundary surface should be almost uniform. 
2. 
Default Boundary Condition. If any boundary segment has not been assigned 
a boundary condition by any of the *DUALCESE_BOUNDARY_… cards, then 
it will automatically be assigned this non-reﬂective boundary condition.

================================================================================
PAGE 180
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED 
5-20 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set boundary values for velocity, 
density, pressure and temperature.  Boundary values are applied at the centroid of ele-
ments connected with this boundary.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  This card is included if the MSURF keyword option is used. 
MSPID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Card 1b.  This card is included if the SEGMENT_SET keyword option is used. 
SSID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Card 2.  This card is required. 
LC_U 
LC_V 
LC_W 
LC_RHO 
LC_P 
LC_T 
 
 

================================================================================
PAGE 181
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-21 (DUALCESE) 
Card 3.  This card is required. 
SF_U 
SF_V 
SF_W 
SF_RHO 
SF_P 
SF_T 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format used when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, the chemical mixture of the ﬂuid entering the domain is de-
ﬁned with a *CHEMISTRY_COMPOSITION card with this ID [Not 
yet available]. 
DIRX, DIRY, 
DIRZ 
If this vector is non-zero, then it is used as the prescribed ﬂow di-
rection. 
 
Set Card. Card 1 format used when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 182
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED 
5-22 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, the chemical mixture of the ﬂuid entering the domain is de-
ﬁned with a *CHEMISTRY_COMPOSITION card with this ID [Not 
yet available]. 
DIRX, DIRY, 
DIRZ 
If this vector is non-zero, then it is used as the prescribed ﬂow di-
rection. 
 
Load Curve Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_U 
LC_V 
LC_W 
LC_RHO 
LC_P 
LC_T 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
Remarks 
1 
1 
1 
1 
1 
1 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_U 
Load curve ID (see *DEFINE_CURVE) to describe the 푥-compo-
nent of the velocity as a function of time or function ID (see *DE-
FINE_FUNCTION) to give the 푥-component of the velocity as a 
function of position, velocity, temperature, pressure, and time, f(x, 
y, z, vx, vy, vz, temp, pres, time). 
EQ.0: 푥-component of velocity is a constant with value SF_U. 
EQ.-1: 푥-component of velocity is computed by the solver. 
LC_V 
Load curve ID to describe the 푦-component of the velocity as a 
function of time or function ID to give the 푦-component of the ve-
locity as a function of position, velocity, temperature, pressure, and 
time, f(x, y, z, vx, vy, vz, temp, pres, time). 
EQ.0: 푦-component of velocity is a constant with value SF_V. 
EQ.-1: 푦-component of velocity is computed by the solver. 
LC_W 
Load curve ID to describe the 푧-component of the velocity as a
function of time or function ID to give the 푧-component of the 

================================================================================
PAGE 183
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-23 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
velocity as a function of position, velocity, temperature, pressure, 
and time, f(x, y, z, vx, vy, vz, temp, pres, time). 
EQ.0: 푧-component of velocity is a constant with value SF_W.
EQ.-1: 푧-component of velocity is computed by the solver. 
LC_RHO 
Load curve ID to describe the density as a function of time or func-
tion ID to give the density as a function of position, velocity, tem-
perature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time).
EQ.0: Density is a constant with value SF_RHO. 
EQ.-1: Density is computed by the solver. 
LC_P 
Load curve ID to describe the pressure as a function of time or 
function ID to give the pressure as a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time). 
EQ.0: Pressure is a constant with value SF_P. 
EQ.-1: Pressure is computed by the solver. 
LC_T 
Load curve ID to describe the temperature as a function of time or
function ID to give the temperature as a function of position, ve-
locity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Temperature is a constant with value SF_T. 
EQ.-1: Temperature is computed by the solver. 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_U 
SF_V 
SF_W 
SF_RHO 
SF_P 
SF_T 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_U 
Scale factor for LC_U  

================================================================================
PAGE 184
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED 
5-24 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SF_V 
Scale factor for LC_V  
SF_W 
Scale factor for LC_W  
SF_RHO 
Scale factor for LC_RHO  
SF_P 
Scale factor for LC_P 
SF_T 
Scale factor for LC_T  
Remarks: 
1. 
Consistent Boundary Values. On each centroid or set of centroids, the varia-
bles (푣푥, 푣푦, 푣푧, 휌, 푃, 푇) that are given values must be consistent and make the 
model well-posed (meaning be such that the solution of the model exists, is 
unique, and is physical).

================================================================================
PAGE 185
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-25 (DUALCESE) 
*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set boundary values for velocity, 
density, pressure, temperature, and other values in the hybrid multiphase model.  Bound-
ary values are applied at the centroid of elements connected with this boundary.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Cards 2 and 3 provide load curve IDs. 
3. 
Cards 4 and 5 provide scale factors. 
For each boundary condition to be speciﬁed include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  This card is included if the keyword option is set to MSURF. 
MSPID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Card 1b.  This card is included if the keyword option is set to SSID. 
SSID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Card 2.  This card is required. 
LC_Z1 
LC_RA 
LC_U 
LC_V 
LC_W 
LC_D1 
LC_DA 
LC_DB 

================================================================================
PAGE 186
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID 
5-26 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Card 3.  This card is required. 
LC_P 
LC_T 
 
 
 
 
 
 
Card 4.  This card is required. 
SF_Z1 
SF_RA 
SF_U 
SF_V 
SF_W 
SF_D1 
SF_DA 
SF_DB 
Card 5.  This card is required. 
SF_P 
SF_T 
 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Set Card. Card 1 format used when the MSURF keyword option is active.
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, the chemical mixture of the ﬂuid entering the domain is de-
ﬁned with a *CHEMISTRY_COMPOSITION card with this ID [Not 
yet available]. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, then it is used as the prescribed ﬂow di-
rection. 
 

================================================================================
PAGE 187
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-27 (DUALCESE) 
Segment Set Card. Card 1 format used when the SEGMENT_SET keyword option is 
active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, the chemical mixture of the ﬂuid entering the domain is de-
ﬁned with a *CHEMISTRY_COMPOSITION card with this ID [Not 
yet available]. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, then it is used as the prescribed ﬂow di-
rection. 
 
Load Curve Card.  See Remark 1. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_Z1 
LC_RA 
LC_U 
LC_V 
LC_W 
LC_D1 
LC_DA 
LC_DB 
Type 
I 
I 
I 
I 
I 
I 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_Z1 
Load curve ID or function ID to describe the volume fraction of 
material 1 as a function of time or a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The volume fraction is a constant with value SF_Z1.  
EQ.-1: The volume fraction is computed by the solver. 
LC_RA 
Load curve or function ID to describe the mass fraction of reactant 
(material 훼) with respect to the explosive mixture (material 2) as a

================================================================================
PAGE 188
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID 
5-28 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
function of time or a function of position, velocity, temperature, 
pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), respec-
tively. 
EQ.0: The mass fraction is a constant with value SF_RA.  
EQ.-1: The mass fraction is computed by the solver. 
LC_U 
Load curve or deﬁned function ID to describe the 푥-component of 
the velocity as a function of time or a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The 푥-component of velocity is a constant with value SF_-
U.  
EQ.-1: The 푥-component of velocity is computed by the solver.
LC_V 
Load curve or deﬁned function ID to describe the 푦-component of 
the velocity as a function of time or a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The 푦-component of velocity is a constant with value SF_-
V.  
EQ.-1: The 푦-component of velocity is computed by the solver.
LC_W 
Load curve or deﬁned function ID to describe the 푧-component of 
the velocity as a function of time or a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The 푧-component of velocity is a constant with value SF_-
W.  
EQ.-1: The 푧-component of velocity is computed by the solver. 
LC_D1 
Load curve or deﬁned function ID to describe the density of the 
ﬁrst multiphase material as a function of time or a function of po-
sition, velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, 
temp, pres, time), respectively. 
EQ.0: The density of the ﬁrst multiphase material is a constant 
with value SF_D1.  
EQ.-1: The density of the ﬁrst multiphase material is computed 
by the solver. 

================================================================================
PAGE 189
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-29 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
LC_DA 
Load curve or deﬁned function ID to describe the density of the 
reactant (material 훼) as a function of time or a function of position, 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time), respectively. 
EQ.0: The density of the reactant is a constant with value SF_-
DA.  
EQ.-1: The density of the reactant is computed by the solver. 
LC_DB 
Load curve or deﬁned function ID to describe the density of the 
product (material 훽) as a function of time or a function of position, 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time), respectively. 
EQ.0: The density of the product is a constant with value SF_-
DB.  
EQ.-1: The density of the product is computed by the solver. 
 
Load Curve Card 2.  See Remark 1. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_P 
LC_T 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_P 
Load curve or deﬁned function ID to describe the pressure as a 
function of time or a function of position, velocity, temperature, 
pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), respec-
tively. 
EQ.0: The pressure is a constant with value SF_P.  
EQ.-1: The pressure is computed by the solver. 
LC_T 
Load curve or deﬁned function ID to describe the temperature as a 
function of time or a function of position, velocity, temperature, 
pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), respec-
tively. 
EQ.0: The temperature is a constant with value SF_T.  

================================================================================
PAGE 190
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID 
5-30 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.-1: The temperature is computed by the solver. 
 
Scale Factor Card.   
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_Z1 
SF_RA 
SF_U 
SF_V 
SF_W 
SF_D1 
SF_DA 
SF_DB 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
 
 VARIABLE  
 
DESCRIPTION 
SF_Z 
Scale factor for LC_Z1  
SF_RA 
Scale factor for LC_RA  
SF_U 
Scale factor for LC_U  
SF_V 
Scale factor for LC_V  
SF_W 
Scale factor for LC_W  
SF_D1 
Scale factor for LC_D1  
SF_DA 
Scale factor for LC_DA  
SF_DB 
Scale factor for LC_DB  
 
Scale Factor Card 2.  
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_P 
SF_T 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
1.0 
1.0 
 
 
 
 
 
 
 

================================================================================
PAGE 191
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_HYBRID 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-31 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
SF_P 
Scale factor for LC_P  
SF_T 
Scale factor for LC_T  
Remark: 
1. 
Consistent Boundary Values. On each centroid or set of element centroids, the 
variables (푣푥, 푣푦, 푣푧, 휌, 푃, 푇, …) that are given values must be consistent and make 
the model well-posed (meaning be such that the solution of the model exists, is 
unique, and is physical).

================================================================================
PAGE 192
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MACHNUM 
5-32 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MACHNUM_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set inlet boundary values using 
total pressure, total temperature, and Mach number.  Specifying an arbitrary inlet ﬂow 
direction is an option.  Boundary values are applied at the centroid of elements connected 
with this boundary.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed, include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  Include this card if the MSURF keyword option is used. 
MSPID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 1b.  Include this card if the SEGMENT_SET keyword option is used. 
SSID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 2.  This card is required. 
LC_TOTP 
LC_TOTT 
LC_MACH 
 
 
 
 
 

================================================================================
PAGE 193
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MACHNUM 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-33 (DUALCESE) 
Card 3.  This card is required. 
SF_TOTP 
SF_TOTT 
SF_MACH 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Include this card when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IWALL 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this inlet boundary. 
EQ.1: Do treat this inlet boundary as an artiﬁcial wall whenever 
ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Set Card. Include this card when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IWALL 
DIRX 
DIRX 
DIRY 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 194
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MACHNUM 
5-34 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this inlet boundary. 
EQ.1: Do treat this inlet boundary as an artiﬁcial wall whenever 
ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Load Curve Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_TOTP
LC_TOTT LC_MACH
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Remarks 
1 
1 
1 
 
 
  
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_TOTP 
Load curve ID (see *DEFINE_CURVE) to describe the total pres-
sure as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the total pressure as a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time). 
EQ.0: Total pressure is a constant with value SF_TOTP. 
LC_TOTT 
Load curve ID (see *DEFINE_CURVE) to describe the total temper-
ature as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the total temperature as a function of position, 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Total temperature is a constant with value SF_TOTT. 
LC_MACH 
Load curve ID to describe the Mach number as a function of time 
or function ID to give the Mach number as a function of position,

================================================================================
PAGE 195
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MACHNUM 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-35 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Mach number is a constant with value SF_MACH. 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_TOTP
SF_TOTT SF_MACH
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
1.0 
1.0 
1.0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_TOTP 
Scale factor for LC_TOTP 
SF_TOTT 
Scale factor for LC_TOTT 
SF_MACH 
Scale factor for LC_MACH 
Remarks: 
1. 
Consistent boundary values. On each centroid or set of centroids, the variables 
(푃total, 푇total, Mach number) that are given values must be consistent and make 
the model well-posed (meaning be such that the solution of the model exists, is 
unique, and is physical).

================================================================================
PAGE 196
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MFRATE 
5-36 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MFRATE_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set inlet boundary values using 
total pressure, total temperature, and mass ﬂow rate.  Specifying an arbitrary inlet ﬂow 
direction is an option.  Boundary values are applied at the centroid of elements connected 
with this boundary.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed, include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  Include this card if the MSURF keyword option is used. 
MSPID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 1b.  Include this card if the SEGMENT_SET keyword option is used. 
SSID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 2.  This card is required. 
LC_TOTP 
LC_TOTT 
LC_MFRT 
 
 
 
 
 

================================================================================
PAGE 197
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MFRATE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-37 (DUALCESE) 
Card 3.  This card is required. 
SF_TOTP 
SF_TOTT 
SF_MFRT 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Include this card when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IWALL 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this inlet boundary. 
EQ.1: Do treat this inlet boundary as an artiﬁcial wall whenever 
ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Set Card. Include this card when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IWALL 
DIRX 
DIRX 
DIRY 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 198
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MFRATE 
5-38 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this inlet boundary. 
EQ.1: Do treat this inlet boundary as an artiﬁcial wall whenever 
ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Load Curve Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_TOTP
LC_TOTT LC_MFRT
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Remarks 
1 
1 
1 
 
 
  
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_TOTP 
Load curve ID (see *DEFINE_CURVE) to describe the total pres-
sure as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the total pressure as a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time). 
EQ.0: Total pressure is a constant with value SF_TOTP. 
LC_TOTT 
Load curve ID (see *DEFINE_CURVE) to describe the total temper-
ature as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the total temperature as a function of position, 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Total temperature is a constant with value SF_TOTT. 
LC_MFRT 
Load curve ID to describe the mass ﬂow rate as a function of time
or function ID to give the mass ﬂow rate as a function of position,

================================================================================
PAGE 199
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_INLET_MFRATE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-39 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Mass ﬂow rate is a constant with value SF_MFRT. 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_TOTP
SF_TOTT
SF_MFRT
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
1.0 
1.0 
1.0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_TOTP 
Scale factor for LC_TOTP 
SF_TOTT 
Scale factor for LC_TOTT 
SF_MFRT 
Scale factor for LC_MFRT 
Remarks: 
1. 
Consistent boundary values. On each centroid or set of centroids, the variables 
(푃total, 푇total, mass flow rate) that are given values must be consistent and make 
the model well-posed (meaning be such that the solution of the model exists, is 
unique, and is physical).

================================================================================
PAGE 200
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_PRESSURE 
5-40 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_PRESSURE_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set inlet boundary values using 
total pressure, total temperature, and static pressure.  Specifying an arbitrary inlet ﬂow 
direction is an option.  Boundary values are applied at the centroid of elements connected 
with this boundary.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed, include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  Include this card if the MSURF keyword option is used. 
MSPID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 1b.  Include this card if the SEGMENT_SET keyword option is used. 
SSID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 2.  This card is required. 
LC_TOTP 
LC_TOTT 
LC_PSTAT 
 
 
 
 
 

================================================================================
PAGE 201
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_INLET_PRESSURE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-41 (DUALCESE) 
Card 3.  This card is required. 
SF_TOTP 
SF_TOTT 
SF_PSTAT 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Include this card when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IWALL 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this inlet boundary. 
EQ.1: Do treat this inlet boundary as an artiﬁcial wall whenever 
ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Set Card. Include this card when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IWALL 
DIRX 
DIRX 
DIRY 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 202
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_INLET_PRESSURE 
5-42 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this inlet boundary. 
EQ.1: Do treat this inlet boundary as an artiﬁcial wall whenever 
there is ﬂow recirculation there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Load Curve Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_TOTP
LC_TOTT LC_PSTAT
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Remarks 
1 
1 
1 
 
 
  
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_TOTP 
Load curve ID (see *DEFINE_CURVE) to describe the total pres-
sure as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the total pressure as a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time). 
EQ.0: Total pressure is a constant with value SF_TOTP. 
LC_TOTT 
Load curve ID (see *DEFINE_CURVE) to describe the total temper-
ature as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the total temperature as a function of position, 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Total temperature is a constant with value SF_TOTT. 
LC_PSTAT 
Load curve ID to describe the static pressure as a function of time 
or function ID to give the static pressure as a function of position, 

================================================================================
PAGE 203
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_INLET_PRESSURE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-43 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Static pressure is a constant with value SF_PSTAT. 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_TOTP
SF_TOTT SF_PSTAT
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
1.0 
1.0 
1.0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_TOTP 
Scale factor for LC_TOTP 
SF_TOTT 
Scale factor for LC_TOTT 
SF_PSTAT 
Scale factor for LC_PSTAT 
Remarks: 
1. 
Consistent boundary values. On each centroid or set of centroids, the variables 
(푃total,  푇total, 푃static) that are given values must be consistent and make the model 
well-posed (meaning be such that the solution of the model exists, is unique, and 
is physical).

================================================================================
PAGE 204
================================================================================

*DUALCESE *DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_EXMFRATE 
5-44 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_EXMFRATE_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set outlet boundary values using 
reference pressure, reference temperature, and exit mass ﬂow rate.  Specifying an arbi-
trary outlet ﬂow direction is an option.  Boundary values are applied at the centroid of 
elements connected with this boundary.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  Include this card if the MSURF keyword option is used. 
MSPID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 1b.  Include this card if the SEGMENT_SET keyword option is used. 
SSID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 2.  This card is required. 
LC_PREF 
LC_TREF 
LC_MFRT 
 
 
 
 
 

================================================================================
PAGE 205
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_EXMFRATE *DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-45 (DUALCESE) 
Card 3.  This card is required. 
SF_PREF 
SF_TREF 
SF_MFRT 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Include this card when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IWALL 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this outlet boundary. 
EQ.1: Do treat this outlet boundary as an artiﬁcial wall when-
ever ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Set Card. Include this card when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IWALL 
DIRX 
DIRX 
DIRY 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 206
================================================================================

*DUALCESE *DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_EXMFRATE 
5-46 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this outlet boundary. 
EQ.1: Do treat this outlet boundary as an artiﬁcial wall when-
ever ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Load Curve Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_PREF
LC_TREF
LC_MFRT
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Remarks 
1 
1 
1 
 
 
  
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_PREF 
Load curve ID (see *DEFINE_CURVE) to describe the reference 
pressure as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the reference pressure as a function of position, ve-
locity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Reference pressure is a constant with value SF_PREF. 
LC_TREF 
Load curve ID (see *DEFINE_CURVE) to describe the reference 
temperature as a function of time or function ID (see *DEFINE_-
FUNCTION) to give the reference temperature as a function of po-
sition, velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, 
temp, pres, time). 
EQ.0: Reference temperature is a constant with value SF_TREF.
LC_MFRT 
Load curve ID to describe the exit mass ﬂow rate as a function of 
time or function ID to give the exit mass ﬂow rate as a function of 

================================================================================
PAGE 207
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_EXMFRATE *DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-47 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
position, velocity, temperature, pressure, and time, f(x, y, z, vx, vy, 
vz, temp, pres, time). 
EQ.0: exit mass ﬂow rate is a constant with value SF_MFRT. 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_PREF
SF_TREF
SF_MFRT
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
1.0 
1.0 
1.0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_PREF 
Scale factor for LC_PREF 
SF_TREF 
Scale factor for LC_TREF 
SF_MFRT 
Scale factor for LC_MFRT 
Remarks: 
1. 
Consistent boundary values. On each centroid or set of centroids, the variables 
(푃ref, 푇ref, Exit Mass Flow Rate) that are given values must be consistent and 
make the model well-posed (meaning be such that the solution of the model ex-
ists, is unique, and is physical).

================================================================================
PAGE 208
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_FARFIELD 
5-48 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_FARFIELD_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set outlet boundary values using 
static pressure, static temperature, and Mach number.  Specifying an arbitrary outlet ﬂow 
direction is an option.  Boundary values are applied at the centroid of elements connected 
with this boundary.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed, include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  Include this card if the MSURF keyword option is used. 
MSPID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 1b.  Include this card if the SEGMENT_SET keyword option is used. 
SSID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 2.  This card is required. 
LC_PSTAT LC_TSTAT 
LC_MACH 
 
 
 
 
 

================================================================================
PAGE 209
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_FARFIELD *DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-49 (DUALCESE) 
Card 3.  This card is required. 
SF_PSTAT SF_TSTAT 
SF_MACH 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Include this card when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IWALL 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this outlet boundary. 
EQ.1: Do treat this outlet boundary as an artiﬁcial wall when-
ever ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Set Card. Include this card when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IWALL 
DIRX 
DIRX 
DIRY 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 210
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_FARFIELD 
5-50 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this outlet boundary. 
EQ.1: Do treat this outlet boundary as an artiﬁcial wall when-
ever ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Load Curve Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable LC_PSTAT LC_TSTAT LC_MACH
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Remarks 
1 
1 
1 
 
 
  
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_PSTAT 
Load curve ID (see *DEFINE_CURVE) to describe the static pres-
sure as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the static pressure as a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time). 
EQ.0: Static pressure is a constant with value SF_PSTAT. 
LC_TSTAT 
Load curve ID (see *DEFINE_CURVE) to describe the static tem-
perature as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the static temperature as a function of position, 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Static temperature is a constant with value SF_TSTAT. 
LC_MACH 
Load curve ID to describe the Mach number as a function of time 
or function ID to give the Mach number as a function of position,

================================================================================
PAGE 211
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_FARFIELD *DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-51 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
velocity, temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, 
pres, time). 
EQ.0: Mach number is a constant with value SF_MACH. 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable SF_PSTAT SF_TSTAT SF_MACH
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
1.0 
1.0 
1.0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_PSTAT 
Scale factor for LC_PSTAT 
SF_TSTAT 
Scale factor for LC_TSTAT 
SF_MACH 
Scale factor for LC_MACH 
Remarks: 
1. 
Consistent boundary values. On each centroid or set of centroids, the variables 
(푃static, 푇static, Mach number) that are given values must be consistent and make 
the model well-posed (meaning be such that the solution of the model exists, is 
unique, and is physical).

================================================================================
PAGE 212
================================================================================

*DUALCESE *DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_PRESSURE 
5-52 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_PRESSURE_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set outlet boundary values using 
static pressure.  Specifying an arbitrary outlet ﬂow direction is an option.  Boundary val-
ues are applied at the centroid of elements connected with this boundary.  
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed, include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  Include this card if the MSURF keyword option is used. 
MSPID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 1b.  Include this card if the SEGMENT_SET keyword option is used. 
SSID 
IWALL 
DIR_X 
DIR_Y 
DIR_Z 
 
 
 
Card 2.  This card is required. 
LC_PSTAT 
 
 
 
 
 
 
 

================================================================================
PAGE 213
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_PRESSURE *DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-53 (DUALCESE) 
Card 3.  This card is required. 
SF_PSTAT 
 
 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Include this card when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IWALL 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this outlet boundary. 
EQ.1: Do treat this outlet boundary as an artiﬁcial wall when-
ever ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
Set Card. Card 1b format used when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IWALL 
DIRX 
DIRX 
DIRY 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 214
================================================================================

*DUALCESE *DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_PRESSURE 
5-54 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IWALL 
Artiﬁcial wall ﬂag: 
EQ.0: Do not treat as an artiﬁcial wall if there is ﬂow recircula-
tion at this outlet boundary. 
EQ.1: Do treat this outlet boundary as an artiﬁcial wall when-
ever ﬂow recirculation exists there. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, it is used as the prescribed ﬂow direction.
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable LC_PSTAT
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Remarks 
1 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_PSTAT 
Load curve ID (see *DEFINE_CURVE) to describe the total pres-
sure as a function of time or function ID (see *DEFINE_FUNC-
TION) to give the total pressure as a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time). 
EQ.0: Total pressure is a constant with value SF_PSTAT. 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable SF_PSTAT
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
1.0 
 
 
 
 
 
 
 
 

================================================================================
PAGE 215
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_OUTLET_PRESSURE *DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-55 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
SF_PSTAT 
Scale factor for LC_PSTAT 
Remarks: 
1. 
Consistent boundary values. On each centroid or set of centroids, the variable 
(푃static) that is given a value must be consistent and make the model well-posed 
(meaning be such that the solution of the model exists, is unique, and is physi-
cal).

================================================================================
PAGE 216
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE 
5-56 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE_OPTION 
Available options are: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set boundary values for velocity, 
density, pressure, temperature, and other values in the phase-change multiphase model.  
Boundary values are applied at the centroid of outside elements connected with this 
boundary. 
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET option card should be used when *DUALCESE_-
ELE2D or *DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards:  
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its for-
mat depends on the keyword option.  
2. 
Cards 2 and 3 provide load curve IDs.  
3. 
Cards 4 and 5 provide scale factors.  
 
For each boundary condition to be specified include one set of cards. This input ends at 
the next keyword (“*”) card.  
Card Summary: 
Card 1a.  This card is included for the MSURF keyword option.  
MSPID 
 
DIRX 
DIRY 
DIRZ 
 
 
 
Card 1b.  This card is included for the SEGMENT_SET keyword option.  
SSID 
 
DIRX 
DIRY 
DIRZ 
 
 
 
Card 2.  This card is required. 
LCIDU 
LCIDV 
LCIDW 
LCIDRHO 
LCIDP 
LCIDT 
LCIDY1 
LCIDY2 

================================================================================
PAGE 217
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-57 (DUALCESE) 
Card 3.  This card is required. 
LCIDY3 
 
 
 
 
 
 
 
Card 4.  This card is required. 
SFU 
SFV 
SFW 
SFRHO 
SFP 
SFT 
SFY1 
SFY2 
Card 5.  This card is required. 
SFY3 
 
 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card.  Card 1 used when the MSURF keyword option is active.  
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
 
F 
F 
F 
 
 
 
Default 
none 
 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
DIRX, DIRY, 
DIRZ 
If nonzero, vector giving the prescribed ﬂow direction 
 
Set Card.  Card 1 used when the SEGMENT_SET keyword option is active.   
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
 
F 
F 
F 
 
 
 
Default 
none 
 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 218
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE 
5-58 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID for the segment set created with *DUALCESE_-
SEGMENTSET 
DIRX, DIRY, 
DIRZ 
If nonzero, vector giving the prescribed ﬂow direction 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LCIDU 
LCIDV 
LCIDW 
LCIDRHO
LCIDP 
LCIDT 
LCIDY1 
LCIDY2 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
0 
0 
0 
0 
0 
0 
0 
0 
Remarks 
1 
1 
1 
1 
1 
1 
1 
1 
 
 VARIABLE  
 
DESCRIPTION 
LCIDU 
Load curve or deﬁned function ID to describe the 푥푥-component of 
the velocity as a function of time or a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The 푥-component of velocity is a constant with value 
SFU. 
EQ.-1: The 푥-component of velocity is computed by the solver. 
LCIDV 
Load curve or deﬁned function ID to describe the 푦푦-component of 
the velocity as a function of time or a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The 푦-component of velocity is a constant with value 
SFV. 
EQ.-1: The 푦-component of velocity is computed by the solver.
LCIDW 
Load curve or deﬁned function ID to describe the 푧푧-component of 
the velocity as a function of time or a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 

================================================================================
PAGE 219
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-59 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
EQ.0: The 푧-component of velocity is a constant with value 
SFW. 
EQ.-1: The 푧-component of velocity is computed by the solver. 
LCIDRHO 
Load curve or deﬁned function ID to describe the mixture density 
as a function of time or a function of position, velocity, tempera-
ture, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), re-
spectively. 
EQ.0: The density is a constant with value SFRHO. 
EQ.-1: The density is computed by the solver. 
LCIDP 
Load curve or deﬁned function ID to describe the pressure as a 
function of time or a function of position, velocity, temperature, 
pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), respec-
tively. 
EQ.0: The pressure is a constant with value SFP. 
EQ.-1: The pressure is computed by the solver. 
LCIDT 
Load curve or deﬁned function ID to describe the temperature as a 
function of time or a function of position, velocity, temperature, 
pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), respec-
tively. 
EQ.0: The temperature is a constant with value SFT. 
EQ.-1: The temperature is computed by the solver. 
LCIDY1 
Load curve or deﬁned function ID to describe the mass fraction of 
material 1 as a function of time or a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The mass fraction is a constant with value SFY1. 
EQ.-1: The mass fraction is computed by the solver. 
LCIDY2 
Load curve or deﬁned function ID to describe the mass fraction of 
material 2 as a function of time or a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The mass fraction is a constant with value SFY2. 
EQ.-1: The mass fraction is computed by the solver. 

================================================================================
PAGE 220
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE 
5-60 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LCIDY3 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
Remarks 
1 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LCIDY3 
Load curve or deﬁned function ID to describe the mass fraction of 
material 3 as a function of time or a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The mass fraction is a constant with value SFY3. 
EQ.-1: The mass fraction is computed by the solver. 
 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SFU 
SFV 
SFW 
SFRHO 
SFP 
SFT 
SFY1 
SFY2 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
 
 VARIABLE  
 
DESCRIPTION 
SFU 
Scale factor for LCIDU 
SFV 
Scale factor for LCIDV 
SFW 
Scale factor for LCIDW 
SFRHO 
Scale factor for LCIDRHO 
SFP 
Scale factor for LCIDP 

================================================================================
PAGE 221
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_PHASE_CHANGE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-61 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
SFT 
Scale factor for LCIDT 
SFY1 
Scale factor for LCIDY1 
SFY2 
Scale factor for LCIDY2 
 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SFY3 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
1.0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SFY3 
Scale factor for LCIDY3 
Remarks: 
1. 
Consistent Boundary Values. On each centroid or set of element centroids, the 
variables (푣푥, 푣푦, 푣푧, 휌, 푃, 푇, … ) that are given values must be consistent and 
make the model well-posed (meaning be such that the solution of the model ex-
ists, is unique, and is physical).

================================================================================
PAGE 222
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE 
5-62 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set boundary values for velocity, 
density, pressure, temperature, and other values in the two-phase multiphase model.  
Boundary values are applied at the centroid of elements connected with this boundary.  
OPTION = SEGMENT_SET is for user deﬁned meshes whereas OPTION = MSURF is as-
sociated with the automatic volume mesher (See *MESH keywords).  
 
That is, the MSURF option is used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET card is used when *DUALCESE_ELE2D or *DUAL-
CESE_ELE3D cards are used to deﬁne the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 provides load curve IDs. 
3. 
Card 3 provides scale factors. 
For each boundary condition to be speciﬁed include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  This card is included if the keyword option is set to MSURF. 
MSPID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Card 1b.  This card is included if the keyword option is set to SSID. 
SSID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Card 2.  This card is required. 
LC_Z1 
LC_U 
LC_V 
LC_W 
LC_D1 
LC_D2 
LC_P 
LC_T 

================================================================================
PAGE 223
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-63 (DUALCESE) 
Card 3.  This card is required. 
SF_Z1 
SF_U 
SF_V 
SF_W 
SF_D1 
SF_D2 
SF_P 
SF_T 
Data Card Deﬁnitions: 
Surface Part Set Card. Card 1 format used when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
0.0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, the chemical mixture of the ﬂuid entering the domain is de-
ﬁned with a *CHEMISTRY_COMPOSITION card with this ID [Not 
yet available]. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, then it is used as the prescribed ﬂow di-
rection. 
 
Segment Set Card. Card 1 format used when the SEGMENT_SET keyword option is 
active.  
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IDCOMP 
DIRX 
DIRY 
DIRZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
0.0 
0.0 
0.0 
 
 
 
 

================================================================================
PAGE 224
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE 
5-64 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, the chemical mixture of the ﬂuid entering the domain is de-
ﬁned with a *CHEMISTRY_COMPOSITION card with this ID [Not 
yet available]. 
DIRX, DIRY, 
DIRZ 
If this vector is nonzero, then it is used as the prescribed ﬂow di-
rection. 
 
Load Curve Card.  See Remark 1. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_Z1 
LC_U 
LC_V 
LC_W 
LC_D1 
LC_D2 
LC_P 
LC_T 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
 
 VARIABLE  
 
DESCRIPTION 
LC_Z1 
Load curve or deﬁned function ID to describe the volume fraction 
of material 1 as a function of time or a function of position, velocity, 
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The volume fraction is a constant with value SF_Z1.  
EQ.-1: The volume fraction is computed by the solver. 
LC_U 
Load curve or deﬁned function ID to describe the 푥-component of 
the velocity as a function of time or a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The 푥-component of velocity is a constant with value SF_-
U.  
EQ.-1: The 푥-component of velocity is computed by the solver.
LC_V 
Load curve or deﬁned function ID to describe the 푦-component of 
the velocity as a function of time or a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 

================================================================================
PAGE 225
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-65 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
EQ.0: The 푦-component of velocity is a constant with value SF_-
V.  
EQ.-1: The 푦-component of velocity is computed by the solver.
LC_W 
Load curve or deﬁned function ID to describe the 푧-component of 
the velocity as a function of time or a function of position, velocity,
temperature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, 
time), respectively. 
EQ.0: The 푧-component of velocity is a constant with value SF_-
W.  
EQ.-1: The 푧-component of velocity is computed by the solver. 
LC_D1 
Load curve or deﬁned function ID to describe the density of mate-
rial 1 as a function of time or a function of position, velocity, tem-
perature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), 
respectively. 
EQ.0: The density is a constant with value SF_D1.  
EQ.-1: The density is computed by the solver. 
LC_D2 
Load curve or deﬁned function ID to describe the density of mate-
rial 2 as a function of time or a function of position, velocity, tem-
perature, pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), 
respectively. 
EQ.0: The density is a constant with value SF_D2.  
EQ.-1: The density is computed by the solver. 
LC_P 
Load curve or deﬁned function ID to describe the pressure as a 
function of time or a function of position, velocity, temperature, 
pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), respec-
tively. 
EQ.0: The pressure is a constant with value SF_P.  
EQ.-1: The pressure is computed by the solver. 
LC_T 
Load curve or deﬁned function ID to describe the temperature as a 
function of time or a function of position, velocity, temperature, 
pressure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), respec-
tively. 
EQ.0: The temperature is a constant with value SF_T.  

================================================================================
PAGE 226
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_TWO-PHASE 
5-66 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.-1: The temperature is computed by the solver. 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_Z1 
SF_U 
SF_V 
SF_W 
SF_D1 
SF_D2 
SF_P 
SF_T 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
 
 VARIABLE  
 
DESCRIPTION 
SF_Z 
Scale factor for LC_Z1  
SF_U 
Scale factor for LC_U  
SF_V 
Scale factor for LC_V  
SF_W 
Scale factor for LC_W  
SF_D1 
Scale factor for LC_D1  
SF_D2 
Scale factor for LC_D2  
SF_P 
Scale factor for LC_P  
SF_T 
Scale factor for LC_T  
Remark: 
1. 
Consistent Boundary Values. On each centroid or set of element centroids, the 
variables (푣푥, 푣푦, 푣푧, 휌, 푃, 푇, …) that are given values must be consistent and make 
the model well-posed (meaning be such that the solution of the model exists, is 
unique, and is physical).

================================================================================
PAGE 227
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_VN 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-67 (DUALCESE) 
*DUALCESE_BOUNDARY_PRESCRIBED_VN_OPTION 
Available options include: 
MSURF 
SEGMENT_SET 
Purpose:  For the dual CESE compressible ﬂow solver, set boundary values for the normal 
velocity, density, pressure and temperature.  Boundary values are applied at the centroid 
of elements connected with this boundary.  This boundary condition diﬀers from *DU-
ALCESE_BOUNDARY_PRESCRIBED in that the normal velocity is prescribed instead of 
each velocity component. 
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET option should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the object to which the boundary condition is applied.  Its format 
depends on the keyword option. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each boundary condition to be speciﬁed include one set of cards.  This input ends at 
the next keyword (“*”) card. 
Card Summary: 
Card 1a.  This card is included if the MSURF keyword option is used. 
MSPID 
IDCOMP 
 
 
 
 
 
 
Card 1b.  This card is included if the SEGMENT_SET keyword option is used. 
SSID 
IDCOMP 
 
 
 
 
 
 
Card 2.  This card is required. 
LC_VN 
 
 
LC_RHO 
LC_P 
LC_T 
 
 

================================================================================
PAGE 228
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_VN 
5-68 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Card 3.  This card is required. 
SF_VN 
 
 
SF_RHO 
SF_P 
SF_T 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format used when the MSURF keyword option is active. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
IDCOMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, the chemical mixture of the ﬂuid entering the domain is de-
ﬁned with a *CHEMISTRY_COMPOSITION card with this ID [Not 
yet available]. 
 
Set Card. Card 1 format used when the SEGMENT_SET keyword option is active. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
IDCOMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID for the segment set created with *DUALCESE_SEGMENTSET 

================================================================================
PAGE 229
================================================================================

*DUALCESE_BOUNDARY_PRESCRIBED_VN 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-69 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
IDCOMP 
For inﬂow boundaries in problems involving chemical reacting 
ﬂows, the chemical mixture of the ﬂuid entering the domain is de-
ﬁned with a *CHEMISTRY_COMPOSITION card with this ID [Not 
yet available]. 
 
Load Curve Card.  See Remark 1. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_VN 
 
 
LC_RHO 
LC_P 
LC_T 
 
 
Type 
I 
 
 
I 
I 
I 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_VN 
Load curve or function ID to describe the normal velocity as a func-
tion of time or a function of position, velocity, temperature, pres-
sure, and time, f(x, y, z, vx, vy, vz, temp, pres, time), respectively.
EQ.0: The normal velocity is a constant with value SF_VN.  
EQ.-1: The normal velocity is computed by the solver. 
LC_RHO 
Load curve ID to describe the density as a function of time or a 
function of position, velocity, temperature, pressure, and time, f(x, 
y, z, vx, vy, vz, temp, pres, time), respectively. 
EQ.0: The density is a constant with value SF_RHO.  
EQ.-1: The density is computed by the solver. 
LC_P 
Load curve ID to describe the pressure as a function of time or a
function of position, velocity, temperature, pressure, and time, f(x, 
y, z, vx, vy, vz, temp, pres, time), respectively. 
EQ.0: The pressure is a constant with value SF_P.  
EQ.-1: The pressure is computed by the solver. 
LC_T 
Load curve ID to describe the temperature as a function of time or
a function of position, velocity, temperature, pressure, and time,
f(x, y, z, vx, vy, vz, temp, pres, time), respectively. 
EQ.0: The temperature is a constant with value SF_T.  
EQ.-1: The temperature is computed by the solver. 

================================================================================
PAGE 230
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_PRESCRIBED_VN 
5-70 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 
Scale Factor Card. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_VN 
 
 
SF_RHO 
SF_P 
SF_T 
 
 
Type 
F 
 
 
F 
F 
F 
 
 
Default 
1.0 
 
 
1.0 
1.0 
1.0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_VN 
Scale factor for LC_VN  
SF_RHO 
Scale factor for LC_RHO  
SF_P 
Scale factor for LC_P  
SF_T 
Scale factor for LC_T  
Remarks: 
1. 
Consistent Boundary Values. On each centroid or set of centroids, the varia-
bles ( 푉푁, 휌, 푃, 푇) that are given values must be consistent and make the model 
well-posed (meaning be such that the solution of the model exists, is unique, and 
is physical).

================================================================================
PAGE 231
================================================================================

*DUALCESE_BOUNDARY_REFLECTIVE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-71 (DUALCESE) 
*DUALCESE_BOUNDARY_REFLECTIVE_OPTION 
Available options are: 
MSURF 
SEGMENT_SET 
Purpose: Deﬁne a reﬂective boundary condition for the dual CESE compressible ﬂow 
solver.  This boundary condition can be applied on a symmetrical surface or a solid wall 
of the computational domain. 
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET option should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh. 
Card Summary: 
Card 1a.  This card is included for the MSURF keyword option.  Provide as many cards 
as necessary.  This input ends at the next keyword (“*”) card. 
MSPID 
 
 
 
 
 
 
 
Card 1b.  This card is included for the SEGMENT_SET keyword option.  Provide as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
SSID 
 
 
 
 
 
 
 
Data Card Deﬁnitions: 
Surface Part Card. Card 1 format used when the MSURF keyword option is active. 
Provide as many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 

================================================================================
PAGE 232
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_REFLECTIVE 
5-72 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
 
Set Card. Card 1 format used when the SEGMENT_SET keyword option is active. 
Provide as many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment set ID for the segment set created with *DUALCESE_-
SEGMENTSET 
Remarks: 
This boundary condition has the same eﬀect as a solid wall boundary condition for invis-
cid ﬂows.

================================================================================
PAGE 233
================================================================================

*DUALCESE_BOUNDARY_SOLID_WALL 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-73 (DUALCESE) 
*DUALCESE_BOUNDARY_SOLID_WALL_OPTION1_{OPTION2} 
For OPTION1 the choices are: 
MSURF 
SEGMENT_SET 
For OPTION2 the choices are: 
<BLANK> 
ROTATE 
Purpose: Deﬁne a solid wall boundary condition for the dual CESE compressible ﬂow 
solver.  This boundary condition can be applied at a solid boundary that is the physical 
boundary for the ﬂow ﬁeld.  For inviscid ﬂow, this will be a slip boundary condition; 
while for viscous ﬂows, it is a no-slip boundary condition. 
 
The MSURF option should be used when the dual CESE mesh has been created using 
*MESH cards.  The SEGMENT_SET option should be used when *DUALCESE_ELE2D or 
*DUALCESE_ELE3D cards specify the dual CESE mesh.  The ROTATE keyword option 
allows the boundary condition to rotate around an axis with a variable speed given by a 
load curve. 
Card Summary: 
Card Sets.  The following sequence of cards comprises a single set.  LS-DYNA will con-
tinue reading data card sets until the next keyword (“*”) card is encountered. 
Card 1a.  This card is included for the MSURF keyword option without the ROTATE 
keyword option. 
MSPID 
LCID 
VX 
VY 
VZ 
 
 
 
Card 1b.  This card is included for the MSURF keyword option with the ROTATE key-
word option. 
MSPID 
LCID 
XP 
YP 
ZP 
NX 
NY 
NZ 
Card 1c.  This card is included for the SEGMENT_SET keyword option without the RO-
TATE keyword option. 
SSID 
LCID 
VX 
VY 
VZ 
 
 
 

================================================================================
PAGE 234
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_SOLID_WALL 
5-74 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Card 1d.  This card is included for the SEGMENT_SET keyword option with the RO-
TATE keyword option. 
SSID 
LCID 
XP 
YP 
ZP 
NX 
NY 
NZ 
Data Card Deﬁnitions: 
Surface Part Card without Rotation.  Card 1 format used when the MSURF keyword 
option is active without the ROTATE keyword option 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
LCID 
VX 
VY 
VZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
Remarks 
 
2 
2 
2 
2 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
LCID 
Load curve ID scales the velocity vector speciﬁed with 
(VX, VY, VZ) to give the solid wall boundary movement.  If not 
deﬁned, the solid wall boundary moves with a constant velocity 
vector speciﬁed by (VX, VY, VZ). 
VX, VY, VZ 
Velocity vector of the solid wall boundary condition: 
LCID.EQ.0: Constant velocity vector speciﬁed with VX, VY, and 
VZ. 
LCID.NE.0: VX, VY, and VZ give the velocity vector that is 
scaled by LCID. 
 

================================================================================
PAGE 235
================================================================================

*DUALCESE_BOUNDARY_SOLID_WALL 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-75 (DUALCESE) 
Surface Part Card with Rotation.  Card 1 format used when the MSURF keyword 
option is active with the ROTATE keyword option.  
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSPID 
LCID 
XP 
YP 
ZP 
NX 
NY 
NZ 
Type 
I 
I 
F 
F 
F 
F 
F 
F 
Default 
none 
0 
0.0 
0.0 
0.0 
0.0 
0.0 
0.0 
 
 VARIABLE  
 
DESCRIPTION 
MSPID 
Mesh surface part ID that is referenced by *MESH_SURFACE_EL-
EMENT cards 
LCID 
Load curve ID for specifying the rotating speed frequency in Hz. 
This input is required. 
XP, YP, ZP 
Coordinates for a point on the axis of rotation 
NX, NY, NZ 
Unit vector for specifying the direction of the axis of rotation.  This 
is not used for the 2D case. 
 
Segment Set Card without Rotation.  Card 1 format used when the SEGMENT_SET 
keyword option is active without the ROTATE keyword option 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
LCID 
VX 
VY 
VZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0.0 
0.0 
0.0 
 
 
 
Remarks 
 
2 
2 
2 
2 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID of the segment set created with *DUALCESE_SEGMENTSET 

================================================================================
PAGE 236
================================================================================

*DUALCESE 
*DUALCESE_BOUNDARY_SOLID_WALL 
5-76 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
LCID 
Load curve ID scales the velocity vector speciﬁed with 
(VX, VY, VZ) to give the solid wall boundary movement.  If not 
deﬁned, the solid wall boundary moves with a constant velocity 
vector speciﬁed by (VX, VY, VZ). 
VX, VY, VZ 
Velocity vector of the solid wall boundary condition: 
LCID.EQ.0: Constant velocity vector speciﬁed with VX, VY, and 
VZ. 
LCID.NE.0: VX, VY, and VZ give the velocity vector that is 
scaled by LCID. 
 
Segment Set Card with Rotation.  Card 1 format used when the SEGMENT_SET 
keyword option is active with the ROTATE keyword option.  
 Card 1d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
LCID 
XP 
YP 
ZP 
NX 
NY 
NZ 
Type 
I 
I 
F 
F 
F 
F 
F 
F 
Default 
none 
0 
0.0 
0.0 
0.0 
0.0 
0.0 
0.0 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID of the segment set created with *DUALCESE_SEGMENTSET 
LCID 
Load curve ID for specifying the rotating speed frequency in Hz. 
This input is required. 
XP, YP, ZP 
Coordinates for a point on the axis of rotation 
NX, NY, NZ 
Unit vector for specifying the direction of the axis of rotation.  This 
is not used for the 2D case. 
Remarks: 
1. 
Boundary Movement Restrictions. In this solid-wall condition, the boundary 
movement can only be in the tangential direction of the wall and should not 
aﬀect the ﬂuid domain size and mesh during the calculation. Otherwise an FSI 

================================================================================
PAGE 237
================================================================================

*DUALCESE_BOUNDARY_SOLID_WALL 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-77 (DUALCESE) 
or moving mesh solver should be used.  Also, this moving boundary condition 
only aﬀects viscous ﬂows (no-slip boundary condition). 
2. 
Fixed Solid Wall Boundary Condition. If LCID = 0 and Vx = Vy = Vz = 0.0 (de-
fault), this will be a regular solid wall boundary condition.

================================================================================
PAGE 238
================================================================================

*DUALCESE 
*DUALCESE_CONTROL_LIMITER 
5-78 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_CONTROL_LIMITER 
Purpose: Sets some stability parameters used in the dual CESE compressible ﬂow solver 
on the current dual CESE model. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IDLMT 
ALPHA 
BETA 
EPSR 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
0 
0.0 
0.0 
0.0 
 
 
 
 
Remarks 
 
1 
2 
3 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
IDLMT 
Set the stability limiter option (see dual CESE theory manual): 
EQ.0: Limiter format 1 (re-weighting) 
EQ.1: Limiter format 2 (relaxing) 
ALPHA 
Re-weighting coeﬃcient, 훼 (see dual CESE theory manual).  Must 
be ≥ 0. 
BETA 
Numerical viscosity control coeﬃcient, 훽 (see dual CESE theory 
manual). 0 ≤훽≤1. 
EPSR 
Stability control coeﬃcient, 휀 (see dual CESE theory manual).  Must 
be ≥ 0. 
Remarks: 
1. 
Re-weighting Coefﬁcient.  Larger values of 훼 give more stability, but less ac-
curacy.  Usually 훼 = 2.0 or 4.0 will be enough for normal shock problems. 
2. 
Numerical Viscosity Control Coefﬁcient. Larger values of 훽 give more stabil-
ity.  For problems with shock waves, 훽 = 1.0 is recommended. 
3. 
Stability Control Coefﬁcient. Larger values of 휀 give more stability, but less 
accuracy.

================================================================================
PAGE 239
================================================================================

*DUALCESE_CONTROL_MESH_MOV 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-79 (DUALCESE) 
*DUALCESE_CONTROL_MESH_MOV 
Purpose:  Specify the algorithm for calculating the mesh movement (morphing) of a given 
DUALCESE part in an FSI problem.  This keyword is for the moving mesh version of 
dual CESE.   
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
IALG 
NINTER 
RELERR 
MXDISPR
 
 
 
Type 
I 
I 
I 
F 
F 
 
 
 
Default 
none 
9 
100 
10-3 
10-2 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ID 
ID for this mesh motion algorithm 
IALG 
Mesh motion algorithm: 
EQ.9: IDW scheme (default) 
NITER 
Number of linear solver iterations (when using a linear solver spec-
iﬁed in IALG).  No linear solvers have been implemented at this 
time, so this ﬁeld is ignored. 
RELERR 
Relative error for determining convergence when using a linear 
solver speciﬁed in IALG. No linear solvers have been implemented 
at this time, so this ﬁeld is ignored. 
MXDISPR 
Maximum displacement relative to element size to use as a crite-
rion for avoiding the full calculation of the motion of the DUAL-
CESE part on a given time step.  If the full calculation can be 
avoided, the elements touching an FSI interface are still morphed, 
but it is assumed that this approximation will not lead to elements 
that are overly distorted. 

================================================================================
PAGE 240
================================================================================

*DUALCESE 
*DUALCESE_CONTROL_SOLVER 
5-80 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_CONTROL_SOLVER 
Purpose:  Set general purpose control variables for the dual CESE compressible ﬂow 
solver. 
WARNING: As of version R14, this keyword is deprecated.  Instead, 
in order to select the appropriate equations to solve, 
you should use *DUALCESE_SOLVER_SELECTION 
along 
with 
the 
corresponding 
*DUALCESE_-
SOLVER_... card.  Also, instead of this card, use *DU-
ALCESE_MESH_GEOM for the geometry-related 
details. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EQNS 
IGEOM 
IFRAME 
MIXTYPE 
IDC 
ISNAN 
 
 
Type 
A 
A 
A 
A 
F 
I 
 
 
Default 
EULER
none 
FIXED 
optional
0.25 
0 
 
 
Remarks 
 
1 
 
 
2 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EQNS 
Select the equations being solved with the dual CESE solver: 
EQ.NS: 
Navier-Stokes equations 
EQ.EULER: Euler equations 
IGEOM 
Sets the geometric dimension: 
EQ.2D: Two-dimensional (2D) problem 
EQ.3D: Three-dimensional (3D) problem 
EQ.AXI: 2D axisymmetric 
IFRAME 
Choose the frame of reference: 
EQ.FIXED: Usual non-moving reference frame (default). 
EQ.ROT: 
Non-inertial rotating reference frame.  IFRAME = 
ROTATING may also be used. 

================================================================================
PAGE 241
================================================================================

*DUALCESE_CONTROL_SOLVER 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-81 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
MIXTYPE 
Select the mix or multiphase model solver (if any): 
EQ.<blank>: 
No mix or multiphase model (default) 
EQ.HYBRID: 
Hybrid multiphase model solver 
EQ.TWO-PHASE: Two-phase multiphase solver 
IDC 
Contact interaction detection coeﬃcient (for FSI problems) 
ISNAN 
Flag to check for NaN in the dual CESE solver solution arrays at
the completion of each time step.  This option can be useful for de-
bugging purposes.  There is a cost overhead when this option is 
active. 
EQ.0: No checking. 
EQ.1: Checking is active. 
Remarks: 
1. 
Mesh and Boundary Conditions for 2D Problems. If you want to use the 2D 
(IGEOM = 2D) or 2D axisymmetric (IGEOM=AXI) solver, the mesh should only 
be distributed in the 푥푦-plane with the boundary conditions given only at the 푥푦 
domain boundaries.  Otherwise, a warning message will be given, and the 3D 
solver will be triggered instead. 
The 2D axisymmetric case will work only if the 2D mesh and corresponding 
boundary conditions are properly deﬁned with the 푥 and 푦 coordinates corre-
sponding to the radial and axial directions, respectively. 
2. 
Contact Interaction Detection Coefﬁcient. IDC is the same type of variable 
that is input on the *ICFD_CONTROL_FSI card.  For an explanation, see Remark 
1 for the *ICFD_CONTROL_FSI card. 
3. 
Dual CESE Solver and Restarts. The dual CESE solver is not currently sup-
ported for restarts.

================================================================================
PAGE 242
================================================================================

*DUALCESE 
*DUALCESE_CONTROL_TIMESTEP 
5-82 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_CONTROL_TIMESTEP 
Purpose:  Sets the time step control parameters for the CESE compressible ﬂow solver.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IDDT 
CFL 
DTINT 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
0 
0.9 
10-3 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
IDDT 
Sets the time step option: 
EQ.0: Fixed time step size of DTINT, the given initial time step 
size 
NE.0: The time step size will be calculated based on the given 
CFL-number and the ﬂow solution at the previous time 
step. 
CFL 
CFL number (Courant–Friedrichs–Lewy condition). 0.0 < CFL ≤
1.0 
DTINT 
Initial time step size 

================================================================================
PAGE 243
================================================================================

*DUALCESE_DARCY-FORCHHEIMER_EQ 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-83 (DUALCESE) 
*DUALCESE_DARCY-FORCHHEIMER_EQ 
Purpose: Provide the parameters of the Darcy-Forchheimer equation.  This equation is 
also called the Forchheimer correction of Darcy’s Law.  This equation models the porous 
medium for compressible porous media ﬂows, such as supersonic spacecraft parachute 
ﬂows.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EQID 
KP 
BETA 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EQID 
Equation ID of the porous medium model (see *DUALCESE_PO-
ROUS_SPECIFY_JUMP) 
KP 
Permeability of the porous medium, 푘p. See Remark 1.
BETA 
Inertial resistance coeﬃcient of the porous medium, 훽. See Remark 
1. 
Remarks: 
1. 
Darcy-Forchheimer equation. The Darcy-Forchheimer equation is given by: 
휕푃
휕푛= 휇f
푘p
푣푛+ 훽휌f푣푛 
where 
휕푃
휕푛 
Pressure gradient (in the normal direction) across the porous me-
dium 
휌f 
Fluid density 
휇f 
Fluid dynamic viscosity 
푣푛 
Wall normal velocity of the ﬂow through the porous medium 
푘푝 
Permeablity of the porous media 
훽 
Inertial resistance coeﬃcient 

================================================================================
PAGE 244
================================================================================

*DUALCESE 
*DUALCESE_DARCY-FORCHHEIMER_EQ 
5-84 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
2. 
Restrictions for the structure. The porous media model can only be used in 
FSI  problems with thin shell structures (such as fabric).  It is intended for mod-
eling supersonic spacecraft parachutes and airbags.  
3. 
Porous media model. Currently, only a jump condition method is available for 
modeling porous media ﬂow.

================================================================================
PAGE 245
================================================================================

*DUALCESE_DATABASE_HISTORY_DRAG_LIFT 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-85 (DUALCESE) 
*DUALCESE_DATABASE_HISTORY_DRAG_LIFT 
Purpose:  Enable output of drag and lift-related data for all pieces of structural parts par-
ticipating in FSI with the dual CESE immersed boundary method (IBM).  This data output 
goes to binary database binout. At most, one instance of this keyword may appear in the 
input deck. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
LCUR 
IOOPT 
REFDENS
REFVEL REFPRESS REFAREA
REFLENG
Type 
F 
I 
I 
F 
F 
F 
F 
F 
Default 
0.0 
0 
0 
none 
none 
none 
none 
none 
 
Directions Card.   
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable DRAGDIRX DRAGDIRY DRAGDIRZ LIFTDIRX
LIFTDIRY
LIFTDIRZ
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
1.0 
0.0 
0.0 
0.0 
1.0 
0.0 
 
 
 
Moment Options Card.   
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DRGAREA MOMNTD
MOMNTL
MOMNTC
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
0 
0 
0 
0 
 
 
 
 
 

================================================================================
PAGE 246
================================================================================

*DUALCESE 
*DUALCESE_DATABASE_HISTORY_DRAG_LIFT 
5-86 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated.  DT is ignored if LCUR > 0. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve.  The abscissa is time, 
and the ordinate is the time interval between outputs. 
IOOPT 
Flag to govern the behavior of the output frequency load curve de-
ﬁned by LCUR: 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 
REFDENS 
An appropriate reference density 
REFVEL 
An appropriate reference velocity 
REFPRESS 
An appropriate reference pressure 
REFAREA 
An appropriate reference area 
REFLENG 
An appropriate reference length 
DRAGDIRX 
푥-component of the drag direction 
DRAGDIRY 
푦-component of the drag direction 
DRAGDIRZ 
푧-component of the drag direction 
LIFTDIRX 
푥-component of the lift direction 
LIFTDIRY 
푦-component of the lift direction 
LIFTDIRZ 
푧-component of the lift direction 

================================================================================
PAGE 247
================================================================================

*DUALCESE_DATABASE_HISTORY_DRAG_LIFT 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-87 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
DRGAREA 
Flag specifying how to obtain the drag area needed for ﬁnding the 
drag-related coeﬃcients: 
EQ.0: Use REFAREA in all the calculations requiring an enclos-
ing surface area 
NE.0: Use LS-DYNA’s dynamic calculation of the surface area of 
each piece/part to compute the various drag-related coef-
ﬁcients.  REFAREA scales the computed surface area be-
fore being used to calculate the drag-related coeﬃcients. 
MOMNTD 
Flag determining whether to compute the torque in the drag direc-
tion: 
EQ.0: Do not compute the torque. 
NE.0: Compute the torque. 
MOMNTL 
Flag determining whether to compute the torque in the lift direc-
tion: 
EQ.0: Do not compute the torque. 
NE.0: Compute the torque. 
MOMNTC 
Flag determining whether to compute the torque in the direction
that is the cross product of the drag and lift directions: 
EQ.0: Do not compute the torque. 
NE.0: Compute the torque. 

================================================================================
PAGE 248
================================================================================

*DUALCESE 
*DUALCESE_DATABASE_HISTORY_ELEMENT_SET 
5-88 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_DATABASE_HISTORY_ELEMENT_SET 
Purpose:  Enable output of dual CESE solver data at the element centroids of the selected 
dual CESE mesh elements.  This element output goes to binary database binout. At most, 
one instance of this keyword may appear in the input deck. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ESID 
DT 
LCUR 
IOOPT 
 
 
 
 
Type 
I 
F 
I 
I 
 
 
 
 
Default 
0 
0. 
0 
0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ESID 
ID of a dual CESE element set (see *DUALCESE_ELEMENTSET) 
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve.  The abscissa is time, 
and the ordinate is time interval between outputs. 
IOOPT 
Flag to govern behavior of the output frequency load curve deﬁned 
by LCUR: 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 

================================================================================
PAGE 249
================================================================================

*DUALCESE_DATABASE_HISTORY_GLOBALS 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-89 (DUALCESE) 
*DUALCESE_DATABASE_HISTORY_GLOBALS 
Purpose:  Enable output of global dual CESE solver data.  The output goes to binary da-
tabase binout. At most, one instance of this keyword may appear in the input deck. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
LCUR 
IOOPT 
 
 
 
 
 
Type 
F 
I 
I 
 
 
 
 
 
Default 
0.0 
0 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve; the abscissa is time, and 
the ordinate is time interval between outputs. 
IOOPT 
Flag to govern behavior of the output frequency load curve deﬁned 
by LCUR: 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 

================================================================================
PAGE 250
================================================================================

*DUALCESE 
*DUALCESE_DATABASE_HISTORY_NODE_SET 
5-90 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_DATABASE_HISTORY_NODE_SET 
Purpose:  Enable output of dual CESE solver data at the selected dual CESE mesh nodes.  
This nodal output goes to binary database binout. At most, one instance of this keyword 
may appear in the input deck. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NSID 
DT 
LCUR 
IOOPT 
 
 
 
 
Type 
I 
F 
I 
I 
 
 
 
 
Default 
0 
0. 
0 
0. 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NSID 
ID of a dual CESE node set (see *DUALCESE_NODESET) 
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve; the abscissa is time, and 
the ordinate is time interval between outputs. 
IOOPT 
Flag to govern behavior of the output frequency load curve deﬁned 
by LCUR: 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 

================================================================================
PAGE 251
================================================================================

*DAULCESE_DATABASE_HISTORY_POINT_SET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-91 (DUALCESE) 
*DUALCESE_DATABASE_HISTORY_POINT_SET 
Purpose:  Enable output of dual CESE solver data at the selected points inside the dual 
CESE mesh.  This point-based output goes to binary database binout. At most, one in-
stance of this keyword may appear in the input deck. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PNTSID 
DT 
LCUR 
IOOPT 
 
 
 
 
Type 
I 
F 
I 
I 
 
 
 
 
Default 
0 
0. 
0 
0. 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PNTSID 
ID of a dual CESE point set (see *DUALCESE_POINTSET)  
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve; the abscissa is time, and 
the  ordinate is time interval between outputs. 
IOOPT 
Flag to govern behavior of the output frequency load curve deﬁned 
by LCUR: 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 

================================================================================
PAGE 252
================================================================================

*DUALCESE 
*DUALCESE_DATABASE_HISTORY_SEGMENT_SET 
5-92 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_DATABASE_HISTORY_SEGMENT_SET 
Purpose:  Enable output of dual CESE solver data averaged on each of the speciﬁed dual 
CESE segment sets.  This segment set-based output goes to binary database binout. At 
most, one instance of this keyword may appear in the input deck. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
LCUR 
IOOPT 
 
 
 
 
 
Type 
F 
I 
I 
 
 
 
 
 
Default 
0.0 
0 
0 
 
 
 
 
 
 
Segment Sets Card.  Deﬁne as many cards as necessary.  Input ends at the next keyword 
(“*”) card.   
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID1 
SSID2 
SSID3 
SSID4 
SSID5 
SSID6 
SSID7 
SSID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
DT 
Time interval between outputs.  If DT is zero, no output is gener-
ated. 
LCUR 
Optional curve ID specifying the time interval between outputs. 
Use *DEFINE_CURVE to deﬁne the curve; the abscissa is time, and 
the ordinate is time interval between outputs. 
IOOPT 
Flag to govern behavior of the output frequency load curve deﬁned 
by LCUR: 

================================================================================
PAGE 253
================================================================================

*DUALCESE_DATABASE_HISTORY_SEGMENT_SET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-93 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛) . 
This is the default behavior. 
EQ.2: When output is generated at time 푡푛, the next output time 
푡푛+1 is computed as 
푡푛+1 = 푡푛+ LCUR(푡푛+1) . 
EQ.3: Output is generated for each abscissa point in the load 
curve deﬁnition.  The actual value of the load curve is ig-
nored. 
SSIDi 
ith dual CESE segment set ID (see *DUALCESE_SEGMENTSET). 
For each of these segment sets, an average value of each dual CESE 
output variable is output to the binout ﬁle at the times selected by 
the ﬁelds in Card 1. 

================================================================================
PAGE 254
================================================================================

*DUALCESE 
*DUALCESE_D3PLOT 
5-94 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_D3PLOT 
Purpose:  Specify the ﬂow variables to be added to the dual CESE d3plot output. 
 
Provide as many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FLOW_VAR 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
FLOW_VAR 
Name of a ﬂow variable to output to the d3plot ﬁle.  The currently 
supported variables are listed in the table below.  
Flow Variables: 
This table lists the supported ﬂow variables. 
 
 FLOW_VAR  
 
DESCRIPTION 
DENSITY 
Density 
VELOCITY 
Velocity 
MOMENTUM 
Momentum 
VORTICITY 
Vorticity 
TOTAL_ENERGY 
Total energy 
INTERNAL_ENERGY 
Internal energy 
PRESSURE 
Pressure 
TEMPERATURE 
Temperature 
MACH_NUMBER 
Flow Mach number 
SCHLIEREN_NUMBER 
Quantity for capturing or highlighting the shock 
structure in a compressible ﬂow 

================================================================================
PAGE 255
================================================================================

*DUALCESE_D3PLOT 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-95 (DUALCESE) 
 FLOW_VAR  
 
DESCRIPTION 
VOID_FRACTION 
Void fraction (only for the dual CESE cavitation 
solver) 
VOLUME_FRACTION 
Volume fraction of the diﬀerent materials in a 
hybrid or two-phase multiphase model 
REACTANT_MASS_FRAC-
TION 
Mass fraction of the reactant (material 훼) with re-
spect to the explosive material (material 2) in a 
hybrid multiphase model 
LIQUID_MASS_FRACTION 
Mass fraction of the liquid component of the 
ﬂuid in the phase change model 
VAPOR_MASS_FRACTION 
Mass fraction of the vapor component of the 
ﬂuid in the phase change model 
OTHER_GASES_MASS_FRAC-
TION 
Mass fraction of the other gases in the ﬂuid in 
the phase change model 

================================================================================
PAGE 256
================================================================================

*DUALCESE 
*DUALCESE_D3PLOT_FLUID_SSID 
5-96 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_D3PLOT_FLUID_SSID 
Purpose:  Generate surface d3plot output for the dual CESE solver on a speciﬁed dual 
CESE mesh segment set.  These surfaces may be on the outside of the dual CESE ﬂuid 
mesh that is in contact with the structural volume element parts. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
Type 
I 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
ID of a segment set created with *DUALCESE_SEGMENTSET 
 
Dual CESE variables to output. Provide as many cards as necessary.  This input ends at 
the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FLOW_VAR 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
FLOW_VAR 
Name of a ﬂow variable to output to the d3plot ﬁle.  The currently 
supported variables are listed in the table below.  
Flow Variables: 
This table lists the supported ﬂow variables. 
 
 FLOW_VAR  
 
DESCRIPTION 
DENSITY 
Density 
VELOCITY 
Velocity 
MOMENTUM 
Momentum 

================================================================================
PAGE 257
================================================================================

*DUALCESE_D3PLOT_FLUID_SSID 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-97 (DUALCESE) 
 FLOW_VAR  
 
DESCRIPTION 
VORTICITY 
Vorticity 
TOTAL_ENERGY 
Total energy 
INTERNAL_ENERGY 
Internal energy 
PRESSURE 
Pressure 
TEMPERATURE 
Temperature 
MACH_NUMBER 
Flow Mach number 
SCHLIEREN_NUMBER 
Quantity for capturing or highlighting the shock 
structure in a compressible ﬂow 
VOID_FRACTION 
Void fraction (only for the dual CESE cavitation 
solver) 
VOLUME_FRACTION 
Volume fraction of the diﬀerent materials in a 
hybrid or two-phase multiphase model 
REACTANT_MASS_FRAC-
TION 
Mass fraction of the reactant (material 훼) with re-
spect to the explosive material (material 2) in a 
hybrid multiphase model 

================================================================================
PAGE 258
================================================================================

*DUALCESE 
*DUALCESE_ELE2D 
5-98 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_ELE2D 
Purpose:  Deﬁne three and four node elements. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
EID 
PID 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EID 
Element ID.  Choose a unique number with respect to other ele-
ments. 
PID 
Part ID, see *DUALCESE_MESH_PART. 
N1 
Nodal point 1 
N2 
Nodal point 2 
N3 
Nodal point 3 
N4 
Nodal point 4 

================================================================================
PAGE 259
================================================================================

*DUALCESE_ELE3D 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-99 (DUALCESE) 
*DUALCESE_ELE3D 
Purpose:  Deﬁne three-dimensional ﬂuid volume elements.  These can be 4 node tetrahe-
dra, 5 node pyramids, 6 node wedges (prisms), and 8 node hexahedra. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
EID 
PID 
N1 
N2 
N3 
N4 
N5 
N6 
N7 
N8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
none 
none 
Remarks 
1 
 
 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EID 
Element ID.  A unique number must be chosen. 
PID 
Part ID, see *DUALCESE_MESH_PART. 
N1 
Nodal point 1 
N2 
Nodal point 2 
N3 
Nodal point 3 
⋮
            ⋮ 
N8 
Nodal point 8 
Remarks: 
1. 
Node Numbering.  Four, ﬁve, six, and eight node elements are allowed as num-
bered below.  This ordering must be followed, or code termination will occur 
during the initialization phase with a negative volume message.  In the case of a 
pyramid element, the base of the pyramid must follow the ordering used for the 
hexahedron.  See *ELEMENT_SOLID for a ﬁgure showing the positions of the 
nodes in 4, 6, and 8 node elements. 
4-noded tetrahedron 
N1, N2, N3, N4, N4, N4, N4, N4 
5-noded pyramid 
N1, N2, N3, N4, N5, N5, N5, N5 

================================================================================
PAGE 260
================================================================================

*DUALCESE 
*DUALCESE_ELE3D 
5-100 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
6-noded pentahedron 
N1, N2, N3, N4, N5, N5, N6, N6 
8-noded hexahedron 
N1, N2, N3, N4, N5, N6, N7, N8

================================================================================
PAGE 261
================================================================================

*DUALCESE_ELEMENTSET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-101 (DUALCESE) 
*DUALCESE_ELEMENTSET 
Purpose:  Deﬁne a set of dual CESE mesh elements. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ESID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Element ID Cards. List of elements in the set, where the element IDs are deﬁned with 
*DUALCESE_ELE2D or *DUALCESE_ELE3D cards.  Include as many cards as needed. 
This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EID1 
EID2 
EID3 
EID4 
EID5 
EID6 
EID7 
EID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
 
 VARIABLE  
 
DESCRIPTION 
ESID 
Set ID.  All dual CESE element sets should have a unique set ID. 
EIDi 
Element ID i 

================================================================================
PAGE 262
================================================================================

*DUALCESE 
*DUALCESE_EOS_CAV_HOMOG_EQUILIB 
5-102 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_EOS_CAV_HOMOG_EQUILIB 
Purpose: Deﬁne the coeﬃcients in the equation of state (EOS) for the homogeneous equi-
librium cavitation model. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
RHOVAP 
RHOLIQ 
AVAP 
ALIQ 
MUVAP 
MULIQ 
PSATVAP
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
0.8 
880.0 
334.0 
1386.0 1.435e-5
1.586e-4
1.2e+4 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID 
RHOVAP 
Density of the saturated vapor, 휌vap 
RHOLIQ 
Density of the saturated liquid, 휌liq 
AVAP 
Sound speed of the saturated vapor, 푎vap 
ALIQ 
Sound speed of the saturated liquid, 푎liq 
MUVAP 
Dynamic viscosity of the vapor, 휇vap 
MULIQ 
Dynamic viscosity of the liquid, 휇liq 
PSATVAP 
Pressure of the saturated vapor, 푃SatVap 
Remarks: 
1. 
EOS Validity. In this homogeneous equilibrium cavitation model, a barotropic 
equation of state is used.  This model can be used in small scale and high-speed 
cavitation ﬂows, but it is not good for large-scale, low-speed cavitation calcula-
tions.

================================================================================
PAGE 263
================================================================================

*DUALCESE_EOS_COCHRAN_CHAN 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-103 (DUALCESE) 
*DUALCESE_EOS_COCHRAN_CHAN 
Purpose:  Deﬁne a Cochran-Chan type of EOS that provides a means to represent a con-
densed phase explosive in a dual CESE multiphase model. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
A 
B 
EPS1 
EPS2 
GAMMA0 
RHO0 
E0 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
0.0 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CV 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID for the dual CESE solver 
A 
Model parameter (in pressure units), 퐴 
B 
Model parameter (in pressure units), 퐵 
EPS1 
Model constant (dimensionless), 휀1 
EPS2 
Model constant (dimensionless), 휀2 
GAMMA0 
Gruneisen coeﬃcient 
RHO0 
Initial or reference density, 휌0 
E0 
Represents the heat of detonation released during the reactions, or 
the constant rate of afterburn energy added (E0 = 0.0 is the default), 
푒0 
CV 
Heat capacity, 퐶푣 

================================================================================
PAGE 264
================================================================================

*DUALCESE 
*DUALCESE_EOS_COCHRAN_CHAN 
5-104 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
 
The Cochran-Chan EOS like the JWL EOS (*DUALCESE_EOS_JWL) is a type of Mie-
Gruneisen EOS. The equations of state of a Mie-Gruneisen form are given by: 
푃(ρ, 푒) = 푃ref + Γ(ρ)ρ[푒−푒ref(ρ)] 
Here Γ(휌) is the Gruneisen coeﬃcient.  For the Cochran-Chan EOS reference pressure 
and energy are given by: 
푃ref(휌) = 퐴(휌0
휌)
−휀1
−퐵(휌0
휌)
−휀2
푒ref(휌) =
퐴
휌0(1 −휀1) (휌0
휌)
1−휀1
+
퐵
휌0(1 −휀2) (휌0
휌)
1−휀2
−푒0

================================================================================
PAGE 265
================================================================================

*DUALCESE_EOS_COOLPROP 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-105 (DUALCESE) 
*DUALCESE_EOS_COOLPROP 
Purpose:  Deﬁne an equation of state (EOS) to be evaluated using the COOLPROP EOS 
library 
 
Note that the COOLPROP library is not provided by ANSYS. You need to download a 
64-bit version of the shared library from a public repository, such as: 
https://sourceforge.net/projects/coolprop/ﬁles/CoolProp/6.3.0/shared_li-
brary/Linux/64bit/ 
WARNING: Since the *MODULE capability is not yet working in 
the Windows build of LS-DYNA, do not attempt to use 
a Windows DLL version of the COOLPROP shared li-
brary. 
 
To use the COOLPROP shared library with this keyword card, load this shared library 
into LS-DYNA using the *MODULE capability.  The following *MODULE card needs to 
appear before a *DUALCESE_MODEL card (not inside the ﬁle hierarchy of any ﬁle spec-
iﬁed with a *DUALCESE_MODEL card): 
 
*MODULE_LOAD 
UserA                  DUALCESE COOLPROP 
 < path to installed COOLPROP shared library >  
Card Summary: 
Card 1.  This card is required. 
EOSID 
NCOMP 
TYPE 
PHASE 
TABULAR 
 
 
 
Card 2.  Include as many cards as needed to specify mole fractions for the NCOMP 
components of the ﬂuid. 
MOL_FR1 
MOL_FR2 
MOL_FR3 
MOL_FR4 
MOL_FR5 
MOL_FR6 
MOL_FR7 
MOL_FR8 
Card 3.  Include this card when the TABULAR ﬁeld is active on Card 1. 
N_T 
N_DEN 
DEN_LOW DEN_HIGH 
T_LOW 
T_HIGH 
 
 
Card 4.  This card is required. 
FLUIDNAME 

================================================================================
PAGE 266
================================================================================

*DUALCESE 
*DUALCESE_EOS_COOLPROP 
5-106 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
NCOMP 
TYPE 
PHASE 
TABULAR
 
 
 
Type 
I 
I 
A 
A 
A 
 
 
 
Default 
none 
none 
none 
GAS 
optional
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
ID for this EOS 
NCOMP 
Number of components in the ﬂuid composition 
TYPE 
Fluid type: 
EQ.PURE: 
A single component ﬂuid (default) 
EQ.PSEUDOPURE: A predeﬁned ﬂuid mixture 
EQ.MIXTURE: 
A ﬂuid mixture with NCOMP components
PHASE 
Phase of the ﬂuid. 
EQ.GAS: 
Gas phase 
EQ.LIQUID: Liquid phase 
TABULAR 
Type of lookup tables to build for this EOS: 
EQ.<BLANK>: No table lookup (default)  
EQ.P_EIN: 
Build tables of pressure and internal energy, both 
as a function of density and temperature. 
 
COOLPROP Parameters by Fluid Component. Repeat this card as many times as 
needed to input mole fractions for the NCOMP components of the ﬂuid. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MOL_FR1 MOL_FR2 MOL_FR3 MOL_FR4 MOL_FR5 MOL_FR6 MOL_FR7 MOL_FR8
Type 
F 
F 
F 
F 
F 
F 
F 
F 
 

================================================================================
PAGE 267
================================================================================

*DUALCESE_EOS_COOLPROP 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-107 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
MOL_FRi 
Mole fraction of the ith component  
 
COOLPROP EOS Table Density and Temperature Ranges. This card is included when 
the TABULAR option on Card 1 is active. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N_T 
N_DEN 
DEN_LOW DEN_HIGH
T_LOW 
T_HIGH 
 
 
Type 
I 
I 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
Remarks 
1 
1 
2 
2 
2 
2 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N_T 
Number of temperature values in the tables 
N_DEN 
Number of density values (on a log scale) in the tables 
DEN_LOW 
Minimum density available in the tables (in model units) 
DEN_HIGH 
Maximum density available in the tables (in model units) 
T_LOW 
Minimum temperature available in the tables (in model units) 
T_HIGH 
Maximum temperature available in the tables (in model units) 
 
Name of CoolProp ﬂuid.  This card is required. 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FLUIDNAME 
Type 
A 
 

================================================================================
PAGE 268
================================================================================

*DUALCESE 
*DUALCESE_EOS_COOLPROP 
5-108 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
FLUIDNAME 
Name of a ﬂuid that has an EOS in CoolProp.  For a list of the
supported pure and pseudo-pure ﬂuids, see: 
http://www.coolprop.org/ﬂuid_properties/PurePseudo-
Pure.html#list-of-ﬂuids 
Note that the predeﬁned ﬂuid mixtures are not supported at this
time. 
Remarks: 
1. 
Number of Values in the Lookup Tables. The number of density and temper-
ature values in the tables should not be too few to give good resolution of the 
EOS. Note that the cost of building the EOS from these tables rises with these 
numbers, as well as the computer memory required.  Nevertheless, if these num-
bers are too small (< 20), then the accuracy may suﬀer, while larger numbers of 
density and temperature points improves the accuracy. 
2. 
Valid Value Ranges for the Lookup Tables. For many equations of state in the 
CoolProp library, there is a range of valid densities and temperatures.  Thus, the 
low and high limits for the table densities and temperatures should not lie out-
side these ranges.  Please refer to the CoolProp documentation for that infor-
mation.

================================================================================
PAGE 269
================================================================================

*DUALCESE_EOS_IDEAL_GAS 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-109 (DUALCESE) 
*DUALCESE_EOS_IDEAL_GAS 
Purpose: Deﬁne the coeﬃcients 퐶푣and 퐶푝 in the equation of state for an ideal gas in the 
dual CESE ﬂuid solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
CV 
CP 
E0 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
717.5 
1004.5 
0.0 
 
 
 
 
Remarks 
 
1 
1 
2 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID 
CV 
Speciﬁc heat at constant volume, 퐶푣 
CP 
Speciﬁc heat at constant pressure, 퐶푝 
E0 
Represents the heat of detonation released during the reactions, or 
the constant rate of afterburn energy added (E0 = 0.0 is the default), 
푒0 
Remarks: 
1. 
Units.  As with other solvers in LS-DYNA, you are responsible for unit con-
sistency.  For example, if you want to use dimensionless variables, CV and CP 
should also be replaced by the corresponding dimensionless ones.  If the dual 
CESE model has a speciﬁed system of units either directly from the *DUAL-
CESE_MODEL card or inherited from the overall problem input, then these val-
ues need to be given in that unit system. 
2. 
E0. E0 is used only with the hybrid multiphase solver where the EOS of the re-
actant is speciﬁed by this ideal gas EOS in the *DUALCESE_EOS_SET card.

================================================================================
PAGE 270
================================================================================

*DUALCESE 
*DUALCESE_EOS_INFLATOR1 
5-110 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_EOS_INFLATOR1 
Purpose:  Deﬁne an EOS using 퐶푝 and 퐶푣 thermodynamic expansions for an inﬂator gas 
mixture with a single temperature range. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CP0 
CP1 
CP2 
CP3 
CP4 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CV0 
CV1 
CV2 
CV3 
CV4 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID for the dual CESE solver 
CP0, …, CP4 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
pressure 
퐶푝(푇) = 퐶푝0 + 퐶푝1푇+ 퐶푝2푇2 + 퐶푝3푇3 + 퐶푝4푇4 

================================================================================
PAGE 271
================================================================================

*DUALCESE_EOS_INFLATOR1 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-111 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
CV0, …, CV4 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
volume 
퐶푣(푇) = 퐶푣0 + 퐶푣1푇+ 퐶푣2푇2 + 퐶푣3푇3 + 퐶푣4푇4 
Remarks: 
These coeﬃcient expansions for the speciﬁc heats over the entire temperature range are 
generated by the zero-dimensional inﬂator model solver.  See *CHEMISTRY_CON-
TROL_INFLATOR and *CHEMISTRY_INFLATOR_PROPERTIES for details related to 
running that solver.

================================================================================
PAGE 272
================================================================================

*DUALCESE 
*DUALCESE_EOS_INFLATOR2 
5-112 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_EOS_INFLATOR2 
Purpose:  Deﬁne an EOS using 퐶푝 and 퐶푣 thermodynamic expansions for an inﬂator gas 
mixture with two temperature ranges, one below 1000 Kelvin, and the other above 1000 
Kelvin. 
Card Summary: 
Card 1.  This card is required. 
EOSID 
 
 
 
 
 
 
 
Card 2.  This card is required.  This card with Card 3 speciﬁes 퐶푝. This card gives the 
coeﬃcients for T < 1000 K. 
CP10 
CP11 
CP12 
CP13 
CP14 
 
 
 
Card 3.  This card is required.  This card gives the coeﬃcients for T > 1000 K. 
CP20 
CP21 
CP22 
CP23 
CP24 
 
 
 
Card 4.  This card is required.  This card with Card 5 deﬁnes 퐶푣. This card gives the 
coeﬃcients for T < 1000 K. 
CV10 
CV11 
CV12 
CV13 
CV14 
 
 
 
Card 5.  This card is required.  This card gives the coeﬃcients for T > 1000 K. 
CV20 
CV21 
CV22 
CV23 
CV24 
 
 
 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 

================================================================================
PAGE 273
================================================================================

*DUALCESE_EOS_INFLATOR2 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-113 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID for the dual CESE solver 
 
Coeﬃcients for the expansion to determine speciﬁc heat at constant pressure for T < 1000 
K. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CP10 
CP11 
CP12 
CP13 
CP14 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
Coeﬃcients for the expansion to determine speciﬁc heat at constant pressure for T > 1000 
K. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CP20 
CP21 
CP22 
CP23 
CP24 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CP10, …, 
CP14 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
pressure valid for T < 1000 K 
CP20, …, 
CP24 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
pressure valid for T > 1000 K 
 
Cards 2 and 3 give 퐶푝 over the two temperature ranges: 
퐶푝(푇) = {CP10 + CP11 × 푇+ CP12 × 푇2 + CP13 × 푇3 + CP14 × 푇4   for 푇< 1000 K
CP20 + CP21 × 푇+ CP22 × 푇2 + CP23 × 푇3 + CP24 × 푇4   for 푇> 1000 K 
 

================================================================================
PAGE 274
================================================================================

*DUALCESE 
*DUALCESE_EOS_INFLATOR2 
5-114 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Card for the Expansion of Speciﬁc Heat at Constant Volume. Valid for T < 1000 K 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CV10 
CV11 
CV12 
CV13 
CV14 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
Card for the Expansion of Speciﬁc Heat at Constant Volume. Valid for T > 1000 K 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CV20 
CV21 
CV22 
CV23 
CV24 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0. 
0. 
0. 
0. 
0. 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CV10, …, 
CV14 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
volume valid for T < 1000 K 
CV20, …, 
CV24 
Coeﬃcients of temperature-dependent speciﬁc heat at constant 
volume valid for T > 1000 K 
 
Cards 4 and 5 give 퐶푣 over the two temperature ranges: 
퐶푣(푇) = {CV10 + CV11 × 푇+ CV12 × 푇2 + CV13 × 푇3 + CV14 × 푇4   for 푇< 1000 K
CV20 + CV21 × 푇+ CV22 × 푇2 + CV23 × 푇3 + CV24 × 푇4   for 푇> 1000 K 
Remarks: 
These coeﬃcient expansions for the speciﬁc heats over two temperature ranges are gen-
erated by the zero-dimensional inﬂator model solver.  See *CHEMISTRY_CONTROL_-
INFLATOR and *CHEMISTRY_INFLATOR_PROPERTIES for details related to running 
that solver.

================================================================================
PAGE 275
================================================================================

*DUALCESE_EOS_JWL 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-115 (DUALCESE) 
*DUALCESE_EOS_JWL 
Purpose:  Deﬁne a JWL-type EOS that provides a means to represent a condensed phase 
explosive in a dual CESE multiphase model. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
A 
B 
R1 
R2 
GAMMA0 
RHO0 
E0 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
0.0 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CV 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID for the dual CESE solver. 
A 
Model parameter, 퐴 (in pressure units) 
B 
Model parameter, 퐵 (in pressure units) 
R1 
Model constant, 푅1 (dimensionless) 
R2 
Model constant, 푅2 (dimensionless) 
GAMMA0 
Gruneisen coeﬃcient 
RHO0 
Initial or reference density, 휌0 
E0 
Represents the heat of detonation released during the reactions or 
the constant rate of afterburn energy added (E0 = 0.0 for standard 
JWL EOS), 푒0 
CV 
Heat capacity, 퐶푣 

================================================================================
PAGE 276
================================================================================

*DUALCESE 
*DUALCESE_EOS_JWL 
5-116 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Remark: 
The equations of state of a Mie-Gruneisen form are given by: 
푃(ρ, 푒) = 푃ref + Γ(ρ)ρ[푒−푒ref(ρ)] 
Here Γ(휌) is the Gruneisen coeﬃcient. Equations of state of this type are very popular in 
condensed phase explosive modeling.  Depending on the form of the reference pressure 
and energy functions, diﬀerent EOS types can be retrieved.  The JWL EOS is one type 
with reference pressure and energy given by: 
푃ref(ρ) = 퐴exp (−푅1ρ0
ρ
) + 퐵exp (−푅2ρ0
ρ
)
푒ref(ρ) =
퐴
ρ0푅1
exp (−푅1ρ0
ρ
) +
퐵
ρ0푅2
exp (−푅2ρ0
ρ
) −푒0

================================================================================
PAGE 277
================================================================================

*DUALCESE_EOS_NASG 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-117 (DUALCESE) 
*DUALCESE_EOS_NASG 
Purpose:  Deﬁne a Noble-Abel Stiﬀened-Gas (NASG) type ﬂuid EOS for use in the phase-
change dual CESE solver. See M’etayer and Saurel [2016] for details. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
GAMMA 
CV 
PINF 
Q 
QP 
B 
W 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID 
GAMMA 
Ratio of speciﬁc heats, 훾 
CV 
Speciﬁc heat at constant volume 
PINF 
Parameter for a given phase, 푝∞ (dimensions: [ 푀
퐿푇2]). See Le 
M’etayer and Saurel [2016]. 
Q 
Parameter for a given phase, 푞 (dimensions: [퐿2
푇2]). 푞 is the heat bond 
for the phase.  See Le M’etayer and Saurel [2016]. 
QP 
Parameter for a given phase, 푞′ (dimensions: [ 퐿2
푇2휃], where 휃 repre-
sents the dimension of temperature).  See Le M’etayer and Saurel 
[2016]. 
B 
Parameter for a given phase, 푏 (dimensions: [퐿3
푀]). 푏 indicates the 
ﬂuid’s covolume.  See Le M’etayer and Saurel [2016]. 
W 
Molar mass of this ﬂuid 
Remarks: 
The NASG EOS given by M’etayer and Saurel [2016] has the following form: 

================================================================================
PAGE 278
================================================================================

*DUALCESE 
*DUALCESE_EOS_NASG 
5-118 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
푝(휈, 푒) = (훾−1)(푒−푞)
휈−푏
−훾푝∞
푇(푝, 휈) = (휈−푏)(푝+ 푝∞)
퐶푣(훾−1)
푔(푝, 푇) = (훾퐶푣−푞′)푇−퐶푣푇ln [
푇훾
(푝+ 푝∞)훾−1] + 푏푝+ 푞
푐(푝, 휈) = √훾휈(푝+ 푝∞)
 
where 훾, 퐶푣, 푝∞, 푞, 푞′ and 푏 are parameters needed for each phase. 휈, 푒, 푔 and 푐 are for each 
ﬂuid phase the speciﬁc volume, the speciﬁc internal energy, the speciﬁc Gibbs free en-
ergy, and the sound speed, respectively. 푔= ℎ−푇푠 with ℎ and 푠 as the speciﬁc enthalpy 
and speciﬁc entropy, respectively.  
References: 
 [1]  
Le M’etayer, O. and R. Saurel, “The Nobel-Abel Stiffened-Gas equation of state,” Physics of Fluids, 
28 (4), (2016).

================================================================================
PAGE 279
================================================================================

*DUALCESE_EOS_REFPROP 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-119 (DUALCESE) 
*DUALCESE_EOS_REFPROP 
Purpose:  Deﬁne an equation of state (EOS) to be evaluated using the REFPROP EOS 
library 
 
Note that the REFPROP library is provided by ANSYS; it is REFPROP v10.0 from NIST. 
 
WARNING: Since the *MODULE capability is not yet working in 
the Windows build of LS-DYNA, do not attempt to use 
a Windows DLL version of the REFPROP shared li-
brary that comes with REFPROP v10.0. 
 
To use the REFPROP shared library with this keyword card, load this shared library into 
LS-DYNA using the *MODULE capability.  The following *MODULE card needs to ap-
pear before a *DUALCESE_MODEL card (not inside the ﬁle hierarchy of any ﬁle speciﬁed 
with a *DUALCESE_MODEL card): 
 
*MODULE_LOAD 
UserA                  DUALCESE REFPROP 
 < path to the installed REFPROP shared library >  
 
In addition, for REFPROP to be able to ﬁnd the appropriate EOS data, *DUALCESE_-
EOS_REFPROP_PATH must also be given somewhere inside a *DUALCESE_MODEL 
ﬁle hierarchy to point to the place in your ﬁlesystem where REFPROP has been installed. 
Card Summary: 
Card 1.  This card is required. 
EOSID 
NCOMP 
TYPE 
PHASE 
TABULAR 
 
 
 
Card 2.  Include as many cards as needed to specify mole fractions for the NCOMP 
components of the ﬂuid. 
MOL_FR1 
MOL_FR2 
MOL_FR3 
MOL_FR4 
MOL_FR5 
MOL_FR6 
MOL_FR7 
MOL_FR8 
Card 3.  This card is included when the TABULAR ﬁeld is active on Card 1.  
N_T 
N_DEN 
DEN_LOW DEN_HIGH 
T_LOW 
T_HIGH 
 
 
Card 4.  This card is required. 
FLUIDNAME 

================================================================================
PAGE 280
================================================================================

*DUALCESE 
*DUALCESE_EOS_REFPROP 
5-120 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
NCOMP 
TYPE 
PHASE 
TABULAR
 
 
 
Type 
I 
I 
A 
A 
A 
 
 
 
Default 
none 
none 
none 
GAS 
optional
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
ID for this EOS 
NCOMP 
Number of components in the ﬂuid composition 
TYPE 
Fluid type: 
EQ.PURE: 
A single component ﬂuid (default) 
EQ.PSEUDOPURE: A predeﬁned ﬂuid mixture 
EQ.MIXTURE: 
A ﬂuid mixture with NCOMP components
PHASE 
Phase of the ﬂuid: 
EQ.GAS: 
Gas phase 
EQ.LIQUID: Liquid phase 
TABULAR 
Type of lookup tables to build for this EOS: 
EQ.<BLANK>: No table lookup (default) 
EQ.P_EIN: 
Build tables of pressure and internal energy, both 
as a function of density and temperature. 
 

================================================================================
PAGE 281
================================================================================

*DUALCESE_EOS_REFPROP 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-121 (DUALCESE) 
REFPROP Parameters by Fluid Component. Repeat this card as many times as needed 
to input mole fractions for the NCOMP components of the ﬂuid. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MOL_FR1 MOL_FR2 MOL_FR3 MOL_FR4 MOL_FR5 MOL_FR6 MOL_FR7 MOL_FR8
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
MOL_FRi 
Mole fraction of the ith component of the ﬂuid. 
. 
REFPROP EOS Table Density and Temperature Ranges. This card is included when 
the TABULAR ﬁeld is active on Card 1. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N_T 
N_DEN 
DEN_LOW DEN_HIGH
T_LOW 
T_HIGH 
 
 
Type 
I 
I 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
Remarks 
1 
1 
2 
2 
2 
2 
 
 
 
 VARIABLE  
 
DESCRIPTION 
N_T 
Number of temperature values in the tables 
N_DEN 
Number of density values (on a log scale) in the table 
DEN_LOW 
Minimum density available in the tables (in model units) 
DEN_HIGH 
Maximum density available in the tables (in model units) 
T_LOW 
Minimum temperature available in the tables (in model units) 
T_HIGH 
Maximum temperature available in the tables (in model units) 
 

================================================================================
PAGE 282
================================================================================

*DUALCESE 
*DUALCESE_EOS_REFPROP 
5-122 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Name of REFPROP ﬂuid.  This card is required. 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FLUIDNAME 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
FLUID-
NAME 
Name of a ﬂuid that has an EOS in REFPROP. For a list of the sup-
ported pure and pseudo-pure ﬂuids, see the directory of supported 
ﬂuids that comes with the REFPROP v10.0 library from ANSYS. 
Note that the predeﬁned ﬂuid mixtures are not supported at this 
time. 
Remarks: 
1. 
Number of Values in the Lookup Table.  The number of values of density and 
temperature axes of the tables should not be too few to give good resolution of 
the EOS. Note that the cost of building the EOS from these tables rises with these 
numbers, as well as the computer memory required.  Nevertheless, if these num-
bers are too small (< 20), then the accuracy may suﬀer, while larger numbers of 
density and temperature points improves the accuracy. 
2. 
Valid Value Ranges for the Lookup Tables.  For many equations of state in 
the REFPROP library, a range of densities and temperatures are valid.  Thus, the 
low and high limits for the table densities and temperatures should not lie out-
side these ranges.  Please refer to the REFPROP documentation for that infor-
mation.

================================================================================
PAGE 283
================================================================================

*DUALCESE_EOS_REFPROP_PATH 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-123 (DUALCESE) 
*DUALCESE_EOS_REFPROP_PATH 
Purpose:  Provide the ﬁle path to the directory where the REFPROP EOS system is in-
stalled. 
 
Note that in any problem where a *DUALCESE_EOS_REFPROP card is used, you must 
also provide a *DUALCESE_EOS_REFPROP_PATH card somewhere inside a *DUAL-
CESE_MODEL ﬁle hierarchy to point to the place in your ﬁlesystem where REFPROP has 
been installed so that the appropriate EOS data can be loaded. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PATH 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
PATH 
Path giving the directory where the REFPROP data is installed. 

================================================================================
PAGE 284
================================================================================

*DUALCESE 
*DUALCESE_EOS_SET 
5-124 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_EOS_SET 
Purpose: Deﬁne a set of equations of state that are used together to compute the thermo-
dynamic state of a multiphase ﬂuid for the dual CESE solver. 
WARNING: As of version R14, this keyword is deprecated.  Instead, 
use *DUALCESE_SOLVER_HYBRID_MULTIPHASE 
for the hybrid multiphase case and *DUALCESE_-
SOLVER_TWO-PHASE_MULTIPHASE for the two-
phase multiphase case. 
 
Include one card for each dual CESE multiphase mesh.  This input ends at the next 
keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSSID 
EOSINID EOSRCTID EOSPRDID
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSSID 
Set ID of the EOS mixture of a given multiphase ﬂuid 
EOSINID 
EOS ID of the inert component of the multiphase mixture 
EOSRCTID 
EOS ID of the reactant phase of the multiphase mixture 
EOSPRDID 
EOS ID of the product phase of the multiphase mixture 

================================================================================
PAGE 285
================================================================================

*DUALCESE_EOS_STIFFENED_GAS 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-125 (DUALCESE) 
*DUALCESE_EOS_STIFFENED_GAS 
Purpose:  Deﬁne a stiﬀened gas type ﬂuid EOS for use by the dual CESE solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
GA 
BT 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID for this dual CESE solver EOS 
GA 
Adiabatic exponent, 훾. Must be > 1.0. 
BT 
Reference pressure, 훽. Must be ≥ 0.0 
Remark: 
The stiﬀened gas equation of state: 
푝(ρ, 푒) = (γ −1)ρ푒−γβ 
provides a fundamental characterization of material properties of ﬂuids.  Here 푒 is the 
internal energy per unit mass, 휌 is the density, and 훾 and 훽 are two thermodynamic con-
stants. 훾 and 훽 can be determined by a ﬁtting procedure from laboratory data.  A typical 
set of parameter values for water are: 훾= 7 and 훽= 3000 atm while for human blood are: 
훾= 5.527 and 훽= 614.6 MPa.  In addition to the modelling of a liquid, it is often used to 
describe other type of materials, including many compressible solids of practical im-
portance.

================================================================================
PAGE 286
================================================================================

*DUALCESE 
*DUALCESE_EOS_VAN_DER_WAALS_GENERALIZED 
5-126 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_EOS_VAN_DER_WAALS_GENERALIZED 
Purpose:  Deﬁne a Van Der Waals generalized type ﬂuid EOS for use in the dual CESE 
solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
A 
B 
GA 
BT 
 
 
 
Type 
I 
F 
F 
F 
F 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state ID 
A 
van der Waals gas constant for molecular cohesive forces, 푎 
B 
van der Waals gas constant for the ﬁnite size of molecules, 푏 
GA 
Ratio of speciﬁc heats, γ. Must be > 1.0. 
BT 
Reference pressure, β. Must be ≥ 0.0. See *DUALCESE_EOS_-
STIFFENED_GAS. 
Remark: 
The generalized Van der Waals equation of state can be written as: 
푝(ρ, 푒) = (γ −1)
1 −푏휌(ρ푒−훽+ 푎휌2) −(훽+ 푎휌2) 
Here 푒 denotes the speciﬁc internal energy, 훾 is the ratio of speciﬁc heats (훾> 1), 훽 is a 
reference pressure, and the quantities 푎 and 푏 are the van der Waals gas constants for 
molecular cohesive forces and the ﬁnite size of molecules, respectively (a ≥0, 0 ≤b <
1 휌
⁄ ). This EOS is often used to deal with possible real-gas eﬀect (without phase transition) 
when both the temperature and pressure are high.  When 훽= 0, the generalized van der 
Waals equation of state becomes a standard Van der Waals equation of state.  If 푎= 푏=
0, the stiﬀened gases EOS will be recovered.  

================================================================================
PAGE 287
================================================================================

*DUALCESE_EOS_VAN_DER_WAALS_GENERALIZED 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-127 (DUALCESE) 
References: 
 [1]  
G. Allaire, S. Clerc, S. Kokh, A ﬁve-equation model for the simulation of interfaces between com-
pressible ﬂuids.  J. Comp.  Phys.  181 (2) (2002) 577-616. 
 [2]  
K.M. Shyue, A ﬂuid-mixture type algorithm for compressible multicomponent ﬂow with van der 
Waals equation of state, J. Comp.  Phys.  156, 43 (1999)

================================================================================
PAGE 288
================================================================================

*DUALCESE 
*DUALCESE_FSI_EXCLUDE 
5-128 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_FSI_EXCLUDE 
Purpose: Provide a list of mechanics solver parts that are not involved in the dual CESE 
FSI calculation.  This keyword is intended for increasing computational eﬃciency by ex-
cluding parts that will not involve signiﬁcant FSI interactions with the dual CESE com-
pressible ﬂuid solver. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
PID7 
PID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
PIDn 
IDs of mechanics parts that will be excluded from the FSI interac-
tion calculation with the dual CESE solver 

================================================================================
PAGE 289
================================================================================

*DUALCESE_FSI_EXCLUDE_PARTSET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-129 (DUALCESE) 
*DUALCESE_FSI_EXCLUDE_PARTSET 
Purpose: Provide a list of mechanics solver part sets for parts that are not involved in the 
dual CESE FSI calculation.  This keyword is intended for increasing computational eﬃ-
ciency by excluding parts that will not involve signiﬁcant FSI interactions with the dual 
CESE compressible ﬂuid solver. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PSID1 
PSID2 
PSID3 
PSID4 
PSID5 
PSID6 
PSID7 
PSID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
PSIDn 
IDs of mechanics part sets that will be excluded from the FSI inter-
action calculation with the dual CESE solver 

================================================================================
PAGE 290
================================================================================

*DUALCESE 
*DUALCESE_GRAVITY 
5-130 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_GRAVITY 
Purpose: Apply a gravity load to the dual CESE ﬂuid.  It is only avilable for single ﬂuid 
solvers (meaning EQNS = EULER or NS) for both FSI (including FSI-IBM and FSI-MMM) 
and no FSI. Please note that this keyword must be accompanied by *LOAD_BODY_VEC-
TOR, *LOAD_BODY_X, *LOAD_BODY_Y, or *LOAD_BODY_Z.  However, these 
*LOAD_BODY_... keywords cannot be in the dual CESE model portion of the input deck 
(see Dual CESE Keyword Deck Structure for details). 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IGRAV 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
IGRAV 
Flag for applying a gravity load: 
EQ.0: No gravity load applied (default) 
EQ.1: Apply gravity load 
Remarks: 
1. 
Including gravity. In most compressible cases, the gravity terms are not needed 
(the default is no gravity).  Including gravity only has a signiﬁcant eﬀect for cer-
tain cases, such as buoyancy driven ﬂow, stratiﬁed ﬂow, etc.

================================================================================
PAGE 291
================================================================================

*DUALCESE_INCLUDE_MODEL 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-131 (DUALCESE) 
*DUALCESE_INCLUDE_MODEL 
Purpose:  Provide the ﬁlename of a ﬁle containing additional keywords belonging to a 
dual CESE model.  Any number of these *DUALCESE_INCLUDE_MODEL keywords 
may be used in a single dual CESE model, where at the top level the overall model begins 
with a *DUALCESE_MODEL card. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FILENAME 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
FILENAME 
Filename of the keyword ﬁle containing more of the dual CESE
model.  This card is only allowed inside a ﬁle that is given in one
instance of a *DUALCESE_MODEL keyword card. 

================================================================================
PAGE 292
================================================================================

*DUALCESE 
*DUALCESE_INITIAL 
5-132 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_INITIAL 
Purpose: Specify constant initial conditions for ﬂow variables at the centroid of each dual 
CESE ﬂuid element.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
U 
V 
W 
RH 
P 
T 
 
IFUNC 
Type 
F 
F 
F 
F 
F 
F 
 
I 
Default 
0 
0.0 
0.0 
1.225 
0.0 
0.0 
 
none 
 
 VARIABLE  
 
DESCRIPTION 
U, V, W 
푥, 푦, and 푧 velocity components, respectively 
RHO 
Density, 휌 
P 
Pressure,  
T 
Temperature,  
IFUNC 
Option to deﬁne initial conditions using *DEFINE_FUNCTION 
cards: 
EQ.0: Not in use. 
EQ.1: All values for initial velocity, pressure, density, and tem-
perature now refer to *DEFINE_FUNCTION IDs.  In these 
functions, the following parameters are allowed: f(x,y,z), 
meaning that each variable’s initial proﬁle is a function of 
position. 
Remarks: 
1. 
Required Input.  Usually, only two of 휌, 푃, and 푇 are needed to be speciﬁed 
(besides the velocity).  If all three are given, only 휌 and  will be used.  
2. 
Applicable Elements.  These initial conditions will be applied in those elements 
that have not been assigned a value by *DUALCESE_INITIAL_OPTION cards 
for individual elements or sets of elements.

================================================================================
PAGE 293
================================================================================

*DUALCESE_INITIAL_SET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-133 (DUALCESE) 
*DUALCESE_INITIAL_SET 
Purpose: Specify initial conditions for the ﬂow variables at the centroid of each element 
in an element subset of the dual CESE mesh. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ESID 
IFUNC 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
U 
V 
W 
RHO 
P 
T 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ESID 
Element set ID (see *DUALCESE_ELEMENTSET) 
IFUNC 
Option to deﬁne initial conditions using *DEFINE_FUNCTION 
cards: 
EQ.0: Not in use. 
EQ.1: All values for initial velocity, pressure, density, and tem-
perature now refer to *DEFINE_FUNCTION IDs.  In these 
functions, the following parameters are allowed: f(x,y,z), 
meaning that each variable’s initial proﬁle is a function of 
position. 
U, V, W 
푥, 푦, and 푧 velocity components, respectively 
RHO 
Density, 휌 
P 
Pressure, 푃 

================================================================================
PAGE 294
================================================================================

*DUALCESE 
*DUALCESE_INITIAL_SET 
5-134 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
T 
Temperature, 푇 
Remarks: 
1. 
Required Input. Usually, only two of 휌, 푃 and  are needed to be speciﬁed (be-
sides the velocity).  If all three are given, only 휌 and  will be used. 
2. 
Keyword Priority. The priority of this card is higher than *DUALCESE_INI-
TIAL. Thus, if an element is assigned an initial value by this card, *DUALCESE_-
INITIAL will no longer apply to that element.

================================================================================
PAGE 295
================================================================================

*DUALCESE_INITIAL_HYBRID 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-135 (DUALCESE) 
*DUALCESE_INITIAL_HYBRID 
Purpose:  Speciﬁes values to use for velocity, pressure, etc.  for problem initialization of 
a hybrid multiphase model on the dual CESE mesh.  Note that these values can be over-
ridden in some mesh elements by use of the *DUALCESE_INITIAL_HYBRID_SET card. 
 
The hybrid multiphase model involves two materials, separated by a material surface.  
These materials do not mix.  The ﬁrst material is inert while the second material is an 
explosive mixture, composed of reactants and products.  This model is useful for simula-
tions with high explosives.  See Michael and Nikiforakis 2016 for details about this model. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Z1 
RA 
UIC 
VIC 
WIC 
RHO1 
RHO_A 
RHO_B 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PIC 
TIC 
 
IFUNC 
 
 
 
 
Type 
F 
F 
 
I 
 
 
 
 
Default 
none 
none 
 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
Z1 
Volume fraction of material 1 (or color function).  This is usually a 
value of 0 or 1. For numerical stability, however, use a very small
value instead of zero. 
RA 
Mass fraction of the reactant (material 훼) with respect to material 2 
(the explosive mixture) 
UIC, VIC, 
WIC 
Multiphase ﬂow velocity components in the 푥, 푦, and 푧-directions, 
respectively 
RHO1 
Density of material 1 

================================================================================
PAGE 296
================================================================================

*DUALCESE 
*DUALCESE_INITIAL_HYBRID 
5-136 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
RHO_A 
Density of the reactant (material 훼) 
RHO_B 
Density of the product (material 훽) 
PIC 
Equilibrium multiﬂuid pressure 
TIC 
Equilibrium multiﬂuid temperature 
IFUNC 
Option to deﬁne initial conditions using *DEFINE_FUNCTION 
cards: 
EQ.0: Not in use. 
EQ.1: All values for initial velocity, pressure, and temperature
now refer to *DEFINE_FUNCTION IDs.  In these func-
tions, the following parameters are allowed: f(x,y,z), 
meaning that each variable’s initial proﬁle is a function of 
position. 

================================================================================
PAGE 297
================================================================================

*DUALCESE_INITIAL_HYBRID_SET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-137 (DUALCESE) 
*DUALCESE_INITIAL_HYBRID_SET 
Purpose:  Speciﬁes values to use for velocity, pressure, etc.  for problem initialization of 
a hybrid multiphase model in an element subset of the dual CESE mesh.  The values 
speciﬁed here override the values set on *DUALCESE_INITIAL_HYBRID for the element 
subset. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ESID 
IFUNC 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Z1 
RA 
UIC 
VIC 
WIC 
RHO1 
RHO_A 
RHO_B 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PIC 
TIC 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ESID 
Element set ID (see *DUALCESE_ELEMENTSET) 
IFUNC 
Option to deﬁne initial conditions using *DEFINE_FUNCTION 
cards: 

================================================================================
PAGE 298
================================================================================

*DUALCESE 
*DUALCESE_INITIAL_HYBRID_SET 
5-138 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.0: Not in use. 
EQ.1: All values for initial velocity, pressure, and temperature
now refer to *DEFINE_FUNCTION IDs.  In these func-
tions, the following parameters are allowed: f(x,y,z), 
meaning that each variable’s initial proﬁle is a function of 
position. 
Z1 
Volume fraction of material 1 (or color function).  This is usually a 
value of 0 or 1. For numerical stability, however, use a small value 
instead of 0. 
RA 
Mass fraction of the reactant (material 훼) with respect to material 2 
(the explosive mixture) 
UIC, VIC, 
WIC 
Multiphase ﬂow velocity components in the 푥, 푦, and 푧-directions, 
respectively 
RHO1 
Density of material 1 
RHO_A 
Density of the reactant (material 훼) 
RHO_B 
Density of the product (material 훽) 
PIC 
Equilibrium multiﬂuid pressure 
TIC 
Equilibrium multiﬂuid temperature 

================================================================================
PAGE 299
================================================================================

*DUALCESE_INITIAL_PHASE_CHANGE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-139 (DUALCESE) 
*DUALCESE_INITIAL_PHASE_CHANGE 
Purpose:  Specify values to use for velocity, pressure, etc.  for problem initialization of a 
phase-change multiphase model on the dual CESE mesh.  Note that these values can be 
overridden 
in 
some 
mesh 
elements 
by 
use 
of 
the 
*DUALCESE_INI-
TIAL_PHASE_CHANGE_SET card.  
 
The phase-change multiphase model involves three ﬂuids: a liquid, its vapor, and other 
gases.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
UIC 
VIC 
WIC 
RHO 
PIC 
TIC 
Y1 
Y2 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Y3 
 
 
IFUNC 
 
 
 
 
Type 
F 
 
 
I 
 
 
 
 
Default 
none 
 
 
0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
UIC, VIC, 
WIC 
Multiphase ﬂow velocity components in the 푥, 푦, and 푧-di-
rections, respectively 
RHO 
Mixture density 
PIC 
Equilibrium multiﬂuid pressure 
TIC 
Equilibrium multiﬂuid temperature 
Y1 
Mass fraction of ﬂuid 1 
Y2 
Mass fraction of ﬂuid 2 

================================================================================
PAGE 300
================================================================================

*DUALCESE 
*DUALCESE_INITIAL_PHASE_CHANGE 
5-140 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
Y3 
Mass fraction of ﬂuid 3 
IFUNC 
Option to deﬁne initial conditions with *DEFINE_FUNCTION: 
EQ.0: Not in use. 
EQ.1: All values for initial velocity, pressure, and temperature
now refer to *DEFINE_FUNCTION IDs.  In these func-
tions, the following parameters are allowed: f(x, y, z). 
Thus, each variable’s initial proﬁle is a function of posi-
tion. 

================================================================================
PAGE 301
================================================================================

*DUALCESE_INITIAL_PHASE_CHANGE_SET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-141 (DUALCESE) 
*DUALCESE_INITIAL_PHASE_CHANGE_SET 
Purpose:  Specify values to use for velocity, pressure, etc.  for problem initiali-
zation of a phase- change multiphase model in an element subset of the dual 
CESE mesh.  The values speciﬁed here override the values set on *DUAL-
CESE_INITIAL_PHASE_CHANGE for the element subset. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ESID 
IFUNC 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
0 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
UIC 
VIC 
WIC 
RHO 
PIC 
TIC 
Y1 
Y2 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Y3 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ESID 
Element set ID (see *DUALCESE_ELEMENTSET) 
IFUNC 
Option to deﬁne initial conditions with *DEFINE_FUNCTION: 
EQ.0: Not in use. 

================================================================================
PAGE 302
================================================================================

*DUALCESE 
*DUALCESE_INITIAL_PHASE_CHANGE_SET 
5-142 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: All values for initial velocity, pressure, and temperature
now refer to *DEFINE_FUNCTION IDs.  In these func-
tions, the following parameters are allowed: f(x, y, z). 
Thus, each variable’s initial proﬁle is a function of posi-
tion. 
UIC, VIC, 
WIC 
Multiphase ﬂow velocity components in the 푥, 푦, and 푧-di-
rections, respectively 
RHO 
Mixture density 
PIC 
Equilibrium multiﬂuid pressure 
TIC 
Equilibrium multiﬂuid temperature 
Y1 
Mass fraction of ﬂuid 1 
Y2 
Mass fraction of ﬂuid 2 
Y3 
Mass fraction of ﬂuid 3 

================================================================================
PAGE 303
================================================================================

*DUALCESE_INITIAL_TWO-PHASE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-143 (DUALCESE) 
*DUALCESE_INITIAL_TWO-PHASE 
Purpose:  Specify values to use for velocity, pressure, etc.  for problem initialization of a 
two-phase multiﬂuid model on the dual CESE mesh.  Note that these values can be over-
ridden in some mesh elements by use of the *DUALCESE_INITIAL_TWO-PHASE_SET 
card. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Z1 
UIC 
VIC 
WIC 
RHO_1 
RHO_2 
PIC 
TIC 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
0. 
0. 
0. 
none 
none 
none 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IFUNC 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
Z1 
Volume fraction of material 1 (or color function) 
UIC, VIC, 
WIC 
Multiphase ﬂow velocity components in the 푥, 푦, and 푧-directions 
respectively. 
RHO_1 
Density of ﬂuid 1 
RHO_2 
Density of ﬂuid 2 
PIC 
Equilibrium multiﬂuid pressure 
TIC 
Equilibrium multiﬂuid temperature 
IFUNC 
Option to deﬁne initial conditions using *DEFINE_FUNCTION 
cards: 

================================================================================
PAGE 304
================================================================================

*DUALCESE 
*DUALCESE_INITIAL_TWO-PHASE 
5-144 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.0: Not in use. 
EQ.1: All values for initial velocity, pressure, and temperature
now refer to *DEFINE_FUNCTION IDs.  In these func-
tions, the following parameters are allowed: f(x,y,z), 
meaning that each variable’s initial proﬁle is a function of 
position. 

================================================================================
PAGE 305
================================================================================

*DUALCESE_INITIAL_TWO-PHASE_SET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-145 (DUALCESE) 
*DUALCESE_INITIAL_TWO-PHASE_SET 
Purpose:  Specify values to use for velocity, pressure, etc.  for problem initialization of a 
two-phase multiﬂuid model in an element subset of the dual CESE mesh. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ESID 
IFUNC 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Z1 
UIC 
VIC 
WIC 
RHO_1 
RHO_2 
PIC 
TIC 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
ESID 
Element set ID (see *DUALCESE_ELEMENTSET) 
IFUNC 
Option to deﬁne initial conditions using *DEFINE_FUNCTION 
cards: 
EQ.0: Not in use. 
EQ.1: All values for initial velocity, pressure, and temperature
now refer to *DEFINE_FUNCTION IDs.  In these func-
tions, the following parameters are allowed: f(x,y,z), 
meaning that each variable’s initial proﬁle is a function of 
position. 
Z1 
Volume fraction of material 1 (or color function) 
UIC, VIC, 
WIC 
Multiphase ﬂow velocity components in the 푥, 푦, and 푧-directions, 
respectively 

================================================================================
PAGE 306
================================================================================

*DUALCESE 
*DUALCESE_INITIAL_TWO-PHASE_SET 
5-146 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
RHO_1 
Density of material 1 
RHO_2 
Density of material 2 
PIC 
Equilibrium multiphase ﬂow pressure 
TIC 
Equilibrium multiphase ﬂow temperature 

================================================================================
PAGE 307
================================================================================

*DUALCESE_MAT_GAS 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-147 (DUALCESE) 
*DUALCESE_MAT_GAS 
Purpose: Deﬁne the ﬂuid (gas) properties in a viscous ﬂow for the dual CESE solver.  In 
this model, the dynamic viscosity is determined using Sutherland’s formula for viscosity, 
and the thermal conductivity is determined using the Prandtl Number. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
C1 
C2 
PRND 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
1.458E-6
110.4 
0.72 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID 
C1, C2 
Two coeﬃcients in the Sutherland’s formula for viscosity: 
휇= 퐶1푇3 2
⁄
푇+ 퐶2
  . 
Here 퐶1 and 퐶2 are constants for a given gas.  For example, for air
at moderate temperatures 
퐶1 = 1.458 × 10−6 kg msK1 2
⁄
⁄
,
퐶2 = 110.4 K
PRND 
Prandtl Number (used to determine the coeﬃcient of thermal con-
ductivity).  It is approximately constant for most gases.  For air at 
standard conditions PRND = 0.72. 
Remarks: 
1. 
Inviscid ﬂows.  C1 and C2 are only used to calculate the viscosity in viscous 
ﬂows, so for inviscid ﬂows, this material card is not needed.  
2. 
Thermal coupling. The Prandtl number is used to extract the thermal conduc-
tivity.  It is only needed when thermal coupling with the structure is being done.  
However, the dual CESE does not include a conjugate heat transfer capability in 
the Dual CESE solver. 

================================================================================
PAGE 308
================================================================================

*DUALCESE 
*DUALCESE_MAT_GAS 
5-148 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
3. 
Unit consistency. As with other solvers in LS-DYNA, you are responsible for 
unit consistency.  For example, if dimensionless variables are used, 퐶1 and 퐶2 
should be replaced by the corresponding dimensionless ones.  If the dual CESE 
model has a speciﬁed system of units either directly from the *DUALCESE_-
MODEL card or inherited from the overall problem input, then these values 
need to be given in that unit system.  Also, note that the formulas here require 
the temperature be given in either Kelvin or Rankine units.

================================================================================
PAGE 309
================================================================================

*DUALCESE_MAT_GAS_0 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-149 (DUALCESE) 
*DUALCESE_MAT_GAS_0 
Purpose: Deﬁne the ﬂuid (gas) properties in a viscous ﬂow for the dual CESE solver.  In 
this model, the dynamic viscosity and thermal conductivity are speciﬁed constants.  
 
Material Deﬁnition Cards.  Include one card for each instance of this material type.  This 
input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MU 
K 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID 
MU 
Fluid dynamic viscosity.  MU = 1.81 × 10−5 kg/ms for air at 15°C.
K 
Thermal conductivity of the ﬂuid 
Remarks: 
1. 
Fields that depend on the problem’s physics. The viscosity is only used in 
viscous ﬂows, so it is not necessary to deﬁne it for inviscid ﬂows.  The thermal 
conductivity is only used when coupling is activated between the structure and 
thermal solver to calculate the heat transfer.  However, the Dual CESE solver 
does not include a conjugate heat transfer capability. 
2. 
Unit consistency. As with other solvers in LS-DYNA, you are responsible for 
unit consistency.  For example, if dimensionless variables are used, MU should 
be replaced by the corresponding dimensionless one.  If the dual CESE model 
has a speciﬁed system of units either directly from the *DUALCESE_MODEL 
card or inherited from the overall problem input, then these values need to be 
given in that unit system.

================================================================================
PAGE 310
================================================================================

*DUALCESE 
*DUALCESE_MAT_GAS_2 
5-150 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_MAT_GAS_2 
Purpose:  Deﬁne the ﬂuid (gas) properties in a viscous ﬂow for the dual CESE solver.  
This model determines dynamic viscosity and thermal conductivity by combining Suth-
erland’s formula with the Power law for dilute gases.  
 
Material Deﬁnition Cards.  Include one card for each instance of this material type.  This 
input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MU0 
SMU 
K0 
SK 
T0 
 
 
Type 
I 
F 
F 
F 
F 
F 
 
 
Default 
none 
1.716E-5
111. 
0.0241 
194.0 
273.0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID 
MU0 / SMU 
Two coeﬃcients appearing in the equation derived by combining 
Sutherland’s formula with the Power law for dilute gases: 
휇
휇0
= ( 푇
푇0
)
3 2
⁄ 푇0 + 푆휇
푇+ 푆휇
  . 
Here 휇 is the dynamic viscosity, 휇0 is a reference value, and 푆휇 is 
an eﬀective temperature called the Sutherland constant which is 
characteristic of the gas.  For air at moderate temperatures, 
휇0 = 1.716 × 10−5 Ns m2
⁄
,
푆휇= 111 K
K0/SK 
Two coeﬃcients appearing in the equation derived by combining 
Sutherland’s formula with the Power law for dilute gases: 
푘
푘0
= ( 푇
푇0
)
3 2
⁄ 푇0 + 푆푘
푇+ 푆푘
  . 
Here 푘 is the thermal conductivity, 푘0 is a reference value, and 푆푘 is 
the Sutherland constant, which is characteristic of the gas.  For air
at moderate temperatures, 
푘0 = 0.0241 W m
⁄
,
푆푘= 194 K
T0 
Reference temperature, 푇0. The default value (273.0) is for air in K.

================================================================================
PAGE 311
================================================================================

*DUALCESE_MAT_GAS_2 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-151 (DUALCESE) 
Remarks: 
1. 
Fields that depend on the problem’s physics.  The viscosity is only used for 
viscous ﬂows, so it is not necessary to deﬁne it for inviscid ﬂows.  The thermal 
conductivity is only used to calculate the heat transfer between the structure and 
the thermal solver when coupling is activated.  However, the dual CESE solver 
does not include a conjugate heat transfer capability. 
2. 
Unit consistency.  As with other solvers in LS-DYNA, you are responsible for 
unit consistency.  For example, if dimensionless variables are used, MU should 
be replaced by the corresponding dimensionless one.  If the dual CESE model 
has a speciﬁed system of units either directly from the *DUALCESE_MODEL 
card or inherited from the overall problem input, then these values need to be 
given in that unit system.  Also, note that the formulas here require the temper-
ature be given in either Kelvin or Rankine units.

================================================================================
PAGE 312
================================================================================

*DUALCESE 
*DUALCESE_MAT_LIQUID 
5-152 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_MAT_LIQUID 
Purpose: Deﬁne the ﬂuid (liquid) properties in a viscous ﬂow for the dual CESE solver.  
The parameters are used to calculate the viscosity of the liquid.  This material model is 
usually accompanied by a liquid EOS (see *DUALCESE_EOS_NASG). This keyword is 
only available for single ﬂuid, viscous ﬂows for either no FSI or FSI-IBM. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
A 
B 
 
 
K 
 
 
Type 
I 
F 
F 
 
 
F 
 
 
Default 
none 
1.732E-6
1863 
 
 
0.579 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID 
A, B 
Two coeﬃcients in the Andrade’s formula for the liquid’s viscosity:
휇= 퐴exp (퐵
푇) 
Here 푇 is the absolute temperature of the liquid.  See Remark 1. 
The default values taken from the values for water at 10°C: 퐴=
1.732 × 10−6 N∙s/m2 and 퐵= 1863 K. 
K 
Thermal conductivity of the liquid.  The default value is taken from 
that for water at 10°C: 0.579 W/m∙K. 
Remarks: 
1. 
Properties in Andrade’s formula. The values of 퐴 and 퐵 need to be determined 
for the liquid by ﬁtting the equation to experimental viscosity data at diﬀerent 
temperatures.

================================================================================
PAGE 313
================================================================================

*DUALCESE_MESH_GEOMETRY 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-153 (DUALCESE) 
*DUALCESE_MESH_GEOMETRY 
Purpose:  Set general purpose control variables for the dual CESE compressible ﬂow 
solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
GEOM 
IDC 
 
 
 
 
 
 
Type 
A 
F 
 
 
 
 
 
 
Default 
none 
0.25 
 
 
 
 
 
 
Remarks 
1 
2 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
GEOM 
Sets the geometric dimension: 
EQ.2D: Two-dimensional (2D) problem 
EQ.3D: Three-dimensional (3D) problem 
EQ.AXI: 2D axisymmetric 
IDC 
Contact interaction detection coeﬃcient (for FSI problems) 
Remarks: 
1. 
Mesh and Boundary Conditions for 2D Problems. If you want to use the 2D 
(GEOM = 2D) or 2D axisymmetric (GEOM=AXI) solver, the mesh should only 
be distributed in the 푥푦-plane with the boundary conditions given only at the 푥푦 
domain boundaries.  Otherwise, a warning message will be given, and the 3D 
solver will be triggered instead. 
The 2D axisymmetric case will work only if the 2D mesh and corresponding 
boundary conditions are properly deﬁned with the 푥 and 푦 coordinates corre-
sponding to the radial and axial directions, respectively. 
2. 
Contact Interaction Detection Coefﬁcient. IDC is the same type of variable 
that is input on the *ICFD_CONTROL_FSI card.  For an explanation, see Remark 
1 for the *ICFD_CONTROL_FSI card. 

================================================================================
PAGE 314
================================================================================

*DUALCESE 
*DUALCESE_MESH_GEOMETRY 
5-154 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
3. 
Dual CESE Solver and Restarts. The dual CESE solver is not currently sup-
ported for restarts.

================================================================================
PAGE 315
================================================================================

*DUALCESE_MESH_PART 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-155 (DUALCESE) 
*DUALCESE_MESH_PART 
Purpose: Deﬁne dual CESE solver mesh parts, that is, specify the dual CESE FSI algorithm 
to use for a mesh part.  In other words, this keyword allows you to restrict the type of 
solver (immersed boundary FSI, moving mesh FSI, or non-FSI Eulerian) used on a region 
of a dual CESE mesh.  The part ID speciﬁed with this keyword corresponds to the second 
ﬁeld of Card 1 for either *DUALCESE_ELE2D or *DUALCESE_ELE3D. 
 
Part Cards.  Include one card for each dual CESE part.  This input ends at the next 
keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
FSITYPE 
MMSHID 
 
 
 
 
 
Type 
I 
A 
I 
 
 
 
 
 
Default 
none 
optional
o 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID (must be diﬀerent from any other *DUALCESE_MESH_-
PART part ID).  It is important to note that *DUALCESE_PART 
and *DUALCESE_PART_MULTIPHASE cards should not be used 
when the newer *DUALCESE_MESH_PART card is used. 
FSITYPE 
FSI type to use on this part: 
EQ.<BLANK>: If left blank, no FSI performed. 
EQ.IBM: 
Immersed boundary FSI solver 
EQ.MOVMESH: Moving mesh FSI solver (FSITYPE = MMM 
may also be used for the same eﬀect) 
MMSHID 
ID for the mesh motion algorithm to use for the moving mesh FSI 
solver on this part (region of the current dual CESE mesh).  This ID 
refers to the ID of an instantiation of *DUALCESE_CONTROL_-
MESH_MOV. 

================================================================================
PAGE 316
================================================================================

*DUALCESE 
*DUALCESE_MODEL 
5-156 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_MODEL 
Purpose:  Set the units used by a dual CESE compressible ﬂow problem, along with the 
name of the ﬁle specifying the dual CESE model.  There can be any number of such mod-
els (each with a separate mesh), and each such model must be in a diﬀerent ﬁle. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
UNITSYS 
FILENAME 
Type 
A 
A 
 
 VARIABLE  
 
DESCRIPTION 
UNITSYS 
Name of the unit system of this dual CESE model (deﬁned with 
*UNIT_SYSTEM). 
EQ.<BLANK>: Use same units as the presumed units of the en-
tire problem. 
FILENAME 
Filename of the keyword ﬁle containing the dual CESE model. 
Note that only *DUALCESE_... keyword cards are allowed in this 
ﬁle. 

================================================================================
PAGE 317
================================================================================

*DUALCESE_NODE2D 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-157 (DUALCESE) 
*DUALCESE_NODE2D 
Purpose:  Deﬁne a node and its coordinates in the global coordinate system.  The nodal 
point ID must be unique relative to other nodes deﬁned with *DUALCESE_NODE2D or 
*DUALCESE_NODE3D cards. 
 
Node Cards.  Include as many cards in the following format as desired.  This input ends 
at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
NID 
X 
Y 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
none 
0. 
0. 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID 
Node number 
X 
푥 coordinate 
Y 
푦 coordinate 

================================================================================
PAGE 318
================================================================================

*DUALCESE 
*DUALCESE_NODE3D 
5-158 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_NODE3D 
Purpose:  Deﬁne a node and its coordinates in the global coordinate system.  The nodal 
point ID must be unique relative to other nodes deﬁned with *DUALCESE_NODE3D or 
*DUALCESE_NODE2D cards. 
 
Node Cards.  Include as many cards in the following format as desired.  This input ends 
at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
NID 
X 
Y 
Z 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
Default 
none 
0. 
0. 
0. 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID 
Node number 
X 
푥 coordinate 
Y 
푦 coordinate 
Z 
푧 coordinate 

================================================================================
PAGE 319
================================================================================

*DUALCESE_NODESET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-159 (DUALCESE) 
*DUALCESE_NODESET 
Purpose:  Deﬁne a nodal set of dual CESE mesh nodes. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Node ID Cards. Set one value per node in the set.  Include as many cards as needed.  This 
input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID1 
NID2 
NID3 
NID4 
NID5 
NID6 
NID7 
NID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
 
 VARIABLE  
 
DESCRIPTION 
NSID 
Set ID of new node set.  All dual CESE node sets should have a 
unique set ID. 
NIDi 
Node ID i 

================================================================================
PAGE 320
================================================================================

*DUALCESE 
*DUALCESE_PART 
5-160 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_PART 
Purpose: Deﬁne dual CESE solver parts, that is, specify the dual CESE material and EOS 
information for a part.  It also provides a means to restrict the type of solver used on a 
region of a dual CESE mesh, meaning an immersed boundary FSI solver, a moving mesh 
FSI solver, or a non-FSI Eulerian solver can be speciﬁed for just this part. 
WARNING: As of version R14, this keyword is deprecated.  Instead, 
for the part ID and FSI solver details, use *DUAL-
CESE_MESH_PART.  For the material properties, use 
the *DUALCESE_SOLVER_... card corresponding to 
the choice made with *DUALCESE_SOLVER_SELEC-
TION. 
 
Part Cards.  Include one card for each dual CESE part.  This input ends at the next 
keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
MID 
EOSID 
FSITYPE 
MMSHID 
 
 
 
Type 
I 
I 
I 
A 
I 
 
 
 
Default 
none 
none 
none 
optional
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID (must be diﬀerent from any other *DUALCESE_PART, 
*DUALCESE_PART_MULTIPHASE, *DUALCESE_MESH_PART 
part ID) 
MID 
Material ID referring to a *DUALCESE_MAT_… material (see Re-
mark 1) 
EOSID 
Equation of state ID referring to a *DUALCESE_EOS_… EOS 
FSITYPE 
FSI type to use on this part: 
EQ.<BLANK>: If left blank, no FSI performed. 
EQ.IBM: 
Immersed boundary FSI solver 
EQ.MOVMESH: Moving mesh FSI solver (FSITYPE = MMM 
may also be used for the same eﬀect) 

================================================================================
PAGE 321
================================================================================

*DUALCESE_PART 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-161 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
MMSHID 
ID for the mesh motion algorithm to use for the moving mesh FSI
solver on this part (region of the current dual CESE mesh).  This ID 
refers to a *DUALCESE_CONTROL_MESH_MOV card ID. 
Remarks: 
1. 
MID for Inviscid Flows. Since material coeﬃcients are only used in viscous 
ﬂows, MID can be left blank for inviscid ﬂows.

================================================================================
PAGE 322
================================================================================

*DUALCESE 
*DUALCESE_PART_MULTIPHASE 
5-162 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_PART_MULTIPHASE 
Purpose: Deﬁne dual CESE multiphase solver parts, that is, specify the dual CESE mate-
rial and EOS information for a part.  It also provides a means to restrict the type of solver 
used on a region of a dual CESE mesh, meaning an immersed boundary FSI solver, a 
moving mesh FSI solver, or a non-FSI Eulerian solver can be speciﬁed for just this part. 
WARNING: As of version R14, this keyword is deprecated.  Instead, 
for the part ID and FSI solver details, use *DUAL-
CESE_MESH_PART. For the material properties, use 
the *DUALCESE_SOLVER_... card corresponding to 
the choice made with *DUALCESE_SOLVER_SELEC-
TION. 
 
Part Cards. Include one card for each dual CESE multiphase solver part.  This input 
ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
REACT_ID
EOSSID 
MID 
FSITYPE 
MMSHID 
 
 
Type 
I 
I 
I 
I 
A 
I 
 
 
Default 
none 
none 
none 
none 
optional
0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID (must be diﬀerent from any PID on a *DUALCESE_PART, 
*DUALCESE_PART_MULTIPHASE, 
*DUALCESE_MESH_-
PART card) 
REACT_ID 
ID of chemical reaction rate model (see *DUALCESE_REAC-
TION_RATE_... cards) 
EOSSID 
Set ID of multiphase EOS set speciﬁcation (see *DUALCESE_-
EOS_SET) 
MID 
Material ID deﬁned by a *DUALCESE_MAT_… card 

================================================================================
PAGE 323
================================================================================

*DUALCESE_PART_MULTIPHASE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-163 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
FSITYPE 
FSI type to use on this part: 
EQ.<BLANK>: If left blank, no FSI is performed.  
EQ.IBM: 
Immersed boundary FSI solver 
EQ.MOVMESH: Moving mesh FSI solver (FSITYPE = MMM 
may also be used for the same eﬀect) 
MMSHID 
ID of the mesh motion algorithm to use for the moving mesh FSI
solver on this part (region of the current dual CESE mesh).  This
ID refers to a *DUALCESE_CONTROL_MESH_MOV card ID. 

================================================================================
PAGE 324
================================================================================

*DUALCESE 
*DUALCESE_POINTSET 
5-164 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_POINTSET 
Purpose:  Deﬁne a list of points used to output at speciﬁed sample times variables from 
the chosen dual CESE solver to binary database binout. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PNTSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Point Cards.  Provide as many cards as necessary.  This input ends at the next keyword 
(“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
X 
Y 
Z 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PNTSID 
ID for this point set which can be used by *DUALCESE_DATA-
BASE_HISTORY_POINT_SET 
X, Y, Z 
Coordinates of a point.  As many points as desired can be speci-
ﬁed 

================================================================================
PAGE 325
================================================================================

*DUALCESE_POINT_SOURCE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-165 (DUALCESE) 
*DUALCESE_POINT_SOURCE 
Purpose:  For the dual CESE compressible ﬂow solver, deﬁne values at a point source 
(inside the ﬂuid mesh) for mass ﬂow rate, magnitude of velocity, density, pressure, and 
temperature. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the position and direction where an injected point source is to 
be applied. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each point source to be speciﬁed include one set of cards.  This input ends at the next 
keyword (“*”) card. 
Card Summary: 
Card 1.  This card is required. 
NSID 
 
 
 
 
 
 
 
Card 2.  This card is required. 
LC_MRTE 
LC_V 
LC_RHO 
LC_P 
LC_T 
 
 
 
Card 3.  This card is required. 
SF_MRTE 
SF_V 
SF_RHO 
SF_P 
SF_T 
 
 
 

================================================================================
PAGE 326
================================================================================

*DUALCESE 
*DUALCESE_POINT_SOURCE 
5-166 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NSID 
The ID of a *DUALCESE_POINT_SOURCE_STRUCTNODE_SET 
card to determine where the point source values in this card should 
be set. 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_MRTE
LC_V 
LC_RHO 
LC_P 
LC_T 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
0 
0 
0 
0 
0 
 
 
 
Remarks 
1 
1 
1 
1 
1 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_MRTE 
Load curve ID (see *DEFINE_CURVE) to describe the mass ﬂow 
rate as a function of time. 
EQ.0: Mass ﬂow rate is a constant with value SF_MRTE. 
EQ.-1: Mass ﬂow rate is computed by the solver. 
LC_V 
Load curve ID to describe the magnitude of the velocity as a func-
tion of time. 
EQ.0: The magnitude of velocity is a constant with value SF_V.
EQ.-1: The magnitude of velocity is computed by the solver. 

================================================================================
PAGE 327
================================================================================

*DUALCESE_POINT_SOURCE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-167 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
LC_RHO 
Load curve ID to describe the density as a function of time. 
EQ.0: Density is a constant with value SF_RHO. 
EQ.-1: Density is computed by the solver. 
LC_P 
Load curve ID to describe the pressure as a function of time. 
EQ.0: Pressure is a constant with value SF_P. 
EQ.-1: Pressure is computed by the solver. 
LC_T 
Load curve ID to describe the temperature as a function of time. 
EQ.0: Temperature is a constant with value SF_T. 
EQ.-1: Temperature is computed by the solver. 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_MRTE
SF_V 
SF_RHO 
SF_P 
SF_T 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
1.0 
1.0 
1.0 
1.0 
1.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_MRTE 
Scale factor for LC_MRTE 
SF_V 
Scale factor for LC_V  
SF_RHO 
Scale factor for LC_RHO  
SF_P 
Scale factor for LC_P 
SF_T 
Scale factor for LC_T  
Remarks: 
1. 
Consistent ﬂow injection values. On each point source, the variables (푚푟푎푡푒, 푣, 
휌, 푃, 푇) that are given values must be consistent and make the model well-posed 
(meaning be such that the solution of the model exists, is unique, and is physi-
cal).

================================================================================
PAGE 328
================================================================================

*DUALCESE 
*DUALCESE_POINT_SOURCE_TWO-PHASE 
5-168 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_POINT_SOURCE_TWO-PHASE 
Purpose:  For the dual CESE compressible two-phase multiphase ﬂow solver, this key-
word speciﬁes values at a point source (inside the ﬂuid mesh) for the mass ﬂow rate, 
volume fraction of material 1, magnitude of the velocity, density of material 1, density of 
material 2, pressure, and temperature. 
Card Sets: 
A set of data cards for this keyword consists of 3 of the following cards: 
1. 
Card 1 speciﬁes the position and direction where an injected point source is to 
be applied. 
2. 
Card 2 reads in load curve IDs. 
3. 
Card 3 reads in scale factors. 
For each point source to be speciﬁed, include one set of cards.  This input ends at the next 
keyword (“*”) card. 
Card Summary: 
Card 1.  This card is required. 
NSID 
 
 
 
 
 
 
 
Card 2.  This card is required. 
LC_MRTE 
LC_Z1 
LC_V 
LC_D1 
LC_D2 
LC_P 
LC_T 
 
Card 3.  This card is required. 
SF_MRTE 
SF_Z1 
SF_V 
SF_D1 
SF_D2 
SF_P 
SF_T 
 

================================================================================
PAGE 329
================================================================================

*DUALCESE_POINT_SOURCE_TWO-PHASE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-169 (DUALCESE) 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NSID 
ID of a *DUALCESE_POINT_SOURCE_STRUCTNODE_SET 
where the point source values in this card should be set. 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LC_MRTE
LC_Z1 
LC_V 
LC_D1 
LC_D2 
LC_P 
LC_T 
 
Type 
I 
I 
I 
I 
I 
I 
I 
 
Default 
0 
0 
0 
0 
0 
0 
0 
 
Remarks 
1 
1 
1 
1 
1 
1 
1 
 
 
 VARIABLE  
 
DESCRIPTION 
LC_MRTE 
Load curve ID (see *DEFINE_CURVE) to describe the mass ﬂow 
rate as a function of time. 
EQ.0: Constant mass ﬂow rate with value SF_MRTE 
EQ.-1: The solver computes the mass ﬂow rate. 
LC_Z1 
Load curve ID to describe the magnitude of the volume fraction of 
material 1 as a function of time. 
EQ.0: Constant volume fraction for material 1 with value SF_Z1
EQ.-1: The solver computes the volume fraction of material 1. 

================================================================================
PAGE 330
================================================================================

*DUALCESE 
*DUALCESE_POINT_SOURCE_TWO-PHASE 
5-170 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
LC_V 
Load curve ID to describe the magnitude of the velocity as a func-
tion of time. 
EQ.0: Constant magnitude of velocity with value SF_V 
EQ.-1: The solver computes the magnitude of velocity. 
LC_D1 
Load curve ID to describe the density of material 1 as a function of
time. 
EQ.0: Constant density for material 1 with value SF_D1 
EQ.-1: The solver computes the density of material 1. 
LC_D2 
Load curve ID to describe the density of material 2 as a function of
time. 
EQ.0: Constant density for material 2 with value SF_D2 
EQ.-1: The solver computes the density of material 2. 
LC_P 
Load curve ID to describe the pressure as a function of time. 
EQ.0: Constant pressure is a constant with value SF_P 
EQ.-1: The solver computes the pressure. 
LC_T 
Load curve ID to describe the temperature as a function of time. 
EQ.0: Constant temperature with value SF_T 
EQ.-1: The solver computes the temperature. 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SF_MRTE
SF_Z1 
SF_V 
SF_D1 
SF_D2 
SF_P 
SF_T 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
1.0 
 
 
 VARIABLE  
 
DESCRIPTION 
SF_MRTE 
Scale factor for LC_MRTE 
SF_Z1 
Scale factor for LC_Z1 

================================================================================
PAGE 331
================================================================================

*DUALCESE_POINT_SOURCE_TWO-PHASE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-171 (DUALCESE) 
 VARIABLE  
 
DESCRIPTION 
SF_V 
Scale factor for LC_V  
SF_D1 
Scale factor for LC_D1  
SF_D2 
Scale factor for LC_D2  
SF_P 
Scale factor for LC_P 
SF_T 
Scale factor for LC_T  
Remarks: 
1. 
Consistent ﬂow injection values. On each point source, the variables (푚푟푎푡푒,  
푧1, 푣, 휌1, 휌2, 푃, 푇) that are given values must be consistent and make the model 
well-posed (meaning be such that the solution of the model exists, is unique, and 
is physical).

================================================================================
PAGE 332
================================================================================

*DUALCESE 
*DUALCESE_POINT_SOURCE_STRUCTNODE_SET 
5-172 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_POINT_SOURCE_STRUCTNODE_SET 
Purpose:  Provide the position, direction, and size (area of the oriﬁce) of a ﬂow to be 
injected into a background ﬂow ﬁeld. 
 
Node Set ID Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Oriﬁce Deﬁnition Card. Include as many cards as needed.  This input ends at the next 
keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID 
VID 
ORIFA 
 
 
 
 
 
Type 
I 
I 
F 
 
 
 
 
 
Default 
none 
none 
1.0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NSID 
ID of this set of oriﬁce deﬁnitions 
NID 
Structural node that gives the position of the oriﬁce 
VID 
ID of a vector deﬁned by *DEFINE_VECTOR that gives the direc-
tion of the ﬂow away from the position deﬁned by NID 
ORIFA 
Surface area of the oriﬁce 

================================================================================
PAGE 333
================================================================================

*DUALCESE_POROUS_MODEL 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-173 (DUALCESE) 
*DUALCESE_POROUS_MODEL 
Purpose: Specify the method for treating porous media ﬂow in porous media ﬂuid-struc-
ture interaction.  Although the literature contains several methods, currently only the 
jump condition method is available.  Other methods may be added in the future.   
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
METHOD 
 
 
 
 
 
 
 
Type 
C 
 
 
 
 
 
 
 
Default 
JUMP 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
METHOD 
Method for modeling the porous-media interface: 
EQ.JUMP: Jump method (default).  See *DUALCESE_PO-
ROUS_SPECIFY_JUMP. 
Remarks: 
1. 
Availability. The porous media ﬂow capability is available for single-ﬂuid FSI-
IBM and two-phase FSI-IBM solvers including for viscous and inviscid ﬂows.

================================================================================
PAGE 334
================================================================================

*DUALCESE 
*DUALCESE_POROUS_SPECIFY_JUMP 
5-174 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_POROUS_SPECIFY_JUMP 
Purpose: Specify the properties of the porous media used in the jump method (see *DU-
ALCESE_POROUS_MODEL).  These properties include the structural part or part set of 
the porous medium, the thickness of the medium, and the model for mimicking the po-
rosity of the materials. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
THICKNSS
EQID 
 
 
 
 
 
Type 
I 
F 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Structural part ID of the porous medium 
THICKNSS 
Thickness of the medium 
EQID 
ID of the equation used to model the porous medium (see *DUAL-
CESE_DARCY-FORCHHEIMER_EQ) 

================================================================================
PAGE 335
================================================================================

*DUALCESE_REACTION_RATE_IG 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-175 (DUALCESE) 
*DUALCESE_REACTION_RATE_IG 
Purpose:  Deﬁne a reaction rate law for the Ignition and Growth model to describe the 
conversion of reactants to products in the modeling of a condensed phase explosive in a 
dual CESE multiphase model.  See Michael and Nikiforakis 2016 and Tarver 2005 for de-
tails about this law. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
REACT_ID
IGN 
AA 
BB 
XX 
GROW1 
CC 
DD 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
YY 
GROW2 
EE 
GG 
ZZ 
IGMAX 
G1MAX 
G2MAX 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
REACT_ID 
ID of reaction rate law 
IGN 
Reaction ignition term parameter, 퐼 
AA 
Reaction ignition term parameter, 푎 
BB 
Reaction ignition term parameter, 푏 
XX 
Reaction ignition term parameter, 푥 
GROW1 
Reaction growth term parameter, 퐺1 
CC 
Reaction growth term parameter, 푐 
DD 
Reaction growth term parameter, 푑 
YY 
Reaction growth term parameter, 푦 

================================================================================
PAGE 336
================================================================================

*DUALCESE 
*DUALCESE_REACTION_RATE_IG 
5-176 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
GROW2 
Reaction completion term parameter, 퐺2 
EE 
Reaction completion term parameter, 푒 
GG 
Reaction completion term parameter, 푔 
ZZ 
Reaction completion term parameter, 푧 
IGMAX 
Maximum mass fraction of the product for reaction ignition term,
ΦIGmax 
G1MAX 
Maximum mass fraction of the product for reaction growth term, 
ΦG1max 
G2MAX 
Maximum Φ for reaction completion term, ΦG2max 
Remarks: 
 
Using the notation of Michael and Nikiforakis 2016, the reaction rate law can be given as: 
푑Φ
푑푡= 퐼(1 −Φ)푏(휌−1 −푎)푥퐻(ΦIGmax −Φ)
+ 퐺1(1 −Φ)푐Φ푑푝푦퐻(ΦG1max −Φ) + 퐺2(1 −Φ)푒Φ푔푝푧퐻(Φ −ΦG2max) 
where 퐻 is the Heaviside function.  Here Φ is the mass fraction of the products, 푝 is the 
pressure, and 휌 is the density of the explosive mixture.  Note that the pressure is assumed 
to be in equilibrium between the phases. 퐼, 퐺1, 퐺2, 푎, 푏, 푐, 푑, 푒, 푔, 푥, 푦, and 푧 are constants.  
They depend on the explosive as well as the part of the detonation process being mod-
eled; see Michael and Nikiforakis 2016 for details.  
 
The constants ΦIGmax, ΦG1max, and ΦG2max in the Heavyside functions indicate when each 
of the three stages of the reaction are dominant.  It was developed by Tarver 2005 to de-
scribe the reaction of pressed solid explosives during shock initiation and detonation.  
Tarver 2005 developed this reaction law for pressed solid explosives to describe the ob-
served reaction stages during shock initiation and detonation See Tarver 2005 for a de-
scription of each stage of the reaction.

================================================================================
PAGE 337
================================================================================

*DUALCESE_REACTION_RATE_IG_REDUCED 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-177 (DUALCESE) 
*DUALCESE_REACTION_RATE_IG_REDUCED 
Purpose:  Deﬁne a reduced form reaction rate law compared to that deﬁned with *DU-
ALCESE_REACTION_RATE_IG for describing the conversion of reactants to products in 
the modeling of a condensed phase explosive in a dual CESE multiphase model.  See 
Michael and Nikiforakis 2016 for details about this reaction rate law. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
REACT_ID
GROW1 
CC 
DD 
YY 
PHI0 
 
 
Type 
I 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
REACT_ID 
ID of reaction rate law 
GROW1 
Reaction growth term parameter, 퐺1 
CC 
Reaction growth term parameter, 푐 
DD 
Reaction growth term parameter, 푑 
YY 
Reaction growth term parameter, 푦 
PHI0 
Additional parameter to account for the non-zero amount of reac-
tion when the mass fraction of the products, 휙, is zero 
Remarks: 
Michael and Nikiforakis 2016 simpliﬁed the Ignition and Growth model reaction law to 
a pressure dependent law with a single stage to make the reduced model.  They excluded 
the ﬁrst and third terms from the Ignition and Growth model to makes this law.  How-
ever, to account for a ﬁnite amount of reaction from ignition when 휙 is zero, they added 
a constant 휙0. This reduced law has the form: 
푑휙
푑푡= 퐺1(1 −휙)푐(휙+ 휙0)푑푝푦  . 
All the parameters are the same as the Ignition and Growth model except Φ0. See *DU-
ALCESE_REACTION_RATE_IG and Michael and Nikiforakis 2016 for details.

================================================================================
PAGE 338
================================================================================

*DUALCESE 
*DUALCESE_REACTION_RATE_P_DEPEND 
5-178 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_REACTION_RATE_P_DEPEND 
Purpose:  Deﬁne an explicitly pressure-dependent reaction rate law for describing the 
conversion of reactants to products in the modeling of a condensed phase explosive in a 
dual CESE multiphase model.  This law is from Banks et al 2008. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
REACT_ID
SIGMA 
NU 
N 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
REACT_ID 
ID of reaction rate law 
SIGMA 
A positive constant, 휎 
NU 
A positive constant, 휈 
N 
A positive constant, 푛 
Remarks: 
Using the notation of Michael and Nikiforakis 2016, this simple pressure dependent re-
action rate law by Banks et al 2008 can be stated as: 
푑휙
푑푡= 휎휙휈푝푛 
Here 휙 is the mass fraction of the products, 푝 is the pressure, and 휎, 휈, and 푛 are positive 
constants found from experimental data.  As discussed by Banks et al 2008, this type of 
reaction rate law that depends explicitly on pressure is often preferred for modeling the 
detonation of solid explosives because the constants can be found by ﬁtting experimental 
data and other physical variables are diﬃcult to measure.

================================================================================
PAGE 339
================================================================================

*DUALCESE_SEGMENTSET 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-179 (DUALCESE) 
*DUALCESE_SEGMENTSET 
Purpose:  Deﬁne a set of segments.  For three-dimensional geometries, a segment can be 
triangular or quadrilateral.  For two-dimensional geometries, a segment is a line deﬁned 
by two nodes. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Segment Cards.  For each segment in the set include one card of this format.  Include as 
many cards as necessary.  This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SID 
Set ID.  All segment sets should have a unique set ID. 
N1 
Nodal point 푛1 
N2 
Nodal point 푛2 
N3 
Nodal point 푛3.  To deﬁne a line segment, set N3 = N2. 
N4 
Nodal point 푛4.  To deﬁne a triangular segment, set N4 = N3. To 
deﬁne a line segment, set N4 = N2.
 
FACE 
Hexahedron 
Pentahedron 
Pyramid 
Tetrahedron 
1 
N1, N5, N8, N4 
N1, N2, N5 
N1, N4, N3, N2 
N1, N2, N4 
2 
N2, N3, N7, N6 
N4, N6, N3 
N1, N2, N5 
N2, N3, N4 

================================================================================
PAGE 340
================================================================================

*DUALCESE 
*DUALCESE_SEGMENTSET 
5-180 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
FACE 
Hexahedron 
Pentahedron 
Pyramid 
Tetrahedron 
3 
N1, N2, N6, N5 
N1, N4, N3, N2 
N2, N3, N5 
N1, N3, N2 
4 
N4, N8, N7, N3 
N2, N3, N6, N5 
N3, N4, N5 
N1, N4, N3 
5 
N1, N4, N3, N2 
N1, N5, N6, N4 
N4, N1, N5 
 
6 
N5, N6, N7, N8 
 
 
 
Table 5-1.  Face deﬁnitions for volume dual CESE elements

================================================================================
PAGE 341
================================================================================

*DUALCESE_SOLVER_SELECTION 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-181 (DUALCESE) 
*DUALCESE_SOLVER_SELECTION 
Purpose:  Set general purpose control variables for the dual CESE compressible ﬂow 
solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EQNS 
 
 
 
 
 
 
 
Type 
A 
 
 
 
 
 
 
 
Default 
EULER
 
 
 
 
 
 
 
Remark 
1 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EQNS 
Select the equations being solved with the dual CESE solver: 
EQ.CAVITATION: 
Cavitation solver 
EQ.EULER: 
Euler equations 
EQ.HYBRID: 
Hybrid multiphase model 
EQ.NS: 
Navier-Stokes equations 
EQ.PHASE-CHNG: Phase change model 
EQ.TWO-PHASE: Two-phase multiphase model 
Remarks: 
1. 
Dual CESE Solver and Restarts. The dual CESE solver is not currently sup-
ported for restarts.

================================================================================
PAGE 342
================================================================================

*DUALCESE 
*DUALCESE_SOLVER_CAV_EQNS 
5-182 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_SOLVER_CAV_EQNS 
Purpose: Set the properties of the cavitating ﬂow mixture being solved with the cavitation 
solver. 
 
Property Card.  Include one card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state (EOS) ID that must refer to an EOS deﬁned with 
*DUALCESE_EOS_CAV_HOMOG_EQUILIB  

================================================================================
PAGE 343
================================================================================

*DUALCESE_SOLVER_EULER_EQNS 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-183 (DUALCESE) 
*DUALCESE_SOLVER_EULER_EQNS 
Purpose: Set the properties of the gas ﬂow being solved with the Euler equations solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state (EOS) ID that refers to an EOS deﬁned by one of 
the following keywords: *DUALCESE_EOS_IDEAL_GAS, *DU-
ALCESE_EOS_INFLATOR1, or *DUALCESE_EOS_INFLATOR2.

================================================================================
PAGE 344
================================================================================

*DUALCESE 
*DUALCESE_SOLVER_HYBRID_MULTIPHASE 
5-184 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_SOLVER_HYBRID_MULTIPHASE 
Purpose: Deﬁne the properties of the ﬂuid and condensed phase materials via equations-
of-state that are used together to compute the thermodynamic state in the hybrid multi-
phase dual CESE solver.  Also, specify the single-step reaction rate model for the chemical 
reactions. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSINID EOSRCTID EOSPRDID REACT_ID
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
Remark 
1 
1 
1 
2 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSINID 
EOS ID of the inert component of the multiphase mixture 
EOSRCTID 
EOS ID of the reactant phase of the multiphase mixture 
EOSPRDID 
EOS ID of the product phase of the multiphase mixture 
REACT_ID 
ID of chemical reaction rate model 
Remarks: 
1. 
Supported EOS Types.  Each EOS can be one of the following types: 
*DUALCESE_EOS_IDEAL_GAS 
*DUALCESE_EOS_STIFFENED_GAS 
*DUALCESE_EOS_VAN_DER_WAALS_GENERALIZED 
*DUALCESE_EOS_COCHRAN_CHAN 
*DUALCESE_EOS_JWL. 
2. 
Supported Reaction Rate Types.  The reaction rate can be one of the following 
types:  

================================================================================
PAGE 345
================================================================================

*DUALCESE_SOLVER_HYBRID_MULTIPHASE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-185 (DUALCESE) 
*DUALCESE_REACTION_REAT_IG 
*DUALCESE_REACTION_RATE_IG_REDUCED 
*DUALCESE_REACTION_RATE_P_DEPEND

================================================================================
PAGE 346
================================================================================

*DUALCESE 
*DUALCESE_SOLVER_NAVIER_STOKES 
5-186 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_SOLVER_NAVIER_STOKES 
Purpose: Set the properties of the ﬂuid ﬂow being solved with the Navier-Stokes equa-
tions solver.  That is, specify the dual CESE material and EOS information to be used. 
 
Property Card.  Include one card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
MID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
Equation of state (EOS) ID referring to an EOS deﬁned by one of 
the following card types: *DUALCESE_EOS_IDEAL_GAS, *DU-
ALCESE_EOS_INFLATOR1, or *DUALCESE_EOS_INFLATOR2.
MID 
Material ID referring to a *DUALCESE_MAT_… material card (see 
Remark 1) 
Remarks: 
1. 
MID for Inviscid Flows. Since material coeﬃcients are only used in viscous 
ﬂows, MID can be left blank for inviscid ﬂows.

================================================================================
PAGE 347
================================================================================

*DUALCESE_SOLVER_PHASE_CHANGE 
*DUALCESE 
R16@bdccd6d07 (03/10/25) 
5-187 (DUALCESE) 
*DUALCESE_SOLVER_PHASE_CHANGE 
Purpose:  Deﬁne the properties of the ﬂuid and condensed phase materials via 
equations of state that are used together to compute the thermodynamic state 
in the phase change multiphase dual CESE solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSIDL 
EOSIDV 
EOSIDO 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
Remarks 
1 
1 
1 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSIDL 
Equation of state (EOS) ID of the liquid component in the multi-
phase mixture 
EOSIDV 
Equation of state (EOS) ID of the vapor component in the multi-
phase mixture 
EOSIDO 
Equation of state (EOS) ID of the other gases in the multiphase mix-
ture 
Remarks: 
1. 
Available EOS models. Each EOS can be one of the following types: 
*DUALCESE_EOS_NASG

================================================================================
PAGE 348
================================================================================

*DUALCESE 
*DUALCESE_SOLVER_TWO-PHASE_MULTIPHASE 
5-188 (DUALCESE) 
R16@bdccd6d07 (03/10/25) 
*DUALCESE_SOLVER_TWO-PHASE_MULTIPHASE 
Purpose: Deﬁne the properties of the ﬂuid phase materials through equations-of-state 
that are used together to compute the thermodynamic state in the two-phase multiphase 
dual CESE solver.  This solver does not compute phase changes. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID1 
EOSID2 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
Remarks 
1 
1 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID1 
EOS ID of the ﬁrst inert component of the multiphase mixture 
EOSID2 
EOS ID of the second inert component of the multiphase mixture
Remarks: 
1. 
Supported EOS Types.  Each EOS can be one of the following types: 
*DUALCESE_EOS_IDEAL_GAS 
*DUALCESE_EOS_STIFFENED_GAS 
*DUALCESE_EOS_VAN_DER_WAALS_GENERALIZED 
*DUALCESE_EOS_COCHRAN_CHAN 
*DUALCESE_EOS_JWL

================================================================================
PAGE 349
================================================================================

*EM 
*EM 
R16@bdccd6d07 (03/10/25) 
6-1 (EM) 
*EM 
 
The *EM keyword cards provide input for the electromagnetism module.  This module 
is for solving 3D eddy-current, inductive heating or resistive heating problems.  It can be 
coupled with the mechanical and thermal solvers.  Typical applications include magnetic 
metal forming and welding.  This module also includes coupling the boundary element 
method to the ﬁnite element method coupling.  We intend this coupling for simulations 
involving a conductor interacting with air so that the air does not need to be meshed.  The 
conductor is modeled with ﬁnite elements while the air is modeled with boundary ele-
ments. 
*EM_2DAXI 
*EM_BOUNDARY 
*EM_BOUNDARY_PRESCRIBED 
*EM_CIRCUIT 
*EM_CIRCUIT_CONNECT 
*EM_CIRCUIT_ROGO 
*EM_CIRCUIT_SOURCE 
*EM_CONTACT 
*EM_CONTACT_RESISTANCE 
*EM_CONTACT_SUBDOM 
*EM_CONTROL 
*EM_CONTROL_CONTACT 
*EM_CONTROL_COUPLING 
*EM_CONTROL_EROSION 
*EM_CONTROL_MAGNET 
*EM_CONTROL_SOLUTION 
*EM_CONTROL_SWITCH 
*EM_CONTROL_SWITCH_CONTACT 

================================================================================
PAGE 350
================================================================================

*EM 
*EM 
6-2 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CONTROL_TIMESTEP 
*EM_DATABASE_CIRCUIT 
*EM_DATABASE_CIRCUIT0D 
*EM_DATABASE_CIRCUITSOURCE 
*EM_DATABASE_ELOUT 
*EM_DATABASE_FIELDLINE 
*EM_DATABASE_GLOBALENERGY 
*EM_DATABASE_NODOUT 
*EM_DATABASE_PARTDATA 
*EM_DATABASE_POINTOUT 
*EM_DATABASE_ROGO 
*EM_DATABASE_TIMESTEP 
*EM_EP_CELLMODEL_DEFINE_FUNCTION 
*EM_EP_CELLMODEL_FENTONKARMA 
*EM_EP_CELLMODEL_FIZHUGHNAGUMO 
*EM_EP_CELLMODEL_TENTUSSCHER 
*EM_EP_CELLMODEL_TOMEK 
*EM_EP_CELLMODEL_TOR_ORD 
*EM_EP_CELLMODEL_USERMAT 
*EM_EP_CREATEFIBERORIENTATION 
*EM_EP_ECG 
*EM_EP_EIKONAL 
*EM_EP_ISOCH 
*EM_EP_LAPLACE_DIRICHLET 
*EM_EP_PURKINJE_NETWORK 
*EM_EP_TENTUSSCHER_STIMULUS 

================================================================================
PAGE 351
================================================================================

*EM 
*EM 
R16@bdccd6d07 (03/10/25) 
6-3 (EM) 
*EM_EOS_BURGESS 
*EM_EOS_MEADON 
*EM_EOS_PERMEABILITY 
*EM_EOS_TABULATED1 
*EM_EOS_TABULATED2 
*EM_EXTERNAL_FIELD 
*EM_ISOPOTENTIAL 
*EM_ISOPOTENTIAL_CONNECT 
*EM_ISOPOTENTIAL_ROGO 
*EM_MAT_001 
*EM_MAT_002 
*EM_MAT_003 
*EM_MAT_004 
*EM_MAT_005 
*EM_MAT_006 
*EM_OUTPUT 
*EM_OUTPUT_FORCES 
*EM_OUTPUT_VTK 
*EM_PERMANENT_MAGNET 
*EM_POINT_SET 
*EM_RANDLES_BATMAC 
*EM_RANDLES_EXOTHERMIC_REACTION 
*EM_RANDLES_MESHLESS 
*EM_RANDLES_TSHELL 
*EM_RANDLES_SHORT 
*EM_RANDLES_SOLID 

================================================================================
PAGE 352
================================================================================

*EM 
*EM 
6-4 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_ROTATION_AXIS 
*EM_SOLVER_BEM 
*EM_SOLVER_BEMMAT 
*EM_SOLVER_FEM 
*EM_SOLVER_FEMBEM 
*EM_SOLVER_FEMBEM_MONOLITHIC

================================================================================
PAGE 353
================================================================================

*EM_2DAXI 
*EM 
R16@bdccd6d07 (03/10/25) 
6-5 (EM) 
*EM_2DAXI 
Purpose:  Sets up the electromagnetism solver as 2D axisymmetric instead of 3D, on a 
given part, in order to save computational time as well as memory. 
 
The electromagnetism is solved in 2D on a given cross section of the part (deﬁned by a 
segment set), with a symmetry axis deﬁned by its direction (at this time, it can be the 푥, 
푦, or 푧 axis).  The EM forces and Joule heating are then computed over the full 3D part by 
rotations.  The part needs to be compatible with the symmetry, i.e. each node in the part 
needs to be the child of a parent node on the segment set, by a rotation around the axis.  
Only the conductor parts (with a *EM_MAT_… of type 2 or 4) should be deﬁned as 2D 
axisymmetric. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
SSID 
 
 
STARSSID ENDSSID
NUMSEC 
 
Type 
I 
I 
 
 
I 
I 
I 
 
Default 
none 
none 
 
 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the part to be solved using 2D axisymmetry 
SSID 
Segment Set ID : Segment that will deﬁne the 2D cross section of 
the part where the EM ﬁeld is solved 
STARSSID, 
ENDSSID 
Used by the 2D axisymmetric solver to make the connection be-
tween two corresponding boundaries on each side of a slice when 
the model is a slice of the full 360 circle. 
NUMSEC 
Number of Sectors.  This ﬁeld gives the ratio of the full circle to the 
angular extension of the mesh.  This has to be a power of two.  For 
example, NUMSEC = 4 means that the mesh of the part represents 
one fourth of the total circle.  If this value is set to 0, then the value
from *EM_ROTATION_AXIS is used instead. 
Remarks: 
1. 
At this time, either all or none of the conductor parts should be 2D axisymmetric.  
In the future, a mix between 2D axisymmetric and 3D parts will be allowed.

================================================================================
PAGE 354
================================================================================

*EM 
*EM_BOUNDARY 
6-6 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_BOUNDARY 
Purpose:  Deﬁne some boundary conditions for the electromagnetism problems. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSID 
BTYPE 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSID 
Segment Set Id 
BTYPE 
EQ.9: The faces of this segment set are eliminated from the BEM 
calculations (used for example for the rear or side faces of
a workpiece). 
 
 

================================================================================
PAGE 355
================================================================================

*EM_BOUNDARY_PRESCRIBED 
*EM 
R16@bdccd6d07 (03/10/25) 
6-7 (EM) 
*EM_BOUNDARY_PRESCRIBED 
Purpose:  Prescribe a local boundary condition applied on nodes.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BPID 
BPTYPE 
SETTYPE 
SETID 
VAL 
LCID 
 
SYSTYPE
Type 
I 
I 
I 
I 
F 
I 
 
I 
Default 
none 
none 
none 
none 
0. 
0 
 
0 
 
Optional Card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BIRTHT 
DEATHT 
 
 
VAL2 
LCID2 
 
 
Type 
F 
F 
 
 
F 
I 
 
 
Default 
0. 
1.e28 
 
 
0. 
0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ISOID 
ID of the prescribed boundary 
BPTYPE 
Prescribed boundary type: 
EQ.1: Short (scalar potential set to 0.) 
EQ.2: Prescribed resistance (Robin B.C.) 
EQ.3: Prescribed scalar potential (Dirichlet B.C.) 
EQ.4: Prescribed current density (Neumann B.C.) 
SETTYPE 
Set type: 
EQ.1: Segment set 
EQ.2: Node set 
EQ.3: Fluid part (see *ICFD_PART) 
SETID 
Set ID 

================================================================================
PAGE 356
================================================================================

*EM 
*EM_BOUNDARY_PRESCRIBED 
6-8 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
VAL 
Value of the resistance, current density or potential depending on 
BPTYPE. Ignored if LCID is deﬁned. 
LCID 
Load curve ID deﬁning the value of the resistance, voltage, or cur-
rent as a function of time.  If a negative value is entered, a *DE-
FINE_FUNCTION will be expected.  The following parameters are
allowed: f(time, emdt, curr, pot, cond, temp, potglob, currglob, ar-
eaglob, area, x, y, z). Pot/curr/area and potglob/currglob/area-
glob are the local value of the scalar potential/current/area and
the global averaged value on the prescribed boundary, respect-
fully.  Cond is the local electrical conductivity, and x, y, and z are 
the local coordinates. 
SYSTYPE 
Flag for the type of system on which the boundary condition is ap-
plied (applies only for cardiac electrophysiology when *EM_-
BOUNDARY_PRESCRIBED is used with EMSOL = 11 or 12): 
EQ.0: Applied on extracellular potential 
EQ.1: Applied on transmembrane potential 
BIRTHT / 
DEATHT 
Birth and death times for that prescribed boundary 
VAL2 
Value of the impedance in radiofrequency problems to be used in 
conjunction with BPTYE = 2. 
LCID2 
Load curve ID for deﬁning the impedance value as a function of 
time.  It is only available in radiofrequency problems with BP-
TYPE = 2. 
Remarks: 
1. 
Supported solvers.  This keyword is currently only available for the resistive 
heating solver (EMSOL = 3) and the electrophysiology solvers (EMSOL = 11, 12, 
and 13).

================================================================================
PAGE 357
================================================================================

*EM_CIRCUIT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-9 (EM) 
*EM_CIRCUIT 
Purpose:  Deﬁne an electrical circuit. 
 
The solver type, set with EMSOL of *EM_CONTROL, determines how the current density 
in a circuit is modeled.  For example, for an eddy current solver, the diﬀusion of the cur-
rent in the circuit is considered.  To model a circuit with uniform current through its 
cross-section, see *EM_CIRCUIT_SOURCE.   
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CIRCID 
CIRCTYP 
LCID 
R/F 
L/A 
C/T0 
V0 
T0 
Type 
I 
I 
I 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
0. 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SIDCURR
SIDVIN 
SIDVOUT 
PID 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
Optional Card. This card is only read if CIRCTYP = 30. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VCUT 
R3 
L3 
R2 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
0. 
0. 
0. 
0. 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CIRCID 
Circuit ID 

================================================================================
PAGE 358
================================================================================

*EM 
*EM_CIRCUIT 
6-10 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
CIRCTYP 
Circuit type : 
EQ.1: Imposed current as a function of time set by a load curve.
EQ.2: Imposed voltage as a function of time speciﬁed by a load
curve.  If a negative value is entered for LCID, its abso-
lute value will refer to a DEFINE FUNCTION for a user-
deﬁned circuit equation.  If a DEFINE_FUNCTION is 
used, the following parameters are accepted: f(time, 
emdt, curr, curr1, curr2, pot1, pot2). emdt is the current 
timestep; curr, curr1, and curr2 refer to the current value 
at 푡, 푡−1, and 푡−2, respectfully; and pot1 and pot2 refer 
to the scalar potential at 푡−1 and 푡−2, respectfully. 
EQ.3: R, L, C, V0 circuit. 
EQ.11: Imposed current deﬁned by an amplitude 퐴, frequency 
퐹 and initial time 푡0: 퐼= 퐴sin[2휋퐹(푡−푡0)] 
EQ.12: Imposed voltage deﬁned by an amplitude 퐴, frequency 
퐹 and initial time 푡0: 푉= 퐴sin[2휋퐹(푡−푡0)] 
EQ.21: Imposed current deﬁned by a load curve over one period 
and a frequency 퐹.  See Remark 3. 
EQ.22: Imposed voltage deﬁned by a load curve over one period 
and a frequency 퐹.  See Remark 3. 
EQ.30: Modiﬁed version of R, L, C, V0 circuit that includes a di-
ode.  See Figure 6-1. 
LCID 
Load curve ID for CIRCTYP = 1, 2, 21, and 22 
R/F 
Value of the circuit resistance for CIRCTYP = 3 and 30. For CIRC-
TYP = 30, this part of the circuit is labeled R1 in Figure 6-1. 
Value of the frequency for CIRCTYP = 11, 12, 21, and 22. For CIRC-
TYP = 11 and 12, to have the frequency speciﬁed as a function of 
time with a load curve, a negative value can be entered with the 
absolute value corresponding to the load curve ID. 
L/A 
Value of the circuit inductance for CIRCTYP = 3 and 30. For CIRC-
TYP = 30, this part of the circuit is labeled L1 in Figure 6-1. 
Value of the amplitude for CIRCTYP = 11 and 12. To have the am-
plitude speciﬁed as a function of time with a load curve, a negative
value can be entered with the absolute value corresponding to the 
load curve ID. 
C/T0 
Value of the circuit capacity for CIRCTYP = 3 and 30. For CIRC-

================================================================================
PAGE 359
================================================================================

*EM_CIRCUIT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-11 (EM) 
 VARIABLE  
 
DESCRIPTION 
TYP = 30, this part of the circuit is labeled C1 in Figure 6-1. 
Value of the initial time 푡0 for CIRCTYP = 11 and 12. 
V0 
Value of the circuit initial voltage for CIRCTYP = 3 and 30. 
T0 
Starting time for CIRCTYP = 3. The default is the beginning of the 
run. 
SIDCURR 
Segment set ID for the current.  It uses the orientation given by the
normal of the segments.  To use the opposite orientation, use a '–' 
(minus) sign in front of the segment set ID. 
CIRCTYP.EQ.1/11/21: The current is imposed through this seg-
ment set. 
CIRCTYP.EQ.3/30: 
The current needed by the circuit equa-
tions is measured through this segment 
set. 
CIRCTYP.EQ.2/12/22: Optional segment set that the current is 
forced through.  See Remark 2. 
SIDVIN 
Segment set ID for input voltage when CIRCTYP = 2, 3, 30, 12, or 
22 or for input current when CIRCTYP = 1, 11, or 21. The input 
voltage or current is oriented to enter the structural mesh, irrespec-
tive of the orientation of the segments. 
SIDVOUT 
Segment set ID for output voltage when CIRCTYP = 2, 3, 30, 12, or 
22 or for output current when CIRCTYP = 1, 11, or 21. The output 
voltage or current is oriented to leave the structural mesh, irrespec-
tive of the orientation of the segment. 
PID 
Part ID associated with the circuit.  It is only mandatory when in-
cluding the second line of *EM_ROTATION_AXIS for the EM 2D 
axisymmetric solver. 
VCUT 
Cut oﬀ voltage for the diode, allowing the current to ﬂow or not. 
Setting this ﬁeld to a very large negative value eﬀectively means 
that the diode circuit branch is never triggered, causing CIRC-
TYP = 30 to revert to an R, L, C circuit with behavior similar to
CIRCTYP = 3. See Figure 6-1. 
R3/L3/R2 
Optional circuit resistance and inductance values for the diﬀerent 
branches for CIRCTYP = 30. See Figure 6-1. 

================================================================================
PAGE 360
================================================================================

*EM 
*EM_CIRCUIT 
6-12 (EM) 
R16@bdccd6d07 (03/10/25) 
Table 6-1. Correspondence between circuit type and card entries.  “M” indicates manda-
tory, “M*” mandatory with exceptions (see Remark 1), “O” optional, and “-” ignored. 
 
Circuit type (CIRCTYP) 
Variable 
 
Imposed 
1: current 
 
Imposed 
2: voltage 
3: R, L, C 
11: F, A, t0 
12: F, A, t0
LCID
M 
M 
- 
- 
- 
R/L/C/V0
- 
- 
M 
- 
- 
F
- 
- 
- 
M 
M 
A/T0
- 
- 
- 
M 
M 
SIDCURR
M 
O 
M 
M 
O 
SIDVIN
M* 
M 
M 
M* 
M 
SIDVOUT
M* 
M 
M 
M* 
M 
 
Circuit type (CIRCTYP) 
Variable 
21: LCID, F 
22: LCID, F 
 
R, L, C 
30: with diode  
 
LCID 
M 
M 
- 
 
 
R/L/C/V0 
- 
- 
M 
 
 
F 
M 
M 
- 
 
 
A/T0 
- 
- 
- 
 
 
SIDCURR 
M 
O 
M 
 
 
SIDVIN 
M* 
M 
M 
 
 
SIDVOUT 
M* 
M 
M 
 
 
 
 
Remarks: 
1. 
Imposed current with closed loop geometry.  For a circuit with an imposed 
current (CIRCTYP 1, 11, or 21) in a closed loop geometry (torus), SIDVIN and 
SIDVOUT cannot be speciﬁed.  Thus, only SIDCURR is necessary. 
R1
R3
L3
R2
C1
L1
Meshed 
Part
i1
V0
i2
i3
 
Figure 6-1.  CIRCTYP = 30 circuit sketch 

================================================================================
PAGE 361
================================================================================

*EM_CIRCUIT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-13 (EM) 
2. 
SIDCURR with imposed tension. For a circuit with an imposed tension (CIRC-
TYP 2, 12, 22), it is also possible to set SIDCURR. This can be useful in circuits 
where various ﬂow paths are possible for the current to force the entire current 
to go through SIDCURR. 
3. 
CIRCTYP = 21 and 22. Circuit types 21 and 22 are for cases where the periodic 
current/tension does not exactly follow a perfect sinusoidal.  You must provide 
the frequency and the shape of the current/tension over one period through a 
load curve. 
4. 
EMSOL = 4. Only CIRCTYP = 1 and 2 are available for the frequency-based 
Eddy current solver.  The values in the load curve represent the norm of the 
amplitude.  A time shift can optionally be deﬁned using T0. 
5. 
CIRCTYP = 30. This circuit type is only available for the Eddy current solver.  
When used, the output includes the current and voltage values of the diﬀerent 
branches.

================================================================================
PAGE 362
================================================================================

*EM 
*EM_CIRCUIT_CONNECT 
6-14 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CIRCUIT_CONNECT 
Purpose:  Connect several circuits together by imposing a linear constraint on the global 
currents of circuit pairs. 
푐1푖1 + 푐2푖2 = 0. 
This feature is especially useful for 2D axisymmetric models involving spiral or helical 
coils. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CONID 
CONTYPE
CIRC1 
CIRC2 
C1 
C2 
 
 
Type 
I 
I 
I 
I 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CONID 
ID of the circuit connect 
CONTYPE 
Connection type between circuits: 
EQ.1: If CIRC2 already has a global condition on its current, 푖2, 
(see *EM_CIRCUIT), that global condition takes prece-
dence over the constraint deﬁned by the circuit connect. 
EQ.2: The condition deﬁned by circuit connect takes precedence 
in the case of conﬂicting constraints (for example CIRC2 
also has an imposed current deﬁned by *EM_CIRCUIT). 
CIRC1 
ID of the ﬁrst circuit 
CIRC2 
ID of the second circuit 
C1/C2 
Values of the linear constraints 

================================================================================
PAGE 363
================================================================================

*EM_CIRCUIT_ROGO 
*EM 
R16@bdccd6d07 (03/10/25) 
6-15 (EM) 
*EM_CIRCUIT_ROGO 
Purpose:  Deﬁne Rogowsky coils to measure a global current versus time through a seg-
ment set or a node set. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ROGID 
SETID 
SETTYPE 
CURTYP 
PID 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
0 
0 
0 
0 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ROGID 
Rogowsky coil ID 
SETID 
Segment or node set ID 
SETTYPE 
Type of set: 
EQ.1: Segment set 
EQ.2: Node set (not available yet} 
CURTYP 
Type of current measured: 
EQ.1: Volume current 
EQ.2: Surface current (not available yet} 
EQ.3: Magnetic ﬁeld ﬂux (B ﬁeld times Area) 
PID 
Part ID. It is only available for 2D axisymmetric Eddy current cases.
See Remark 2. 
Remarks: 
1. 
Output. An ASCII ﬁle em_rogo_xxx, with xxx being the ROGID, is generated for 
each *EM_CIRCUIT_ROGO card.  This ﬁle contains the value of the current or 
the magnetic ﬁeld versus time for that Rogowsky coil. 
2. 
Special input for 2D axisymmetric Eddy current problems. When the second 
line of *EM_ROTATION_AXIS is used, a simpliﬁed input for 2D axisymmetric 

================================================================================
PAGE 364
================================================================================

*EM 
*EM_CIRCUIT_ROGO 
6-16 (EM) 
R16@bdccd6d07 (03/10/25) 
Eddy current problems becomes available.  This case does not require specifying 
segment sets through the cross sections.  Instead, if segment sets are unavailable, 
provide the part ID of the 2D axisymmetric part as PID to associate it with a 
Rogowsky coil.

================================================================================
PAGE 365
================================================================================

*EM_CIRCUIT_SOURCE 
*EM 
R16@bdccd6d07 (03/10/25) 
6-17 (EM) 
*EM_CIRCUIT_SOURCE 
Purpose:  Deﬁne a circuit with uniform current through its cross-section. 
 
This feature generally helps model stranded conductors carrying a source current (in 
which case Amperes become Ampere-turns).  This feature can also help save computa-
tional time in models with a low-frequency current and where the diﬀusion of the EM 
ﬁelds is a very fast process.  In contrast, when using *EM_CIRCUIT, the current density 
in a circuit is modeled in accordance with the solver type deﬁned in EMSOL of *EM_-
CONTROL. For example, using an eddy current solver causes considering the diﬀusion 
of the current in the circuit.  See Remark 2 for a discussion of the available circuit types 
for source circuits. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CIRCID 
CIRCTYP 
LCID 
R/F 
T/A 
T0 
 
 
Type 
I 
I 
I 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SIDCURR
SIDVIN 
SIDVOUT 
PARTID 
IFREQST 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
none 
none 
none 
none 
1 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CIRCID 
Circuit ID 
CIRCTYP 
Circuit type : 
EQ.1: Imposed current as a function of time speciﬁed by a load 
curve. 
EQ.2: Imposed voltage as a function of time given by a load 
curve.  

================================================================================
PAGE 366
================================================================================

*EM 
*EM_CIRCUIT_SOURCE 
6-18 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.11: Imposed current deﬁned by an amplitude 퐴, frequency 
퐹 and initial time 푡0: 퐼= 퐴sin[2휋퐹(푡−푡0)] 
LCID 
Load curve ID for CIRCTYP = 1 or 2. See Remark 3. 
R/F 
Value of the frequency for CIRCTYP = 11. To have the frequency 
speciﬁed as a function of time with a load curve, a negative value
can be entered with the absolute value corresponding to the load
curve ID. 
Value of the resistance when using an imposed voltage (CIRC-
TYPE = 2). 
T/A 
Value of the amplitude for CIRCTYP = 11. To have the amplitude 
speciﬁed as a function of time with a load curve, a negative value
can be entered with the absolute value corresponding to the load
curve ID.  See Remark 3. 
Number of turns when using an imposed voltage (CIRCTYPE = 2).
T0 
Value of the initial time, 푡0, for CIRCTYP = 11 
SIDCURR 
Segment set ID for the current.  It uses the orientation given by the
normal of the segments.  To use the opposite orientation, use a '–' 
(minus) sign in front of the segment set ID or reorient the face nor-
mals. 
SIDVIN 
Segment set ID for input voltage when CIRCTYP = 2 or for input 
current when CIRCTYP = 1 or 11.  This ﬁeld must be left blank if 
the stranded conductor is a torus shape (see Remark 1). 
SIDVOUT 
Segment set ID for output voltage when CIRCTYP = 2 or for output 
current when CIRCTYP = 1 or 11. This ﬁeld must be left blank if 
the stranded conductor is a torus shape (see Remark 1). 
PARTID 
Part ID associated with the circuit  
IFREQST 
Frequency for recomputing the source terms.  The source terms are 
recalculated every IFREQST time steps.  By default, the source 
terms are recomputed every EM time step.  See Remark 4. 
LT.0: |IFREQST| is a load curve ID giving the frequency for 
recomputing as a function of time.  
 

================================================================================
PAGE 367
================================================================================

*EM_CIRCUIT_SOURCE 
*EM 
R16@bdccd6d07 (03/10/25) 
6-19 (EM) 
Remarks: 
1. 
Imposed current with closed loop geometry.  For a closed loop geometry (to-
rus), SIDVIN and SIDVOUT cannot be deﬁned.  Thus, only SIDCURR is neces-
sary. 
2. 
Circuit types for source circuits.  Source circuits with imposed currents 
(CIRCTYP = 1 or 11) can be associated with an insulator material (MTYPE = 1) 
in *EM_MAT_001. In this case, the solver relies on the Biot-Savart integration 
method to retrieve the inﬂuence of the source circuit on other conductors.  This 
method is fast, but it is not possible to calculate the force on the coil.  Circuits 
conforming to these conditions can be used with both the Richardson (*EM_-
SOLVER_FEMBEM) and Monolithic solvers (*EM_SOLVER_FEMBEM_MON-
OLITHIC) for coupling the FEM-BEM solvers.  
To extract the magnetic force on the coil when using imposed current, the source 
circuit must be associated with a conductor material (MTYPE = 2) that has a 0. 
value for the conductivity.  In this case, the stranded circuit becomes part of the 
FEM/BEM system, and resolution might be slower.  This approach is only valid 
with the monolithic solver (see *EM_SOLVER_FEMBEM_MONOLITHIC). 
Source circuits also support imposed voltage with CIRCTYP = 2 (associated to a 
resistance value and a number of turns or windings).  The source circuit must be 
used with the monolithic solver (*EM_SOLVER_FEMBEM_MONOLITHIC) and 
become part of the FEM/BEM system.  Therefore, it must be associated with a 
conductor material (MTYPE = 2) with a 0. value for the conductivity in its asso-
ciated EM material (see *EM_MAT_001).  Deﬁning source circuits by their volt-
age instead of their current is very useful in cases where the current is unknown, 
such as for actuators or electric motors.  
3. 
Ampere versus Ampere-turns.  For an imposed current (CIRCTYP = 1 or 11), 
the number of windings can be directly applied by multiplying the current value 
by the number of turns.  The imposed current value corresponds to Ampere-
turns.  For example, a stranded coil with ten turns and a current of two Amperes 
means that imposing a value of twenty in the load curve (if CIRCTYP = 1) or its 
periodic amplitude (if CIRCTYP = 11).  For imposed voltage, providing Am-
pere-turns is not available.  Thus, the number of turns must be speciﬁed directly 
in the keyword (as well as the total resistance of the circuit). 
4. 
When to change IFREQST.  In cases where conductors are not moving with 
respect to one another, using high values of IFREQST avoids recomputing the 
source ﬁelds which can save some calculation time. 
5. 
EMSOL = 4. For the frequency-based Eddy current solver, only CIRCTYPE = 1 
and 2 are available.  The values contained in the load curve represent the norm 
of the amplitude while a time shift can optionally be deﬁned using T0.

================================================================================
PAGE 368
================================================================================

*EM 
*EM_CONTACT 
6-20 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CONTACT 
Purpose:  Optional deﬁne and specify options on electromagnetic contacts between two 
sets of parts.  Generally, it is used with the *EM_CONTACT_RESISTANCE.  Fields left 
empty on this card default to the value of the equivalent ﬁeld for *EM_CONTROL_CON-
TACT. 
 
Contact Deﬁnition Cards.  Include one card for each contact deﬁnition.  This input ends 
at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CONTID 
DTYPE 
PSIDR 
PSIDT 
EPS1 
EPS2 
EPS3 
D0 
Type 
I 
I 
I 
I 
F 
F 
F 
F 
Default 
none 
0 
none 
none 
0.3 
0.3 
0.3 
none 
 
 VARIABLE  
 
DESCRIPTION 
CONTID 
Electromagnetic contact ID 
DTYPE 
Detection type (see remarks): 
EQ.0: Contact type 0 (default)  
EQ.1: Contact type 1 
PSIDR 
Reference surface part set ID 
PSIDT 
Tracked surface part set ID 
EPSi 
Contact coeﬃcients for contact detection conditions.  See the dis-
cussion below. 
D0 
Parameter for contact condition 3 when DTYPE = 1 (see re-
marks) 
Remarks: 
In these remarks, we discuss the conditions for contact detection.  For reference, Fig-
ure 0-1 illustrates which geometric values help determine contact.  In this ﬁgure and dis-
cussion, 푓푟 is a face of the reference surface, and 푓푡 is a face of the tracked surface.  Contact 
is detected when all of the following three conditions are satisﬁed: 

================================================================================
PAGE 369
================================================================================

*EM_CONTACT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-21 (EM) 
1. 
Contact condition 1: 
퐧푟⋅퐧푡≤−1 + 휀1 
Here 퐧푟 and 퐧푡 are the normal vectors of faces 푓푟 and 푓푡, respectively, and 휀1 is an 
input parameter.  See Figure 0-1. 
2. 
Contact condition 2: 
−휀2 ≤훼1 ≤1 + 휀2 
−휀2 ≤훼2 ≤1 + 휀2 
−휀2 ≤훼3 ≤1 + 휀2  
(훼1, 훼2, 훼3) are the local coordinates of point 푃 (see Figure 0-1). 푃 is the projection 
of point 푎2 on face 푓푟. 휀2 is an input parameter. 
3. 
Contact condition 3 depends on the contact type.  For either possible condition, 
let 푑 be the distance between 푃 and 푎푡 (see Figure 0-1). 
a) For contact type 0: 
푑≤휀3푆푟  , 
where 휀3 is an input parameter and 푆푟 is the minimum side length for 푓푟: 
푆푟= min[푑(푎푟, 푏푟), 푑(푏푟, 푐푟), 푑(푐푟, 푎푟)]  . 
b) For contact type 1: 
푑≤퐷0  , 
where 퐷0 is an input parameter.
 
nt
nr
d
at
bt
ct
cr
br
fr
ft
ar
P(1,2,3)
 
Figure 0-1.  Contact detection conditions between two faces. 

================================================================================
PAGE 370
================================================================================

*EM 
*EM_CONTACT_RESISTANCE 
6-22 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CONTACT_RESISTANCE 
Purpose:  Calculate the electric contact resistance of a previously deﬁned EM contact in 
*EM_CONTACT.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CRID 
CONTID 
CTYPE 
 
JHRTYPE
 
 
 
Type 
I 
I 
I 
 
I 
 
 
 
Default 
none 
none 
none 
 
none 
 
 
 
 
 Cards 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DFID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CRID 
Resistive contact ID 
CONTID 
EM contact ID deﬁned in *EM_CONTACT  
CTYPE 
Contact resistance type: 
EQ.1: Electric contact resistance deﬁned by user deﬁned deﬁne 
function. 
DFID 
Deﬁne function ID (see Remark 1) 
JHRTYPE 
Indicates how the Joule heating calculated by the contact resistance 
shall be taken into account: 
EQ.0: No addition.  The Joule heating calculated by the contact 
resistance is not taken into account. 

================================================================================
PAGE 371
================================================================================

*EM_CONTACT_RESISTANCE 
*EM 
R16@bdccd6d07 (03/10/25) 
6-23 (EM) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: The Joule heating coming from the contact resistance is di-
vided and distributed evenly among all elements neigh-
boring the contact surface. 
Remarks: 
1. 
Deﬁne Function Parameters. In the *DEFINE_FUNCTION, the following pa-
rameters are allowed: f(time, emdt, arealoc, areatot, ctdist, currloc, currglob, 
rho_mst, rho_slv, cond_mst, cond_slv, ctpress_mst, ctpress_slv, temp_mst, 
temp_slv, vmstress_mst, vmstress_slv, press_mst, press_slv). Here,  
 
time 
current time step 
emdt 
EM time step 
arealoc 
Local area associated with each face in contact 
areatot 
Total contact area  
ctdist 
Contact distance between the two faces in contact  
currloc 
Local current density at the contact area 
currglob 
Total current ﬂowing through the contact area 
Curvature of the 
current lines induces 
a Lorentz Force
Contact Area
Current ﬂow
Electrode
Workpiece
2a
D
Lorentz  
Force: Fc
Figure 6-2.  Electrode coming into contact with workpiece (RSW ap-
plication). 

================================================================================
PAGE 372
================================================================================

*EM 
*EM_CONTACT_RESISTANCE 
6-24 (EM) 
R16@bdccd6d07 (03/10/25) 
rho_mst 
Density of the elements associated with the reference sur-
face side of the contact 
rho_slv 
Density of the elements associated with the tracked sur-
face side of the contact 
cond_mst 
Electrical conductivity of the elements associated with the 
reference surface side of the contact 
cond_slv 
Electrical conductivity of the elements associated with the 
tracked surface side of the contact 
ctpress_mst 
Contact pressure of the elements associated with the ref-
erence surface side of the contact 
ctpress_slv 
Contact pressure of the elements associated with the 
tracked surface side of the contact 
temp_mst 
Temperature of the elements associated with the reference 
surface side of the contact 
temp_slv 
Temperature of the elements associated with the tracked 
surface side of the contact 
vmstress_mst 
von Mises stress of the elements associated with the refer-
ence surface side of the contact 
vmstress_slv 
von Mises stress of the elements associated with the 
tracked surface side of the contact 
press_mst 
Pressure of the elements associated with the reference sur-
face side of the contact 
press_slv 
Pressure of the elements associated with the tracked sur-
face side of the contact

================================================================================
PAGE 373
================================================================================

*EM_CONTACT_SUBDOM 
*EM 
R16@bdccd6d07 (03/10/25) 
6-25 (EM) 
*EM_CONTACT_SUBDOM 
Purpose:  Optional card used for deﬁning a speciﬁc region where EM contact will be ac-
tive.  This allows saving some calculation time by limiting the contact search area.  Must 
be used in conjunction with *EM_CONTROL_CONTACT. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SDTYPE 
MVTYPE LCIDX/NID
LCIDY 
LCIDZ 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
none 
0 
none 
none 
none 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R 
PMINX 
PMINY 
PMINZ 
PMAXX 
PMAXY 
PMAXZ 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SDTYPE 
Subdomain deﬁnition type : 
EQ.1: Deﬁned by box.  
EQ.2: Deﬁned by cylinder. 
EQ.3: Deﬁned by sphere. 
MVTYPE 
Movement type of subdomain : 
EQ.0: Static subdomain (Default).  
EQ.1: Domain translates in the three directions by the veloci-
ties given by LCIDX,LCIDY,LCIDZ. 
EQ.2: Domain follows the displacements of the node ID given 
by NID. 

================================================================================
PAGE 374
================================================================================

*EM 
*EM_CONTACT_SUBDOM 
6-26 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
LCIDX/NID 
Time dependent load curve ID for the translational velocity in
the X direction for MVTYPE = 1, Node ID for MVTYPE = 2. 
LCIDY/Z 
Time dependent load curve IDs for MVTYPE = 1 in the Y and Z 
directions. 
R 
Radius of the sphere if SDTYPE = 3 or the cylinder if SD-
TYPE = 2. 
PMINX/Y/Z 
Point of minimum coordinates if SDTYPE = 1. Origin point if 
SDTYPE = 3. Axis head point if SDTYPE = 2. 
PMAXX/Y/Z 
Point of maximum coordinates if SDTYPE = 1. Axis tail point if 
SDTYPE = 2. 

================================================================================
PAGE 375
================================================================================

*EM_CONTROL 
*EM 
R16@bdccd6d07 (03/10/25) 
6-27 (EM) 
*EM_CONTROL 
Purpose:  Enable the EM solver and set its options. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EMSOL 
NUMLS 
 
DIMTYPE
NPERIO 
 
NCYLFEM NCYLBEM
Type 
I 
I 
 
I 
I 
 
I 
I 
Default 
none 
100 
 
0 
2 
 
5000 
5000 
 
 VARIABLE  
 
DESCRIPTION 
EMSOL 
Electromagnetism solver selector: 
EQ.-1: Turns the EM solver oﬀ after reading the EM keywords.
EQ.1: Eddy current solver 
EQ.2: Periodic inductive heating solver (see Remark 3) 
EQ.3: Resistive heating solver 
EQ.4: Frequency-based Eddy current solver (see Remark 3) 
EQ.5: Periodic resistive heating solver (see Remark 3) 
EQ.11: Electrophysiology monodomain 
EQ.12: Electrophysiology bidomain 
EQ.13: Electrophysiology monodomain coupled with bidomain
EQ.14: Pure eikonal model.  Activation times are computed and 
output in VTK format to the /vtk directory.  See *EM_-
EP_EIKONAL. 
EQ.15: Reaction eikonal (RE) model based on [1]. See *EM_EP_-
EIKONAL. 
NUMLS 
Number of local EM steps in a whole period for EMSOL = 2. Global 
frequency for EMSOL = 4.  If a negative value is entered, it gives 
the value as a function of the macro time. 
DIMTYPE 
EM dimension type: 
EQ.0: 3D solve 
EQ.1: 2D planar with zero thickness shell elements 

================================================================================
PAGE 376
================================================================================

*EM 
*EM_CONTROL 
6-28 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.2: 2D axisymmetric (푌-axis only) with zero thickness ele-
ments 
NPERIO 
Number of periods for which the last is used to calculate the aver-
age Joule heat rate when EMSOL = 2. NPERIO = 2 means that two 
periods of NUMLS steps will be calculated.  Only the last period of 
NPERIO is used for the average Joule heat calculation.  See Re-
mark 1. 
NCYLFEM 
Number of electromagnetism cycles between the recalculation of 
FEM matrices.  If negative, the absolute value refers to a load curve 
that gives the number of electromagnetism cycles as a function of 
time.  See Remark 2. 
NCYLBEM 
Number of electromagnetism cycles between the recalculation of
BEM matrices.  If negative, the absolute value refers to a load curve 
that gives the number of electromagnetism cycles as a function of 
time.  See Remark 2. 
Remarks: 
1. 
Number of periods and the average Joule heating calculation. The purpose 
of using more than one period to calculate the average Joule heating is to allow 
the diﬀerent ﬁelds to adopt the correct amplitude and time shift when starting 
from 0.0 at 푡= 0. NPERIO = 2 means that two periods are calculated, of which 
only last one, being the second one in this case, is used for the average Joule heat 
calculation.  In some cases, larger values might be required to achieve good ac-
curacy, and conversely, in others, NPERIO = 1 might yield suﬃcient accuracy.  
2. 
Order of precedence for NCYLFEM and NCYLBEM.  You can set NCYLFEM 
and NCYLBEM with *EM_CONTROL_SOLUTION, *EM_SOLVER_FEM/BEM, 
or *EM_CONTROL. *EM_CONTROL_SOLUTION has the highest priority for 
setting these ﬁelds, while *EM_CONTROL has the lowest priority.  If a ﬁeld is 
left as the default on *EM_CONTROL_SOLUTION, LS-DYNA looks at the set-
ting of that ﬁeld on *EM_SOLVER_FEM/BEM. If left as default on *EM_-
SOLVER_FEM/BEM, LS-DYNA looks at the setting on *EM_CONTROL. 
3. 
Solver for inductive heating. Both EMSOL = 2 and 4 can be used for inductive 
heating problems.  EMSOL = 4 requires using the monolithic solver.  It is a fre-
quency-based solver, so the solve is usually faster than solving EM quantities in 
the time domain over the full period.  However, only EMSOL = 2 is available for 
nonlinear magnetic permeability cases.  EMSOL = 5 is similar to EMSOL = 2 but 

================================================================================
PAGE 377
================================================================================

*EM_CONTROL 
*EM 
R16@bdccd6d07 (03/10/25) 
6-29 (EM) 
restricted to resistive-heating-type applications because it does not consider in-
ductive-diﬀusive eﬀects.  
References: 
 [1]  
A. Neic et al, “  Efficient computation of electrograms and ECGs in human whole heart simulations 
using a reaction-eikonal model”, Journal of Computational Physics 346 (2017) 191–211

================================================================================
PAGE 378
================================================================================

*EM 
*EM_CONTROL_CONTACT 
6-30 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CONTROL_CONTACT 
Purpose:  Activate the electromagnetism contact algorithms, which detect contact be-
tween conductors.  Electromagnetic ﬁelds ﬂow from one conductor to another when 
found to be in contact. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EMCT 
CCONLY 
CTYPE 
DTYPE 
EPS1 
EPS2 
EPS3 
D0 
Type 
I 
I 
I 
I 
F 
F 
F 
F 
Default 
0 
0 
0 
0 
0.3 
0.3 
0.3 
none 
 
 VARIABLE  
 
DESCRIPTION 
EMCT 
EM contact activation ﬂag: 
EQ.0: No contact detection 
EQ.1: Contact detection 
CCONLY 
Determines parts for which EM contact is active: 
EQ.0: Contact detection between all active parts associated with 
a conducting material.  (Default) 
EQ.1: Only look for EM contact between parts associated 
through the *EM_CONTACT card.  In some cases, this op-
tion can reduce the calculation time. 
CTYPE 
Contact type: 
EQ.-1: Node-to-node contact based on constraints on the scalar 
potential.  See Remark 1. 
EQ.0: Node-to-node penalty-based contact on the scalar poten-
tial.  
EQ.1: Discrete mortar penalty contact on the scalar potential. 
EQ.2: Continuous mortar penalty contact on the scalar poten-
tial and the vector potential (when active).  
DTYPE 
Detection type.  If *EM_CONTACT is not deﬁned, the solver will 
look for global contact options in *EM_CONTROL_CONTACT. 
See *EM_CONTACT for details. 

================================================================================
PAGE 379
================================================================================

*EM_CONTROL_CONTACT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-31 (EM) 
 VARIABLE  
 
DESCRIPTION 
EQ.0: Contact type 0 (default).  
EQ.1: Contact type 1. 
EPSi 
Global contact coeﬃcients used if the equivalent ﬁelds in *EM_-
CONTACT are empty.  See *EM_CONTACT for details. 
D0 
Global parameter for contact condition 3 when DTYPE = 1. See 
*EM_CONTACT for details. 
Remarks: 
1. 
Contact types. In versions prior to R12, CTYPE = 0 was the default EM contact 
for the resistive heating solver, while CTYPE = -1 was the default EM contact for 
the Eddy current solver.  In versions R12 and later, CTYPE = 0 became the de-
fault for all solvers.  We recommend CTYPE = 1 and 2 for the best accuracy. 
2. 
Contact between BEM surfaces with the Eddy current solver.  When the 
Eddy current solver is active and contact occurs between BEM surfaces, the 
solver automatically removes the faces on the contact surface and internally 
stitches the two BEM surfaces together to achieve a continuous closed BEM 
mesh.

================================================================================
PAGE 380
================================================================================

*EM 
*EM_CONTROL_COUPLING 
6-32 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CONTROL_COUPLING 
Purpose:  Control couplings between various solvers with the EM solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
THCPL 
SMCPL 
THLCID 
SMLCID 
THCPLFL
SMCPLFL
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
Default 
0 
0 
0 
0 
0 
0 
 
 
 
Optional Card.   
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SMMOD 
DFX 
DFY 
DFZ 
 
FSIB 
INTERP 
 
Type 
I 
I 
I 
I 
 
I 
I 
 
Default 
0 
none 
none 
none 
 
0 
0 
 
 
Optional Card.   
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID1 
NID2 
NID3 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
0 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
THCPL 
Coupling to the thermal solver.  When turned on, the EM
solver will transfer the Joule heating terms to the solid me-
chanics thermal solver. 
EQ.0:  Coupling on. 

================================================================================
PAGE 381
================================================================================

*EM_CONTROL_COUPLING 
*EM 
R16@bdccd6d07 (03/10/25) 
6-33 (EM) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: Coupling oﬀ. 
EQ.2: Coupling on.  It forces all EM heating terms to be 
expressed at the element level.  See Remark 2. 
SMCPL 
Coupling to the solid mechanics solver.  When turned on, the 
EM solver will transfer forces to the solid mechanics solver.
EQ.0: Coupling on.  Lorentz force density is transferred. 
EQ.1: Coupling oﬀ. 
EQ.2: Coupling on.  Magnetic force surface density is 
transferred.  More accurate representation of EM 
forces in cases involving magnets or nonlinear fer-
romagnets.  See *EM_SOLVER_FEMBEM_MONO-
LITHIC. 
EQ.3: Coupling on.  Magnetic force surface density is 
transferred to magnets and ferromagnets, while Lo-
rentz force density is transferred to regular conduc-
tors. 
THLCID 
Optional load curve ID. When deﬁned, the heat rate transferred to
the thermal solver will be scaled by the value returned by THLCID.
SMLCID 
Optional load curve ID. When deﬁned, the forces transferred to the 
solid mechanics solver will be scaled by the value returned by 
SMLCID. 
THCPLFL 
Coupling to the heat equation when EM quantities are solved 
on ﬂuid elements.  When turned on, the EM solver will trans-
fer the Joule heating terms to the ICFD solver. 
EQ.0: Coupling oﬀ. 
EQ.1: Coupling on. 
SMCPLFL 
Interaction between the solid mechanics solver and the ICFD 
solver when EM quantities are solved on ﬂuid elements.  
EQ.0: The ﬂuid pressure will be passed to the solid me-
chanics solver (default). 
EQ.1: The ﬂuid pressure is replaced by the electrostatic 
pressure. 
EQ.2: The ﬂuid and electrostatic pressure are passed on to 
the solid mechanics solver. 

================================================================================
PAGE 382
================================================================================

*EM 
*EM_CONTROL_COUPLING 
6-34 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.4: The EM solver will send the Lorentz Force as a vol-
umetric source term to the ﬂuid solver. 
SMMOD 
Coupling to the solid mechanics solver.  When turned on, the 
EM solver will transfer forces to the solid mechanics solver.
EQ.0: Oﬀ. 
EQ.1: Force calculation at the element level is decided by 
*DEFINE_FUNCTION. See DFX, DFY and DFZ. 
EQ.2: Force calculation at the element level is decided by 
the 
usermat 
routine. 
 
See 
dyn21em.f 
and 
user_getEMForceArray routine. 
DFX/DFY/DFZ 
*DEFINE_FUNCTION IDs for the force three components if
SMMOD = 1. Arguments for the *DEFINE_FUNCTIONs are 
the same as in *EM_EOS_TABULATED2. See Remark 2 of 
*EM_EOS_TABULATED2.  
FSIB 
Solid mechanics – ICFD FSI boundaries.  When turned on, 
the EM solver uses the coupled FSI interface to impose the 
continuity of the scalar potential between the two domains.
See Remark 1. 
EQ.0: Oﬀ 
EQ.1: On 
INTERP 
Flag for EM force interpolation by the solid mechanics solver. 
By default, the solid mechanics solver interpolates at each 
time the EM force from the last two EM steps.  See Remark 3.
EQ.0: Time interpolation on (default) 
EQ.1: No time interpolation.  Use the force from the last 
EM solve. 
NID1/NID2/NID3 
Three node IDs deﬁning a local coordinate system.  See Re-
mark 4. 
Remarks: 
1. 
FSI coupling. *ICFD_CONTROL_FSI and *ICFD_BOUNDARY_FSI control the 
coupling between the ICFD and the solid mechanics solvers.  When FSI exists 
and the FSIB ﬂag is turned on, the EM solver reuses those boundaries to impose 
the necessary constraints on the scalar potential to ensure continuity.  The solid 

================================================================================
PAGE 383
================================================================================

*EM_CONTROL_COUPLING 
*EM 
R16@bdccd6d07 (03/10/25) 
6-35 (EM) 
and ﬂuid domains must have been previously deﬁned as conductors (see *EM_-
MAT_001).  
2. 
Heating term at the element level. By default, the EM-thermal heat rate is ex-
pressed at the node level before being sent to the thermal solver.  However, for 
some applications where sharp gradients are present, such as battery applica-
tions involving Randles circuits, an alternative approach is to express the heat 
rate term at the element level using THCPL = 2. THCPL = 2 results in a smoother 
and more diﬀusive solution. 
3. 
Force interpolation. In typical EM Eddy current applications, such as magnetic 
metal forming or welding, the mechanical time step is much smaller than the 
EM time step.  The EM solver completes its solve with its larger time step and 
waits for the mechanical solver to catch up.  During each of its solves, the me-
chanical solver interpolates the force between the two last EM steps.  However, 
for speciﬁc magnetostatic problems (speciﬁcally rotating problems), this time in-
terpolation can introduce errors.  INTERP, therefore, exists to turn oﬀ the time 
interpolation and have the mechanical solver use the force from the last EM 
solve. 
4. 
Rotating problems. In conjunction with INTERP = 1 described in Remark 3, 
optional Card 3 enables deﬁning a local reference frame.  If the frame is rotating, 
the mechanical solver applies the corresponding rotation to the force vectors ob-
tained from the EM solver.  This feature was developed speciﬁcally for magne-
tostatic rotating problems and is subject to further development.

================================================================================
PAGE 384
================================================================================

*EM 
*EM_CONTROL_COUPLING 
6-36 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CONTROL_EROSION 
Purpose:  Allows the EM solver to take eroded elements into account 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ECTRL 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ECTRL 
Erosion search : 
EQ.0: Oﬀ.  This means that the EM solver will ignore eroded 
elements and still consider them part of the EM problem.
EQ.1: On.  The EM solver will look for potential elements that 
are eroded and remove them from the EM solve by up-
dating its matrix system. 

================================================================================
PAGE 385
================================================================================

*EM_CONTROL_MAGNET 
*EM 
R16@bdccd6d07 (03/10/25) 
6-37 (EM) 
*EM_CONTROL_MAGNET 
Purpose:  Control how often the magnetization vector for magnets is recomputed.  By 
default, the magnetization vector for each magnet is computed only once at the beginning 
of the calculation (see Remark 1).  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MCOMP 
NCYCM 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
0 
0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MCOMP 
Flag controlling whether the magnetization vector is recomputed.
EQ.0: Magnetization vector not recomputed (see Remark 1). 
EQ.1: Magnetization vector recomputed at the frequency con-
trolled by NCYCM. 
NCYCM 
Magnetization vector recomputation frequency.  A value of 1 
means recomputation at every EM time step.  If a negative value is 
entered, |NCYCM| is the ID of a load curve giving the value as a
function of time. 
Remark: 
1. 
MCOMP. In most applications involving magnets, the magnetization vector as-
sociated to each magnet needs only to be calculated once at the beginning of the 
analysis.  The magnetization direction is then scaled by the Coercive force value 
(See EM_PERMANENT_MAGNET) to correctly estimate the contribution of 
each magnet.  In certain speciﬁc applications, for examples in cases involving 
magnet deformations or changes in magnet boundary conditions, it may be 
needed to periodically update the initially computed magnetization vector.  This 
can be achieved by setting MCOMP to 1 and deﬁning NCYCM.

================================================================================
PAGE 386
================================================================================

*EM 
*EM_CONTROL_SOLUTION 
6-38 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CONTROL_SOLUTION 
Purpose:  Specify diﬀerent conditions under which reassembly of the FEM and BEM ma-
trices occurs. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NCYLFEM NCYLBEM AUTOFEM AUTOBEM TOL1FEM TOL2FEM TOL1BEM TOL2BEM
Type 
I 
I 
I 
I 
F 
F 
F 
F 
Default 
5000 
5000 
0 
0 
0.3 
0.1 
0.3 
0.1 
 
Optional Card.   
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID1 
NID2 
NID3 
NID4 
NID5 
NID6 
ANG 
DIST 
Type 
I 
I 
I 
I 
I 
I 
F 
F 
Default 
0 
0 
0 
0 
0 
0 
1.e16 
1.e16 
 
 VARIABLE  
 
DESCRIPTION 
NCYLFEM 
Number of electromagnetism cycles between the recalculation of
FEM matrices.  See Remark 1. 
LT.0: |NCYLFEM| refers to a load curve, giving the number of 
cycles as a function of time. 
NCYLBEM 
Number of electromagnetism cycles between the recalculation of
BEM matrices.  See Remark 1. 
LT.0: |NCYLBEM| refers to a load curve, giving the number of 
cycles as a function of time. 
AUTOFEM 
In addition to NCYLFEM, AUTOFEM triggers an automatic 
recomputation of the FEM matrices based on an error calculation 
of the conductors’ relative deformation and electrical conductivity 
changes.  See TOL1FEM and TOL2FEM. See Remark 2. 
EQ.0: Autorecomputation oﬀ 

================================================================================
PAGE 387
================================================================================

*EM_CONTROL_SOLUTION 
*EM 
R16@bdccd6d07 (03/10/25) 
6-39 (EM) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: Autorecomputation on 
AUTOBEM 
In addition to NCYLBEM, AUTOBEM triggers an automatic 
recomputation of the BEM matrices based on an error calculation 
of the conductors’ relative displacements.  See TOL1BEM and 
TOL2BEM. See Remark 2. 
EQ.0: Autorecomputation oﬀ 
EQ.1: Autorecomputation on 
TOL1FEM 
Only used if AUTOFEM = 1. If a conducting element experiences a 
deformation or a conductivity change that reaches an error larger 
than TOL1FEM, the solver reassembles the FEM matrices.  If nega-
tive, the absolute value refers to a load curve that gives the toler-
ance as a function of time. 
TOL2FEM 
Only used if AUTOFEM = 1. If (number of conducting elements) × 
TOL2FEM elements experience a deformation or a conductivity
change that reaches an error larger than TOL2FEM, the solver
recomputes the FEM matrices.  If negative, the absolute value re-
fers to a load curve that gives TOL2FEM as a function of time. 
TOL1BEM 
Only used if AUTOBEM = 1. If a conducting element experiences 
a displacement that reaches an error larger than TOL1BEM, then
LS-DYNA reassembles the BEM matrices.  If negative, the absolute 
value refers to a load curve that gives the tolerance as a function of 
time. 
TOL2BEM 
Only used if AUTOBEM = 1. If (number of conducting elements) × 
TOL2BEM elements experience a displacement that reaches an er-
ror larger than TOL2BEM, then the BEM matrices are recomputed. 
If negative, the absolute value refers to a load curve that gives 
TOL2BEM as a function of time. 
NID1, NID2, 
NID3 
Local coordinate system speciﬁed with NID1, NID2, and NID3. See 
Remark 3. 
NID4, NID5, 
NID6 
Local coordinate system speciﬁed with NID4, NID5, and NID6. See 
Remark 3. 
ANG 
Angle (in degrees) tolerance criterion that triggers a BEM matrix
recomputation.  See Remark 3. 
LT.0.0: |ANG| is a load curve ID giving the angle tolerance cri-
terion as a function of time. 

================================================================================
PAGE 388
================================================================================

*EM 
*EM_CONTROL_SOLUTION 
6-40 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
DIST 
Distance tolerance criterion that triggers a BEM matrix recomputa-
tion.  See Remark 3. 
LT.0.0: |DIST| is a load curve ID giving the distance tolerance
criterion as a function of time. 
Remarks: 
1. 
Order of precedence for NCYLFEM and NCYLBEM.  You can set NCYLFEM 
and NCYLBEM with *EM_CONTROL_SOLUTION, *EM_SOLVER_FEM/BEM, 
or *EM_CONTROL. *EM_CONTROL_SOLUTION has the highest priority for 
setting these ﬁelds, while *EM_CONTROL has the lowest priority.  If you leave 
one of these ﬁelds as the default value on *EM_CONTROL_SOLUTION, LS-DY-
NA then looks at the setting of that ﬁeld on *EM_SOLVER_FEM/BEM. If left as 
the default on *EM_SOLVER_FEM/BEM, LS-DYNA looks at the setting on 
*EM_CONTROL. 
2. 
EM contact with recomputation.  When EM contact occurs and you have ena-
bled automatic FEM or BEM matrix recomputation, LS-DYNA simultaneously 
reassembles both the FEM and BEM matrices when any criterion is reached to 
maintain consistency.  When you do not enable automatic recomputation, we 
recommend the FEM and BEM systems have the same value for the recomputa-
tion cycle.  
3. 
Rotating and translating parts. The optional second line triggers a BEM matrix 
recomputation only if the rotation or distance between the system composed of 
NID1/NID2/NID3 and NID4/NID5/NID6 exceeds ANG (in degrees) or DIST. 
This feature is useful in cases when one conductor part rotates or translates 
based on another part and an automatic criterion is desired.

================================================================================
PAGE 389
================================================================================

*EM_CONTROL_SWITCH 
*EM 
R16@bdccd6d07 (03/10/25) 
6-41 (EM) 
*EM_CONTROL_SWITCH 
Purpose:  Create a control “switch” that will shut down the solver based on information 
from a load curve.  LS-DYNA supports complex types of curves (See *DEFINE_CURVE_-
FUNCTION) that allow the setting up of complex on/oﬀ switches, for instance, by using 
a nodal temperature value. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LCID 
FEMCOMP BEMCOMP
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
0 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LCID 
Load curve or deﬁne curve function ID. Negative values switch the 
solver oﬀ; positive values switch it back on. 
FEMCOMP 
Flag to determine if LS-DYNA recomputes the FEM matrices each 
time the EM solver is turned back on: 
EQ.0: Recompute FEM matrices. 
EQ.1: Do not recompute FEM matrices. 
BEMCOMP 
Flag to determine if LS-DYNA recomputes the BEM matrices each 
time the EM solver is turned back on: 
EQ.0: Recompute BEM matrices. 
EQ.1: Do not recompute the BEM matrices. 

================================================================================
PAGE 390
================================================================================

*EM 
*EM_CONTROL_SWITCH 
6-42 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_CONTROL_SWITCH_CONTACT 
Purpose:  It is possible to active a control “switch” that will shut down the electromag-
netic contact detection.  This can be useful in order to save some calculation time in cases 
where the user knows when contact between conductors will occur or stop occurring. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LCID 
NCYLFEM NCYLFEM
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
0 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LCID 
Load Curve ID.  
Negative values switch the contact detection off, positive values 
switch it back on. 
NCYLFEM 
Determines the number of cycles before FEM matrix recomputa-
tion.  If deﬁned this will overwrite the previous NCYCLFEM as long 
as the contact detection is turned on. 
NCYLBEM 
Determines the number of cycles before BEM matrix recomputa-
tion.  If deﬁned this will overwrite the previous NCYCLBEM as long 
as the contact detection is turned on. 

================================================================================
PAGE 391
================================================================================

*EM_CONTROL_TIMESTEP 
*EM 
R16@bdccd6d07 (03/10/25) 
6-43 (EM) 
*EM_CONTROL_TIMESTEP 
Purpose:  Controls the EM time step and its evolution. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TSTYPE 
DTCONST
LCID 
FACTOR 
TSMIN 
TSMAX 
RLCSF 
MECATS 
Type 
I 
F 
I 
F 
F 
F 
I 
I 
Default 
none 
none 
none 
1.0 
none 
none 
25 
0 
 
 VARIABLE  
 
DESCRIPTION 
TSTYPE 
Time step type: 
EQ.1: Constant time step given in DTCONST 
EQ.2: Time step as a function of time given by a load curve spec-
iﬁed in LCID 
EQ.3: Automatic time step computation, depending on the 
solver type.  This time step is then multiplied by FACTOR
EQ.5: EM time step forced to be the same as the thermal time 
step in problems with the EM solver coupled to the ther-
mal solver.  In other words, the thermal solver determines 
the EM time step. 
DTCONST 
Constant value for the time step for TSTYPE = 1 
LCID 
Load curve ID giving the time step as a function of time for 
TSTYPE = 2 
FACTOR 
Multiplicative factor applied to the time step for TSTYPE = 3 
TSMIN 
Minimum time step.  When TSMIN is deﬁned, the EM time step 
cannot drop below TSMIN. A negative value will refer to a time-
dependent load curve. 
TSMAX 
Maximum time step.  When TSMAX is deﬁned, the EM time step 
cannot increase beyond TSMAX. A negative value will refer to a 
time-dependent load curve. 
RLCSF 
RLC Circuit time step scale factor.  See Remark 2. 

================================================================================
PAGE 392
================================================================================

*EM 
*EM_CONTROL_TIMESTEP 
6-44 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
MECATS 
Mechanical time step handling in cases where the EM solver time 
step becomes smaller (see Remark 3): 
EQ.0: Default.  The EM time step will go below the solid me-
chanics timestep, and several EM solves will occur be-
tween two solid mechanics time steps to ensure time 
consistency. 
EQ.1: The solid mechanics time step will adapt and decrease to 
the EM time step value so that only one EM solve occurs
between two solid mechanics solves. 
Remarks: 
1. 
Automatic time step for Eddy current solvers.  For eddy current solvers, the 
automatic time step is based on the diﬀusion equation for the magnetic ﬁeld: 
휎∂퐴⃗
∂푡+ ∇⃗⃗⃗× 1
휇∇⃗⃗⃗× 퐴⃗+ 휎∇⃗⃗⃗휑= 횥⃗푆  . 
It is computed as the minimal elemental diﬀusion time step over the elements.  
For a given element, the elemental diﬀusion time step is given as 푑푡푒= 푙푒
2 (2퐷)
⁄
, 
where: 
• 퐷 is the diﬀusion coeﬃcient 퐷= 1 (휇0휎푒)
⁄
, 
• 휎푒 is the element’s electrical conductivity, 
• 휇0 is the permeability of free space, 
• 푙푒 is the minimal edge length of the element (minimal size of the element). 
2. 
Automatic time step with RLC circuit.  When an automatic time step is deﬁned 
and an RLC circuit is present, the EM solver will perform an additional check 
and calculate an approximation of the ﬁrst current period based on a 0-D circuit 
solve.  It will then limit the timestep by a factor 푇period (4 × RLCSF
⁄
). The default 
value of RLCSF ensures that 25 EM timesteps will be calculated for the ﬁrst quar-
ter period. 
3. 
MECATS.  In general, we recommend avoiding scenarios where the EM time 
step becomes smaller than the solid mechanics time step, a situation often result-
ing from ill-deﬁned input decks and parameters.  However, this can happen 
when conducting elements have large deformations and an automatic EM time 
step is selected.  For this case, choose between the two MECATS options. 
4. 
Macro time step. If EMSOL = 2 or 4 in *EM_CONTROL, the EM time step de-
ﬁned here represents a “macro” time step, meaning the time when new time-

================================================================================
PAGE 393
================================================================================

*EM_CONTROL_TIMESTEP 
*EM 
R16@bdccd6d07 (03/10/25) 
6-45 (EM) 
averaged quantities such as Joule heating Power or Magnetic Forces are up-
dated.  If material properties are constant and no displacement of parts is ex-
pected, this macro time step can be equal to the termination time.

================================================================================
PAGE 394
================================================================================

*EM 
*EM_DATABASE_CIRCUIT 
6-46 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_DATABASE_CIRCUIT 
Purpose:  Enable the output of EM data for every circuit deﬁned.  
 
Output options card 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
1 
0. 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if LS-DYNA creates the output ﬁle: 
EQ.0: Do not generate the output ﬁle. 
EQ.1: Generate the output ﬁle. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, LS-
DYNA uses the EM timestep. 
Remarks: 
1. 
File name. The ﬁle name for this database is em_circuit_XXX.dat with XXX as 
the circuit ID. 
2. 
ResistanceD. LS-DYNA calculates ResistanceD in the following way: 
a) Imposes a scalar potential diﬀerence of 1 at the circuit’s boundaries SIDVIN 
and SIDVOUT. 
b) Solves ∇2휑= 0 with 휑SIDVIN = 1 and 휑SIDVOUT = 0 at SIDCURR. We do not 
consider diﬀusive eﬀects, meaning the current density can be written as 퐣=
∇휑 and the total current as 퐼= 퐣⋅퐧푑퐴. 
c) Estimates the resistance using 푅퐷= 푈퐼
⁄ . 푈 is the potential diﬀerence be-
tween 휑SIDVIN and and 휑SIDVOUT, that is, equal to 1.  The circuit’s geometry 
and conductivity solely determine this 푅퐷 resistance.  It is, therefore, equiv-
alent to the resistance as commonly deﬁned in the circuit equations: 
푅퐷= 퐿휎푆
⁄
  , 

================================================================================
PAGE 395
================================================================================

*EM_DATABASE_CIRCUIT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-47 (EM) 
where 퐿 is the length of the circuit and 푆 is its surface area. 
3. 
ResistanceJ. LS-DYNA calculates ResistanceJ with the data provided during 
the EM solve: 푅퐽= 퐽퐼2
⁄
 where 퐽 and 퐼 are, respectively, the joule heating and the 
current.  Compared with ResistanceD, ResistanceJ is not so much a resistance 
calculation since it accounts for the resistive eﬀects (when using the Eddy cur-
rent solver).  Rather, it corresponds to the resistance that the circuit would need 
in order to get the same Joule heating in the context of a circuit equation.  If all 
EM ﬁelds are diﬀused or you are using the resistive heating solver, ResistanceJ 
should be close to ResistanceD. 
4. 
Mutual inductances. Only the mutual inductances between the ﬁrst three cir-
cuits deﬁned are output.

================================================================================
PAGE 396
================================================================================

*EM 
*EM_DATABASE_CIRCUIT0D 
6-48 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_DATABASE_CIRCUIT0D 
Purpose:  Enable the output of 0D EM data for every circuit deﬁned.  
 
Output options card 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if LS-DYNA creates the output ﬁle. 
EQ.0: Does not generate the output ﬁle. 
EQ.1: Generates the output ﬁle. 
DTOUT 
Time interval to print the output.  If DTOUT equals 0.0, then LS-
DYNA uses the EM time step. 
Remarks: 
1. 
File name. The ﬁle name for this database is em_circuit0D_XXX.dat with XXX as 
the circuit ID.  
2. 
0D solution.  At the start of the run, based on the initial values of the meshes 
resistances and inductances, the solver calculates the results for a so-called “0D” 
solution, which does not consider the current’s diﬀusion, the part’s displace-
ments, or the EM material property changes.  It is, therefore, a crude approxima-
tion.  LS-DYNA extrapolates the initial results through time which it outputs at 
DTOUT intervals.  This result can be useful in some cases, especially in RLC 
circuits if you need a rough idea of how the source current will behave. 
3. 
Cost.  Since the calculation of this 0D circuit can take time depending on the size 
of the problem, you should only use it in cases where the output results help 
with comprehension of the analysis. 
4. 
Effect of this keyword. This keyword does not inﬂuence the results of the EM 
run itself.

================================================================================
PAGE 397
================================================================================

*EM_DATABASE_CIRCUITSOURCE 
*EM 
R16@bdccd6d07 (03/10/25) 
6-49 (EM) 
*EM_DATABASE_CIRCUITSOURCE 
Purpose:  Output additional data speciﬁc to source circuits.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CIRCID 
IMP 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CIRCID 
Source circuit ID for which total magnetic ﬂux is calculated and
output to em_CircuitSource_CIRCID.dat. See Remark 1. 
IMP 
Include the source circuit with ID CIRCID in the impedance matrix 
calculation and output: 
EQ.0: Not included. 
EQ.1: Included.  See Remark 2.  
Remarks: 
1. 
Magnetic ﬂux. This keyword causes an additional vector product operation on 
the current density and vector potential to give the magnetic ﬂux for the speci-
ﬁed source circuits.  For the frequency domain solver, the output is decomposed 
into its real and imaginary components.  This output is useful for retrieving coil 
inductance variations and resistance variations or induced voltage.  It is fre-
quently used in crack detection problems in conjunction with the frequency do-
main Eddy current solver.  Since it relies on the vector potential output, the 
source circuit coil must be deﬁned as a conductor.  See Remark 2 in *EM_CIR-
CUIT_SOURCE).  
2. 
Impedance matrix. IMP = 1 only applies when the frequency domain solver is 
also activated (EMSOL = 4 in *EM_CONTROL). For each CIRCID for which 
IMP = 1, the solver performs a separate solve with each CIRCID considered in 
turn as an emissive and receptive coil.  This method enables establishing the 
complete impedance matrix.  Its real and imaginary parts are output in ASCII 
ﬁles em_indMtx.dat and em_resMtx.dat, respectively.  The results of 
em_resMtx.dat are multiplied by 휔, where 휔= 2휋퐹, for convenience purposes.

================================================================================
PAGE 398
================================================================================

*EM 
*EM_DATABASE_ELOUT 
6-50 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_DATABASE_ELOUT 
Purpose:  Enable the output of EM data on elements.  
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ELSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if LS-DYNA creates the output ﬁle: 
EQ.0: Does not generate the output ﬁle. 
EQ.1: Generates the output ﬁle. 
DTOUT 
Time interval to print the output.  If DTOUT equals 0.0, LS-DYNA 
uses the EM time step. 
ELSID 
Solid elements set ID  
Remarks: 
1. 
File name. The ﬁle name for this database is em_elout.dat.

================================================================================
PAGE 399
================================================================================

*EM_DATABASE_FIELDLINE 
*EM 
R16@bdccd6d07 (03/10/25) 
6-51 (EM) 
*EM_DATABASE_FIELDLINE 
Purpose:  The EM solver uses a BEM method to calculate the EM ﬁelds between conduc-
tors.  With this method, the magnetic ﬁeld in the air or vacuum between conductors is 
therefore not explicitly computed.  However, in some cases, it may be interesting to vis-
ualize some magnetic ﬁeld lines for a better analysis.  This keyword allows the output of 
ﬁeld line data.  It has no inﬂuence on the results of the EM solve. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FLID 
PSID 
DTOUT 
NPOINT 
 
 
 
 
Type 
I 
I 
F 
I 
 
 
 
 
Default 
none 
none 
0. 
100 
 
 
 
 
Remaining cards are optional.† 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
INTEG 
H 
HMIN 
HMAX 
TOLABS 
TOLREL 
 
 
Type 
I 
F 
F 
F 
F 
F 
 
 
Default 
2 
0. 
0. 
1E10 
1E-3 
1E-5 
 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BTYPE 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
2 
 
 
 
 
 
 
 
 

================================================================================
PAGE 400
================================================================================

*EM 
*EM_DATABASE_FIELDLINE 
6-52 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
FLID 
Field line set ID 
PSID 
Point Set ID associated to the ﬁeld line set (See *EM_POINT_SET). 
The coordinates given by the diﬀerent points will be the starting 
points of the ﬁeld lines. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the EM time step will be used. 
NPOINT 
Number of points per ﬁeld line.  The points are regularly spaced. 
INTEG 
Type of numerical integrator used to compute the ﬁeld lines : 
EQ.1: RK4, Runge Kutta 4. See Remark 2. 
EQ.2: DOP853, Dormand Prince 8(5,3).  See Remark 2. 
H 
Value of the step size.  In case of an integrator with adaptive step 
size, it is the initial value of the step size. 
HMIN 
Minimal step size value.  Only used in the case of an integrator 
with adaptive step size. 
HMAX 
Maximal step size value.  Only used in the case of an integrator
with adaptive step size. 
TOLABS 
Absolute tolerance of the integrator.  Only used in the case of an 
integrator with adaptive step size. 
TOLREL 
Relative tolerance of the integrator.  Only used in the case of an 
integrator with adaptive step size. 
BTYPE 
Method to compute the magnetic ﬁeld : 
EQ.1: Direct method (every contribution is computed by the
Biot Savart Law and summed up : very slow). 
EQ.2: Multipole method (approximation of the direct method 
using the multipole expansion). 
EQ.3: Multicenter method (approximation of the direct method
using a weighted subset of points only in order to com-
pute the magnetic ﬁeld). 

================================================================================
PAGE 401
================================================================================

*EM_DATABASE_FIELDLINE 
*EM 
R16@bdccd6d07 (03/10/25) 
6-53 (EM) 
Remarks: 
1. 
File Names.  The ﬁle name for this database is em_ﬁeldLine_XX_YYY.dat where 
XX is the ﬁeld line ID and YYY is the point set ID deﬁned in *EM_POINT_SET. 
2. 
Integrators.  The Runge Kutta 4 integrator is an explicit iterative method for 
solving ODEs.  It is a fourth order method with a constant step size.  The Dor-
mand Prince 8(5,3) integrator is an explicit iterative method for solving IDEs.  
Particularly, this integrator is an embedded Runge Kutta integrator of order 8 
with an adaptive step size.  This integrator allows a step size control which is 
done though an error estimate at each step.  The Dormand Prince 8(5,3) is a Dor-
mand Prince 8(6) for which the 6th order error estimator has been replaced by a 
5th order estimator with 3rd order correction in order to make the integrator more 
robust.

================================================================================
PAGE 402
================================================================================

*EM 
*EM_DATABASE_GLOBALENERGY 
6-54 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_DATABASE_GLOBALENERGY 
Purpose:  Enable the output of global EM energies. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be dumped. 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle is generated. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the EM timestep will be used. 
Remarks: 
1. 
Database Name. The ﬁle name for this database is em_globEnergy.dat.  
2. 
Output Data.  The output ﬁle includes the global EM energies of the mesh, the 
air, and the source circuit.  It also includes the global kinetic energy and the 
global plastic work energy.

================================================================================
PAGE 403
================================================================================

*EM_DATABASE_NODOUT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-55 (EM) 
*EM_DATABASE_NODOUT 
Purpose:  This keyword enables the output of EM data on nodes.  
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be dumped. 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle is generated. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the EM timestep will be used. 
NSID 
Node Set ID. 
Remarks: 
1. 
The ﬁle name for this database is em_nodout.dat.

================================================================================
PAGE 404
================================================================================

*EM 
*EM_DATABASE_PARTDATA 
6-56 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_DATABASE_PARTDATA 
Purpose:  This keyword enables the output of EM data for every part deﬁned.  . 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be dumped. 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle is generated. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the EM timestep will be used. 
Remarks: 
1. 
The ﬁle name for this database is em_partData_XXX.dat with XXX the part ID.  
2. 
Outputs the part EM energies of the part as well as the Lorentz force.  Also out-
puts the part kinetic energy and the part plastic work energy.

================================================================================
PAGE 405
================================================================================

*EM_DATABASE_POINTOUT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-57 (EM) 
*EM_DATABASE_POINTOUT 
Purpose:  Enable the output of EM data on point sets.  
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PTSID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if LS-DYNA creates the output ﬁle: 
EQ.0: Do not generate the output ﬁle. 
EQ.1: Generate the output ﬁle. 
DTOUT 
Time interval to print the output.  If DTOUT equals 0.0, LS-DYNA 
uses the ICFD time step. 
PTSID 
Point set ID (See *EM_POINT_SET card). 
Remarks: 
1. 
File name. The ﬁle name for this database is em_pointout.dat.

================================================================================
PAGE 406
================================================================================

*EM 
*EM_DATABASE_ROGO 
6-58 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_DATABASE_ROGO 
Purpose:  This keyword enables the output of EM data for every circuit deﬁned.  . 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
1 
0. 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be dumped. 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle is generated. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the EM timestep will be used. 
Remarks: 
1. 
The ﬁle name for this database is em_rogoCoil_XXX.dat  where XXX is the rogo 
Coil ID.

================================================================================
PAGE 407
================================================================================

*EM_DATABASE_TIMESTEP 
*EM 
R16@bdccd6d07 (03/10/25) 
6-59 (EM) 
*EM_DATABASE_TIMESTEP 
Purpose:  This keyword enables the output of EM data regarding the EM timestep. 
 
Output options card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be dumped. 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle is generated. 
Remarks: 
1. 
The ﬁle name for this database is em_timestep.dat.  
2. 
Outputs the run’s EM tim estep versus the time step calculated using the EM 
CFL condition as criteria (autotimestep).  This can be useful in cases with big 
deformations and/or material property changes and a ﬁxed time step is being 
used in case that time step becomes to big compared to the stability time step.

================================================================================
PAGE 408
================================================================================

*EM 
*EM_EP_CELLMODEL_DEFINE_FUNCTION 
6-60 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EP_CELLMODEL_DEFINE_FUNCTION 
Purpose:  Deﬁne a user-deﬁned ionic cell model for Electro-Physiology. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
NSTATE 
FSWITCH
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DVDT 
DU1DT 
DU2DT 
DU3DT 
DU4DT 
DU5DT 
DU6DT 
DU7DT 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
V0 
U1 
U2 
U3 
U4 
U5 
U6 
U7 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID deﬁned in the *MAT section.  If a negative value is en-
tered, the cell model is deﬁned on a node set instead of a part, and 
-MID is the node set where the cell model is deﬁned. 
FSWITCH 
Flag for the ODE deﬁnition (see Remark 1): 
EQ.0: Functions 
EQ.1: Derivatives 

================================================================================
PAGE 409
================================================================================

*EM_EP_CELLMODEL_DEFINE_FUNCTION 
*EM 
R16@bdccd6d07 (03/10/25) 
6-61 (EM) 
 VARIABLE  
 
DESCRIPTION 
NSTATE 
Number of state variables 푢1, 푢2, … , 푢푛. The maximum value is 7 
(see Cards 2 and 3). 
DVDT 
Function ID (see *DEFINE_FUNCTION) for evolution of 푉 (func-
tion 푔 in the equations in Remark 1). 
DUiDT 
Function ID (see *DEFINE_FUNCTION) for evolution of 푢푖 (func-
tion 푓푖 in the equations in Remark 1) 
V0 
Function ID (see *DEFINE_FUNCTION) for initial value of 
푉(푥, 푦, 푧) 
Ui 
Function ID (see *DEFINE_FUNCTION) for initial value of 
푢푖(푥, 푦, 푧)  
Remarks: 
1. 
Model. This keyword enables specifying a user-deﬁned cell model through de-
ﬁned functions (see *DEFINE_FUNCTION).  This model traces the evolution of 
the transmembrane potential, 푉, and 푛 state variables: 푢1, 푢2, … 푢푛. Their tem-
poral evolution depends upon FSWITCH. 
a) If FSWITCH = 0: 
푉(푡) = 푔(푡, 푑푡, 푉(푡−1), 푢1(푡−1), 푢2(푡−1), … , 푢푛(푡−1))
푢1(푡) = 푓1(푡, 푑푡, 푉(푡−1), 푢1(푡−1), 푢2(푡−1), … , 푢푛(푡−1))
푢2(푡) = 푓2(푡, 푑푡, 푉(푡−1), 푢1(푡−1), 푢2(푡−1), … , 푢푛(푡−1))
⋮
푢푛(푡) = 푓푛(푡, 푑푡, 푉(푡−1), 푢1(푡−1), 푢2(푡−1), … , 푢푛(푡−1))
 
b) If FSWITCH = 1: 
휕푉(푡)
휕푡
= 푔(푡, 푑푡, 푉(푡−1), 푢1(푡−1), 푢2(푡−1), … , 푢푛(푡−1)) 
휕푢1(푡)
휕푡
= 푓1(푡, 푑푡, 푉(푡−1), 푢1(푡−1), 푢2(푡−1), … , 푢푛(푡−1))
휕푢2(푡)
휕푡
= 푓2(푡, 푑푡, 푉(푡−1), 푢1(푡−1), 푢2(푡−1), … , 푢푛(푡−1))
⋮
휕푢푛(푡)
휕푡
= 푓3(푡, 푑푡, 푉(푡−1), 푢1(푡−1), 푢2(푡−1), … , 푢푛(푡−1))
 
2. 
Benchmarks.  You can use this model to perform the electrophysiology bench-
marks presented in Pathmanathan and Gray [2014].  

================================================================================
PAGE 410
================================================================================

*EM 
*EM_EP_CELLMODEL_DEFINE_FUNCTION 
6-62 (EM) 
R16@bdccd6d07 (03/10/25) 
References: 
 [1]  
Pathmanathan, P. and R.A. Gray, “Verification of computational models of cardiac electro-physiol-
ogy,” Int J Numer Method Biomed Eng, vol.  30, No.  5, pp.  524-544, (2014).

================================================================================
PAGE 411
================================================================================

*EM_EP_CELLMODEL_FENTONKARMA 
*EM 
R16@bdccd6d07 (03/10/25) 
6-63 (EM) 
*EM_EP_CELLMODEL_FENTONKARMA 
Purpose:  Deﬁne a Fenton-Karma ionic cell model for Electro-Physiology. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TAUD 
TAUR 
TAUSI 
TAUO 
TAUVP 
TAUVM 
TAUWP 
TAUWM 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
UC 
UCSI 
K 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
U0 
V0 
W0 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 

================================================================================
PAGE 412
================================================================================

*EM 
*EM_EP_CELLMODEL_FENTONKARMA 
6-64 (EM) 
R16@bdccd6d07 (03/10/25) 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID deﬁned in *MAT. If a negative value is entered, the cell
model is deﬁned on a node set instead of a part, and -MID is the 
node set where the cell model is deﬁned. 
TAUD 
Time constant 휏푑 described in Equation 5 
TAUR 
Time constant 휏푟 described in Equation 6 
TAUSI 
Time constant 휏푠푖 described in Equation 7 
TAU0 
Time constant 휏0 described in Equation 6 
TAUVP 
Time constant 휏푣푝 described in Equation 3 
TAUVM 
Time constant 휏푣푚 described in Equation 3 
TAUWP 
Time constant 휏푤푝 described in Equation 4 
TAUWM 
Time constant 휏푤푚 described in Equation 4 
UC 
Threshold potential, 푢푐 for activation of 퐽fi (the fast inward current) 
in Equations 3, 4, 5, and 6 
UCSI 
Threshold potential 푢푐
si for activation of 퐽si (the slow inward cur-
rent) in Equation 7 
K 
Constant 푘 in Equation 7 
U0/V0/W0 
Initial values of 푢, 푣, and 푤, respectively 
Remarks: 
The Fenton-Karma model is a simpliﬁed ionic model with three membrane currents that 
approximates well the restitution properties and spiral wave behavior of more complex 
ionic models of cardiac action potential (Beeler-Reuter and others).  It was introduced in 
[1].  
 
The total current ﬂowing through the membrane is given by: 
퐼ion = −퐶푚
휕푉
휕푡= −퐽fi 
(1) 
where 푉 is the transmembrane potential, 퐶푚 is the speciﬁc capacitance of the cell mem-
brane, and 퐽fi is the fast inward current.  
 

================================================================================
PAGE 413
================================================================================

*EM_EP_CELLMODEL_FENTONKARMA 
*EM 
R16@bdccd6d07 (03/10/25) 
6-65 (EM) 
The model depends on three state variables, 푢, 푣, and 푤, and three membrane currents, 
퐽fi, 퐽so (slow outward current), and 퐽si (slow inward current), through the following equa-
tions:  
푑푢
푑푡= −퐽fi −퐽so −퐽si 
(2) 
푑푣
푑푡= Θ(푢푐−푢)(1 −푣)
휏푣푚
−Θ(푢−푢푐)푣
휏푣푝
 
(3) 
푑푤
푑푡= Θ(푢푐−푢)(1 −푤)
휏푤푚
−Θ(푢−푢푐)푤
휏푤푝
 
(4) 
퐽fi = −Θ(푢푐−푢)(1 −푢)(푢−푢푐)
휏푑
 
(5) 
퐽so = 푢Θ(푢푐−푢)
휏표
+ 푢Θ(푢−푢푐)
휏푟
 
(6) 
퐽si = −푤(1 + tanh[푘(푢−푢푐
푠푖])
2휏푠푖
 
(7) 
In the above Θ is the Heaviside step function. 
References: 
 [1]  
Fenton, F. & A. Karma, “Vortex dynamics in three-dimensional continuous myocardium with fiber 
rotation.  Filament instability and fibrillations,” Chaos, Solitons, and Fractals, Vol.  8, No.  1, pp.  661-
686, (1998). 
 [2]  
https://www.ibiblio.org/e-notes/html5/fk.html

================================================================================
PAGE 414
================================================================================

*EM 
*EM_EP_CELLMODEL_FITZHUGHNAGUMO 
6-66 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EP_CELLMODEL_FITZHUGHNAGUMO 
Purpose:  Deﬁne a Fitzhugh-Nagumo ionic cell model for Electro-Physiology. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ALPHA 
BETA 
GAMMA 
C 
MU1 
MU2 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
V 
R 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID deﬁned in *MAT. If a negative value is entered, the cell
model is deﬁned on a node set instead of a part, and -MID is the 
node set where the cell model is deﬁned. 
ALPHA 
Excitation constant 훼 described in Equation 1 
BETA 
Excitation constant 훽 described in Equation 2 

================================================================================
PAGE 415
================================================================================

*EM_EP_CELLMODEL_FITZHUGHNAGUMO 
*EM 
R16@bdccd6d07 (03/10/25) 
6-67 (EM) 
 VARIABLE  
 
DESCRIPTION 
GAMMA 
Excitation constant 훾 described in Equation 2 
C 
Excitation constant 푐 described in Equation 1 
MU1 
Excitation constant 휇1 described in Equation 2 
MU2 
Excitation constant 휇2 described in Equation 2 
V 
Initial value of 푉 
R 
Initial value of 푟 
Remarks: 
In the Fitzhugh-Nagumo model, the excitation is deﬁned by a cubic polynomial along 
with one recovery variable, 푟. The transmembrane current, 퐼ion, is given by: 
퐼ion = −퐶푚
휕푉
휕푡= −푐푉(푉−훼)(푉−1) −푟푉 
(1) 
Here 푉 is the transmembrane potential, 퐶푚 is the speciﬁc capacitance of the cell mem-
brane, and 푐 and 훼 are excitation constants. 
 
The recovery variable 푟 evolves according to: 
푑푟
푑푡= (훾+
푟휇1
휇2 + 푉)(−푟−푐푉(푉−훽−1)) 
(2) 
where 훽, 훾, 휇1 and 휇2 are excitation constants. 
References: 
 [1]  
Aliev, R.R. and Panfilov, A.V., “A simple two-variable model of cardiac excitation,” Chaos, Solitons, 
and Fractals, Vol 7, No 3, pp 293-301, (1996). 
 [2]  
Pullan, A.J., Cheng, L.K., and Buist, M.L., Mathematically Modelling the Electrical Activity of the 
Heart, World Scientific Publishing Co.  Pte.  Ltd., Singapore, pp 132-133, (2005). 
 [3]  
Baillargeon, B. et al., “The Living Heart Project: A robust and integrative simulator for human heart 
function,” European Journal of Mechanics - A/Solids. Vol 48, pp 38-47, (2014).

================================================================================
PAGE 416
================================================================================

*EM 
*EM_EP_CELLMODEL_TENTUSSCHER 
6-68 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EP_CELLMODEL_TENTUSSCHER 
Purpose:  Deﬁne a ten Tusscher ionic cell model for Electro-Physiology. 
Card Summary: 
Card 1.  This card is required. 
MID 
 
 
 
 
 
 
 
Card 2.  This card is required. 
R 
T 
F 
CM 
VC 
VSR 
VSS 
PKNA 
Card 3.  This card is required. 
KO 
NAO 
CAO 
 
 
 
 
 
Card 4.  This card is required. 
GK1 
GKR 
GKS 
GNA 
GBNA 
GCAL 
GBCA 
GTO 
Card 5.  This card is required. 
GPCA 
GPK 
 
 
 
 
 
 
Card 6.  This card is required. 
PNAK 
KMK 
KMNA 
KNACA 
KSAT 
ALPHA 
GAMMA 
KMCA 
Card 7.  This card is required. 
KMNAI 
KPCA 
 
 
 
 
 
 
Card 8.  This card is required. 
K1 
K2 
K3 
K4 
EC 
MAXSR 
MINSR 
 
Card 9.  This card is required. 
VREL 
VLEAK 
VXFER 
VMAXUP 
KUP 
 
 
 
Card 10.  This card is required. 
BUFC 
KBUFC 
BUFSR 
KBUFSF 
BUFSS 
KBUFSS 
 
 

================================================================================
PAGE 417
================================================================================

*EM_EP_CELLMODEL_TENTUSSCHER 
*EM 
R16@bdccd6d07 (03/10/25) 
6-69 (EM) 
Card 11.  This card is required. 
V 
KI 
NAI 
CAI 
CASS 
CASR 
RPRI 
 
Card 12.  This card is required. 
XR1 
XR2 
XS 
M 
H 
J 
D 
F 
Card 13.  This card is required. 
F2 
FCASS 
S 
R 
 
 
 
 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID deﬁned in *MAT section.  If a negative value is entered, 
the cell model is deﬁned on a node set instead of a part, and -MID 
is the node set where the cell model is deﬁned. 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R 
T 
F 
CM 
VC 
VSR 
VSS 
PKNA 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
R 
Gas constant (J × K-1 × Mol-1) 

================================================================================
PAGE 418
================================================================================

*EM 
*EM_EP_CELLMODEL_TENTUSSCHER 
6-70 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
T 
Temperature (K) 
F 
Faraday constant (C × mmol-1) 
CM 
Cell capacitance for unit surface area (µF × Cm-2) 
VC 
Cytoplasmic volume (µm3) 
VSR 
Sarcoplasmic reticulum volume (µm3) 
VSS 
Subspace volume (µm3) 
PKNA 
Relative 퐼Ks permeability to Na+ 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
KO 
NAO 
CAO 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
KO 
Extracellular K+ concentration (mM) 
NAO 
Extracellular Na+ concentration (mM) 
CAO 
Extracellular Ca2+ concentration (mM) 
 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
GK1 
GKR 
GKS 
GNA 
GBNA 
GCAL 
GBCA 
GTO 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 

================================================================================
PAGE 419
================================================================================

*EM_EP_CELLMODEL_TENTUSSCHER 
*EM 
R16@bdccd6d07 (03/10/25) 
6-71 (EM) 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
GPCA 
GPK 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
GK1, GKR, 
GKS, GNA, 
GBNA, 
GCAL, GB-
CA, GTO, 
GPCA, GPK 
Maximal 퐼K1, 퐼Kr, 퐼Ks, 퐼Na, 퐼bNa, 퐼CaL, 퐼bCa, 퐼to, 퐼pCa, and 퐼pK conduct-
ance, respectively (units: nS × pF-1) 
 
 Card 6 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PNAK 
KMK 
KMNA 
KNACA 
KSAT 
ALPHA 
GAMMA 
KMCA 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 7 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
KMNAI 
KPCA 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PNAK 
푃NaK, parameter for calculating the Na+/K+ pump current (units: 
pA × pF-1). See Reference [1].  

================================================================================
PAGE 420
================================================================================

*EM 
*EM_EP_CELLMODEL_TENTUSSCHER 
6-72 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
KMK,  
KMNA 
퐾mK and 퐾mNa, parameters for calculating the Na+/K+ pump cur-
rent (units: millimolar).  See Reference [1]. 
KNACA, 
KSAT, AL-
PHA, GAM-
MA, KMNAI 
푘NaCa, 푘sat, 훼, 훾, and 퐾mNai, parameters for calculating the Na+/Ca2+
exchanger current (units: millimolar).  See Reference [1]. 
KPCA 
퐾pCa, parameter for calculating Ca2+ pump current (units: millimo-
lar).  See Reference [1]. 
 
 Card 8 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
K1 
K2 
K3 
K4 
EC 
MAXSR 
MINSR 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
Ref 
2 
2 
2 
2 
2 
2 
2 
 
 
 VARIABLE  
 
DESCRIPTION 
K1 
R to O and RI to I 퐼rel transition rate (mM-2 × ms-1) 
K2 
O to I and R to RI 퐼rel transition rate (mM-1 × ms-1) 
K3 
O to R and I to RI 퐼rel transition rate (ms-1) 
K4 
I to O and RI to I 퐼rel transition rate (ms-1) 
EC 
CaSR half-saturation constant of 푘casr (mM) 
MAXSR/MI
NSR 
Maximum and minimum values of 푘casr 
 

================================================================================
PAGE 421
================================================================================

*EM_EP_CELLMODEL_TENTUSSCHER 
*EM 
R16@bdccd6d07 (03/10/25) 
6-73 (EM) 
 Card 9 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VREL 
VLEAK 
VXFER 
VMAXUP 
KUP 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
VREL, 
VLEAK, 
VXFER, 
VMAXUP 
Maximal 퐼rel, 퐼leak, 퐼xfer, and 퐼up conductance (mM × ms-1), respec-
tively.  See Reference [2]. 
KUP 
Half-saturation constant of 퐼up (mM).  See Reference [2]. 
 
 Card 10 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BUFC 
KBUFC 
BUFSR 
KBUFSF 
BUFSS 
KBUFSS 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
Ref 
2 
2 
2 
2 
2 
2 
 
 
 
 VARIABLE  
 
DESCRIPTION 
BUFC 
Total cytoplasmic buﬀer concentration (mM) 
KBUFC 
Cai half-saturation constant for cytoplasmic buﬀer (mM) 
BUFSR 
Total sarcoplasmic buﬀer concentration (mM) 
KBUFSR 
CaSR half-saturation constant for sarcoplasmic buﬀer (mM) 
BUFSS 
Total subspace buﬀer concentration (mM) 
KBUFSS 
CaSS half-saturation constant for subspace buﬀer (mM) 
 

================================================================================
PAGE 422
================================================================================

*EM 
*EM_EP_CELLMODEL_TENTUSSCHER 
6-74 (EM) 
R16@bdccd6d07 (03/10/25) 
 Card 11 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
V 
KI 
NAI 
CAI 
CASS 
CASR 
RPRI 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
Ref 
2 
1 
1 
2 
2 
2 
2 
 
 
 VARIABLE  
 
DESCRIPTION 
V 
Initial value of transmembrane potential (mV) 
KI 
Initial value of Ki, used in potassium dynamics (mM) 
NAI 
Initial value of Nai, used in sodium dynamics (mM) 
CAI 
Initial value of Cai. used in calcium dynamics (mM) 
CASS 
Initial value of CaSS, used in calcium dynamics (mM) 
CASR 
Initial value of CaSR, used in calcium dynamics (mM) 
RPRI 
Initial value of R’, used in calcium dynamics 
 
 Card 12 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
XR1 
XR2 
XS 
M 
H 
J 
D 
F 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
Ref 
1 
1 
1 
1 
1 
1 
2 
2 
 
 VARIABLE  
 
DESCRIPTION 
XR1 
Initial value of 푥푟1, used to compute the rapid time dependent K+
current 

================================================================================
PAGE 423
================================================================================

*EM_EP_CELLMODEL_TENTUSSCHER 
*EM 
R16@bdccd6d07 (03/10/25) 
6-75 (EM) 
 VARIABLE  
 
DESCRIPTION 
XR2 
Initial value of 푥푟2, used to compute the rapid time dependent K+
current  
XS 
Initial value of 푥푠, used to compute slow time dependent K+ current
M 
Initial value of 푚, used to compute the fast Na+ current  
H 
Initial value of ℎ, used to compute the fast Na+ current 
J 
Initial value of 푗, used to compute the fast Na+ current 
D 
Initial value of 푑, used to compute the L-type Ca2+ current 
F 
Initial value of 푓, used to compute the L-type Ca2+ current 
 
 Card 13 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
F2 
FCASS 
S 
R 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
Ref 
2 
2 
1 
1 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
F2 
Initial value of 푓2, used to compute the L-type Ca2+ current 
FCASS 
Initial value of 푓cass, used to compute the L-type Ca2+ current 
S 
Initial value of 푠, used to compute the transient outward current  
R 
Initial value of 푟, used to compute the transient outward current 
Remarks: 
This is a model of the action potential of human ventricular cells that, while including a 
high level of electrophysiological detail, is computationally cost-eﬀective enough to be 
applied in large-scale spatial simulations for the study of reentrant arrhythmias.  Please 
see the references for details.  This model is based on [2]. 

================================================================================
PAGE 424
================================================================================

*EM 
*EM_EP_CELLMODEL_TENTUSSCHER 
6-76 (EM) 
R16@bdccd6d07 (03/10/25) 
References: 
 [1]  
ten Tusscher, K.H.W.J., D. Noble, P.J. Noble, and A.V. Panfilov, “A model for human ventricular 
tissue,” Am J Physiol Heart Circ Physiol, vol 286, no 4, pp H1573-H1589, (2004). 
 [2]  
ten Tusscher, K.H.W.J. and A.V. Panfilov, “Alternans and spiral breakup in human ventricular tissue 
model,” Am J Physiol Heart Circ Physiol, vol 291, no 3, pp H1088-H1100, (2006).

================================================================================
PAGE 425
================================================================================

*EM_EP_CELLMODEL_TOMEK 
*EM 
R16@bdccd6d07 (03/10/25) 
6-77 (EM) 
*EM_EP_CELLMODEL_TOMEK 
Purpose:  Deﬁne a ToR-ORd model for cardiac electrophysiology [1]. 
WARNING: As of version R15, this keyword is deprecated.  Instead, 
use *EM_EP_CELLMODEL_TOR_ORD which is an 
updated version of this keyword. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
PHIEND 
PHIMYO 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
none 
0.0 
0.0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID: refers to MID in the *PART card.  If a negative value 
is entered, the cell model is deﬁned on a node set instead of a part,
and -MID is the node set where the cell model is deﬁned. 
PHIEND 
Value between 0.0 and 1.0 giving the ratio of the cardiac tissue to 
be considered endocardial in the ToR-Ord cell model. 
PHIMYO 
Value between 0.0 and 1.0 giving the ratio of the cardiac tissue to 
be considered myocardial in the ToR-Ord cell model. 
References: 
 [1]  
Tomek J., Bueno-Orovio A., Passini E., Zhou X., Minchole A., Britton O., Bartolucci C., Severi S., 
Shrier A., Virag L., Varro A., and Rodriguez B., “Development, calibration, and validation of a novel 
human ventricular myocyte model in health, disease, and drug block,” Elife (2019).

================================================================================
PAGE 426
================================================================================

*EM 
*EM_EP_CELLMODEL_TOR_ORD 
6-78 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EP_CELLMODEL_TOR_ORD 
Purpose:  Deﬁne a ToR-ORd model for cardiac electrophysiology [1]. 
NOTE: This keyword is an updated version of *EM_EP_CELLMODEL_-
TOMEK. For versions R15 and later, *EM_EP_CELLMODEL_-
TOR_ORD is the preferred keyword, and *EM_EP_CELLMOD-
EL_TOMEK is deprecated. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
LDID 
PHIEND 
PHIMYO 
 
 
 
 
Type 
I 
I 
F 
F 
 
 
 
 
Default 
none 
none 
0.0 
0.0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID. It refers to MID in the *PART card.  If a negative value 
is entered, the cell model is deﬁned on a node set instead of a part,
and -MID is the node set where the cell model is deﬁned. 
LDID 
ID of the *EM_EP_LAPLACE_DIRICHLET solution to be used for 
transmural depth deﬁnition 
PHIEND 
Value between 0.0 and 1.0 giving the ratio of the cardiac tissue to 
be considered endocardial in the ToR-Ord cell model. 
PHIMYO 
Value between 0.0 and 1.0 giving the ratio of the cardiac tissue to 
be considered myocardial version in the ToR-Ord cell model. 
References: 
 [1]  
Tomek J., Bueno-Orovio A., Passini E., Zhou X., Minchole A., Britton O., Bartolucci C., Severi S., 
Shrier A., Virag L., Varro A., and Rodriguez B., “Development, calibration, and validation of a novel 
human ventricular myocyte model in health, disease, and drug block,” Elife (2019).

================================================================================
PAGE 427
================================================================================

*EM_EP_CELLMODEL_USERMAT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-79 (EM) 
*EM_EP_CELLMODEL_USERMAT 
Purpose:  Specify a user material for an ionic cell model to be used in electrophysiology 
simulations.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID.  A unique number must be speciﬁed (see *PART).  If a 
negative value is entered, the cell model is deﬁned on a node set 
instead of a part, and -MID is the node set where the cell model is 
deﬁned. 

================================================================================
PAGE 428
================================================================================

*EM 
*EM_EP_CREATEFIBERORIENTATION 
6-80 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EP_CREATEFIBERORIENTATION 
Purpose:  Deﬁne ﬁber orientation by solving a Laplace-Dirichlet system deﬁned by *EM_-
EP_LAPLACE_DIRICHLET. This feature is based on [1]. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PSID 
LDID1 
LDID2 
ALPHA 
BETA 
IEXPORT 
IPRERUN 
 
Type 
I 
I 
I 
F 
F 
I 
I 
 
Default 
none 
none 
none 
0.0 
0.0 
0 
0 
 
 
 VARIABLE  
 
DESCRIPTION 
PSID 
Part set ID of the part set on which the system is solved 
LDID1 
ID of the Laplace system that is solved in the transmural direction
LDID2 
ID of the Laplace system that is solved in the apicobasal direction
ALPHA 
Helical angle with respect to the counterclockwise circumferential
direction in the heart when looking from the base towards the 
apex.  
LT.0: |ALPHA| is the ID for the *DEFINE_FUNCTION giving 
the helical angle.  See Remark 1 for available arguments.  
BETA 
Angle with respect to the outward transmural axis of the heart.  
LT.0: |BETA| is the ID for the *DEFINE_FUNCTION giving the 
angle.  See Remark 1 for available arguments. 
IEXPORT 
Selects whether result ﬁles (ELEMENT_SOLID_ORTHO.k and vtk
ﬁles) are exported: 
EQ.0: Not exported 
EQ.1: Exported 
IPRERUN 
Select whether the run is stopped after creating ﬁbers: 
EQ.0: Do not stop after ﬁber creation 
EQ.1: Stop after ﬁber creation 

================================================================================
PAGE 429
================================================================================

*EM_EP_CREATEFIBERORIENTATION 
*EM 
R16@bdccd6d07 (03/10/25) 
6-81 (EM) 
Remarks: 
1. 
*DEFINE_FUNCTION Arguments. The arguments for the function deﬁned with 
*DEFINE_FUNCTION may include the following: f(x_ele, y_ele, z_ele, phi_len, 
phi_thi). Here phi_len and phi_thi are the potentials corresponding to the poten-
tials solved in LDID1 and LDID2, respectively. 
References: 
 [1]  
Bayer, J.D., Blake, R. C., Plank, G., and Trayanova, N. A., “A novel rule-based algorithm for assign-
ing myocardial ﬁber orientation to computational heart models,” Annals of biomedical engineering, 
40(10), 2243-2254 (2012).

================================================================================
PAGE 430
================================================================================

*EM 
*EM_EP_ECG 
6-82 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EP_ECG 
Purpose:  Compute pseudo-ECGs on a set of virtual points.  LS-DYNA exports a ﬁle 
named em_ECG_{ECGID}.dat. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ECGID 
PSID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ECGID 
ID of the ECG computation 
PSID 
Point set ID containing the list of virtual points on which the 
pseudo-ECGs are computed  

================================================================================
PAGE 431
================================================================================

*EM_EP_EIKONAL 
*EM 
R16@bdccd6d07 (03/10/25) 
6-83 (EM) 
*EM_EP_EIKONAL 
Purpose:  Set up the eikonal (EMSOL = 14) or reaction eikonal, RE, (EMSOL = 15) models. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EIKID 
EIKPST 
EIKSNS 
EIKSDF 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
0 
 
 
 
 
 
RE Card. Additional parameters for the RE model (EMSOL = 15) 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FTYPE 
FT 
FA 
 
 
 
 
 
Type 
I 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EIKID 
ID of the eikonal solver 
EIKPST 
Part set ID on which the eikonal solve is performed 
EIKSNS 
Node set ID where the seed (meaning initial activation time values) 
is set 
EIKSDF 
*DEFINE_FUNCTION ID for deﬁning the seed value.  Accepted 
arguments by the *DEFINE_FUNCTION are the node coordinates 
using the names “x_node, y_node, z_node.” If no *DEFINE_-
FUNCTION is used (EIKSDF = 0), the activation time is set to 0.0 
on EIKSNS. 
FTYPE 
Type of foot current: 
EQ.1: Neic model.  FA gives the foot current between the activa-
tion time and the activation time plus FT. 

================================================================================
PAGE 432
================================================================================

*EM 
*EM_EP_EIKONAL 
6-84 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
FT 
Duration of the foot current 
FA 
Amplitude of the foot current 
References: 
 [1]  
A. Neic et al., “Efficient computation of electrograms and ECGs in human whole heart simulations 
using a reaction-eikonal model,” Journal of Computational Physics, 346 (2017), 191–211.

================================================================================
PAGE 433
================================================================================

*EM_EP_ISOCH 
*EM 
R16@bdccd6d07 (03/10/25) 
6-85 (EM) 
*EM_EP_ISOCH 
Purpose:  Compute isochrones of activation/repolarization of a cardiac electrophysiol-
ogy wave of one or several beats.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ISOCHID 
IDEPOL 
DPLTHR 
IREPOL 
RPLTHR CYCLEMIN
APDMIN 
 
Type 
I 
I 
F 
I 
F 
F 
F 
 
Default 
none 
0 
none 
0 
none 
0.0 
0.0 
 
 
 VARIABLE  
 
DESCRIPTION 
ISOCHID 
ID of the isochrone 
IDEPOL 
Flag to activate the computation of depolarization: 
EQ.0: Oﬀ 
EQ.1: On 
DPLTHR 
Amplitude threshold used for measuring depolarization 
IREPOL 
Flag to activate the computation of repolarization times: 
EQ.0: Oﬀ 
EQ.1: On 
RPLTHR 
Amplitude threshold used for measuring repolarization 
CYCLEMIN 
Minimum time between two consecutive depolarizations (used in 
the EP eikonal model with time stepping) 
APDMIN 
Minimum time between depolarization and repolarization (used in 
the EP eikonal model with time stepping) 

================================================================================
PAGE 434
================================================================================

*EM 
*EM_EP_LAPLACE_DIRICHLET 
6-86 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EP_LAPLACE_DIRICHLET 
Purpose:  Deﬁne the boundary conditions of the Laplace-Dirichlet system to be solved to 
deﬁne ﬁber orientation, based on [1].  The system is solved by using *EM_EP_CREATE-
FIBERORIENTATION. This keyword was formerly called *EM_EP_FIBERINITIAL in 
versions R14 and earlier. 
 
Include as many of this card as needed.  The next keyword (“*”) card terminates this 
input. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LDID 
PID 
STYPE 
SID1 
SID0 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LDID 
ID of the Laplace system to solve (deﬁne a new ID with each new 
card) 
PID 
Part ID on which the system is solved 
STYPE 
Set type for the boundary condition: 
EQ.1: Segment set 
EQ.2: Node set 
SID1 
Set on which a potential of value 1 is prescribed 
SID0 
Set on which a potential of value 0 is prescribed 
References: 
 [1]  
Bayer, J.D., Blake, R. C., Plank, G., and Trayanova, N. A., “A novel rule-based algorithm for assign-
ing myocardial ﬁber orientation to computational heart models,” Annals of biomedical engineering, 
40(10), 2243-2254 (2012).

================================================================================
PAGE 435
================================================================================

*EM_EP_PURKINJE_NETWORK 
*EM 
R16@bdccd6d07 (03/10/25) 
6-87 (EM) 
*EM_EP_PURKINJE_NETWORK 
Purpose:  Deﬁne a Purkinje network that consists of conductive beams and lies on a given 
surface, based on Costabal et al [2016].  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PURKID BUILDNET
SSID 
MID 
POINTSTX POINTSTY POINTSTZ EDGELEN
Type 
I 
I 
I 
I 
F 
F 
F 
F 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NGEN 
NBRINIT 
NSPLIT 
INODEID 
IEDGEID 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PURKID 
ID for the Purkinje network 
BUILDNET 
Flag to create Purkinje network: 
EQ.0: Purkinje network not created. 
EQ.1: New Purkinje network created. 
SSID 
Segment set on which the Purkinje network is lying 
MID 
Material ID deﬁned in the *MAT section. 
POINTSTX 
푋 coordinate of the tree origin 
POINTSTY 
푌 coordinate of the tree origin 
POINTSTZ 
푍 coordinate of the tree origin 
EDGELEN 
Edge length 
NGEN 
Number of generations of branches 
NBRINIT 
Number of branches attached to the tree origin 

================================================================================
PAGE 436
================================================================================

*EM 
*EM_EP_PURKINJE_NETWORK 
6-88 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
NSPLIT 
Number of nodes between two consecutive branchings as shown
in Figure 6-3 
INODEID 
Initial node ID 
IEDGEID 
Initial edge ID. These edges are internally generated by LS-DYNA.
References: 
Costabal, F.S., D. E. Hurtado, and E. Kuhl, “Generating Purkinje networks in the human 
heart,” Journal of Biomechanics, vol.  49, issue 12, pp.  2455–2465, (2016).
1
4
10
16
22
21
43
 
Figure 6-3.  Example of part of a network.  For this network, NSPLIT = 4. 

================================================================================
PAGE 437
================================================================================

*EM_EP_TENTUSSCHER_STIMULUS 
*EM 
R16@bdccd6d07 (03/10/25) 
6-89 (EM) 
*EM_EP_TENTUSSCHER_STIMULUS 
Purpose:  Deﬁne a stimulation pattern of a Tentusscher cell model (requires the use of 
*EM_EP_CELLMODEL_TENTUSSCHER).  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
STIMID 
SETTYPE
SETID 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable STIMSTRT
STIMT 
STIMDUR STIMAMP
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
STIMID 
ID of the stimulation 
SETTYPE 
Set type:  
EQ.1: Segment set  
EQ.2: Node set 
SETID 
Node set or segment set ID to be stimulated 
STIMSTRT 
Starting time of the stimulation 
STIMT 
Stimulation period 
STIMDUR 
Stimulation duration 
STIMAMP 
Stimulation amplitude (picoA/picoF) 

================================================================================
PAGE 438
================================================================================

*EM 
*EM_EOS_BURGESS 
6-90 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EOS_BURGESS 
Purpose:  Deﬁne the parameters for a Burgess model giving the electrical conductivity as 
as a function of the temperature and the density, see: 
 
T.J. Burgess, “Electrical resistivity model of metals”, 4th International Conference on Megagauss 
Magnetic-Field Generation and Related Topics, Santa Fe, NM, USA, 1986 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
V0 
GAMMA 
THETA 
LF 
C1 
C2 
C3 
Type 
I 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
C4 
K 
EXPON 
LGTUNIT 
TIMUNIT 
TEMUNI 
ADJUST 
 
Type 
F 
F 
I 
F 
F 
I 
I 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
In the following, UUS stands for User Units System and BUS for Burgess Units  
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
ID of the EM_EOS (speciﬁed by an *EM_MAT card) 
V0 
Reference speciﬁc volume V0 (UUS). 
GAMMA0 
Reference Gruneisen value γ0.(no units). 
THETA 
Reference melting temperature θm,0 in eV (BUS). 
LF 
Latent heat of fusion LF in kJoule/mol (BUS). 
C1 
C1 constant (BUS) 
C2 
C2 constant (no units) 

================================================================================
PAGE 439
================================================================================

*EM_EOS_BURGESS 
*EM 
R16@bdccd6d07 (03/10/25) 
6-91 (EM) 
 VARIABLE  
 
DESCRIPTION 
C3 
C3 constant (no units) 
C4 
C4 constant (no units) 
K 
Parameter k (no units). 
EXPON 
Exponent in equations (2) (see remarks) 
LGTUNIT 
Length units for UUS (relative to meter, i.e. = 1.e-3 if UUS in mm).
TIMUNIT 
Time units for UUS (relative to seconds). 
TEMUNIT 
Temperature units 
EQ.1: temperature in Celsius 
EQ.2: temperature in Kelvins 
ADJUST 
Conductivity modiﬁcation 
EQ.0: (default) The conductivity is given by the Burgess for-
mula. 
EQ.1: The conductivity is adjusted so that it is equal to the con-
ductivity deﬁned in *EM_MAT card σmat at room temper-
ature: 
σ(θ) = σBurgess(θ)
σmat
σBurgess(θroom)
Remarks: 
1. 
The Burgess model gives the electrical resistivity vs temperature and density for 
the solid phase, liquid phase and vapor phase.  At this time, only the solid and 
liquid phases are implemented.  To check which elements are in the solid and in 
the liquid phase, a melting temperature is ﬁrst computed by: 
θ푚= θ푚,0 ( 푉
푉0
)
−1
3 푒
(2γ0−1)(1−푉
푉0
) 
a) If T < 휃푚: solid phase model applies. 
The solid phase electrical resistivity corresponds to the Meadon model: 
η푆= (퐶1 + 퐶2θ퐶3)푓푐( 푉
푉0
),
(1)

================================================================================
PAGE 440
================================================================================

*EM 
*EM_EOS_BURGESS 
6-92 (EM) 
R16@bdccd6d07 (03/10/25) 
where θ is the temperature, V is the speciﬁc volume, and V0 is the reference 
speciﬁc volume (zero pressure, solid phase).  In (1), the volume depend-
ence is given by: 
푓푐( 푉
푉0
) =
⎩{{{{{⎨
{{{{{⎧
( 푉
푉0
)
2γ−1
EXPON.EQ. −1 
(most materials)
( 푉
푉0
)
2γ+1
EXPON.EQ. +1 
(tungsten)
( 푉
푉0
)
2γ
EXPON.EQ. 0
(stainless steel)
 
(2)
with 
γ = γ0 −(γ0 −1
2) (1 −푉
푉0
)
(3)
b) If T > θm : liquid phase model: 
η퐿= (η퐿)θ푚( θ
θ푚
)
퐶4
(4)
with 
(η퐿)θ푚= ∆η(η푆)θ푚 
where 
∆휂=
⎩{{⎨
{{⎧푘푒0.69퐿퐹/θ푚
푘> 0
1 + 0.0772(2 −θ푚)
푘= −1
(tungsten)
1 + 0.106(0.846 −θ푚)
푘= −2
(stainless steel SS-304)
 
(5)
The following table reports some sets of parameters given by Burgess in 
his paper: 
 
Parameter 
Cu 
Ag 
Au 
W 
Al(2024) 
SS(304) 
V0(cm3/gm) 
0.112 
0.0953 
0.0518 
0.0518 
0.370 
0.1265 
γ0 
2.00 
2.55 
3.29 
1.55 
2.13 
2.00 
θm,0 (BUS) 
0.117 
0.106 
0.115 
0.315 
0.0804 
0.156 
LF (BUS) 
0.130 
0.113 
0.127 
0.337 
0.107 
0.153 
C1 (BUS) 
-4.12e-5 
-3.37e-5 
-4.95e-5 
-9.73e-5 
-5.35e-5 
0 

================================================================================
PAGE 441
================================================================================

*EM_EOS_BURGESS 
*EM 
R16@bdccd6d07 (03/10/25) 
6-93 (EM) 
Parameter 
Cu 
Ag 
Au 
W 
Al(2024) 
SS(304) 
C2 
0.113 
0.131 
0.170 
0.465 
0.233 
0.330 
C3 
1.145 
1.191 
1.178 
1.226 
1.210 
0.4133 
EXPON 
-1 
-1 
-1 
+1 
-1 
0 
C4 
0.700 
0.672 
0.673 
0.670 
0.638 
0.089 
k 
0.964 
0.910 
1.08 
-1. 
0.878 
-2. 

================================================================================
PAGE 442
================================================================================

*EM 
*EM_EOS_MEADON 
6-94 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EOS_MEADON 
Purpose:  Deﬁne the parameters for a Meadon model, giving the electrical conductivity 
as a function of the temperature and the density; see: 
 
T.J. Burgess, “Electrical resistivity model of metals”, 4th International Conference on Megagauss 
Magnetic-Field Generation and Related Topics, Santa Fe, NM, USA, 1986 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
C1 
C2 
C3 
TEMUNI 
V0 
GAMMA 
EXPON 
Type 
I 
F 
F 
F 
I 
F 
F 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LGTUNIT 
TIMUNIT 
ADJUST 
 
 
 
 
 
Type 
F 
F 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
In the following, UUS stands for User Units System and BUS for Burgess Units. 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
ID of the EM_EOS 
C1 
C1 constant (BUS) 
C2 
C2 constant (no units) 
C3 
C3 constant (no units) 
TEMUNIT 
Temperature units 
EQ.1: temperature in Celsius 
EQ.2: temperature in Kelvins 

================================================================================
PAGE 443
================================================================================

*EM_EOS_MEADON 
*EM 
R16@bdccd6d07 (03/10/25) 
6-95 (EM) 
 VARIABLE  
 
DESCRIPTION 
V0 
Reference speciﬁc volume V0 (UUS). 
GAMMA0 
Reference Gruneisen value γ0.(no units). 
EXPON 
Exponent in equations (7) 
LGTUNIT 
Length units for UUS (relative to meter, i.e. = 1.e-3 if UUS in mm).
TIMUNIT 
Time units for UUS (relative to seconds). 
ADJUST: 
EQ.0: (default) the conductivity is given by the Burgess formula.
EQ.1: The conductivity is adjusted so that it is equal to the con-
ductivity deﬁned in the *EM_MAT card σmatat room tem-
perature: 
σ(θ) = σBurgess(θ)
σmat
σBurgess(θroom) 
Remarks: 
1. 
The Meadon model is a simpliﬁed Burgess model with the solid phase equations 
only. 
The electrical resistivity is given by: 
η푆= (퐶1 + 퐶2θ퐶3)푓푐( 푉
푉0
) 
(6)
where θ is the temperature, V is the speciﬁc volume, and V0 is the reference spe-
ciﬁc volume (zero pressure, solid phase). 
In (6), the volume dependence is given by: 
푓푐( 푉
푉0
) =
⎩{{{{{{⎨
{{{{{{⎧
( 푉
푉0
)
2γ−1
EXPON.EQ. −1
(most materials)
( 푉
푉0
)
2γ+1
EXPON.EQ. +1
(tungsten)
( 푉
푉0
)
2γ
EXPON.EQ.0
(stainless steel)
1
VO.EQ. 0
(default value for 푉0 is zero)
 
(7)
 (In this last case, only EOSID, C1, C2, C3, TEMUNIT, TIMUNIT and LGTUNIT 
need to be deﬁned) 
with, 

================================================================================
PAGE 444
================================================================================

*EM 
*EM_EOS_MEADON 
6-96 (EM) 
R16@bdccd6d07 (03/10/25) 
γ = γ0 −(γ0 −1
2) (1 −푉
푉0
) 
(8)
The following table reports some sets of parameters given by Burgess in his pa-
per: 
 
Parameter 
Cu 
Ag 
Au 
W 
Al(2024) 
SS(304) 
V0(cm3/gm) 
0.112 
0.0953 
0.0518 
0.0518 
0.370 
0.1265 
γ0 
2.00 
2.55 
3.29 
1.55 
2.13 
2.00 
C1 (BUS) 
-4.12e-5 
-3.37e-5 
-4.95e-5 
-9.73e-5 
-5.35e-5 
0 
C2 
0.113 
0.131 
0.170 
0.465 
0.233 
0.330 
C3 
1.145 
1.191 
1.178 
1.226 
1.210 
0.4133 
EXPON 
-1 
-1 
-1 
+1 
-1 
0 

================================================================================
PAGE 445
================================================================================

*EM_EOS_PERMEABILITY 
*EM 
R16@bdccd6d07 (03/10/25) 
6-97 (EM) 
*EM_EOS_PERMEABILITY 
Purpose:  Deﬁne the parameters for the behavior of a material’s permeability. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
EOSTYPE
LCID 
BS/POLY 
MUR0 
C 
TC 
 
Type 
I 
I 
I 
F 
F 
F 
F 
 
Default 
none 
none 
none 
0. 
0. 
0. 
0. 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
ID of the EM_EOS 
EOSTYPE 
Deﬁne the type of EOS: 
EQ.1: Permeability deﬁned by 퐵 as a function of 퐻 curve 
(퐵= 휇퐻). The abscissa of the curve is 퐻, and the ordi-
nate is 퐵. 
EQ.2: Permeability deﬁned by a 퐻 function of 퐵 curve (퐻=
퐵/휇). The abscissa of the curve is 퐵, and the ordinate 
is 퐻. 
EQ.3: Permeability deﬁned by a load curve where 퐵-퐻
curves (퐵= 휇퐻) may be deﬁned as a function of von 
Mises stress.  The abscissa of the curve is von Mises 
stress, and the ordinate is a load curve ID for the 퐵-퐻
load curves.  The abscissa for each 퐵-퐻 load curve is 
퐻, and the ordinate is 퐵.   
EQ.4: Permeability deﬁned by a load curve where 퐵-퐻 load 
curves (퐵= 휇퐻) may be deﬁned as a function of tem-
perature.  The abscissa of the curve is temperature,
and the ordinate is load curve ID for the 퐵-퐻 load 
curves.  The abscissa for each 퐵-퐻 load curve is 퐻, and 
the ordinate is 퐵.   
EQ.7: Permeability given by an analytical arctan law deﬁn-
ing 퐵 as a function of 퐻 and optionally temperature. 
See Remark 1. 
EQ.8: Permeability given by the Froelich law deﬁning 퐵 as 
a function of 퐻 and optionally temperature.  See 

================================================================================
PAGE 446
================================================================================

*EM 
*EM_EOS_PERMEABILITY 
6-98 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
Remark 2. 
LCID 
Load curve ID for EOSTYPE = 1, 2, 3, and 4. Ignored if 
EOSTYPE = 7 or 8. 
BS/MUR0/C/TC 
Saturation magnetic ﬂux (퐵푠), relative permeability at a refer-
ence temperature (휇푟0), constant value (퐶), and Curie temper-
ature (푇푐), respectively.  These parameters are used by the 
analytical laws (EOSTYPE = 7 and 8).  See Remarks 1 and 2. 
POLY 
Applies a polynomial smoothing on the input load curve for
EOSTYPE = 1 and 2. See Remark 3. 
EQ.0: Oﬀ 
EQ.1: On 
Remarks: 
1. 
Arctan analytical law.  For EOSTYPE = 7, the solver applies the following ana-
lytical law: 
퐵(퐻, 푇) = 휇0퐻+ 2퐵푠
휋atan
⎝
⎜⎛휋
2퐵푠
퐻휇0(휇푟0 −1. )
⎠
⎟⎞× 퐹(푇) × SF 
SF is an optional coeﬃcient deﬁned by the material properties (see Remark 3 
on *EM_MAT_002). 퐹(푇) provides temperature dependence. 퐵푠 and 휇푟0 are in-
put parameters. 휇0 is the permeability of free space and is hard-coded in the 
solver.  By default, SF = 1 and 퐹(푇) = 1. If 퐶 is deﬁned, 퐹(푇) becomes: 
퐹(푇) = max (0. ,1. −exp (푇−푇푐
퐶
)) 
푇푐 is an input parameters. 
2. 
Froelich analytical law.  For EOSTYPE = 8, the solver applies the following an-
alytical law: 
퐵(퐻, 푇) = 휇0퐻+ 퐻
퐵푠
1. +휇푟0퐻× 퐹(푇) × SF 
SF is an optional coeﬃcient deﬁned by material properties (see Remark 3 on 
*EM_MAT_002). 퐹(푇) provides temperature dependence.  By default, SF = 1 
and 퐹(푇) = 1. If 퐶 is deﬁned, 퐹(푇) becomes: 
퐹(푇) = max (0. ,1. −exp (푇−푇푐
퐶
)) 
푇푐 is an input parameters. 

================================================================================
PAGE 447
================================================================================

*EM_EOS_PERMEABILITY 
*EM 
R16@bdccd6d07 (03/10/25) 
6-99 (EM) 
3. 
Polynomial approach.  For EOSTYPE = 1 or 2, in some cases the input 퐵-퐻 
curve contains few points or has some ill-deﬁned areas.  In such scenarios, it can 
be useful to reconstruct the curve using a polynomial approach.  Accuracy can 
increase with reduced computational time.  The smoothed load curve is output 
to a keyword ﬁle em_polyCurve_LCID.dat for reference.  It is not necessarily 
recommended to use this feature if the original 퐵-퐻 curve is well deﬁned.

================================================================================
PAGE 448
================================================================================

*EM 
*EM_EOS_TABULATED1 
6-100 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_EOS_TABULATED1 
Purpose:  Deﬁne the electrical conductivity or permeability depending on the material 
referencing this EOS as a function of temperature by using a load curve.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
LCID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
  
 VARIABLE  
 
DESCRIPTION 
EOSID 
ID of the EM EOS 
LCID 
Load curve ID.  See Remark 1. 
Remarks: 
1. 
Suggestions for the Load Curve. The load curve describes the electrical con-
ductivity or permeability (ordinate) as a function of the temperature (abscissa).  
You need to make sure the temperature and the electrical conductivity / perme-
ability given by the load curve are in the correct units.  Also, we advise giving 
some bounds to the load curve (conductivities / permeabilities at very low and 
very high temperatures) to avoid bad extrapolations of the conductivity if the 
temperature gets out of the load curve bounds.

================================================================================
PAGE 449
================================================================================

*EM_EOS_TABULATED2 
*EM 
R16@bdccd6d07 (03/10/25) 
6-101 (EM) 
*EM_EOS_TABULATED2 
Purpose:  Deﬁne the electrical conductivity or permeability (depending on the material 
model referencing this EOSID) as a function of time by using a load curve. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
EOSID 
LCID 
IFLAG 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EOSID 
ID of the EM EOS 
LCID 
Load curve ID (see Remark 1), function ID (see *DEFINE_FUNC-
TION), table ID or 2D table ID. For the arguments for the *DE-
FINE_FUNCTION, see Remark 2. 
IFLAG 
If LCID is a table ID or 2D table ID, conductivity / permeability is 
a function of temperature and material density.  This ﬂag dictates 
how LS-DYNA interprets the table.  In other words, it speciﬁes 
which property (temperature or material density) is the value for 
the table and which is the ordinate for load curves in the table: 
EQ.0: Temperature (value) indexes each conductivity/permea-
bility (ordinate) versus material density (abscissa) load 
curve. 
EQ.1: Material density indexes each conductivity/permeability
(ordinate) versus temperature (abscissa) load curve.  
Remarks: 
1. 
Suggestions for the Load Curve. The load curve describes the electrical con-
ductivity / permeability (ordinate) as a function of time (abscissa).  You need to 
make sure the time and the electrical conductivity / permeability given by the 
load curve are in the correct units.  Also, we advise giving some bounds to the 
load curve (conductivities / permeabilities at 푡 =  0 and after a long time) to 
avoid bad extrapolations of the conductivity / permeability if the run time gets 
out of the load curve bounds. 

================================================================================
PAGE 450
================================================================================

*EM 
*EM_EOS_TABULATED2 
6-102 (EM) 
R16@bdccd6d07 (03/10/25) 
2. 
*DEFINE_FUNCTION Arguments.  LCID can also refer to a *DEFINE_FUNC-
TION ID. If a *DEFINE_FUNCTION is used, the following parameters are al-
lowed: f(vx, vy, vz, temp, pres, vol, mass, Ex, Ey, Ex, Bx, By, Bz, Fx, Fy, Fz, 
JHrate, time, x, y, z). (Fx, Fy, Fz) refers to the Lorentz force vector.

================================================================================
PAGE 451
================================================================================

*EM_EXTERNAL_FIELD 
*EM 
R16@bdccd6d07 (03/10/25) 
6-103 (EM) 
*EM_EXTERNAL_FIELD 
Purpose:  Deﬁne the components of a time-dependent exterior ﬁeld uniform in space ap-
plied on the conducting parts. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
FIELDID 
FTYPE 
FDEF 
LCIDX 
LCIDY 
LCIDZ 
 
 
Type 
I 
I 
F 
I 
I 
I 
 
 
Default 
0 
0 
0 
0 
0 
0 
 
 
 
Optional Card. Additional input for frequency-based Eddy current cases (EMSOL = 4 in 
*EM_CONTROL). 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
 
 
 
LCIDXI 
LCIDYI 
LCIDZI 
 
 
Type 
 
 
 
I 
I 
I 
 
 
Default 
 
 
 
optional optional optional
 
 
 
 VARIABLE  
 
DESCRIPTION 
FIELDID 
External Field ID 
FTYPE 
Field type:  
EQ.1: Magnetic ﬁeld 
EQ.2: Electric ﬁeld (not available yet) 
EQ.3: Charge density (resistive heating solver only).  See Re-
mark 1. 
FDEF 
Field deﬁned by: 
EQ.1: Load curves 
EQ.2: Deﬁne function (see *DEFINE_FUNCTION).  If a deﬁne 
function is used, the following parameters are accepted: x, 
y, z, time. See Remark 2. For FTYPE = 3, the additional 

================================================================================
PAGE 452
================================================================================

*EM 
*EM_EXTERNAL_FIELD 
6-104 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
following parameters are accepted: emdt, pot, curr, 
sigma. 
EQ.4: Subroutine usermat_getextfield in the usermat
package.  See Remark 3. 
LCID[X,Y,Z] 
Load curve ID deﬁning the (푋, 푌, 푍) component of the ﬁeld func-
tion of time for FTYPE = 1. For FTYPE = 3, only LCIDY is used and 
should be a simple a load curve or deﬁne function ID. 
LCIDI[X,Y,Z] 
Only available for EMSOL = 4 in *EM_CONTROL. Load curve ID 
deﬁning the (푋, 푌, 푍) component of the optional phase shift func-
tion of time for FTYPE = 1. Unit is in degrees. 
Remarks: 
1. 
Electrostatic problems.  FTYPE = 3 is mostly used in electrostatic problem con-
ﬁgurations.  The material’s conductivity then represents the permittivity.  
2. 
Spatially varying magnetic ﬁelds.   Using FTYPE = 1 and FDEF = 2 enables 
deﬁning a spatially varying ﬁeld.  The coordinates given as arguments by the 
*DEFINE_FUNCTION represent the coordinates at the midpoint of the BEM 
edges. 
3. 
Deﬁning ﬁeld with usermat.   Using FTYPE = 1 and FDEF = 4 allows deﬁning 
a spatially varying ﬁeld in even greater detail by accessing the routine called 
usermat_getextfield in dyn21em.f when compiling LS-DYNA in usermat 
mode.  With this subroutine, the user can implement his own law and rules.

================================================================================
PAGE 453
================================================================================

*EM_ISOPOTENTIAL 
*EM 
R16@bdccd6d07 (03/10/25) 
6-105 (EM) 
*EM_ISOPOTENTIAL 
Purpose:  Deﬁne an isopotential.  In other words, constrain nodes so that they have the 
same scalar potential value.  This keyword card can only be used with the type 3 EM 
solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ISOID 
SETTYPE 
SETID 
RDLTYPE
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ISOID 
ID of the isopotential 
SETTYPE 
Set type: 
EQ.1: Segment Set 
EQ.2: Node Set 
EQ.3: Fluid surface part.  See *ICFD_PART. 
SETID 
Set ID 
RDLTYPE 
Used for the battery application (see *EM_RANDLES_BATMAC or 
*EM_RANDLES_TSHELL).  Selects which layers of the underlying
battery cell are associated with the isopotential: 
EQ.0: Default.  No speciﬁc treatment. 
EQ.1: Current Collector Positive 
EQ.2: Positive Electrode 
EQ.3: Separator 
EQ.4: Negative Electrode 
EQ.5: Current Collector Negative 
The function of a layer is deﬁned in *EM_MAT_001. 

================================================================================
PAGE 454
================================================================================

*EM 
*EM_ISOPOTENTIAL_CONNECT 
6-106 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_ISOPOTENTIAL_CONNECT 
Purpose:  Deﬁne a connection between two isopotentials or between an isopotential and 
the ground. 
Card Summary: 
Card 1a.  Include this card for CONTYPE = 1 (short circuit). 
CONID 
CONTYPE 
ISOID1 
ISOID2 
 
 
 
 
Card 1b.  Include this card for CONTYPE = 2, 3, 4, 6, or 7. 
CONID 
CONTYPE 
ISOID1 
ISOID2 
VAL 
LCID 
 
 
Card 1c.  Include this card for CONTYPE = 5 (meshless Randles circuit). 
CONID 
CONTYPE 
ISOID1 
ISOID2 
 
RDLID 
PSID 
 
Card 2.  Include this card for CONTYPE = 6 (RLC circuit).  
L 
C 
V0 
 
 
 
 
 
Data Card Deﬁnitions: 
Short Circuit Connection Card.  Include this card if CONTYPE= 1. 
 Card 1a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CONID 
CONTYPE
ISOID1 
ISOID2 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CONID 
Connection ID 
CONTYPE 
Connection type: 
EQ.1: Short circuit 
ISOID1 
ID of the ﬁrst isopotential to be connected 

================================================================================
PAGE 455
================================================================================

*EM_ISOPOTENTIAL_CONNECT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-107 (EM) 
 VARIABLE  
 
DESCRIPTION 
ISOID2 
Optional ID of the second isopotential to be connected 
 
Resistance, Voltage Source, Current Source, and RLC Circuit Connection Card.
Include this card if CONTYPE= 2, 3, 4, 6, or 7. 
 Card 1b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CONID 
CONTYPE
ISOID1 
ISOID2 
VAL 
LCID 
 
 
Type 
I 
I 
I 
I 
F 
I 
 
 
Default 
none 
none 
none 
0 
none 
0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CONID 
Connection ID 
CONTYPE 
Connection type: 
EQ.2: Resistance 
EQ.3: Voltage source 
EQ.4: Current source 
EQ.6: RLC circuit 
EQ.7: Power (See Remark 1) 
ISOID1 
ID of the ﬁrst isopotential to be connected 
ISOID2 
Optional ID of the second isopotential to be connected 
VAL 
Value of the resistance, voltage, or current depending on CON-
TYPE. Ignored for CONTYPE = 2 through 4 if LCID ≠ 0. 
LCID 
Load curve ID giving the value of the resistance, voltage, or current 
as a function of time.  Only available for CONTYPE = 2 through 4.
LT.0: |LCID| is a *DEFINE_FUNCTION ID. The following ar-
guments are allowed: f(time, emdt, curr1, curr2, pot1, 
pot2, rmesh). pot1 and pot2 are the potential at the previ-
ous time step and at two previous time steps. curr1 and 
curr2 are the current at the previous time step and two pre-
vious time steps. rmesh is the mesh resistance calculated 

================================================================================
PAGE 456
================================================================================

*EM 
*EM_ISOPOTENTIAL_CONNECT 
6-108 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
by the solver at this isopotential.  
 
Meshless Randles Circuit Connection Card.  Include this card if CONTYPE = 5. 
 Card 1c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CONID 
CONTYPE
ISOID1 
ISOID2 
 
RDLID 
PSID 
 
Type 
I 
I 
I 
I 
 
I 
I 
 
Default 
none 
none 
none 
0 
 
none 
0 
 
 
 VARIABLE  
 
DESCRIPTION 
CONID 
Connection ID 
CONTYPE 
Connection type: 
EQ.5: Meshless Randles circuit (used to represent a cell by one 
lumped Randles circuit) 
ISOID1 
ID of the ﬁrst isopotential to be connected 
ISOID2 
Optional ID of the second isopotential to be connected 
VAL 
Value of the resistance, voltage, or current depending on CON-
TYPE 
RDLID 
ID of the Randles circuit deﬁned by *EM_RANDLES_MESHLESS
PSID 
Used if the variable R0TOTH of *EM_RANDLES_MESHLESS 
equals 1. Part set ID where LS-DYNA adds the joule heating corre-
sponding to the resistance 푟0 in *EM_RANDLES_MESHLESS, av-
eraged over the part set. 
 

================================================================================
PAGE 457
================================================================================

*EM_ISOPOTENTIAL_CONNECT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-109 (EM) 
RLC Circuit Parameters Card. Only deﬁned if CONTYPE = 6. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
L 
C 
V0 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
L/C/V0 
Circuit inductance, capacity, and initial voltage.  VAL gives the re-
sistance. 
Remarks: 
1. 
Power boundary condition.  This condition is only available when using the 
EM resistive heating solver (EMSOL = 3 in *EM_CONTROL_SOLVER).  When 
active, the solver solves the resistive heating problem in two steps per time step.  
In the ﬁrst solve, it applies a Dirichlet boundary condition with an imposed volt-
age of 1 to each power boundary condition.  Once the ﬁrst solve is complete, it 
retrieves the current on the boundary in order to update the voltage boundary 
condition to the value corresponding to the user-deﬁned expected value for 
power and solves again.  
In classic resistive heating applications, the classic Ohm’s law is used to deter-
mine the relationship between power, voltage, and current: 
푃= 푉퐼 
In radiofrequency applications (meaning when complex numbers are present), 
power is found by calculating the sum of the real and imaginary parts: 
푃= 푉푟퐼푟+ 푉푖퐼푖

================================================================================
PAGE 458
================================================================================

*EM 
*EM_ISOPOTENTIAL_ROGO 
6-110 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_ISOPOTENTIAL_ROGO 
Purpose:  measures the total current ﬂowing through a given section of the conductor 
and outputs it in an ASCII ﬁle called em_rogoCoil.dat 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ISOID 
SETTYPE 
SETID 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ISOID 
ID of the Rogo coil. 
SETTYPE 
Set type: 
EQ.1: Segment Set. 
SETID 
Set ID 

================================================================================
PAGE 459
================================================================================

*EM_MAT_001 
*EM 
R16@bdccd6d07 (03/10/25) 
6-111 (EM) 
*EM_MAT_001 
Purpose:  Deﬁne the electromagnetic material type and properties for a material whose 
permeability equals the free space permeability.  Electromagnetic materials act like a 
*MAT_ADD, so they must be associated with a *MAT material or an ICFD part.  See Re-
mark 1. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MTYPE 
SIGMA 
EOSID 
 
EPLAMDA
DEATHT 
RDLTYPE
Type 
I 
I 
F 
I 
 
F 
F 
I 
Default 
none 
none 
none 
optional
 
optional
1028 
0 
 
Optional RF Heating Card. Additional material parameters for radio-frequency heating 
(RF) cases. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
 
FREQ 
EPSRR 
EOSID2 
EPSRI 
EOSID3 
EPS0 
 
Type 
 
F 
F 
I 
F 
I 
F 
 
Default 
 
0. 
0. 
optional
0. 
optional
↓ 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID. For all MTYPE except MTYPE = 3, MID must refer-
ence a *MAT material since the electromagnetic properties are
added onto the *MAT properties.  If MTYPE = 3, MID can be left 
blank for the electromagnetic properties to apply to the ICFD en-
tire ﬂuid or it can be the PID of a *ICFD_PART_VOL to apply to 
an ICFD ﬂuid part.  See Remark 1. 
MTYPE 
Deﬁnes the electromagnetism type of the material: 
EQ.0: Air or vacuum 
EQ.1: Insulator material.  These materials have the same elec-
tromagnetism behavior as MTYPE = 0. 
EQ.2: Conductor carrying a source.  In these conductors, the 

================================================================================
PAGE 460
================================================================================

*EM 
*EM_MAT_001 
6-112 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
eddy current problem is solved, which gives the actual 
current density.  Typically, this material would corre-
spond to the coil. 
EQ.3: Fluid conductor.  In this case, MID refers to the ID given
in *ICFD_PART_VOL. See Remark 2. 
EQ.4: Conductor not connected to any current or voltage 
source, where the Eddy current problem is solved.  Typ-
ically, this material would correspond to the workpiece.
SIGMA 
Initial electrical conductivity of the material.  For the eikonal solv-
ers (EMSOL = 14 and 15 on *EM_CONTROL), SIGMA is the wave 
velocity. 
EOSID 
Optional ID of the EOS to be used for the electrical conductivity 
(see *EM_EOS cards). 
EPLAMDA 
Optional.  When deﬁned, this ﬁeld activates the computation of 
extracellular potentials in the purkinje network with the anisot-
ropy ratio given by EPLAMDA. 
DEATHT 
Death time for the material.  After DEATHT, the material will no 
longer be considered a conductor and removed from the EM 
solve.  If a negative value is entered, a *DEFINE_FUNCTION will 
be expected.  The following parameters are allowed: (vx, vy, vz, 
temp, vol, mass, Ex, Ey, Ez, Bx, By, Bz, Fx, Fy, Fz, JHrate, time). 
Fx, Fy, Fz refers to the Lorentz force vector.  A negative value re-
turned by the *DEFINE_FUNCTION corresponds to a “dead” or 
inactive element.  Once an element has been removed from the 
EM solve, it cannot return. 
RDLTYPE 
Used for composite Tshell batteries modeled with *EM_RAN-
DLES_TSHELL.  RDLTYPE speciﬁes the function of the layer as-
sociated to MID: 
EQ.0: Default.  Conductor which is not part of a battery cell. 
EQ.1: Current Collector Positive 
EQ.2: Positive Electrode 
EQ.3: Separator 
EQ.4: Negative Electrode 
EQ.5: Current Collector Negative 

================================================================================
PAGE 461
================================================================================

*EM_MAT_001 
*EM 
R16@bdccd6d07 (03/10/25) 
6-113 (EM) 
 VARIABLE  
 
DESCRIPTION 
FREQ 
Frequency used for the RF solve. 
EPSRR/EPSRI 
Real and imaginary part of the relative permeability (dielectric
constant and dielectric loss terms). 
EOSID2/EO-
SID3 
Optional IDs deﬁning equation of states for EPSRR and EPSRI re-
spectfully. 
EPS0 
Vacuum permittivity.  The default is 8.8541878128 × 10-12 
Remarks: 
1. 
Input decks with EM materials. EM materials must be associated with a *MAT 
material for MTYPE ≠ 3 or an ICFD ﬂuid for MTYPE = 3. These EM properties 
are added onto the normal material properties like *MAT_ADD material prop-
erties.  Thus, when added onto a *MAT material, MID here must refer to the 
MID of the *MAT material.  For example, an input deck can have the following 
to deﬁne a conductor: 
*PART 
2,1,20 
*MAT_RIGID 
20,&dens,&young,$nu 
*EM_MAT_001 
20,2,&cond 
In this case, if *MAT_RIGID is not included, the conduction properties are not 
applied. 
For MTYPE = 3, MID can refer to the PID of a *ICFD_PART_VOL or be left 
blank.  If it is left blank, the EM properties apply to the entire ICFD ﬂuid. 
2. 
Coupling ICFD to EM.  Only the resistive heating solver is currently available 
when coupling the ICFD solver with the EM solver (see *EM_CONTROL). 
3. 
Eikonal solvers.  For the eikonal solvers (EMSOL = 14 and 15 on *EM_CON-
TROL), this material is supported for beam elements.

================================================================================
PAGE 462
================================================================================

*EM 
*EM_MAT_002 
6-114 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_MAT_002 
Purpose:  Deﬁne an electromagnetic material type and properties with a permeability 
diﬀerent than the free space permeability.  Electromagnetic materials act like a *MAT_-
ADD, so they must be associated with a *MAT material.  See Remark 1. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MTYPE 
SIGMA 
EOSID 
MUREL 
EOSMU 
DEATHT 
 
Type 
I 
I 
F 
I 
F 
I 
F 
 
Default 
none 
none 
none 
none 
none 
optional
1028 
 
 
Optional card  
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
 
EOSIDSF 
 
 
 
 
 
 
Type 
 
I 
 
 
 
 
 
 
Default 
 
optional
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material identiﬁcation.  MID must reference a *MAT material since
the electromagnetic properties are added onto the *MAT proper-
ties.  See Remark 1. 
MTYPE 
Electromagnetism type of the material: 
EQ.0: Air or vacuum 
EQ.1: Insulator material.  These materials have the same electro-
magnetism behavior as MTYPE = 0. 
EQ.2: Conductor carrying a source.  In these conductors, the 
eddy current problem is solved, which gives the actual 
current density.  Typically, this would correspond to the 
coil. 
EQ.4: Conductor not connected to any current or voltage source, 
where the Eddy current problem is solved.  Typically, this 

================================================================================
PAGE 463
================================================================================

*EM_MAT_002 
*EM 
R16@bdccd6d07 (03/10/25) 
6-115 (EM) 
 VARIABLE  
 
DESCRIPTION 
would correspond to the workpiece. 
SIGMA 
Initial electrical conductivity of the material 
EOSID 
ID of the EOS to be used for the electrical conductivity (see *EM_-
EOS cards) 
MUREL 
Relative permeability which is the ratio of the permeability of a 
speciﬁc medium to the permeability of free space (휇푟= 휇/휇0). See 
Remark 2. 
EOSMU 
ID of the EOS to be used to deﬁne the nonlinear behavior of 휇. It is 
optional.  Note: if EOSMU is deﬁned, MUREL will be used for the 
initial value only.  See *EM_EOS_PERMEABILITY. 
DEATHT 
Death time for the material.  After DEATHT, the material will no
longer be considered a conductor and will be removed from the 
EM solve.  If a negative value is entered, a *DEFINE_FUNCTION 
will be expected.  The following parameters are allowed: (vx, vy, 
vz, temp, vol, mass, Ex, Ey, Ez, Bx, By, Bz, Fx, Fy, Fz, JHrate, 
time). Fx, Fy, and Fz refer to the components of the Lorentz force 
vector.  A negative value returned by the *DEFINE_FUNCTION 
corresponds to a ‘dead’ or inactive element.  Once an element has 
been removed from the EM solve, it cannot return. 
EOSIDSF 
Optional ID of the EOS for specifying a scale factor to the permea-
bility EOS deﬁned in EOSMU. This ﬁeld only applies if EOSMU is 
deﬁned, but it is optional.  If used, the EOS must be either *EM_-
EOS_TABULATED1 or *EM_EOS_TABULATED2. See Remark 3.
Remarks: 
1. 
Input decks with EM materials. EM materials must be associated with a *MAT 
material.  These EM properties are added onto the normal material properties 
like *MAT_ADD material properties.  Thus, MID here must refer to the MID of 
the *MAT material.  For example, an input deck can have the following to deﬁne 
a conductor: 
*PART 
2,1,20 
*MAT_RIGID 
20,&dens,&young,$nu 
*EM_MAT_002 
20,2,&cond,&eosid,&murel 

================================================================================
PAGE 464
================================================================================

*EM 
*EM_MAT_002 
6-116 (EM) 
R16@bdccd6d07 (03/10/25) 
In this case, if *MAT_RIGID is not included, the conduction properties are not 
applied. 
2. 
Solver recommendations.  If 휇≠휇0, then it is recommended to switch to the 
monolithic solver (See *EM_SOLVER_FEMBEM_MONOLITHIC) for better sta-
bility. 
3. 
Scale factor applied on permeability. EOSIDSF is an equation of state for spec-
ifying a scale factor to the permeability speciﬁed with EOSMU. The scale factor 
is applied in the following way: 
퐵(퐻, 푇) = 휇0퐻+ 퐺(퐻) × SF 
In other words, the nonlinear behavior of 퐵(퐻, 푇) is decomposed into a linear 
part (휇0퐻) and a nonlinear part (퐺(퐻) × SF). The linear part represents what 
happens at very high 퐻 values, such as when saturation is reached. 퐺(퐻) in the 
nonlinear term depends on the curve or law speciﬁed with EOSMU. The scale 
factor, SF, is determined with EOSIDSF. In general, this scale factor is a function 
of temperature, but the capability is not limited to it (see options available in 
*EM_EOS_TABULATED1 and *EM_EOS_TABULATED2).

================================================================================
PAGE 465
================================================================================

*EM_MAT_003 
*EM 
R16@bdccd6d07 (03/10/25) 
6-117 (EM) 
*EM_MAT_003 
Purpose:  Deﬁne an electromagnetic material type whose electromagnetic conductivity is 
deﬁned by a (3 × 3) tensor matrix.  Applications include composite materials.  This mate-
rial only applies to solid elements.  Electromagnetic materials act like a *MAT_ADD, so 
they must be associated with a *MAT material.  See Remark 1. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MTYPE 
SIGMA11
SIGMA22
SIGMA33
BETA 
CM 
 
Type 
I 
I 
F 
F 
F 
F 
F 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SIGMA12
SIGMA13
SIGMA21
SIGMA23
SIGMA31
SIGMA32
AOPT 
LAMBDA 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
XP 
YP 
ZP 
A1 
A2 
A3 
MACF 
 
Type 
F 
F 
F 
F 
F 
F 
I 
 
 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
V1 
V2 
V3 
D1 
D2 
D3 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID. . MID must reference a *MAT material since the elec-
tromagnetic properties are added onto the *MAT properties.  See 
Remark 1. 
MTYPE 
Deﬁnes the electromagnetism type of the material: 

================================================================================
PAGE 466
================================================================================

*EM 
*EM_MAT_003 
6-118 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.0: Air or vacuum 
EQ.1: Insulator material.  These materials have the same electro-
magnetism behavior as MTYPE = 0. 
EQ.2: Conductor carrying a source.  For these conductors, the 
EM solver solves the eddy current problem, which gives 
the actual current density.  Typically, this type would cor-
respond to the coil.  In electrophysiology (EP), it corre-
sponds to the tissue where the monodomain equations are
solved for EMSOL = 11 or EMSOL = 13. For this case, an 
*EM_EP_CELLMODEL must be associated with this 
*EM_MAT_003. 
EQ.4: Conductor not connected to any current or voltage source, 
where the Eddy current problem is solved.  Typically, this 
type would correspond to the workpiece.  In electrophys-
iology (EP), for EMSOL = 11, 12 or 13, it corresponds to 
the bath surrounding the tissue for which only the exter-
nal potential is found.  In the case of electrophysiology, no 
*EM_EP_CELLMODEL should be associated with this 
material. 
SIGMA11 
The 1, 1 term in the 3 × 3 electromagnetic conductivity tensor ma-
trix.  For the eikonal solvers (EMSOL = 14 and 15 on *EM_CON-
TROL), this is the 1, 1 term in the 3 × 3 wave velocity tensor.  Note 
that 1 corresponds to the 퐚 material direction.  
LT.0.0: |SIGMA11| corresponds to the ID of a *DEFINE_-
FUNCTION. See Remark 3 for available parameters. 
SIGMA12 
The 1, 2 term in the 3 × 3 electromagnetic conductivity tensor ma-
trix.  For the eikonal solvers (EMSOL = 14 and 15 on *EM_CON-
TROL), this is the 1, 2 term in the 3 × 3 wave velocity tensor.  Note 
that 2 corresponds to the 퐛 material direction.  
LT.0.0: |SIGMA12| corresponds to the ID of a *DEFINE_-
FUNCTION. See Remark 3 for available parameters. 
⋮ 
⋮  
SIGMA33 
The 3, 3 term in the 3 × 3 electromagnetic conductivity tensor ma-
trix.  For the eikonal solvers (EMSOL = 14 and 15 on *EM_CON-
TROL), this is the 3, 3 term in the 3 × 3 wave velocity tensor.  Note 
that 3 corresponds to the 퐜 material direction.  
LT.0.0: |SIGMA33| corresponds to the ID of a *DEFINE_-

================================================================================
PAGE 467
================================================================================

*EM_MAT_003 
*EM 
R16@bdccd6d07 (03/10/25) 
6-119 (EM) 
 VARIABLE  
 
DESCRIPTION 
FUNCTION. See Remark 3 for available parameters. 
BETA 
Surface to volume ratio of the cell membrane (to be used only when 
EMSOL = 11 or 12 in *EM_CONTROL). 
CM 
Membrane capacitance per unit area (to be used only when EM-
SOL = 11 or 12 in *EM_CONTROL). 
AOPT 
Material axes option (see *MAT_002 for a more detailed descrip-
tion): 
EQ.0.0: Locally orthotropic with material axes determined by el-
ement nodes.  The 퐚-direction is from node 1 to node 2 
of the element.  The 퐛-direction is orthogonal to the 퐚-
direction and is in the plane formed by nodes 1, 2, and 
4.  
EQ.1.0: Locally orthotropic with material axes determined by a 
point in space, 푃, and the global location of the element 
center; this is the 퐚-direction.   
EQ.2.0: Globally orthotropic with material axes determined by
vectors deﬁned below, as with *DEFINE_COORDI-
NATE_VECTOR. 
EQ.3.0: Locally orthotropic material axes determined by a vec-
tor 퐯 and the normal vector to the plane of the ele-
ment.The plane of a solid element is the midsurface 
between the inner surface and outer surface deﬁned by 
the ﬁrst four nodes and the last four nodes of the con-
nectivity of the element, respectively.  Thus, for solid el-
ements, AOPT = 3 is only available for hexahedrons. 퐚
is determined by taking the cross product of 퐯 with the 
normal vector, 퐛 is determined by taking the cross prod-
uct of the normal vector with 퐚, and 퐜 is the normal vec-
tor.  Then 퐚 and 퐛 are rotated about 퐜 by an angle BETA. 
BETA may be set in the keyword input for the element. 
EQ.4.0: Locally orthotropic in cylindrical coordinate system
with the material axes determined by a vector, 퐯, and an 
originating point, 푃, which deﬁne the centerline axis.   
XP, YP, ZP 
Coordinates of point, 푃, for AOPT = 1 and 4 
A1, A2, A3 
Components of vector, 퐚, for AOPT = 2 

================================================================================
PAGE 468
================================================================================

*EM 
*EM_MAT_003 
6-120 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
MACF 
Material axes change ﬂag for solid elements: 
EQ.1: No change, default 
V1, V2, V3 
Components of vector, 퐯, for AOPT = 3 and 4. 
D1, D2, D3 
Components of vector, 퐝, for AOPT = 2 
LAMBDA 
Intra-to-extracellular conductivity ratio.  When non-empty, the el-
liptic equation is solved to compute extracellular potentials (to be 
used only when EMSOL = 11 in *EM_CONTROL). 
Remarks: 
1. 
Input decks with EM materials. EM materials must be associated with a *MAT 
material.  These EM properties are added onto the normal material properties 
like *MAT_ADD material properties.  Thus, MID here must refer to the MID of 
the *MAT material.  For example, an input deck can have the following to deﬁne 
a conductor: 
*PART 
2,1,20 
*MAT_RIGID 
20,&dens,&young,$nu 
*EM_MAT_003 
20,2,&cond11,&cond22,&cond33 
&cond12,&cond13,&cond21,&cond23,&cond31,&cond32 
In this case, if *MAT_RIGID is not included, the conduction properties are not 
applied. 
2. 
Material directions.  See the manual page for *MAT_002 for a description of 
how the principal material directions, {퐚, 퐛, 퐜}, are determined with AOPT. Note 
that *EM_MAT_003 only works for solid elements.  The AOPT options illus-
trated in the AOPT ﬁgure of *MAT_002 can deﬁne the material directions for all 
elements of the parts that use the material.  
3. 
Function parameters.  The available parameters for the *DEFINE_FUNC-
TIONs are: f(time, emdt, x_ele, y_ele, z_ele, ieleuser). Here, time is the current 
EM time; emdt is the current EM time step; x_ele, y_ele, and z_ele are the loca-
tion of the element; and ieleuser is the element ID. 
4. 
Eikonal solvers.  For the eikonal solvers (EMSOL = 14 and 15 on *EM_CON-
TROL), this material is supported for tetrahedral elements.

================================================================================
PAGE 469
================================================================================

*EM_MAT_004 
*EM 
R16@bdccd6d07 (03/10/25) 
6-121 (EM) 
*EM_MAT_004 
Purpose:  Deﬁne the electromagnetic material type and properties for conducting shells 
in a 3D problem or in a 2D resistive heating problem.  Electromagnetic materials act like 
a *MAT_ADD, so they must be associated with a *MAT material or an ICFD part.  See 
Remark 1. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MTYPE 
SIGMA 
EOSID 
NELE 
MUREL 
EOSMU 
DEATHT 
Type 
I 
I 
F 
I 
I 
F 
I 
F 
Default 
none 
none 
none 
none 
1 
1. 
optional
1028 
 
Optional RF heating Card. Additional material parameters for radio-frequency heating 
(RF) cases. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
 
FREQ 
EPSRR 
EOSID2 
EPSRI 
EOSID3 
EPS0 
 
Type 
 
F 
F 
I 
F 
I 
F 
 
Default 
 
0. 
0. 
0 
0. 
0 
↓ 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID. For all MTYPE except MTYPE = 3, MID must refer-
ence a *MAT material since the electromagnetic properties are
added onto the *MAT properties.  If MTYPE = 3, MID can be left 
blank for the electromagnetic properties to apply to the ICFD en-
tire ﬂuid or it can be the PID of a *ICFD_PART_VOL to apply to 
an ICFD ﬂuid part.  See Remark 1. 
MTYPE 
Deﬁnes the electromagnetism type of the material: 
EQ.0: Air or vacuum 
EQ.1: Insulator material.  These materials have the same elec-
tromagnetism behavior as MTYPE = 0. 
EQ.2: Conductor carrying a source.  In these conductors, the 

================================================================================
PAGE 470
================================================================================

*EM 
*EM_MAT_004 
6-122 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
eddy current problem is solved, which gives the actual 
current density.  Typically, this would correspond to the 
coil. 
EQ.3: Fluid conductor.  In this case, MID refers to the ID given
in *ICFD_PART_VOL. Note that this is only available 
for ICFD in 2D. See Remark 2. 
EQ.4: Conductor not connected to any current or voltage 
source, where the Eddy current problem is solved.  Typ-
ically, this would correspond to the workpiece. 
SIGMA 
Initial electrical conductivity of the material 
EOSID 
ID of the EOS to be used for the electrical conductivity (see *EM_-
EOS cards). 
NELE 
Number of elements in the thickness of the shell.  Note that you 
must make sure your mesh ﬁne enough to correctly capture the 
inductive-diﬀusive eﬀects (see skin depth deﬁnition). 
MUREL 
Relative permeability which is the ratio of the permeability of a 
speciﬁc medium to the permeability of free space (휇푟= 휇/휇0). 
EOSMU 
ID of the EOS to be used to deﬁne the nonlinear behavior of 휇. 
Note that if EOSMU is deﬁned, MUREL will be used for the ini-
tial value only.  See *EM_EOS_PERMEABILITY. 
DEATHT 
Death time for the material.  After DEATHT, the material will no 
longer be considered a conductor and will be removed from the 
EM solve.  If a negative value is entered, a *DEFINE_FUNCTION 
will be expected.  The following parameters are allowed: (vx, vy, 
vz, temp, vol, mass, Ex, Ey, Ez, Bx, By, Bz, Fx, Fy, Fz, JHrate, 
time). Fx, Fy, and Fz refer to the components of the Lorentz force
vector.  A negative value returned by the *DEFINE_FUNCTION 
corresponds to a ‘dead’ or inactive element.  Once an element has 
been removed from the EM solve, it cannot return. 
FREQ 
Frequency used for the RF solve. 
EPSRR/EPSRI 
Real and imaginary part of the relative permeability (dielectric 
constant and dielectric loss terms). 
EOSID2/EO-
SID3 
Optional IDs deﬁning equations of state for EPSRR and EPSRI, 
respectfully 

================================================================================
PAGE 471
================================================================================

*EM_MAT_004 
*EM 
R16@bdccd6d07 (03/10/25) 
6-123 (EM) 
 VARIABLE  
 
DESCRIPTION 
EPS0 
Vacuum permittivity.  The default is 8.8541878128 × 10-12.  
Remarks: 
1. 
Input decks with EM materials. EM materials must be associated with a *MAT 
material for MTYPE ≠ 3 or an ICFD ﬂuid for MTYPE = 3. These EM properties 
are added onto the normal material properties like *MAT_ADD material prop-
erties.  Thus, when added onto a *MAT material, MID here must refer to the 
MID of the *MAT material.  For example, an input deck can have the following 
to deﬁne a conductor: 
*PART 
2,1,20 
*MAT_RIGID 
20,&dens,&young,$nu 
*EM_MAT_004 
20,2,&cond,&eosid 
In this case, if *MAT_RIGID is not included, the conduction properties are not 
applied. 
For MTYPE = 3, MID can refer to the PID of a *ICFD_PART_VOL or be left 
blank.  If it is left blank, the EM properties apply to the entire ICFD ﬂuid. 
2. 
Coupling ICFD to EM.  Only the resistive heating solver is currently available 
when coupling the ICFD solver with the EM solver (see *EM_CONTROL).

================================================================================
PAGE 472
================================================================================

*EM 
*EM_MAT_005 
6-124 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_MAT_005 
Purpose:  Deﬁne an electromagnetic material for which two material conductivities are 
speciﬁed per EM node and electromagnetic conductivities are deﬁned by a (3 × 3) tensor 
matrix.  Applications of this material include the Randles Batmac model (see Remark 2) 
and the electrophysiology bidomain model.  This material is only supported for solid 
elements.  Electromagnetic materials act like a *MAT_ADD, so they must be associated 
with a *MAT material.  See Remark 1. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MTYPE 
SIGMAXXA SIGMAYYA SIGMAZZA
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable SIGMAXYA SIGMAXZA SIGMAYXA SIGMAYZA SIGMAZXA SIGMAZYA
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
 
 
SIGMAXXB SIGMAYYB SIGMAZZB
 
 
 
Type 
 
 
F 
F 
F 
 
 
 
 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable SIGMAXYB SIGMAXZB SIGMAYXB SIGMAYZB SIGMAZXB SIGMAZYB
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
 

================================================================================
PAGE 473
================================================================================

*EM_MAT_005 
*EM 
R16@bdccd6d07 (03/10/25) 
6-125 (EM) 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
AOPT 
XP 
YP 
ZP 
A1 
A2 
A3 
MACF 
Type 
F 
F 
F 
F 
F 
F 
F 
I 
 
 Card 6 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
V1 
V2 
V3 
D1 
D2 
D3 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID. MID must reference a *MAT material since the elec-
tromagnetic properties are added onto the *MAT properties.  See 
Remark 1. 
MTYPE 
Deﬁnes the electromagnetism type of the material: 
EQ.0: Air or vacuum 
EQ.1: Insulator material.  These materials have the same elec-
tromagnetism behavior as MTYPE = 0. 
EQ.2: In electrophysiology, it corresponds to the tissue, where 
the bidomain equations will be solved for EMSOL = 12 
or EMSOL = 13. An *EM_EP_CELLMODEL must be as-
sociated with this material. 
EQ.4: In electrophysiology, it corresponds to the bath where
only the external potential is solved for.  No *EM_EP_-
CELLMODEL should be associated with this material.
EQ.5: Material associated with *EM_RANDLES_BATMAC. 
See Remark 2. 
SIGMAXXA/B 
The 1, 1 term in the 3 × 3 electromagnetic conductivity tensor ma-
trix for the two conductivities.  For the BatMac model, A is for 
the potential on the positive current collector, and B is for the po-
tential on the negative current collector.  For the bidomain model 
in Electrophysiology, A is for the intracellular potential, and B is 
for the extracellular potential.  Note that 1 corresponds to the 퐚
material direction. 

================================================================================
PAGE 474
================================================================================

*EM 
*EM_MAT_005 
6-126 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
LT.0.0: |SIGMAXXA/B| corresponds to the ID of a *DE-
FINE_FUNCTION. See Remark 4 for available param-
eters. 
SIGMAXYA/B 
The 1, 2 term in the 3 × 3 electromagnetic conductivity tensor ma-
trix for the two conductivities.  Note that 2 corresponds to the 퐛
material direction.  
LT.0.0: |SIGMAXYA/B| corresponds to the ID of a *DE-
FINE_FUNCTION. See Remark 4 for available param-
eters. 
⋮ 
⋮  
SIGMAZZA/B 
The 3, 3 term in the 3 × 3 electromagnetic conductivity tensor ma-
trix for the two conductivities.  Note that 3 corresponds to the 퐜
material direction.  
LT.0.0: |SIGMAZZA/B| corresponds to the ID of a *DE-
FINE_FUNCTION. See Remark 4 for available param-
eters. 
AOPT 
Material axes option (see *MAT_002 for a more detailed descrip-
tion): 
EQ.0.0: Locally orthotropic with material axes determined by 
element nodes.  The 퐚-direction is from node 1 to node 
2 of the element.  The 퐛-direction is orthogonal to the 
퐚-direction and is in the plane formed by nodes 1, 2, 
and 4.  
EQ.1.0: Locally orthotropic with material axes determined by 
a point in space, 푃, and the global location of the ele-
ment center; this is the 퐚-direction.   
EQ.2.0: Globally orthotropic with material axes determined 
by vectors deﬁned below, as with *DEFINE_COORDI-
NATE_VECTOR. 
EQ.3.0: Locally orthotropic material axes determined by a vec-
tor 퐯 and the normal vector to the plane of the ele-
ment.The plane of a solid element is the midsurface
between the inner surface and outer surface deﬁned 
by the ﬁrst four nodes and the last four nodes of the 
connectivity of the element, respectively.  Thus, for 
solid elements, AOPT = 3 is only available for hexahe-
drons. 퐚 is determined by taking the cross product of 

================================================================================
PAGE 475
================================================================================

*EM_MAT_005 
*EM 
R16@bdccd6d07 (03/10/25) 
6-127 (EM) 
 VARIABLE  
 
DESCRIPTION 
퐯 with the normal vector, 퐛 is determined by taking 
the cross product of the normal vector with 퐚, and 퐜 is 
the normal vector.  Then 퐚 and 퐛 are rotated about 퐜
by an angle BETA. BETA may be set in the keyword 
input for the element.  
EQ.4.0: Locally orthotropic in cylindrical coordinate system 
with the material axes determined by a vector, 퐯, and 
an originating point, 푃, which deﬁne the centerline 
axis.   
XP, YP, ZP 
Deﬁne coordinates of point p for AOPT = 1 and 4. 
A1, A2, A3 
Deﬁne components of vector a for AOPT = 2. 
MACF 
Material axes change ﬂag for solid elements: 
EQ.1: No change, default 
V1, V2, V3 
Deﬁne components of vector v for AOPT = 3 and 4. 
D1, D2, D3 
Deﬁne components of vector d for AOPT = 2. 
Remarks: 
1. 
Input decks with EM materials. EM materials must be associated with a *MAT 
material.  These EM properties are added onto the normal material properties 
like *MAT_ADD material properties.  Thus, MID here must refer to the MID of 
the *MAT material.  For example, an input deck can have the following to deﬁne 
a conductor: 
*PART 
2,1,20 
*MAT_RIGID 
20,&dens,&young,$nu 
*EM_MAT_005 
20,2,&cond11a,&cond22a,&cond33a 
&cond12a,&cond13a,&cond21a,&cond23a,&cond31a,&cond32a 
,,&cond11b,&cond22b,&cond33b 
&cond12b,&cond13b,&cond21b,&cond23b,&cond31b,&cond32b 
In this case, if *MAT_RIGID is not included, the conduction properties are not 
applied. 
2. 
Using this material with BatMac.  When this material is used in conjunction 
with the battery BatMac model, then the conductivities must be adjusted by the 
current collector thickness ratio over the total thickness of the cell.  For example, 
if 푛푝 is the number of positive current collectors, 푡푝 the thickness of each 

================================================================================
PAGE 476
================================================================================

*EM 
*EM_MAT_005 
6-128 (EM) 
R16@bdccd6d07 (03/10/25) 
individual positive current collector and Th the total thickness of the cell, then 
the conductivity for the positive current collector must be scaled by:  
푛푝 × 푡푝
Th
   . 
3. 
Material directions.  See the manual page for *MAT_002 for a description of 
how the principal material directions, {퐚, 퐛, 퐜}, are determined with AOPT. Note 
that *EM_MAT_005 only works for solid elements.  The AOPT options illus-
trated in the AOPT ﬁgure of *MAT_002 can deﬁne the material directions for all 
elements of the parts that use the material.  
4. 
Function parameters.  The available parameters for the *DEFINE_FUNC-
TIONs are: f(time, emdt, x_ele, y_ele, z_ele, ieleuser).  Here, time is the current 
EM time; emdt is the current EM time step; x_ele, y_ele, and z_ele are the loca-
tion of the element; and ieleuser is the element ID.

================================================================================
PAGE 477
================================================================================

*EM_MAT_006 
*EM 
R16@bdccd6d07 (03/10/25) 
6-129 (EM) 
*EM_MAT_006 
Purpose:  Deﬁne two conductivities per EM node for special applications (Randles 
Batmac).  Electromagnetic materials act like a *MAT_ADD, so they must be associated 
with a *MAT material.  See Remark 1. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
MTYPE 
SIGP 
EOSP 
SIGN 
EOSN 
DEATHT 
 
Type 
I 
I 
F 
I 
F 
I 
F 
 
Default 
none 
none 
none 
none 
none 
none 
1028 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material identiﬁcation.  MID must reference a *MAT material since
the electromagnetic properties are added onto the *MAT proper-
ties.  See Remark 1. 
MTYPE 
Deﬁnes the electromagnetism type of the material: 
EQ.0: Air or vacuum 
EQ.1: Insulator material.  These materials have the same electro-
magnetism behavior as MTYPE = 0. 
EQ.5: Material associated to *EM_RANDLES_BATMAC 
SIGP/SIGN 
Conductivities of the positive / negative current collector materials
EOSP/EOSN 
Optional ID of the EOS to be used for the two conductivities 
DEATHT 
Death time for the material.  After DEATHT, the material will no
longer be considered a conductor and removed from the EM solve. 
If a negative value is entered, a |DEATHT| is a *DEFINE_FUNC-
TION ID. The following parameters are allowed: (vx, vy, vz, temp, 
vol, mass, Ex, Ey, Ez, Bx, By, Bz, Fx, Fy, Fz, JHrate, time). The 
vector (Fx, Fy, Fz) refers to the Lorentz force vector.  A negative 
value returned by the *DEFINE_FUNCTION corresponds to a 
“dead” or inactive element.  Once an element has been removed 
from the EM solve, it cannot return. 

================================================================================
PAGE 478
================================================================================

*EM 
*EM_MAT_006 
6-130 (EM) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
1. 
Input decks with EM materials. EM materials must be associated with a *MAT 
material.  These EM properties are added onto the normal material properties 
like *MAT_ADD material properties.  Thus, MID here must refer to the MID of 
the *MAT material.  For example, an input deck can have the following to deﬁne 
an insulator: 
*PART 
2,1,20 
*MAT_RIGID 
20,&dens,&young,$nu 
*EM_MAT_006 
20,1,&condp,&eosp,&condn,&eosn 
In this case, if *MAT_RIGID is not included, the insulator properties are not ap-
plied. 
2. 
BatMac Model.  When this material is used in conjunction with the battery 
BatMac model, the conductivities must be adjusted by the current collector 
thickness ratio over the total thickness of the cell.  For example, if 푛푝 is the num-
ber of positive current collectors, 푡푝 is the thickness of each individual positive 
current collector, and Th is the total thickness of the cell, the conductivity for the 
positive current collector must be scaled by: 푛푝 × 푡푝Th
⁄
.

================================================================================
PAGE 479
================================================================================

*EM_OUTPUT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-131 (EM) 
*EM_OUTPUT 
Purpose:  Deﬁne the level of EM related output on the screen and in the messag ﬁle. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MATS 
MATF 
SOLS 
SOLF 
MESH 
MEM 
TIMING 
 
Type 
I 
I 
I 
I 
I 
I 
I 
 
Default 
0 
0 
0 
0 
0 
0 
0 
 
 
 VARIABLE  
 
DESCRIPTION 
MATS 
Level of matrix assembly output to the screen: 
EQ.0: No output 
EQ.1: Basic assembly steps 
EQ.2: Basic assembly steps + percentage completed + ﬁnal sta-
tistics 
EQ.3: Basic assembly steps + percentage completed + statistics 
at each percentage of completion 
MATF 
Level of matrix assembly output to the messag ﬁle: 
EQ.0: No output 
EQ.1: Basic assembly steps 
EQ.2: Basic assembly steps + percentage completed + ﬁnal sta-
tistics 
EQ.3: Basic assembly steps + percentage completed + statistics 
at each percentage of completion 
SOLS 
Level of solver output on the screen: 
EQ.0: No output 
EQ.1: Global information at each FEM iteration 
EQ.2: Detailed information at each FEM iteration 
SOLF 
Level of solver output to the messag ﬁle: 
EQ.0: No output 

================================================================================
PAGE 480
================================================================================

*EM 
*EM_OUTPUT 
6-132 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: Global information at each FEM iteration 
EQ.2: Detailed information at each FEM iteration 
MESH 
Controls the output of the mesh data to the d3hsp ﬁle: 
EQ.0: No mesh output written. 
EQ.1: Mesh info written. 
MEMORY 
Controls the output of information about the memory used by the 
EM solve to the messag ﬁle: 
EQ.0: No memory information written. 
EQ.1: Memory information written. 
TIMING 
Controls the output of information about the time spent in the dif-
ferent parts of the EM solver to the messag ﬁle 
EQ.0: No timing information written. 
EQ.1: Timing information written. 

================================================================================
PAGE 481
================================================================================

*EM_OUTPUT_FORCES 
*EM 
R16@bdccd6d07 (03/10/25) 
6-133 (EM) 
*EM_OUTPUT_FORCES 
Purpose:  Cause the output of a binary ﬁle (emforcout) containing the node IDs, the co-
ordinates, and the EM forces at each node.  Additionally, ASCII ﬁles in keyword format 
containing these forces can be output.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IOUT 
OUTDT 
LCOFF 
SF 
 
 
 
 
Type 
I 
F 
I 
F 
 
 
 
 
Default 
0 
0.0 
0 
1. 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
IOUT 
Type of the output: 
EQ.1: Outputs the binary ﬁle only. 
EQ.2: Outputs the binary ﬁle and generates a set of keyword 
ﬁles em_loadnid and em_loadlcid giving the EM forces at 
each node at the given output time. 
EQ.3: Same as 2 except the forces are output as function of time.
OUTDT 
Time period at which the keyword ﬁles are generated.  Setting 
OUTDT to 0.0 causes the output to be generated at each EM time
step.  The absolute value of a negative value refers to a time-de-
pendent load curve.  See Remark 2.  
LCOFF 
Optional oﬀset in the load curve IDs that are associated with the 
forces at each node when generating the keyword ﬁles.  
SF 
Optional scaling factor that can be applied to the output forces 
when generating the keyword ﬁles. 
Remarks: 
1. 
2-step EM coupling.  This feature can be used to perform a coupled analysis in 
two steps.  The ﬁrst step solves the magnetostatic EM problem and outputs the 
forces.  The second step loads those forces in a transient mechanical analysis.  
This capability enables quickly gaining a good understanding of the model be-
fore turning to a fully coupled transient EM solid mechanics analysis.  

================================================================================
PAGE 482
================================================================================

*EM 
*EM_OUTPUT_FORCES 
6-134 (EM) 
R16@bdccd6d07 (03/10/25) 
2. 
Memory cost.  The computational cost to generate the ASCII ﬁles can become 
high in large cases.  When  OUT=3 is used, there is also a memory cost associated 
to the output which can again become problematic in large cases.  For this rea-
son, it can recommended to use an OUTDT that is larger than the EM timestep 
to reduce the amount of times those ASCII ﬁles are output.

================================================================================
PAGE 483
================================================================================

*EM_OUTPUT_VTK 
*EM 
R16@bdccd6d07 (03/10/25) 
6-135 (EM) 
*EM_OUTPUT_VTK 
Purpose:  Cause the output of vtk ﬁles.  It can be used in applications that require two 
material conductivities per EM node and whose electromagnetic conductivities are de-
ﬁned by a (3 × 3) tensor matrix.  These applications include the Randles Batmac model 
and the Electrophysiology Bidomain model. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VTKTYPE
VTKT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
0.0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
VTKTYPE 
Type of the vtk ﬁles output.  
EQ.1: A single .vtk ﬁle 
EQ.2: Parallel unstructured points data (.pvtu ﬁles), recom-
mended in mpp executions. 
VTKT 
Time period at which vtk ﬁles are exported. 

================================================================================
PAGE 484
================================================================================

*EM 
*EM_PERMANENT_MAGNET 
6-136 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_PERMANENT_MAGNET 
Purpose:  Deﬁnes a permanent magnet. 
Card Summary: 
Card 1.  This card is required. 
ID 
PID 
MTYPE 
NORTH 
SOUTH 
HC 
 
 
Card 2a.  This card is included if MTYPE = 3. 
X 
Y 
Z 
 
 
 
 
 
Card 2b.  This card is included if MTYPE = 4. 
NID1 
NID2 
 
 
 
 
 
 
Card 2c.  This card is included if MTYPE = 5, 6, or 7. 
X 
Y 
Z 
NDIVIS 
AXIS 
DIR/X2 
Y2 
Z2 
Card 3.  This card is optional. 
TTYPE 
OX 
OY 
OZ 
NX 
NY 
NZ 
 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID 
PID 
MTYPE 
NORTH 
SOUTH 
HC 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ID 
ID of the magnet 
PID 
Part ID 

================================================================================
PAGE 485
================================================================================

*EM_PERMANENT_MAGNET 
*EM 
R16@bdccd6d07 (03/10/25) 
6-137 (EM) 
 VARIABLE  
 
DESCRIPTION 
MTYPE 
Magnet deﬁnition type: 
EQ.0: Magnet deﬁned by two node sets for North and South 
Poles. 
EQ.1: Magnet deﬁned by two segments sets for North and South 
Poles. 
EQ.3: Magnet deﬁned by a global vector orientation. 
EQ.4: Magnet deﬁned by a global vector orientation given by
two node IDs 
EQ.5: Magnetic gear with NDIVIS magnets oriented around an 
axis given by AXIS and centered at point (X, Y, Z). The 
pole orientations alternate for each magnet in the gear, 
meaning they alternate at increments of 360/NDIVIS 
around the gear starting along the vector given by 
(X2, Y2, Z2). See Figure 6-4. 
EQ.6: Magnetic gear with NDIVIS magnets oriented around an 
axis given by AXIS and centered at point (X, Y, Z). The 
pole orientations alternate for each magnet in the gear, 
meaning they alternate at increments of 360/NDIVIS 
around the gear starting along the vector given by DIR. 
See Figure 6-4. 
EQ.7: Same as 5 except the North and South orientation of the 
magnets follows the gear rotation axis (see AXIS in Card 
2c) rather than its radial direction. 
EQ.8: Same as 6 except the North and South orientation of the 
magnets follows the gear rotation axis (see AXIS in Card 
2c) rather than its radial direction. 
NORTH 
Set ID of the magnet north face for MTYPE = 0 and 1  
SOUTH 
Set ID of the magnet south face for MTYPE = 0 and 1  
HC 
Coercive force, 퐻푐. See Remark 1. 
LT.0.0: |HC| refers to a load curve ID giving the coercive force 
as a function of time. 
 

================================================================================
PAGE 486
================================================================================

*EM 
*EM_PERMANENT_MAGNET 
6-138 (EM) 
R16@bdccd6d07 (03/10/25) 
MTYPE = 3 Card.  This card is only included for MTYPE = 3. 
 Card 2a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
X 
Y 
Z 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
0. 
0. 
0. 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
X, Y, Z 
Orientation of magnetization vector 
 
MTYPE = 4 Card.  This card is only included for MTYPE = 4. 
 Card 2b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID1 
NID2 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID1 / NID2 
Two node IDs deﬁning the magnetization vector  
 
Magnetic Gear Card.  This card is only included if MTYPE = 5, 6, or 7.  See Figure 6-4. 
 Card 2c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
X 
Y 
Z 
NDIVIS 
AXIS 
DIR/X2 
Y2 
Z2 
Type 
F 
F 
F 
I 
I 
I/F 
F 
F 
Default 
0. 
0. 
0. 
none 
none 
none 
none 
none 
 

================================================================================
PAGE 487
================================================================================

*EM_PERMANENT_MAGNET 
*EM 
R16@bdccd6d07 (03/10/25) 
6-139 (EM) 
 VARIABLE  
 
DESCRIPTION 
X, Y, Z 
Origin / center point of the magnetic gear 
NDIVIS 
Number of subdivisions, that is, number of magnets around the 
circle   
AXIS 
Normal vector to the magnets: 
EQ.1: Global 푋 axis 
EQ.2: Global 푌 axis 
EQ.3: Global 푍 axis 
DIR 
Directional vector giving the location of the starting magnet / start-
ing magnetic orientation if MTYPE = 6: 
EQ.1: Global 푋 axis 
EQ.2: Global 푌 axis 
EQ.3: Global 푍 axis 
X2, Y2, Z2 
Directional vector coordinates giving the starting magnet / start-
ing magnetic orientation if MTYPE = 5 or 7. 
 
Optional Card.  This card is only useful to change some magnet-related output 
quantities. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TTYPE 
OX 
OY 
OZ 
NX 
NY 
NZ 
 
Type 
I 
F 
F 
F 
I 
I 
I 
 
Default 
0 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
TTYPE 
Torque calculation type: 
EQ.0: Default.  Magnet torque is output as a vector based on the
cross product of the EM force and the relative position of
a given node with respect to the center of gravity. 
EQ.1: The position vector is based on a user-deﬁned origin point 
and the result of the aforementioned cross product 

================================================================================
PAGE 488
================================================================================

*EM 
*EM_PERMANENT_MAGNET 
6-140 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
operation is projected onto a user-deﬁned axis.  As a re-
sult, the torque output becomes a scalar quantity. 
OX/OY/OZ 
Origin point for the magnet torque calculation if TTYPE = 1. 
NX/NY/NZ 
Axis on which the torque is projected if TTYPE = 1. 
Remark: 
1. 
Coercive Force. The absolute value of coercive force 퐻푐 applied to the magnet 
(A/m) relates to the Residual induction 퐵푟 by the following relation:  
퐻푐= 퐵푟휇
⁄  
Here, 휇 is the magnet’s permeability deﬁned in *EM_MAT_002 using a constant 
relative permeability 휇= 휇푟휇0. 
 
The coercive force can also be expressed using the energy product 퐵퐻max : 
퐻푐= 2√퐵퐻max
휇
N
S
N
S
S
N
S
N
X,Y,Z
NDIVIS=4
DIR or (X2, Y2, Z2)
AXIS
 
Figure 6-4.  Example of Magnetic Gear (MTYPE = 5 or 6) 

================================================================================
PAGE 489
================================================================================

*EM_POINT_SET 
*EM 
R16@bdccd6d07 (03/10/25) 
6-141 (EM) 
*EM_POINT_SET 
Purpose:  Create a set of points that can be used by *EM_DATABASE_POINTOUT.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PTSID 
PTSTYPE 
VX 
VY 
VZ 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
0 
0 
0. 
0. 
0. 
 
 
 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PTID 
X 
Y 
Z 
IPOS 
 
 
 
Type 
I 
F 
F 
F 
I 
 
 
 
Default 
none 
none 
none 
none 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PSID 
Point set ID 
PTSTYPE 
Point set type : 
EQ.0: Fixed points 
EQ.1: Tracer points using prescribed velocity 
VX, VY, VZ 
Constant velocities used when PTSTYPE = 1 
PTID 
Point ID 
X, Y, Z 
Point initial coordinates 
IPOS 
Position ﬂag (for 2D, see Remark 1): 
EQ.0: The solver determines if the point is inside or outside of 
the conductors.  

================================================================================
PAGE 490
================================================================================

*EM 
*EM_POINT_SET 
6-142 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: The point is outside of the conductors during the entire 
simulation.  The solver does not check; hence a gain in 
computation time. 
Remarks: 
1. 
2D axisymmetric. If using *EM_2DAXI, notice that the conductors represent the 
corresponding 3D conductors.

================================================================================
PAGE 491
================================================================================

*EM_RANDLES 
*EM 
R16@bdccd6d07 (03/10/25) 
6-143 (EM) 
*EM_RANDLES 
 
The keywords in this section facilitate deﬁning Randles circuit parameters for Randles 
cells.  The available keywords in alphabetical order are as follows: 
*EM_RANDLES_BATMAC 
*EM_RANDLES_EXOTHERMIC_REACTION 
*EM_RANDLES_MESHLESS 
*EM_RANDLES_SHORT 
*EM_RANDLES_SOLID 
*EM_RANDLES_TSHELL 
 
We have implemented four models for the Randles cell: *EM_RANDLES_BATMAC, 
*EM_RANDLES_MESHLESS, *EM_RANDLES_SOLID, and *EM_RANDLES_TSHELL. 
*EM_RANDLES_BATMAC is for deﬁning the parameters for the Randles cell when using 
the batmac model. *EM_RANDLES_MESHLESS, *EM_RANDLES_SOLID, and *EM_-
RANDLES_TSHELL are for deﬁning the parameters when the cell is not associated with 
a mesh, the cell is associated with a solid mechanical model, and the cell is associated 
with a composite tshell mechanical model, respectively. *EM_RANDLES_EXOTHER-
MIC_REACTION and *EM_RANDLES_SHORT enable adding additional parameters to 
the Randles cell for modeling thermal runaway and shorts, respectively. 
Using *DEFINE_FUNCTION for Randles Cell Parameters: 
Table 6-2.  Many of the parameters for these models can be speciﬁed with a *DEFINE_-
FUNCTION. This table indicates the available arguments, depending on the kind of 
model.  The ﬁrst column lists the arguments in single quotes with a description.  The 
second column gives what is available for the Randles circuit parameters.  The third col-
umn indicates what is available for R0CHA and R0DIS for user-deﬁned Equivalent Cir-
cuit models, depending on the model chosen.  The fourth and ﬁfth columns give the 
availability for parameters in *EM_RANDLES_SHORT and *EM_RANDLES_EXOTHER-
MIC_REACTION. 
 
Parameters with *DEFINE_FUNCTIONs 
Variable names
Randles circuit 
parameters  
(푟0, 푟10, 푐10, etc.)
RDLTYPE = -1 
Internal short 
Exothermic 
reaction 
‘time’: Current EM time All models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 

================================================================================
PAGE 492
================================================================================

*EM 
*EM_RANDLES 
6-144 (EM) 
R16@bdccd6d07 (03/10/25) 
 
Parameters with *DEFINE_FUNCTIONs 
Variable names
Randles circuit 
parameters  
(푟0, 푟10, 푐10, etc.)
RDLTYPE = -1 
Internal short 
Exothermic 
reaction 
‘emdt’: Current EM time 
step 
All models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘x_sep, y_sep, z_sep’: 
Positive electrode coor-
dinates 
Solid/tshell models 
Solid/tshell models 
Solid/tshell models 
Solid/tshell models
‘x_sen, y_sen, z_sen’: 
Negative electrode co-
ordinates 
Solid/tshell models 
Solid/tshell models 
Solid/tshell models 
Solid/tshell models
‘x_ccp, y_ccp, z_ccp’: 
Positive Current collec-
tor coordinates 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘x_ccn, y_ccn, z_ccn’: 
Negative Current col-
lector coordinates 
Solid/tshell models 
Solid/tshell models 
Solid/tshell models 
Solid/tshell models
‘pres’: Local pressure 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘rho’: Local density 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘vmstress’: Local von 
Mises stress 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘cond’: Local electrical 
conductivity 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘temp’: Local tempera-
ture 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘tempRand’: Tempera-
ture associated to 
Randles circuit 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘efstrain’: Local eﬀective 
strain 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/batmac mod-
els 
Solid/batmac mod-
els 
‘strainLocX/Y/Z’: Local 
strain in the X/Y/Z di-
rections 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/batmac mod-
els 
Solid/batmac mod-
els 
‘soc,soceﬀ’: Local state of 
charge, eﬀective state of  
charge 
All models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘current’: Transverse 
Randles current 
All models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘ocv, vc, volt, r0’: Open 
charge voltage, damp-
ing voltage, total volt-
age, r0 resistance. 
All models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘H_ex’: Exothermal 
heating power inte-
grated over time 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac
models 

================================================================================
PAGE 493
================================================================================

*EM_RANDLES 
*EM 
R16@bdccd6d07 (03/10/25) 
6-145 (EM) 
 
Parameters with *DEFINE_FUNCTIONs 
Variable names
Randles circuit 
parameters  
(푟0, 푟10, 푐10, etc.)
RDLTYPE = -1 
Internal short 
Exothermic 
reaction 
(= exothermal heating 
energy) when exother-
mic reaction keyword is 
present. 
‘short’: Short gives the 
state of the Randles cir-
cuit.  If short = 0, then 
the circuit is not 
shorted, if short = 1, 
then it is shorted. 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘ero’: Ero gives the state 
of the erosion.  If 
ero = 1, then the circuit 
is adjacent to an ele-
ment that has been 
eroded, ero = 0 other-
wise. 
Solid/batmac mod-
els 
Solid/batmac mod-
els 
Solid/batmac mod-
els 
Solid/batmac mod-
els 
‘areaCircuit, areaCell, ar-
eashortGlob’: Local 
Randles circuit area, to-
tal Randles cell area, to-
tal cell shorted area. 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
Solid/tshell/batmac 
models 
‘save1, save2, save3…, 
save10’: Ten local varia-
bles that the user can 
deﬁne and that will be 
saved during the run 
and associated with 
each local Randles cir-
cuits. 
No models 
Solid/tshell/batmac 
models 
No models 
No models 

================================================================================
PAGE 494
================================================================================

*EM 
*EM_RANDLES_BATMAC 
6-146 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_RANDLES_BATMAC 
Purpose:  Deﬁne the distributed Randles circuit parameters for a Randles cell when using 
the batmac model.  The batmac model is a macro battery model where solid elements are 
retained for the solid mechanics and thermal solve, and each conducting node has its own 
Randles circuit associated with it.  It must be used with *EM_MAT_005 or *EM_MAT_-
006. 
Card Summary: 
Card 1.  This card is required. 
RDLID 
RDLTYPE 
RDLAREA 
PSID 
 
 
 
 
Card 2.  This card is required. 
Q 
CQ 
SOCINIT 
SOCTOU 
 
 
 
 
Card 3.  This card is required. 
R0CHA 
R0DIS 
R10CHA 
R10DIS 
C10CHA 
C10DIS 
 
 
Card 4.  This card is only read if RDLTYPE > 1. It is optional. 
R20CHA 
R20DIS 
C20CHA 
C20DIS 
R30CHA 
R30DIS 
C30CHA 
C30DIS 
Card 5.  This card is optional. 
TEMP 
FRTHER 
R0TOTH 
DUDT 
TEMPU 
 
 
 
Card 6.  This card is optional 
USESOCS 
TAU 
FLCID 
 
 
 
 
 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RDLID 
RDLTYPE
RDLAREA
PSID 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 

================================================================================
PAGE 495
================================================================================

*EM_RANDLES_BATMAC 
*EM 
R16@bdccd6d07 (03/10/25) 
6-147 (EM) 
 
 VARIABLE  
 
DESCRIPTION 
RDLID 
ID of the Randles cell 
RDLTYPE 
Type of Randles cell: 
EQ.-1: User-deﬁned equivalent circuit model.  See Remark 3. 
EQ.0: 0-order Randles Cell 
EQ.1: 1-order Randles Cell 
EQ.2: 2-order Randles Cell 
EQ.3: 3-order Randles Cell 
RDLAREA 
Randles area: 
EQ.1: The parameters are per unit area and are scaled in each 
Randle circuit by a factor depending on the local area of
the circuit.  Unit consistency in SI: Ohms times square
meters. 
EQ.2: The parameters are deﬁned for the whole cell and are 
scaled in each Randle circuit by a factor depending on 
the local area of the circuit and the global area of the cell 
(default).  Unit consistency in SI: Ohms. 
EQ.3: The parameters are not scaled by area factors.  Unit con-
sistency in SI: Ohms. 
EQ.11: Same as 1, except the parameters are deﬁned for the 
whole cell and are scaled in each Randles circuit by a fac-
tor depending on the local volume of the circuit and the 
global volume of the cell. 
EQ.22: Same as 2, except the parameters are deﬁned for the 
whole cell and are scaled in each Randles circuit by a fac-
tor depending on the local volume of the circuit and the 
global volume of the cell. 
PSID 
Part set ID of all the parts composing the cell 
 

================================================================================
PAGE 496
================================================================================

*EM 
*EM_RANDLES_BATMAC 
6-148 (EM) 
R16@bdccd6d07 (03/10/25) 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Q 
CQ 
SOCINIT 
SOCTOU 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
Q 
Cell capacity 
CQ 
SOC conversion factor (%/s).  It is known to be equal to 1/36 in SI 
units. 
SOCINIT 
Initial state of charge of the cell 
SOCTOU 
Equilibrium voltage (OCV): 
GE.0.0: Constant value 
LT.0.0: |SOCTOU| can refer to a load curve ID deﬁning equilib-
rium voltage (OCV) as a function of the state of charge 
(SOC) or to a table ID with temperature indexing load 
curves that give OCV as a function of SOC. 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R0CHA 
R0DIS 
R10CHA 
R10DIS 
C10CHA 
C10DIS 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
R0CHA/ 
R10CHA/ 
C10CHA 
푟0/푟10/푐10 when the current ﬂows in the charge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 

================================================================================
PAGE 497
================================================================================

*EM_RANDLES_BATMAC 
*EM 
R16@bdccd6d07 (03/10/25) 
6-149 (EM) 
 VARIABLE  
 
DESCRIPTION 
parameters can be made a function of the SOC and tem-
perature. 
R0DIS/ 
R10DIS/ 
C10DIS 
푟0/푟10/푐10 when the current ﬂows in the discharge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
 
Optional Card for RDLTYPE > 1.  This card is only read for RDLTYPE > 1. It is optional.
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R20CHA 
R20DIS 
C20CHA 
C20DIS 
R30CHA 
R30DIS 
C30CHA 
C30DIS 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
 
 VARIABLE  
 
DESCRIPTION 
R20CHA/ 
R30CHA/ 
C20CHA/ 
C30CHA 
푟20/푟30/푐20/푐30 when the current ﬂows in the charge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
R20DIS/ 
R30DIS/ 
C20DIS/ 
C30DIS 
푟20/푟30/푐20/푐30 when the current ﬂows in the discharge direction:
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 

================================================================================
PAGE 498
================================================================================

*EM 
*EM_RANDLES_BATMAC 
6-150 (EM) 
R16@bdccd6d07 (03/10/25) 
 
Optional Thermal Card. 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TEMP 
FRTHER 
R0TOTH 
DUDT 
TEMPU 
 
 
 
Type 
F 
I 
I 
F 
I 
 
 
 
Default 
0. 
0 
0 
0.0 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
TEMP 
Constant temperature value used for the Randles circuit parame-
ters when there is no coupling with the thermal solver 
(FRTHER = 0) 
FRTHER 
Flag setting where the temperature is coming from: 
EQ.0: The temperature used in the Randles circuit parameters is 
TEMP. 
EQ.1: The temperature used in the Randles circuit parameter is 
the temperature from the thermal solver. 
R0TOTH 
Flag for adding joule heating from 푟0 to the thermal solve: 
EQ.0: The joule heating in the resistance 푟0 is not added to the 
thermal solve. 
EQ.1: The joule heating in the resistance 푟0 is added to the ther-
mal solve. 
DUDT 
Reversible heat: 
GE.0.0: Constant value 
LT.0.0: |DUDT| is a load curve ID for the curve giving the re-
versible heat as a function of SOC. 
TEMPU 
Temperature unit: 
EQ.0: Celsius 
EQ.1: Kelvin 
 

================================================================================
PAGE 499
================================================================================

*EM_RANDLES_BATMAC 
*EM 
R16@bdccd6d07 (03/10/25) 
6-151 (EM) 
Optional SOCShift Card. 
 Card 6 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
USESOCS
TAU 
FLCID 
 
 
 
 
 
Type 
I 
F 
I 
 
 
 
 
 
Default 
0 
0.0 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
USESOCS 
Use SOC shift (see Remark 2): 
EQ.0: Do not use the added SOCshift 
EQ.1: Use the added SOCshift 
TAU 
Damping time in the SOCshift equation (see Remark 2) 
FLCID 
Load curve giving 푓(푖) where 푖 is the total current in the unit cell 
(see Remark 2) 
Remarks: 
1. 
Model combinations.  The batmac model cannot be mixed with the solid or 
thick shell Randles models.  It can, however, be used in conjunction with the 
meshless model. 
2. 
Accounting for diffusion limitations.  Sometimes, an extra term called SOC-
shift (or SocS) can be added to high-rate discharges to account for diﬀusion lim-
itations.  The SOCshift is added to SOC for the calculation of the OCV, 
푢(SOC + SOCshift), and 푟0(SOC + SOCshift). SOCshift satisﬁes the following 
equation: 
푑(SOCshift)
푑푡
 + SOCshift
휏
 = 푓(푖(푡))
휏
 
with SOCshift(푡= 0) = 0. 
3. 
User-deﬁned ECMs. Randles circuits are based on the ﬁnite element Robin 
boundary condition, acting similarly to a convection boundary condition for the 
heat equation.  As such, the circuit equation is decomposed into a term that en-
ters the left-hand side of the stiﬀness matrix and a term that is added to the right-
hand side.  Changing the deﬁnition of those terms permits replacing the Randles 
circuits with any type of Equivalent Circuit model (ECM).  This is the purpose 

================================================================================
PAGE 500
================================================================================

*EM 
*EM_RANDLES_BATMAC 
6-152 (EM) 
R16@bdccd6d07 (03/10/25) 
of RDLTYPE = -1 where the term entering the left-hand side is deﬁned by a neg-
ative integer referring to a *DEFINE_FUNCTION ID in R0CHA (unit con-
sistency: resistance) while a negative integer in R0DIS associated with a *DE-
FINE_FUNCTION gives the term entering in the right-hand side (unit con-
sistency: current).

================================================================================
PAGE 501
================================================================================

*EM_RANDLES_EXOTHERMIC_REACTION 
*EM 
R16@bdccd6d07 (03/10/25) 
6-153 (EM) 
*EM_RANDLES_EXOTHERMIC_REACTION 
Purpose:  Add an extra heat source term to the Randles circuit nodes to account for ther-
mal runaway situations. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable AREATYPE FUNCTID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
2 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
AREATYPE 
Works the same way as RDLAREA in *EM_RANDLES_SOLID or 
*EM_RANDLES_TSHELL: 
EQ.1: The heat source in FUNCTID is per unit area so that, for 
each local Randles circuit, the result returned by FUNC-
TID is multiplied by a factor areaLoc.  areaLoc is the local 
area associated with each Randles circuit while areaGlob 
is the area of the whole cell.  Unit consistency in SI: W*m2.
EQ.2: The heat source in FUNCTID is for the whole cell (the 
whole cell is shorted), so that, for each Randles circuit, the 
result returned by FUNCTID is multiplied by a factor ar-
eaLoc/areaGlob (default).  Unit consistency in SI: W. 
EQ.3: The heat source returned by FUNCTID is taken as is in 
each Randles circuit.  Unit consistency in SI: W. 
EQ.11: Same as 1, except the parameters are deﬁned for the whole
cell and are scaled in each Randles circuit by a factor de-
pending on the local volume of the circuit and the global
volume of the cell. 
EQ.22: Same as 2, except the parameters are deﬁned for the whole
cell and are scaled in each Randles circuit by a factor de-
pending on the local volume of the circuit and the global 
volume of the cell. 
FUNCTID 
DEFINE_FUNCTION ID giving the local heat source as a function 
of local parameters for the local Randles circuit.  See Table 6-2 in 
*EM_RANDLES. 

================================================================================
PAGE 502
================================================================================

*EM 
*EM_RANDLES_MESHLESS 
6-154 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_RANDLES_MESHLESS 
Purpose:  Deﬁne the distributed Randles circuit parameters for a Randles cell that is not 
associated with a mesh (lumped Randles circuit). 
Card Summary: 
Card 1.  This card is required. 
RDLID 
RDLTYPE 
 
 
 
 
 
 
Card 2.  This card is required. 
Q 
CQ 
SOCINIT 
SOCTOU 
 
 
 
 
Card 3.  This card is required. 
R0CHA 
R0DIS 
R10CHA 
R10DIS 
C10CHA 
C10DIS 
 
 
Card 4.  This card is only read if RDLTYPE > 1. It is optional. 
R20CHA 
R20DIS 
C20CHA 
C20DIS 
R30CHA 
R30DIS 
C30CHA 
C30DIS 
Card 5.  This card is optional. 
TEMP 
 
 
DUDT 
TEMPU 
 
 
 
Card 6.  This card is optional. 
USESOCS 
TAU 
FLCID 
 
 
 
 
 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RDLID 
RDLTYPE
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 

================================================================================
PAGE 503
================================================================================

*EM_RANDLES_MESHLESS 
*EM 
R16@bdccd6d07 (03/10/25) 
6-155 (EM) 
 VARIABLE  
 
DESCRIPTION 
RDLID 
ID of the Randles cell 
RDLTYPE 
Type of Randles cell: 
EQ.0: 0-order Randles cell 
EQ.1: 1-order Randles cell 
EQ.2: 2-order Randles cell 
EQ.3: 3-order Randles cell 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Q 
CQ 
SOCINIT 
SOCTOU 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
Q 
Cell capacity 
CQ 
SOC conversion factor (%/s).  It is known to be equal to 1/36 in SI 
units. 
SOCINIT 
Initial state of charge of the cell 
SOCTOU 
Equilibrium voltage (OCV): 
GE.0.0: Constant value 
LT.0.0: |SOCTOU| is a load curve ID deﬁning the equilibrium 
voltage (OCV) as a function of the state of charge (SOC).
 

================================================================================
PAGE 504
================================================================================

*EM 
*EM_RANDLES_MESHLESS 
6-156 (EM) 
R16@bdccd6d07 (03/10/25) 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R0CHA 
R0DIS 
R10CHA 
R10DIS 
C10CHA 
C10DIS 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
R0CHA/ 
R10CHA/ 
C10CHA 
푟0/푟10/푐10 when the current ﬂows in the charge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
R0DIS/ 
R10DIS/ 
C10DIS 
푟0/푟10/푐10 when the current ﬂows in the discharge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
 
Optional Card for RDLTYPE > 1.  This card is only read if RDLTYPE is greater than 1. 
It is optional. 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R20CHA 
R20DIS 
C20CHA 
C20DIS 
R30CHA 
R30DIS 
C30CHA 
C30DIS 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
 

================================================================================
PAGE 505
================================================================================

*EM_RANDLES_MESHLESS 
*EM 
R16@bdccd6d07 (03/10/25) 
6-157 (EM) 
 VARIABLE  
 
DESCRIPTION 
R20CHA/ 
R30CHA/ 
C20CHA/ 
C30CHA 
푟20/푟30/푐20/푐30 when the current ﬂows in the charge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
R20DIS/ 
R30DIS/ 
C20DIS/ 
C30DIS 
푟20/푟30/푐20/푐30 when the current ﬂows in the discharge direction:
GE.0.0: Constant value. 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
 
Optional Thermal Card. 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TEMP 
 
 
DUDT 
TEMPU 
 
 
 
Type 
F 
 
 
F 
I 
 
 
 
Default 
0. 
 
 
none 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
TEMP 
Constant temperature value used for the Randles circuit parame-
ters 
DUDT 
Reversible heat: 
GE.0.0: Constant value 
LT.0.0: |DUDT| is a load curve ID for the curve giving the re-
versible heat as a function of SOC. 
TEMPU 
Temperature unit: 
EQ.0: Celsius 

================================================================================
PAGE 506
================================================================================

*EM 
*EM_RANDLES_MESHLESS 
6-158 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: Kelvin 
 
SOC shift Optional card. 
 Card 6 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
USESOCS
TAU 
FLCID 
 
 
 
 
 
Type 
I 
F 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
USESOCS 
Use SOCshift (see Remark 1): 
EQ.0: Do not use the added SOCshift. 
EQ.1: Use the added SOCshift. 
TAU 
Damping time in the SOCshift equation (see Remark 1) 
FLCID 
Load curve giving 푓(푖) where 푖 is the total current in the unit cell 
(see Remark 1) 
Remarks: 
1. 
Accounting for diffusion limitations.  Sometimes, an extra term called SOC-
shift (or SocS) can be added to high-rate discharges to account for diﬀusion lim-
itations.  The SOCshift is added to SOC for the calculation of the OCV, 
푢(SOC + SOCshift), and 푟0(SOC + SOCshift). SOCshift satisﬁes the following 
equation: 
푑(SOCshift)
푑푡
 + SOCshift
휏
 = 푓(푖(푡))
휏
 
with SOCshift(푡= 0) = 0.

================================================================================
PAGE 507
================================================================================

*EM_RANDLES_TSHELL 
*EM 
R16@bdccd6d07 (03/10/25) 
6-159 (EM) 
*EM_RANDLES_TSHELL 
Purpose:  Deﬁne the distributed Randles circuit parameters for a Randles cell when using 
a composite tshell mechanical model. 
Card Summary: 
Card 1.  This card is required. 
RDLID 
RDLTYPE 
RDLAREA 
PSID 
 
 
 
 
Card 2.  This card is required. 
Q 
CQ 
SOCINIT 
SOCTOU 
 
 
 
 
Card 3.  This card is required. 
R0CHA 
R0DIS 
R10CHA 
R10DIS 
C10CHA 
C10DIS 
 
 
Card 4.  This is only read if RDLTYPE > 1. It is optional. 
R20CHA 
R20DIS 
C20CHA 
C20DIS 
R30CHA 
R30DIS 
C30CHA 
C30DIS 
Card 5.  This card is optional. 
TEMP 
FRTHER 
R0TOTH 
DUDT 
TEMPU 
 
 
 
Card 6.  This card is optional. 
USESOCS 
TAU 
FLCID 
 
 
 
 
 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RDLID 
RDLTYPE
RDLAREA
PSID 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
2 
none 
 
 
 
 
 

================================================================================
PAGE 508
================================================================================

*EM 
*EM_RANDLES_TSHELL 
6-160 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
RDLID 
ID of the Randles Cell 
RDLTYPE 
Type of Randles Cell: 
EQ.-1: User-deﬁned equivalent circuit model.  See Remark 3. 
EQ.0: 0-order Randles Cell 
EQ.1: 1-order Randles Cell 
EQ.2: 2-order Randles Cell 
EQ.3: 3-order Randles Cell 
RDLAREA 
Randles Area: 
EQ.1: The parameters are per unit area and will be scaled in each 
Randles circuit by a factor depending on the local area of 
the circuit.  Unit consistency in SI: Ohms times square me-
ters. 
EQ.2: The parameters are deﬁned for the whole cell and will be 
scaled in each Randles circuit by a factor depending on the 
local area of the circuit and the global area of the cell (de-
fault).  Unit consistency in SI: Ohms. 
EQ.3: The parameters are not scaled by area factors.  Unit con-
sistency in SI: Ohms. 
PSID 
Part set ID of all the parts composing the cell (see Remark 1) 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Q 
CQ 
SOCINIT 
SOCTOU 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
Q 
Cell capacity 
CQ 
SOC conversion factor (%/s).  It is known to be equal to 1 36
⁄
 in SI 
units. 

================================================================================
PAGE 509
================================================================================

*EM_RANDLES_TSHELL 
*EM 
R16@bdccd6d07 (03/10/25) 
6-161 (EM) 
 VARIABLE  
 
DESCRIPTION 
SOCINIT 
Initial state of charge of the cell 
SOCTOU 
Equilibrium voltage (OCV): 
GE.0.0: Constant value 
LT.0.0: |SOCTOU| is a load curve ID deﬁning equilibrium volt-
age (OCV) as a function of the state of charge (SOC). 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R0CHA 
R0DIS 
R10CHA 
R10DIS 
C10CHA 
C10DIS 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
R0CHA/ 
R10CHA/ 
C10CHA 
푟0/푟10/푐10 when the current ﬂows in the charge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
R0DIS/ 
R10DIS/ 
C10DIS 
푟0/푟10/푐10 when the current ﬂows in the discharge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
 

================================================================================
PAGE 510
================================================================================

*EM 
*EM_RANDLES_TSHELL 
6-162 (EM) 
R16@bdccd6d07 (03/10/25) 
Optional Card for RDLTYPE > 1.  This card is only read if RDLTYPE > 1. It is optional. 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R20CHA 
R20DIS 
C20CHA 
C20DIS 
R30CHA 
R30DIS 
C30CHA 
C30DIS 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
 
 VARIABLE  
 
DESCRIPTION 
R20CHA/ 
R30CHA/ 
C20CHA/ 
C30CHA 
푟20/푟30/푐20/푐30 when the current ﬂows in the charge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
R20DIS/ 
R30DIS/ 
CDIS/ 
C30DIS 
푟20/푟30/푐20/푐30 when the current ﬂows in the discharge direction:
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
 
Optional Thermal Card.   
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TEMP 
FRTHER 
R0TOTH 
DUDT 
TEMPU 
 
 
 
Type 
F 
I 
I 
F 
I 
 
 
 
Default 
0. 
0 
0 
0.0 
0 
 
 
 
 

================================================================================
PAGE 511
================================================================================

*EM_RANDLES_TSHELL 
*EM 
R16@bdccd6d07 (03/10/25) 
6-163 (EM) 
 VARIABLE  
 
DESCRIPTION 
TEMP 
Constant temperature value used for the Randles circuit parame-
ters when there is no coupling with the thermal solver 
(FRTHER = 0) 
FRTHER 
Flag about where the temperature is coming from: 
EQ.0: The temperature used in the Randles circuit parameters is
TEMP. 
EQ.1: The temperature used in the Randle circuit parameter is
the temperature from the thermal solver. 
R0TOTH 
Flag for adding joule heating from 푟0 to the thermal solve: 
EQ.0: The joule heating in the resistance 푟0 is not added to the 
thermal solve. 
EQ.1: The joule heating in the resistance 푟0 is added to the ther-
mal solve. 
DUDT 
Reversible heat: 
GE.0.0: Constant value 
LT.0.0: |DUDT| is a load curve ID for the curve givig the re-
versible heat as a function of SOC. 
TEMPU 
Temperature unit: 
EQ.0: Celsius 
EQ.1: Kelvin 
 
Optional SOCShift Card.   
 Card 6 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
USESOCS
TAU 
FLCID 
 
 
 
 
 
Type 
I 
F 
I 
 
 
 
 
 
Default 
0 
0.0 
0 
 
 
 
 
 
 

================================================================================
PAGE 512
================================================================================

*EM 
*EM_RANDLES_TSHELL 
6-164 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
USESOCS 
Use SOCshift (see Remark 2): 
EQ.0: Do not use the added SOCshift. 
EQ.1: Use the added SOCshift. 
TAU 
Damping time in the SOCshift equation (see Remark 2) 
FLCID 
Load curve giving 푓(푖) where 푖 is the total current in the unit cell 
(see Remark 2) 
Remarks: 
1. 
Sectioning of a circuit.  *PART_COMPOSITE_TSHELL deﬁnes each part of 
PSID. With this keyword for deﬁning the part, each layer of a part can serve a 
diﬀerent function, namely, as a current collector positive, current collector neg-
ative, separator, negative electrode, or positive electrode.  The RDLTYPE ﬁeld 
of *EM_MAT_001 sets a given layer’s function.    
2. 
Accounting for diffusion limitations.  Sometimes, an extra term called SOC-
shift (or SocS) can be added to high-rate discharges to account for diﬀusion lim-
itations.  The SOCshift is added to SOC for the calculation of the OCV, 
푢(SOC + SOCshift), and 푟0(SOC + SOCshift). SOCshift satisﬁes the following 
equation: 
푑(SOCshift)
푑푡
 + SOCshift
휏
 = 푓(푖(푡))
휏
 
with SOCshift(푡= 0) = 0. 
3. 
User-deﬁned ECMs. Randles circuits are based on the ﬁnite element Robin 
boundary condition, acting similarly to a convection boundary condition for the 
heat equation.  As such, the circuit equation is decomposed into a term that en-
ters the left-hand side of the stiﬀness matrix and a term that is added to the right-
hand side.  Changing the deﬁnition of those terms permits replacing the Randles 
circuits with any type of Equivalent Circuit model (ECM).  This is the purpose 
of RDLTYPE = -1 where the term entering the left-hand side is deﬁned by a neg-
ative integer referring to a *DEFINE_FUNCTION ID in R0CHA (unit con-
sistency: resistance) while a negative integer in R0DIS associated with a *DE-
FINE_FUNCTION gives the term entering in the right-hand side (unit con-
sistency: current).

================================================================================
PAGE 513
================================================================================

*EM_RANDLES_SHORT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-165 (EM) 
*EM_RANDLES_SHORT 
Purpose:  For a battery cell internal short, deﬁne conditions to turn on a Randles short 
(replace one or several Randles circuits by resistances).  Also, deﬁne the value of the short 
resistance. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable AREATYPE FUNCTID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
2 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
AREATYPE 
Works the same way as RDLAREA in *EM_RANDLES_SOLID or 
*EM_RANDLES_TSHELL: 
EQ.1: The resistance inverse in FUNCTID is per unit area so that, 
for each local Randles circuit, the result returned by 
FUNCTID is multiplied by a factor 1./areaLoc (areaLoc is
the local area associated with each Randles circuit, while
areaGlob is the area of the whole cell).  Unit consistency in
SI: Ohms times square meters. 
EQ.2: The resistance in FUNCTID is for the whole cell (the 
whole cell is shorted), so that, for each Randles circuit, the 
result returned by FUNCTID is multiplied by a factor ar-
eaGlob/areaLoc (default).  Unit consistency in SI: Ohms.
EQ.3: The resistance returned by FUNCTID is taken as is for 
each Randles circuit.  Unit consistency in SI:Ohms. 
EQ.11: Same as 1, except the parameters are deﬁned for the whole
cell and are scaled in each Randles circuit by a factor de-
pending on the local volume of the circuit and the global 
volume of the cell. 
EQ.22: Same as 2, except the parameters are deﬁned for the whole
cell and are scaled in each Randles circuit by a factor de-
pending on the local volume of the circuit and the global 
volume of the cell. 

================================================================================
PAGE 514
================================================================================

*EM 
*EM_RANDLES_SHORT 
6-166 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
FUNCTID 
Function ID (see *DEFINE_FUNCTION) for the function giving the 
local resistance function of local parameters for the local Randles cir-
cuit.  See Remark 1. See Table 6-2 in *EM_RANDLES for the accepted 
function arguments. 
Remarks: 
1. 
Short criterion.  If the return value of the function is zero, there is no short.  The 
Randles circuit is maintained.  A positive returned value causes replacing the 
Randles circuit with the returned short resistance.  To ensure that the short is 
maintained even after the original criterion is no longer met, the default positive 
value may be replaced by a negative value.  The solver then takes the absolute 
value returned and adopts it as the new short resistance in case the original short 
criterion is no longer met rather than reverting to a Randles circuit. 
2. 
*Example *DEFINE_FUNCTION. The following partial input provides an ex-
ample of a function: 
*DEFINE_FUNCTION 
FID (Function Id) 
Float resistance_short_randle( 
float time, 
float x_ccp,float y_ccp,float z_ccp, 
float x_sep,float y_sep,float z_sep, 
float x_sem,float y_sem,float z_sem, 
float x_ccm,float y_ccm,float z_ccm) 
{  
  float seThick0; 
  seThick0=1.e-5; 
  seThick=(sqrt(x_sep-x_sem)^2+(y_sep-y_sem)^2+(z_sep-z_sem)^2); 
  if (seThick >= seThick0) then 
  return 1.e-2; 
  else 
  return -1.e-3; 
  endif 
} 
In this example, as long as seThick is smaller than seThick0, no short occurs.  
Once seThick becomes larger than seThick0, a short occurs, and the short re-
sistance is 1.e-2. If during the run, seThick once again becomes smaller than 
seThick0, the short is maintained and the short resistance becomes 1.e-3. Replac-
ing 1.e-3 by 0.0 causes the short to revert to the original Randles circuit. 
3. 
Erosion.  For the solid model (see *EM_RANDLES_SOLID), when an erosion-
based criterion is deﬁned, the erosion variable, ero, enables distinguishing 
which component of the battery has been eroded and adjusts the short resistance 
law accordingly: 

================================================================================
PAGE 515
================================================================================

*EM_RANDLES_SHORT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-167 (EM) 
a) ero = 1 when the eroded element comes from the positive current collector. 
b) ero = 10 when the eroded element comes from the negative current collec-
tor. 
c) ero = 100 when the eroded element comes from the separator. 
d) ero = 1000 when the eroded element comes from the positive electrode. 
e) ero = 10000 when the eroded element comes from the negative electrode. 
When multiple components have eroded elements, ero is the sum of the indica-
tors.  For example, a returned value of 1001 indicates that both the elements com-
ing from the positive electrode and the positive current collector have been 
eroded.

================================================================================
PAGE 516
================================================================================

*EM 
*EM_RANDLES_SOLID 
6-168 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_RANDLES_SOLID 
Purpose:  Deﬁne the distributed Randles circuit parameters for a Randles cell when using 
a solid mechanical model. 
Card Summary: 
Card 1.  This card is required. 
RDLID 
RDLTYPE 
RDLAREA 
CCPPART 
CCNPART 
SEPPART 
PELPART 
NELPART 
Card 2.  This card is required. 
Q 
CQ 
SOCINIT 
SOCTOU 
 
 
 
 
Card 3.  This card is required. 
R0CHA 
R0DIS 
R10CHA 
R10DIS 
C10CHA 
C10DIS 
 
 
Card 4.  This card is only read for RDLTYPE > 1. It is optional. 
R20CHA 
R20DIS 
C20CHA 
C20DIS 
R30CHA 
R30DIS 
C30CHA 
C30DIS 
Card 5.  This card is optional. 
TEMP 
FRTHER 
R0TOTH 
DUDT 
TEMPU 
 
 
 
Card 6.  This card is optional. 
USESOCS 
TAU 
FLCID 
 
 
 
 
 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RDLID 
RDLTYPE
RDLAREA
CCPPART CCNPART SEPPART
PELPART
NELPART
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 

================================================================================
PAGE 517
================================================================================

*EM_RANDLES_SOLID 
*EM 
R16@bdccd6d07 (03/10/25) 
6-169 (EM) 
 VARIABLE  
 
DESCRIPTION 
RDLID 
ID of the Randles Cell 
RDLTYPE 
Type of Randles Cell: 
EQ.-1: User-deﬁned equivalent circuit model.  See Remark 3. 
EQ.0: 0-order Randles Cell 
EQ.1: 1-order Randles Cell 
EQ.2: 2-order Randles Cell 
EQ.3: 3-order Randles Cell 
RDLAREA 
Randles Area: 
EQ.1: The parameters are per unit area and will be scaled in each 
Randles circuit by a factor depending on the local area of 
the circuit.  Unit consistency in SI: Ohms times square me-
ters. 
EQ.2: The parameters are deﬁned for the whole cell and will be 
scaled in each Randles circuit by a factor depending on the 
local area of the circuit and the global area of the cell (de-
fault).  Unit consistency in SI: Ohms. 
EQ.3: The parameters are not scaled by area factors.  Unit con-
sistency in SI: Ohms. 
CCPPART 
Current collector positive (CCP) part ID 
CCNPART 
Current collector negative (CCN) part ID 
SEPPART 
Separator part ID 
PELPART 
Positive electrode part ID 
NELPART 
Negative electrode part ID 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Q 
CQ 
SOCINIT 
SOCTOU 
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 

================================================================================
PAGE 518
================================================================================

*EM 
*EM_RANDLES_SOLID 
6-170 (EM) 
R16@bdccd6d07 (03/10/25) 
 
 VARIABLE  
 
DESCRIPTION 
Q 
Cell capacity 
CQ 
SOC conversion factor (%/s).  It is known to be equal to 1/36 in SI 
units. 
SOCINIT 
Initial state of charge of the cell 
SOCTOU 
Equilibrium voltage (OCV): 
GE.0.0: Constant value 
LT.0.0: |SOCTOU| can refer to a load curve ID deﬁning equilib-
rium voltage (OCV) as a function of the state of charge 
(SOC) or to a table ID with temperature indexing load 
curves that give OCV as a function of SOC. 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R0CHA 
R0DIS 
R10CHA 
R10DIS 
C10CHA 
C10DIS 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
R0CHA/ 
R10CHA/ 
C10CHA 
푟0/푟10/푐10 when the current ﬂows in the charge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
R0DIS/ 
R10DIS/ 
C10DIS 
푟0/푟10/푐10 when the current ﬂows in the discharge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 

================================================================================
PAGE 519
================================================================================

*EM_RANDLES_SOLID 
*EM 
R16@bdccd6d07 (03/10/25) 
6-171 (EM) 
 VARIABLE  
 
DESCRIPTION 
parameters can be made a function of the SOC and tem-
perature. 
 
Optional Card for RDLTYPE > 1.  This card is only read for RDLTYPE greater than 1. It 
is optional. 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
R20CHA 
R20DIS 
C20CHA 
C20DIS 
R30CHA 
R30DIS 
C30CHA 
C30DIS 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
 
 VARIABLE  
 
DESCRIPTION 
R20CHA/ 
R30CHA/ 
C20CHA/ 
C30CHA 
푟20/푟30/푐20/푐30 when the current ﬂows in the charge direction: 
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
R20DIS/ 
R30DIS/ 
C20DIS/ 
C30DIS 
푟20/푟30/푐20/푐30 when the current ﬂows in the discharge direction:
GE.0.0: Constant value 
LT.0.0: Absolute value is a function (see *DEFINE_FUNC-
TION) or table ID. See Table 6-2 in *EM_RANDLES for 
the accepted function arguments.  For a table, the circuit 
parameters can be made a function of the SOC and tem-
perature. 
 

================================================================================
PAGE 520
================================================================================

*EM 
*EM_RANDLES_SOLID 
6-172 (EM) 
R16@bdccd6d07 (03/10/25) 
Optional Thermal Card. 
 Card 5 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TEMP 
FRTHER 
R0TOTH 
DUDT 
TEMPU 
 
 
 
Type 
F 
I 
I 
F 
I 
 
 
 
Default 
0. 
0 
0 
0.0 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
TEMP 
Constant temperature value used for the Randles circuit parame-
ters when there is no coupling with the thermal solver 
(FRTHER = 0) 
FRTHER 
Flag about where the temperature is coming from: 
EQ.0: The temperature used in the Randles circuit parameters is
TEMP. 
EQ.1: The temperature used in the Randle circuit parameter is 
the temperature from the thermal solver. 
R0TOTH 
Flag for adding joule heating from 푟0 to the thermal solve: 
EQ.0: The joule heating in the resistance 푟0 is not added to the 
thermal solve. 
EQ.1: The joule heating in the resistance 푟0 is added to the ther-
mal solve. 
DUDT 
Reversible heat: 
GE.0.0: Constant value 
LT.0.0: |DUDT| is a load curve ID for the curve giving the re-
versible heat as a function of SOC. 
TEMPU 
Temperature unit: 
EQ.0: Celsius 
EQ.1: Kelvin 
 

================================================================================
PAGE 521
================================================================================

*EM_RANDLES_SOLID 
*EM 
R16@bdccd6d07 (03/10/25) 
6-173 (EM) 
Optional SOC Shift Card. 
 Card 6 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
USESOCS
TAU 
FLCID 
 
 
 
 
 
Type 
I 
F 
I 
 
 
 
 
 
Default 
0 
0.0 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
USESOCS 
Use SOCshift (see Remark 2): 
EQ.0: Do not use the added SOCshift. 
EQ.1: Use the added SOCshift. 
TAU 
Damping time in the SOCshift equation (see Remark 2) 
FLCID 
Load curve giving 푓(푖) where 푖 is the total current in the unit cell 
(see Remark 2) 
Remarks: 
1. 
Element normal vector orientation.  The solid element normal vectors must 
all be oriented in the direction pointing from the positive current collector to the 
negative current collector to detect which current collector nodes are connected 
to one another.  Furthermore, any number of layers can be modeled, but the 
meshes of the CCP, anode, separator, cathode, and CCN must be continuous and 
have merged nodes at the boundaries. 
2. 
Accounting for diffusion limitations.  Sometimes, an extra term called SOC-
shift (or SocS) can be added to high-rate discharges to account for diﬀusion lim-
itations.  The SOCshift is added to SOC for the calculation of the OCV, 
푢(SOC + SOCshift), and 푟0(SOC + SOCshift). SOCshift satisﬁes the following 
equation: 
푑(SOCshift)
푑푡
 + SOCshift
휏
 = 푓(푖(푡))
휏
 
with SOCshift(푡= 0) = 0. 
3. 
User-deﬁned ECMs. Randles circuits are based on the ﬁnite element Robin 
boundary condition, acting similarly to a convection boundary condition for the 
heat equation.  As such, the circuit equation is decomposed into a term that 

================================================================================
PAGE 522
================================================================================

*EM 
*EM_RANDLES_SOLID 
6-174 (EM) 
R16@bdccd6d07 (03/10/25) 
enters the left-hand side of the stiﬀness matrix and a term that is added to the 
right-hand side.  Changing the deﬁnition of those terms permits replacing the 
Randles circuits with any type of Equivalent Circuit model (ECM).  This is the 
purpose of RDLTYPE = -1 where the term entering the left-hand side is deﬁned 
by a negative integer referring to a *DEFINE_FUNCTION ID in R0CHA (unit 
consistency: resistance) while a negative integer in R0DIS associated with a *DE-
FINE_FUNCTION gives the term entering in the right-hand side (unit con-
sistency: current).

================================================================================
PAGE 523
================================================================================

*EM_ROTATION_AXIS 
*EM 
R16@bdccd6d07 (03/10/25) 
6-175 (EM) 
*EM_ROTATION_AXIS 
Purpose:  Deﬁne a rotation axis for the EM solver.  This keyword is used with the 2D 
axisymmetric solver.  The axis is deﬁned by a point and a direction. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
XP 
YP 
ZP 
XD 
YD 
ZD 
NUMSEC 
 
Type 
F 
F 
F 
F 
F 
F 
I 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
Optional Card. Deﬁne an additional vector normal to the rotation vector that gives the 
rotation direction.  See Remark 1. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
XT 
YT 
ZT 
XH 
YH 
ZH 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
XP, YP, ZP 
푥, 푦, and 푧 coordinates of the point 
XD, YD, ZD 
푥, 푦, and 푧 components of direction of the axis 
NUMSEC 
Number of sectors.  This ﬁeld gives the ratio of the full circle to the
angular extension of the mesh.  This has to be a power of two.  For 
example, NUMSEC = 4 means that the mesh of the part represents 
one-fourth of the total circle.  If NUMSEC = 0 for *EM_2DAXI, the 
solver replaces it with this value. 
XT/YT/ZT 
and 
XH/YH/ZH 
Tail and head coordinates of the additional vector orthogonal to 
the rotation axis that gives the direction of the rotation.  See Re-
mark 1. 

================================================================================
PAGE 524
================================================================================

*EM 
*EM_ROTATION_AXIS 
6-176 (EM) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
1. 
Simpliﬁed 2D axisymmetric input.  Starting with R15, the EM 2D axisymmetric 
solver enables specifying an additional vector orthogonal to the rotation axis 
that provides the rotation direction.  When used, *EM_2DAXI is no longer 
needed.  Also, SIDCUR, SIDVIN, and SIDVOUT in *EM_CIRCUIT are no longer 
needed, but PID becomes mandatory.  This results in a simpliﬁed input deck 
(fewer segment sets and keywords need to be deﬁned).

================================================================================
PAGE 525
================================================================================

*EM_SOLVER_BEM 
*EM 
R16@bdccd6d07 (03/10/25) 
6-177 (EM) 
*EM_SOLVER_BEM 
Purpose:  Deﬁne the type of linear solver and pre-conditioner as well as tolerance for the 
EM_BEM solve. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RELTOL 
MAXITE 
STYPE 
PRECON 
USELAST NCYLBEM
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
Default 
10-6 
1000 
2 
2 
1 
5000 
 
 
 
 VARIABLE  
 
DESCRIPTION 
RELTOL 
Relative tolerance for the iterative solvers (PCG or GMRES).  If the 
results are not accurate enough, the user should try to decrease this 
tolerance.  More iterations will then be needed. 
MAXITER 
Maximum number of iterations for the iterative solvers 
STYPE 
Solver type: 
EQ.1: Direct solve.  The matrices are considered dense. 
EQ.2: Pre-conditioned gradient method (PCG).  This method al-
lows for block matrices with low-rank blocks and thus re-
duces the memory used. 
EQ.3: GMRES method.  This method allows for block matrices
with low-rank blocks and thus reduces the memory used. 
The GMRES option only works in serial for now. 
PRECON 
Preconditioner type for PCG or GMRES iterative solves: 
EQ.-1: No preconditioner 
EQ.1: Diagonal line 
EQ.2: Diagonal block (default) 
EQ.3: Broad diagonal including all neighbor faces 
EQ.4: LLT factorization 
USELAST 
Only used for iterative solvers (PCG or GMRES). 
EQ.-1: Start from 0 as the initial guess for the solution of the 

================================================================================
PAGE 526
================================================================================

*EM 
*EM_SOLVER_BEM 
6-178 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
linear system. 
EQ.1: Starts from the previous solution normalized by the RHS
change.  See Remark 1. 
NCYLBEM 
Number of electromagnetism cycles between the recalculation of
BEM matrices.  If negative, the absolute value refers to a load curve 
giving the number of cycles as a function of time.  See Remarks 2
and 3. 
Remarks: 
1. 
USELAST.  Using USELAST = 1 can save many iterations in the subsequent 
solves if the vector solution of the present solve can be assumed to be nearly 
parallel to the vector solution of the previous solve, as usually happens in time-
domain eddy-current problems.  
2. 
Moving conductors.  Since the BEM matrices depend on (and only on) the sur-
face node coordinates of the conductors, recalculating them when the conduc-
tors are moving is important.  NCYLBEM controls the frequency with which 
they are updated.  Note that very small values, for example, NCYLBEM = 1, 
should, generally, be avoided since this calculation involves a high computa-
tional cost.  However, when two conductors are moving and in contact with each 
other, we recommend recalculating the matrices at every time step.   
3. 
Order of precedence for NCYLBEM.  You can set NCYLBEM with *EM_CON-
TROL_SOLUTION, *EM_SOLVER_FEM/BEM, and *EM_CONTROL. *EM_-
CONTROL_SOLUTION has the highest priority for setting this ﬁeld.  If 
NCYLBEM is the default value on *EM_CONTROL_SOLUTION, LS-DYNA 
looks at the setting of NCYLBEM on *EM_SOLVER_BEM. If left as default on 
this keyword, LS-DYNA looks at the setting of NCYLBEM on *EM_CONTROL.

================================================================================
PAGE 527
================================================================================

*EM_SOLVER_BEMMAT 
*EM 
R16@bdccd6d07 (03/10/25) 
6-179 (EM) 
*EM_SOLVER_BEMMAT 
Purpose:  Deﬁne the type of BEM matrices as well as the way they are assembled. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MATID 
 
 
 
 
 
 
RELTOL 
Type 
I 
 
 
 
 
 
 
F 
Default 
none 
 
 
 
 
 
 
10-6 
 
 VARIABLE  
 
DESCRIPTION 
MATID 
Deﬁnes which BEM matrix the card refers to: 
EQ.1: 퐏 matrix 
EQ.2: 퐐 matrix 
EQ.3: 퐖 matrix 
RELTOL 
Relative tolerance on the sub-blocks of the matrix when doing low 
rank approximations.  The user should try to decrease these toler-
ances if the results are not accurate enough.  More memory will 
then be needed. 
Remarks: 
1. 
The 퐖 matrix only exists when the monolithic solver is activated (see *EM_-
SOLVER_FEMBEM_MONOLITHIC).

================================================================================
PAGE 528
================================================================================

*EM 
*EM_SOLVER_FEM 
6-180 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_SOLVER_FEM 
Purpose:  Deﬁne some parameters for the EM FEM solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RELTOL 
MAXITE 
STYPE 
PRECON 
USELAST
NCYLFEM
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
Default 
10-3 
1000 
1 
1 
1 
5000 
 
 
 
 VARIABLE  
 
DESCRIPTION 
RELTOL 
Relative tolerance for the iterative solvers (PCG).  If the results are 
not accurate enough, try decreasing this tolerance.  More iterations 
will then be needed. 
MAXITER 
Maximum number of iterations for iterative solvers 
STYPE 
Solver type: 
EQ.1: Direct solve  
EQ.2: Pre-conditioned Gradient Method (PCG) 
PRECON 
Preconditioner type for PCG. 
EQ.0: No preconditioner 
EQ.1: Diagonal line 
USELAST 
This is used only for iterative solvers (PCG). 
EQ.-1: Starts from 0 as the initial solution of the linear system. 
EQ.1: Starts from the previous solution normalized by the 
right-hand-side change.  See Remark 1. 
NCYLFEM 
Number of electromagnetism cycles between the recalculation of
FEM matrices.  If negative, the absolute value refers to a load curve 
giving NCYCLFEM as a function of time.  See Remarks 2 and 3. 

================================================================================
PAGE 529
================================================================================

*EM_SOLVER_FEM 
*EM 
R16@bdccd6d07 (03/10/25) 
6-181 (EM) 
Remarks: 
1. 
Starting from the previous solution.  Using USELAST = 1 can save many iter-
ations in the subsequent solves if the vector solution of the present solve can be 
assumed to be nearly parallel to the vector solution of the previous solve, as 
usually happens in time-domain eddy-current problems. 
2. 
NCYLFEM.  When the conductor parts are deforming or undergoing changes in 
their EM material properties (conductivity for example), the FEM matrices 
should be recalculated more often, so NCYLFEM may need to be changed. 
3. 
Order of precedence for NCYLFEM.  You can set NCYLFEM with *EM_CON-
TROL_SOLUTION, *EM_SOLVER_FEM, and *EM_CONTROL. *EM_CON-
TROL_SOLUTION has the highest priority for setting this ﬁeld.  If NCYLFEM is 
the default value on *EM_CONTROL_SOLUTION, LS-DYNA looks at the set-
ting of NCYLFEM on *EM_SOLVER_FEM. If left as default on this keyword, LS-
DYNA looks at the setting on *EM_CONTROL.

================================================================================
PAGE 530
================================================================================

*EM 
*EM_SOLVER_FEMBEM 
6-182 (EM) 
R16@bdccd6d07 (03/10/25) 
*EM_SOLVER_FEMBEM 
Purpose:  Deﬁne some parameters for the standard coupling between the EM_FEM and 
EM_BEM solvers. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RELTOL 
MAXITE 
FORCON 
 
 
 
 
 
Type 
F 
I 
I 
 
 
 
 
 
Default 
10-2 
50 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
RELTOL 
Relative tolerance for the FEM/BEM system solve.  If the results 
are not accurate enough, try decreasing this tolerance.  A smaller 
tolerance will, however, require more iterations. 
MAXITER 
Maximal number of iterations 
FORCON 
Force convergence:  
EQ.0: The code stops with an error if no convergence. 
EQ.1: The code continues to the next time step even if the REL-
TOL convergence criteria has not been reached. 
Remarks: 
This keyword couples the FEM and BEM systems with the Richardson method.  At each 
time step, the solver will iterate between the FEM and the BEM system until reaching 
convergence (based on the choice of RELTOL and MAXITER).  The cost for this solve is 
low.  However, to ensure stability, we recommend imposing a limit on the timestep based 
on the characteristic diﬀusion time (See *EM_CONTROL_TIMESTEP).  Furthermore, it 
can be unstable whenever magnetic materials are involved (conductor’s permeability dif-
ferent than vacuum permeability).  The monolithic solver invoked with *EM_SOLVER_-
FEMBEM_MONOLITHIC aims to remove those two limitations by solving both the FEM 
and BEM systems in one single monolithic bloc.  For such cases, it is, therefore, the rec-
ommended choice (See *EM_SOLVER_FEMBEM_MONOLITHIC).

================================================================================
PAGE 531
================================================================================

*EM_SOLVER_FEMBEM_MONOLITHIC 
*EM 
R16@bdccd6d07 (03/10/25) 
6-183 (EM) 
*EM_SOLVER_FEMBEM_MONOLITHIC 
Purpose:  Replaces *EM_SOLVER_FEMBEM and turns on the monolithic FEM-BEM 
solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MTYPE 
STYPE 
ABSTOL 
RELTOL 
MAXIT 
 
 
 
Type 
I 
I 
F 
F 
I 
 
 
 
Default 
0 
0 
10-6 
10-4 
500 
 
 
 
 
Optional Card. Optional card for nonlinear magnetic cases. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
 
NTSTOL 
NTATOL 
NTRTOL 
NTMIT 
 
 
 
Type 
 
F 
F 
F 
I 
 
 
 
Default 
 
10-5 
10-12 
10-4 
20 
 
 
 
 
Optional Card. Optional card for nonlinear magnetic cases. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LS_ON 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MTYPE 
Monolithic solver type: 
EQ.0: Direct symmetric solver 

================================================================================
PAGE 532
================================================================================

*EM 
*EM_SOLVER_FEMBEM_MONOLITHIC 
6-184 (EM) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
STYPE 
Solver type: 
EQ.0: MINRES iterative solver 
EQ.1: GMRES iterative solver 
ABSTOL 
Absolute tolerance 
RELTOL 
Relative tolerance 
MAXIT 
Maximum number of iterations 
NTSTOL/NTATOL/ 
NTROL 
Solution change tolerance, absolute tolerance, and relative 
tolerance used during the nonlinear Newton step.  These 
tolerances only apply when the EM model includes nonlin-
ear magnetic materials. 
NTMIT 
Maximum nonlinear iterations 
LS_ON 
Line search: 
EQ.0: Oﬀ 
EQ.1: On (only used for nonlinear magnetic materials) 
Remarks: 
The monolithic solver aims to overcome the limitations of the classic Richardson iterative 
coupling between the FEM and BEM systems.  The monolithic solver oﬀers better stability 
for large timesteps and for simulations involving ferromagnetic materials.  We recom-
mend this method whenever the *EM_MAT_002 keyword is present.

================================================================================
PAGE 533
================================================================================

 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-1 (ICFD) 
*ICFD 
 
The keyword *ICFD covers all the diﬀerent options available in the incompressible ﬂuid 
solver.  The keyword cards in this section are deﬁned in alphabetical order: 
*ICFD_BOUNDARY_CONJ_HEAT 
*ICFD_BOUNDARY_CONVECTION_TEMP 
*ICFD_BOUNDARY_FLUX_TEMP 
*ICFD_BOUNDARY_FREESLIP 
*ICFD_BOUNDARY_FSI 
*ICFD_BOUNDARY_FSI_EXCLUDE 
*ICFD_BOUNDARY_FSI_FIXED 
*ICFD_BOUNDARY_FSI_ONEWAY 
*ICFD_BOUNDARY_FSWAVE 
*ICFD_BOUNDARY_GROUND 
*ICFD_BOUNDARY_NAVIERSLIP 
*ICFD_BOUNDARY_NONSLIP 
*ICFD_BOUNDARY_PERIODIC 
*ICFD_BOUNDARY_PRESCRIBED_LEVELSET 
*ICFD_BOUNDARY_PRESCRIBED_MOVEMESH 
*ICFD_BOUNDARY_PRESCRIBED_PRE 
*ICFD_BOUNDARY_PRESCRIBED_SPTRANSP_CONC 
*ICFD_BOUNDARY_PRESCRIBED_TEMP 
*ICFD_BOUNDARY_PRESCRIBED_TURBULENCE 
*ICFD_BOUNDARY_PRESCRIBED_VEL 
*ICFD_BOUNDARY_PRESCRIBED_VISCOELASTIC 
*ICFD_BOUNDARY_WEAKVEL 

================================================================================
PAGE 534
================================================================================

*ICFD 
 
7-2 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_WINDKESSEL 
*ICFD_CONTROL_ADAPT 
*ICFD_CONTROL_ADAPT_SIZE 
*ICFD_CONTROL_ADVECTION 
*ICFD_CONTROL_BACKFLOW 
*ICFD_CONTROL_CONJ 
*ICFD_CONTROL_DEM_COUPLING 
*ICFD_CONTROL_EMBEDSHELL 
*ICFD_CONTROL_FSI 
*ICFD_CONTROL_GAP 
*ICFD_CONTROL_GENERAL 
*ICFD_CONTROL_IMPOSED_MOVE 
*ICFD_CONTROL_LEVELSET 
*ICFD_CONTROL_LOAD 
*ICFD_CONTROL_MESH 
*ICFD_CONTROL_MESH_MOV 
*ICFD_CONTROL_MONOLITHIC 
*ICFD_CONTROL_OUTPUT 
*ICFD_CONTROL_OUTPUT_SUBDOM 
*ICFD_CONTROL_OUTPUT_VAR 
*ICFD_CONTROL_PARTITION 
*ICFD_CONTROL_POROUS 
*ICFD_CONTROL_STEADY 
*ICFD_CONTROL_SURFMESH 
*ICFD_CONTROL_TAVERAGE 
*ICFD_CONTROL_TIME 

================================================================================
PAGE 535
================================================================================

 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-3 (ICFD) 
*ICFD_CONTROL_TRANSIENT 
*ICFD_CONTROL_TURB_SYNTHESIS 
*ICFD_CONTROL_TURBULENCE 
*ICFD_DATABASE_AVERAGE 
*ICFD_DATABASE_DRAG 
*ICFD_DATABASE_FLUX 
*ICFD_DATABASE_FLUXSURF 
*ICFD_DATABASE_FORCE_DEM 
*ICFD_DATABASE_GOA 
*ICFD_DATABASE_HTC 
*ICFD_DATABASE_NODEAVG 
*ICFD_DATABASE_NODOUT 
*ICFD_DATABASE_NTEMPOUT 
*ICFD_DATABASE_POINTAVG 
*ICFD_DATABASE_POINTOUT 
*ICFD_DATABASE_RESIDUALS 
*ICFD_DATABASE_SSOUT 
*ICFD_DATABASE_SSOUT_EXCLUDE 
*ICFD_DATABASE_TEMP 
*ICFD_DATABASE_TIMESTEP 
*ICFD_DATABASE_TPD 
*ICFD_DATABASE_TWINBUILDER 
*ICFD_DATABASE_UINDEX 
*ICFD_DATABASE_WETNESS 
*ICFD_DEFINE_HEATSOURCE 
*ICFD_DEFINE_NONINERTIAL 

================================================================================
PAGE 536
================================================================================

*ICFD 
 
7-4 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DEFINE_POINT 
*ICFD_DEFINE_POROUS_REGION 
*ICFD_DEFINE_RESIDENCETIMESOURCE 
*ICFD_DEFINE_SOURCE 
*ICFD_DEFINE_SPTRANSPSOURCE 
*ICFD_DEFINE_TRANSFORM 
*ICFD_DEFINE_TURBSOURCE 
*ICFD_DEFINE_WAVE_DAMPING 
*ICFD_INITIAL 
*ICFD_INITIAL_LEVELSET 
*ICFD_INITIAL_SPTRANSP 
*ICFD_INITIAL_TEMPNODE 
*ICFD_INITIAL_TURBULENCE 
*ICFD_MAT 
*ICFD_MODEL_NONNEWT 
*ICFD_MODEL_POROUS 
*ICFD_MODEL_SPECIES_TRANSPORT 
*ICFD_MODEL_VISCOELASTIC 
*ICFD_PART 
*ICFD_PART_VOL 
*ICFD_SECTION 
*ICFD_SET_NODE 
*ICFD_SOLVER_SPLIT 
*ICFD_SOLVER_TOL_FSI 
*ICFD_SOLVER_TOL_LSET 
*ICFD_SOLVER_TOL_MMOV 

================================================================================
PAGE 537
================================================================================

 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-5 (ICFD) 
*ICFD_SOLVER_TOL_MOM 
*ICFD_SOLVER_TOL_MONOLITHIC 
*ICFD_SOLVER_TOL_PRE 
*ICFD_SOLVER_TOL_TEMP

================================================================================
PAGE 538
================================================================================

*ICFD 
*ICFD_BOUNDARY_CONJ_HEAT 
7-6 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_CONJ_HEAT 
Purpose:  Specify which boundary of the ﬂuid domain will exchange heat with the solid. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
CTYPE 
VAL 
SFLCID 
 
 
 
 
Type 
I 
I 
F 
I 
 
 
 
 
Default 
none 
0 
0. 
0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID of the ﬂuid surface in contact with the solid 
CTYPE 
Contact type: 
EQ.0: Constraint approach 
EQ.1: Mortar contact 
VAL 
Optional temperature drop if CTYPE = 0 or interface heat transfer 
coeﬃcient if CTYPE = 1 (high value by default to ensure perfect 
contact). 
SFLCID 
Load curve ID used to describe scale factor on VAL value as a func-
tion of time; see *DEFINE_CURVE, *DEFINE_CURVE_FUNC-
TION, or *DEFINE_FUNCTION.  If a *DEFINE_FUNCTION is 
used, the following parameters are allowed: f(x, y, z, vx, vy, vz, 
temp, pres, time).   

================================================================================
PAGE 539
================================================================================

*ICFD_BOUNDARY_CONVECTION_TEMP 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-7 (ICFD) 
*ICFD_BOUNDARY_CONVECTION_TEMP 
Purpose:  Impose a heat transfer coeﬃcient on the boundary expressed as ℎ=
푞
푇푠−푇푏 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
HLCID 
HSF 
TBLCID 
TBSF 
 
 
 
Type 
I 
I 
F 
I 
F 
 
 
 
Default 
none 
none 
1. 
none 
1.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID for a ﬂuid surface. 
HLCID 
Load curve ID to describe the heat transfer coeﬃcient value versus 
time, see *DEFINE_CURVE,*DEFINE_CURVE_FUNCTION or 
*DEFINE_FUNCTION. If a DEFINE_FUNCTION is used, the fol-
lowing parameters are allowed: 푓(푥, 푦, 푧, 푣푥, 푣푦, 푣푧, 푡푒푚푝, 푝푟푒푠, 푡푖푚푒). 
HSF 
Load curve scale factor applied on the heat transfer coeﬃcient 
value.  (default = 1.0) 
TBLCID 
Load curve ID to describe the environment (i.e bulk) temperature 
value versus time, see *DEFINE_CURVE,*DEFINE_CURVE_-
FUNCTION or *DEFINE_FUNCTION. If a DEFINE_FUNCTION 
is 
used, 
the 
following 
parameters 
are 
allowed: 
푓(푥, 푦, 푧, 푣푥, 푣푦, 푣푧, 푡푒푚푝, 푝푟푒푠, 푡푖푚푒).   
TBSF 
Load curve scale factor applied on the environment value.  (de-
fault = 1.0) 

================================================================================
PAGE 540
================================================================================

*ICFD 
*ICFD_BOUNDARY_FLUX_TEMP 
7-8 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_FLUX_TEMP 
Purpose:  Impose a heat ﬂux on the boundary expressed as 푞= −푘∇푇 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
LCID 
SF 
DEATH 
BIRTH 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
1. 
1.E+28
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID for a ﬂuid surface. 
LCID 
Load curve ID to describe the temperature ﬂux value versus time, 
see *DEFINE_CURVE, *DEFINE_CURVE_FUNCTION or *DE-
FINE_FUNCTION. . If a DEFINE_FUNCTION is used, the follow-
ing parameters are allowed: 푓(푥, 푦, 푧, 푣푥, 푣푦, 푣푧, 푡푒푚푝, 푝푟푒푠, 푡푖푚푒).   
SF 
Load curve scale factor.  (default = 1.0) 
DEATH 
Time at which the imposed motion/constraint is removed: 
EQ.0.0: default set to 10e28 
BIRTH 
Time at which the imposed pressure is activated starting from the 
initial abscissa value of the curve 

================================================================================
PAGE 541
================================================================================

*ICFD_BOUNDARY_FREESLIP 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-9 (ICFD) 
*ICFD_BOUNDARY_FREESLIP 
Purpose:  Specify the ﬂuid boundary with free-slip boundary condition. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the ﬂuid surface where a free-slip boundary condition is 
applied 

================================================================================
PAGE 542
================================================================================

*ICFD 
*ICFD_BOUNDARY_FSI 
7-10 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_FSI 
Purpose:  Deﬁnes which ﬂuid surfaces will be considered in contact with the solid sur-
faces for ﬂuid-structure interaction (FSI) analysis.  This keyword should not be deﬁned if 
*ICFD_CONTROL_FSI is not deﬁned. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the ﬂuid surface in contact with the solid domain 

================================================================================
PAGE 543
================================================================================

*ICFD_BOUNDARY_FSI_EXCLUDE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-11 (ICFD) 
*ICFD_BOUNDARY_FSI_EXCLUDE 
Purpose:  Specify which solid part IDs are excluded from the FSI search.  No forces com-
ing from the ﬂuid will be transmitted to those parts. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of a part from the solid mechanics problem that is to be 
excluded from the FSI analysis 

================================================================================
PAGE 544
================================================================================

*ICFD 
*ICFD_BOUNDARY_FSI_FIXED 
7-12 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_FSI_FIXED 
Purpose:  Deﬁne ﬁxed ﬂuid surfaces that will be considered for contact with the solid 
surfaces for FSI. This keyword is similar to *ICFD_BOUNDARY_FSI, except the ﬂuid sur-
face cannot move.  This restriction allows a solid surface to “slide” over the ﬂuid and for 
the exchange of data, such as temperature in CHT applications.  This keyword should 
not be deﬁned if *ICFD_CONTROL_FSI is not deﬁned. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the ﬂuid surface that can be considered for contact with 
the solid domain 

================================================================================
PAGE 545
================================================================================

*ICFD_BOUNDARY_FSI_ONEWAY 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-13 (ICFD) 
*ICFD_BOUNDARY_FSI_ONEWAY 
Purpose:  Specify which solid part IDs experience one-way FSI coupling.  These part IDs 
follow the structural motion to capture the structural deformation. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
IOWC 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
1 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of a part from the solid mechanics problem for which only 
one-way FSI coupling occurs  
IOWC 
Indicates the coupling direction to the solver: 
EQ.1: The solid mechanics solver transfers displacements to the 
ﬂuid solver. 
EQ.2: The ﬂuid solver transfers stresses to the solid mechanics 
solver. 

================================================================================
PAGE 546
================================================================================

*ICFD 
*ICFD_BOUNDARY_FSWAVE 
7-14 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_FSWAVE 
Purpose:  Impose a wave inﬂow boundary condition. 
Card Summary: 
Card Sets. Include as many sets of the following cards as needed.  This input ends with 
the next keyword (“*”) card. 
Card 1.  This card is required. 
PID 
WTYPE 
H0 
WAMP 
WLENG 
WMAX 
SFLCID 
WANG 
Card 2.  This card is included if WTYPE = 7. 
WPEAK 
 
 
 
 
 
 
 
Data Card Deﬁnitions: 
Include as many of this card and/or sets of this card with the next as needed.  This input 
ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
WTYPE 
H0 
WAMP 
WLENG 
WMAX 
SFLCID 
WANG 
Type 
I 
I 
F 
F 
F 
F 
I 
F 
Default 
none 
none 
none 
none 
none 
none 
↓ 
none 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID for a ﬂuid surface 
WTYPE 
Wave type: 
EQ.1: Stokes wave of ﬁrst order 
EQ.2: Stokes wave of second order 
EQ.3: Stokes wave of ﬁfth order 
EQ.4: Solitary wave 
EQ.5: Irregular waves using JONSWAP spectrum 

================================================================================
PAGE 547
================================================================================

*ICFD_BOUNDARY_FSWAVE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-15 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
EQ.6: Irregular waves using One Parameter Pierson-Moskowitz 
spectrum 
EQ.7: Irregular waves using Two Parameter Pierson-Moskowitz 
spectrum 
H0 
Water level (from the bottom of the channel) for the unperturbed 
condition 
WAMP 
Wave amplitude or height for WTYPE = 1 and 4. Signiﬁcant wave 
height for WTYPE = 5, 6, and 7. 
WLENG 
WTYPE.LE.2: Wave length 
WTYPE.EQ.3: Wave period 
WTYPE.EQ.4: Not used 
WTYPE.GE.5: Minimum wave frequency in spectrum (rad/sec)
WMAX 
Maximum wave frequency in spectrum (rad/sec) for WTYPE = 5, 
6, and 7. Angle between the boundary and the incident waves (in 
degrees) for WTYPE = 3. 
SFLCID 
Scale factor LCID on the wave amplitude for WTYPE = 1, 2 and 3. 
Number of wave modes (default = 1024) for WTYPE = 5, 6, and 7.
WANG 
Angle between incoming wave direction and 푥-axis for 푧- and 푦-
aligned gravity vector, or angle between incoming wave direction 
and 푦-axis for 푥-aligned gravity vector. 
 
Card included for WTYPE = 7 only 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
WPEAK 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
WPEAK 
Peak wave frequency in spectrum [rad/sec] for WTYPE = 7.  

================================================================================
PAGE 548
================================================================================

*ICFD 
*ICFD_BOUNDARY_FSWAVE 
7-16 (ICFD) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
1. 
Peak Wave Frequency for WTYPE = 6.  For the irregular waves using the One 
Parameter Pierson-Moskowitz spectrum, the peak wave frequency in the spec-
trum LS-DYNA calculates the peak wave frequency with: 
0.4√푔
퐻푠
 
Here 푔 the gravity and 퐻푠 is the signiﬁcant wave height input with WAMP.

================================================================================
PAGE 549
================================================================================

*ICFD_BOUNDARY_GROUND 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-17 (ICFD) 
*ICFD_BOUNDARY_GROUND 
Purpose:  Specify the ﬂuid boundary with a ground boundary condition.  The ground 
boundary condition is similar to the nonslip boundary condition except that it will keep 
V = 0 in all circumstances, even if the surface nodes are moving.  This is useful in cases 
where the nodes are allowed to move or translate (using ICFD_BOUNDARY_PRE-
SCRIBED_MOVEMESH for example) but those displacements are only to accommodate 
for mesh movement and do not correspond to a physical motion.   
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
VARIABLE
DESCRIPTION
PID 
PID of the ﬂuid surface where a ground boundary condition is ap-
plied. 

================================================================================
PAGE 550
================================================================================

*ICFD 
*ICFD_BOUNDARY_NAVIERSLIP 
7-18 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_NAVIERSLIP 
Purpose:  Specify the ﬂuid boundary with the Navier slip boundary condition. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
FRIC 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
0. 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID of the ﬂuid surface where a Navier boundary condition is ap-
plied 
FRIC 
Friction coeﬃcient.  If a negative value is entered, it will refer to a
load curve ID used to describe the friction coeﬃcient value as a 
function of time; see *DEFINE_CURVE, *DEFINE_CURVE_-
FUNCTION, or *DEFINE_FUNCTION.  If a *DEFINE_FUNC-
TION is used, the following parameters are allowed: f(x, y, z, vx, 
vy, vz, temp, pres, time).   
Remarks: 
1. 
About the Navier condition.  It is similar to the regular free slip condition, ex-
cept a local source term is added based on the choice of the friction coeﬃcient.  
Since this extra shear is a function of the ﬂuid’s velocity, a smaller time step may 
be needed to reduce the eﬀects of the introduced nonlinearity.

================================================================================
PAGE 551
================================================================================

*ICFD_BOUNDARY_NONSLIP 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-19 (ICFD) 
*ICFD_BOUNDARY_NONSLIP 
Purpose:  Specify the ﬂuid boundary with a non-slip boundary condition. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
VARIABLE
DESCRIPTION
PID 
PID of the ﬂuid surface where a non-slip boundary condition is ap-
plied. 

================================================================================
PAGE 552
================================================================================

*ICFD 
*ICFD_BOUNDARY_PERIODIC 
7-20 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_PERIODIC 
Purpose:  Impose various kinds of constraints between two ﬂuid surfaces. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
PTYPE 
PID2 
PDLCID 
AXE 
PTID 
ANGLE 
 
Type 
I 
I 
I 
I 
I 
I 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID for a ﬂuid surface 
PTYPE 
Boundary type: 
EQ.1: Periodic rotation boundary condition 
EQ.2: Periodic reﬂective boundary condition 
EQ.3: Sliding mesh boundary condition 
PID2 
Part ID for the second surface mesh.  The boundary condition se-
lected with PTYPE will be applied between PID and PID2. See Re-
mark 1. 
PDLCID 
Optional load curve ID to describe the pressure drop value be-
tween PID and PID2 as a function of time.  This curve can be 
speciﬁed with *DEFINE_CURVE,*DEFINE_CURVE_FUNCTION, 
or *DEFINE_FUNCTION. For *DEFINE_FUNCTION, the follow-
ing parameters are allowed: f(x,y,z,vx,vy,temp,pres,time). 
AXE 
The meaning of AXE depends on PTYPE. It only applies for 
PTYPE = 1 and 3. For the periodic rotation boundary condition
(PTYPE = 1): 
EQ.1: Rotation around 푋-axis 
EQ.2: Rotation around 푌-axis 
EQ.3: Rotation around 푍-axis 
For the sliding mesh boundary condition (PTYPE = 3):  
EQ.0: The contact distance between two faces of PID and PID2
is based on the characteristic local element size.  

================================================================================
PAGE 553
================================================================================

*ICFD_BOUNDARY_PERIODIC 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-21 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
EQ.1: The contact distance between two faces of PID and PID2
is based on the characteristic local element size scaled by 
a factor given by ANGLE.  
EQ.2: The contact distance between two faces of PID and PID2
is based on the length given by ANGLE. 
PTID 
Origin point ID for PTYPE = 1 and PTYPE = 2. See *ICFD_DE-
FINE_POINT. 
ANGLE 
Rotation angle for PTYPE = 1. Characterizes contact distance for 
PTYPE = 3 and AXE ≠ 0. 
Remarks: 
1. 
Selection of PID and PID2.  When the two meshes are of diﬀerent densities, we 
recommend selecting the ﬁner mesh to be PID and the coarser mesh to be PID2.

================================================================================
PAGE 554
================================================================================

*ICFD 
*ICFD_BOUNDARY_PRESCRIBED_LEVELSET 
7-22 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_PRESCRIBED_LEVELSET 
Purpose:  Prescribe the ﬂuid height on a boundary. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
PTID 
AXE 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID of the ﬂuid surface where a ﬂuid height will be imposed. 
PTID 
Point ID specifying the origin of the ﬂuid surface.  See *ICFD_DE-
FINE_POINT. 
AXE 
Global axis specifying the direction of the ﬂuid: 
EQ.1: 푋-axis 
EQ.2: 푌-axis 
EQ.3: 푍-axis 

================================================================================
PAGE 555
================================================================================

*ICFD_BOUNDARY_PRESCRIBED_MOVEMESH 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-23 (ICFD) 
*ICFD_BOUNDARY_PRESCRIBED_MOVEMESH_{OPTION1} 
Available options for OPTION1 include: 
DR 
Purpose:  Allows the ﬂuid surface nodes to translate in speciﬁc directions using an ALE 
approach.  This feature is helpful in piston-type applications or for avoiding large mesh 
deformation in certain cases. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card.  If the 
DR keyword option is active, then only one occurrence of card 1 is allowed. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
DOFX 
DOFY 
DOFDZ 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
1 
1 
1 
 
 
 
 
 
Include this card for the DR keyword option.  When the dynamic relaxation phase 
includes the ICFD solver, this second line allows the application of diﬀerent parameters 
during that phase.  See IDR of *ICFD_CONTROL_GENERAL. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
 
DRDOFX 
DRDOFY 
DRDOFZ 
 
 
 
 
Type 
 
I 
I 
I 
 
 
 
 
Default 
 
1 
1 
1 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID for a ﬂuid surface 
DOFX/DOFY/DOFZ 
Degrees of freedom in the 푋, 푌, and 푍 directions: 
EQ.0: Degree of freedom left free (surface nodes can 
translate in the chosen direction) 
EQ.1: Prescribed degree of freedom (surface nodes are 
restrained)  

================================================================================
PAGE 556
================================================================================

*ICFD 
*ICFD_BOUNDARY_PRESCRIBED_MOVEMESH 
7-24 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
DRDOFX/DRDOFY/ 
DRDOFZ 
Same as DOFX, DOFY, and DOFZ but applies to the mesh 
displacement during the dynamic relaxation phase. 

================================================================================
PAGE 557
================================================================================

*ICFD_BOUNDARY_PRESCRIBED_PRE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-25 (ICFD) 
*ICFD_BOUNDARY_PRESCRIBED_PRE 
Purpose:  Impose a ﬂuid pressure on the boundary. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
LCID 
SF 
DEATH 
BIRTH 
ISO 
 
 
Type 
I 
I 
F 
F 
F 
I 
 
 
Default 
none 
none 
1. 
1.E+28
0.0 
0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID for a ﬂuid surface 
LCID 
Load curve ID to describe the pressure value as a function of time. 
See *DEFINE_CURVE, *DEFINE_CURVE_FUNCTION, or *DE-
FINE_FUNCTION. If using a *DEFINE_FUNCTION, the following 
parameters are allowed: f(x, y, z, vx, vy, vz, temp, pres, time).    
SF 
Load curve scale factor.  The default is 1.0. 
DEATH 
Time at which the imposed motion/constraint is removed: 
EQ.0.0: Default set to 1028 
BIRTH 
Time at which the imposed pressure is activated starting from the 
initial abscissa value of the curve 
ISO 
Adds an additional isovelocity condition to the system on top of
the user-deﬁned imposed pressure (see Remark 1): 
EQ.0: Oﬀ 
EQ.1: On 
Remarks: 
1. 
Adding an isovelocity condition.  Flow instability is a well known numerical 
issue that can occur with imposed pressure conditions, particularly in complex 
FSI cases or when the global ﬂow changes direction during the transient run 
(inlet transitions into outlet and vice versa).  Using ISO = 1 adds an isovelocity 

================================================================================
PAGE 558
================================================================================

*ICFD 
*ICFD_BOUNDARY_PRESCRIBED_PRE 
7-26 (ICFD) 
R16@bdccd6d07 (03/10/25) 
condition which makes the velocity uniform across that surface.  The objective 
is an attempt to provide an elegant form of constraining the ﬂow and preventing 
numerical issues in cases where this hypothesis can be considered physically 
valid.  This feature imposes an additional numerical cost.

================================================================================
PAGE 559
================================================================================

*ICFD_BOUNDARY_PRESCRIBED_SPTRANSP_CONC 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-27 (ICFD) 
*ICFD_BOUNDARY_PRESCRIBED_SPTRANSP_CONC 
Purpose:  Specify the concentration of the transported species at the boundaries. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
LCID1 
CONC1 
LCID2 
CONC2 
 
 
 
Type 
I 
I 
F 
I 
F 
 
 
 
Default 
none 
none 
0.0 
none 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the boundary with the concentration 
LCIDi 
Load curve ID for the curve giving the concentration of species i at 
the boundary as a function of time.  Note that all the transported
species must have a load curve deﬁned.  
CONCi 
Constant concentration at the boundary for species i. If nonzero, 
LCIDi is ignored. 

================================================================================
PAGE 560
================================================================================

*ICFD 
*ICFD_BOUNDARY_PRESCRIBED_TEMP 
7-28 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_PRESCRIBED_TEMP 
Purpose:  Impose a ﬂuid temperature on the boundary. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
LCID 
SF 
DEATH 
BIRTH 
 
 
 
Type 
I 
I 
F 
F 
F 
 
 
 
Default 
none 
none 
1. 
1.E+28
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID for a ﬂuid surface. 
LCID 
Load curve ID to describe the temperature value versus time; see 
*DEFINE_CURVE, *DEFINE_CURVE_FUNCTION or *DEFINE_-
FUNCTION. . If a DEFINE_FUNCTION is used, the following pa-
rameters are allowed: 푓(푥, 푦, 푧, 푣푥, 푣푦, 푣푧, 푡푒푚푝, 푝푟푒푠, 푡푖푚푒).   
SF 
Load curve scale factor.  (default = 1.0) 
DEATH 
Time at which the imposed temperature is removed: 
EQ.0.0: default set to 10E28 
BIRTH 
Time at which the imposed temperature is activated starting from 
the initial abscissa value of the curve 

================================================================================
PAGE 561
================================================================================

*ICFD_BOUNDARY_PRESCRIBED_TURBULENCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-29 (ICFD) 
*ICFD_BOUNDARY_PRESCRIBED_TURBULENCE 
Purpose:  Optional keyword for strongly imposing turbulence quantities when you select 
a RANS turbulence model.  See *ICFD_CONTROL_TURBULENCE. This keyword is in-
tended for modifying the default boundary conditions at the inlet. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
VTYPE 
IMP 
LCID 
KS 
CS 
 
 
Type 
I 
I 
I 
I 
F 
F 
 
 
Default 
none 
none 
0 
none 
0. 
0. 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID for a ﬂuid surface 
VTYPE 
Variable type: 
EQ.1: Turbulence kinetic energy (see Remark 1) 
EQ.2: Turbulence dissipation rate (see Remark 2) 
EQ.3: Speciﬁc dissipation rate (see Remark 3) 
EQ.4: Modiﬁed turbulence viscosity (see Remark 4) 
IMP 
Imposition method: 
EQ.0: Direct imposition through value speciﬁed by LCID 
EQ.1: Using turbulence intensity speciﬁed by LCID if 
VTYPE = 1 (see Remark 1). Using turbulence length scale 
speciﬁed by LCID if VTYPE = 2, 3, or 4 (see Remarks 2, 3, 
and 4).  
EQ.2: Using turbulence viscosity ratio speciﬁed by LCID. Only 
available for VTYPE = 2 and 3.  See Remarks 2 and 3. 
LCID 
Load curve ID to describe the variable value as a function of time; 
see *DEFINE_CURVE, *DEFINE_CURVE_FUNCTION or *DE-
FINE_FUNCTION. If a *DEFINE_FUNCTION is used, the follow-
ing parameters are allowed: f(x, y, z, vx, vy, vz, temp, pres, time, k, 
e, mut).   

================================================================================
PAGE 562
================================================================================

*ICFD 
*ICFD_BOUNDARY_PRESCRIBED_TURBULENCE 
7-30 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
KS/CS 
Roughness physical height and roughness constant.  When de-
ﬁned, the global values of *ICFD_CONTROL_TURBULENCE are 
replaced for this surface part. 
Remarks: 
1. 
Turbulence Kinetic Energy. At the inlet, the relationship between the turbu-
lence kinetic energy, 푘, and the turbulence intensity, 퐼, is given by: 
푘= 3
2 (푈avg
2 퐼2)  . 
By default, the solver uses an inlet intensity of 0.05 (5%). 
2. 
Turbulence Dissipation Rate. At the inlet, if you specify the turbulent dissipa-
tion rate using a length scale, 푙, the following relationship will be used: 
휖= 퐶휇
3/4 푘3/2
푙  . 
By default, the solver estimates a length scale based on the total height of the 
channel.  
 
If you specify the turbulent viscosity ratio, 푟= 휇푡휇
⁄ , the following relationship 
will be used: 
휖= 휌퐶휇
푘2
휇 푟  . 
3. 
Speciﬁc Dissipation Rate. At the inlet, if you specify the speciﬁc dissipation 
rate using a length scale, 푙, the following relationship will be used: 
휔= 퐶휇
−1/4 푘1/2
푙  . 
By default, the solver estimates a length scale based on the total height of the 
channel.  
 
If you specify the turbulence viscosity ratio, 푟= 휇푡휇
⁄ , the following relationship 
will be used: 
휔= 휌푘
휇 푟  . 

================================================================================
PAGE 563
================================================================================

*ICFD_BOUNDARY_PRESCRIBED_TURBULENCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-31 (ICFD) 
4. 
Modiﬁed Turbulent Viscosity.  At the inlet, the relationship between the mod-
iﬁed turbulent viscosity, 휈̃, and the length scale, 푙, is given by: 
휈̃ = 0.05√3
2 (푈avg 푙)  .

================================================================================
PAGE 564
================================================================================

*ICFD 
*ICFD_BOUNDARY_PRESCRIBED_VEL 
7-32 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_PRESCRIBED_VEL 
Purpose:  Impose the ﬂuid velocity on the boundary. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
DOF 
VAD 
LCID 
SF 
VID 
DEATH 
BIRTH 
Type 
I 
I 
I 
I 
F 
I 
F 
F 
Default 
none 
none 
1 
none 
1. 
0 
1028 
0.0 
 
 VARIABLE  
 
DESCRIPTION 
PID 
PID for a ﬂuid surface. 
DOF 
Applicable degrees of freedom: 
EQ.1: 푥- degree of freedom 
EQ.2: 푦- degree of freedom 
EQ.3: 푧 degree of freedom 
EQ.4: Normal direction degree of freedom 
VAD 
Velocity ﬂag: 
EQ.1: Linear velocity 
EQ.2: Angular velocity 
EQ.3: Parabolic velocity proﬁle 
EQ.4: Activates synthetic turbulent ﬁeld on part.  See *ICFD_-
CONTROL_TURB_SYNTHESIS. 
LCID 
Load curve ID used to describe motion value versus time, see *DE-
FINE_CURVE, *DEFINE_CURVE_FUNCTION, or *DEFINE_-
FUNCTION.  If a DEFINE_FUNCTION is used, the following 
parameters are allowed: f(x, y, z, vx, vy, vz, temp, pres, time). For 
steady state the motion value is a function of the number of itera-
tions instead of time.  
SF 
Load curve scale factor.  (default = 1.0) 

================================================================================
PAGE 565
================================================================================

*ICFD_BOUNDARY_PRESCRIBED_VEL 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-33 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
VID 
Point ID for angular velocity application point, see *ICFD_DE-
FINE_POINT. 
DEATH 
Time at which the imposed motion/constraint is removed: 
EQ.0.0: default set to 1028 
BIRTH 
Time at which the imposed motion/constraint is activated starting 
from the initial abscissa value of the curve 

================================================================================
PAGE 566
================================================================================

*ICFD 
*ICFD_BOUNDARY_PRESCRIBED_VISCOELASTIC 
7-34 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_PRESCRIBED_VISCOELASTIC 
Purpose:  Specify the conformation tensor at the boundaries. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
LCIDXX 
LCIDYY 
LCIDZZ 
LCIDXY 
LCIDXZ 
LCIDYZ 
 
Type 
I 
I 
I 
I 
I 
I 
I 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the boundary with the prescribed conformation tensor 
LCIDij 
Load curve IDs for the conformation tensor components 

================================================================================
PAGE 567
================================================================================

*ICFD_BOUNDARY_WEAKVEL 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-35 (ICFD) 
*ICFD_BOUNDARY_WEAKVEL 
Purpose:  Specify the ﬂuid boundary with a non-slip boundary condition which is im-
posed in a weak form. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the ﬂuid surface where a weak non-slip boundary con-
dition is applied 

================================================================================
PAGE 568
================================================================================

*ICFD 
*ICFD_BOUNDARY_WINDKESSEL 
7-36 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_BOUNDARY_WINDKESSEL 
Purpose:  Impose the pressure function with circuit parameters where an analogy is made 
between pressure and scalar potential and between ﬂow rate and current intensity.  Such 
conditions are frequently encountered in hemodynamics.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
WTYPE 
R1 
C1 
R2 
L1/ 
QPLCID 
 
 
Type 
I 
I 
F 
F 
F 
F 
 
 
Default 
none 
none 
0. 
0. 
0. 
0. 
 
 
 
Optional Card.  This card deﬁnes additional parameters for the Windkessel circuits 
depending on WTYPE. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
P2LCID 
C2 
R3 
P0 
P1 
 
 
 
Type 
I 
F 
F 
F 
F 
 
 
 
Default 
0 
0. 
0. 
0. 
0. 
 
 
 
 
 VARIABLE  
 
DESCRIPTION
PID 
PID for a ﬂuid surface 
WTYPE 
Circuit type.  See remarks and ﬁgures.  
R1/C1/L1/R
2/C2/R3 
Parameters (resistances, inductances, capacities) for the diﬀerent
circuits.  See remarks and ﬁgures. 
P2LCID 
ID of load curve describing the behavior of 푃2(푡) as a function of
time when applicable.  See Remarks 2, 3, and 4 and Figures 7-2,
7-3, and 7-4. 
QPLCID 
ID of load curve describing the behavior of 푄푝(푡) as a function of
time when applicable.  See Remark 4 and Figure 7-4. 

================================================================================
PAGE 569
================================================================================

*ICFD_BOUNDARY_WINDKESSEL 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-37 (ICFD) 
 VARIABLE  
 
DESCRIPTION
P0/P1 
Initial pressures at circuit junctions when applicable.  See remarks
and ﬁgures. 
Remarks: 
1. 
WTYPE = 1 and 2.  See Figure 7-1 for a diagram of the circuit.  The equation 
solved at the boundary is: 
푃(푡) = 푃0(푡) + SF × 푄× 푅2
푃0
′ (푡) = −1.0
푅1퐶1
푃0(푡) + SF × [퐿1푄′′ + 푄
퐶1
+
퐿1
푅1퐶1
푄′] 
with 푄, the ﬂow rate calculated by the solve, and 푃, the pressure.  Time deriva-
tives are marked using Lagrange notation.  By convention, the ﬂow rate has a 
negative value if the ﬂuid goes out of the ﬂuid domain (outlet) and a positive 
value if it goes in (inlet).  The scale factor, SF, applied on the circuit equation’s 
ﬂow-rate-dependent terms enables recovering the desired behavior of the Wind-
kessel circuit.  SF = -1.0 for WTYPE = 1, and SF = 1.0 for WTYPE = 2. 
For WTYPE = 1 and 2, 1, 2 and 퐿1 are optional and can be left as 0. 
 
 
2. 
WTYPE = 3 and 4.  See Figure 7-2 for a diagram of the circuit.  The equation 
solved at the boundary is: 
푃(푡) = 푃0(푡) + SF × 푄× 푅1
푃0
′ (푡) = −1.0
푅2퐶1
푃0(푡) + 1.0
푅2퐶1
푃1(푡) + SF × 푄
퐶1
푃1
′ (푡) = 1.0
푅2퐶2
푃0(푡) −푅3 + 푅2
푅3푅2퐶2
푃1(푡) + 푃2
′ (푡)
 
R1
R2
P(t)
P0(t)
P1(t)
C1
L1
Meshed 
Part
 
Figure 7-1.  WTYPE = 1 and 2 circuit  

================================================================================
PAGE 570
================================================================================

*ICFD 
*ICFD_BOUNDARY_WINDKESSEL 
7-38 (ICFD) 
R16@bdccd6d07 (03/10/25) 
with 푄 and SF as described in Remark 1. SF = -1.0 for WTYPE = 3, and SF = 1.0 
for WTYPE = 4. 푅1 and 푅3 are optional for this type of circuit.  If 푅3 is set to 0., 
that branch of the circuit is removed (open circuit).  A negative value can be 
entered for 푅3 which points to a *DEFINE_FUNCTION. The function accepts the 
following parameters: f(time, dt, ﬂux , pre). In the function, ﬂux is the current 
ﬂow rate, 푄, and pre is the current pressure, 푃(푡). With this method, 푅3can be 
set to a speciﬁc value or left as 0.0 based on the sign of ﬂux, thus modeling diode 
behavior. 
 
 
3. 
WTYPE = 7 and 8.  See Figure 7-3 for a diagram of the circuit.  The equation 
solved at the boundary is: 
푃(푡) = 푃0(푡) + SF × 푄× 푅1
푃0
′ (푡) = −1.0
푅2퐶1
푃0(푡) + SF × 푄
퐶1
+ 1.0
푅2퐶1
푃2(푡) 
with 푄 and SF as described in Remark 1. SF = -1.0 for WTYPE = 7, and SF = 1.0 
for WTYPE = 8. For this type of circuit, 푅1, 푅2 , and 2() are optional. 
 
 
R1
C1
R2
C2
R3
Meshed
Part
P2(t)
P(t)
P0(t)
P1(t)
 
Figure 7-2.  WTYPE = 3 and 4 circuit 
R1
C1
R2
P2(t)
P(t)
P0(t)
Meshed 
Part
 
Figure 7-3.  WTYPE = 7 and 8 circuit 

================================================================================
PAGE 571
================================================================================

*ICFD_BOUNDARY_WINDKESSEL 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-39 (ICFD) 
4. 
WTYPE = 9 and 10.  See Figure 7-4 for a diagram of the circuit.  The equation 
solved at the boundary is: 
푃(푡) =
푅3
푅2 + 푅3
푃0(푡) + SF × 푄×
푅3푅2
푅2 + 푅3
+
푅2
푅2 + 푅3
푃2(푡)
푃0
′ (푡) = −푅1 + 푅2 + 푅3
(푅2 + 푅3)푅1퐶2
푃0(푡) + 1.0
푅1퐶2
푃1(푡) +
푅3
(푅2 + 푅3) SF × 푄
퐶2
−푃2(푡)
퐶2
×
1.0
푅2 + 푅3
푃1
′ (푡) = 1.0
푅1퐶1
푃0(푡) −1.0
푅1퐶1
푃1(푡) +
푄푝(푡)
퐶1
 
with 푄 and SF as described in Remark 1. SF = -1.0 for WTYPE = 9, and SF = 1.0 
for WTYPE = 10. For this type of circuit, 푅2, 푃2(푡), 푄푝(푡), and 푅3 are optional.  If 
푅3 is set to 0.0, that branch of the circuit is removed (open circuit).  A negative 
value can be entered for 푅3 which points to a *DEFINE_FUNCTION. The func-
tion accepts the following parameters: f(time, dt, ﬂux , pre). In the function, ﬂux 
is the current ﬂow rate, 푄, and pre is the current pressure, 푃(푡). With this 
method, 푅3can be set to a speciﬁc value or left as 0.0 based on the sign of ﬂux, 
thus modeling diode behavior. 
 
 
5. 
WTYPE = 6.  WTYPE = 6 enables implementing user-deﬁned circuit laws by 
compiling the usermat versions of LS-DYNA. The routine that can be modiﬁed 
is called icfd_usercircuit and can be found in dyn21icfd.f.
R3
R2
C2
P(t)
P2(t)
QP(t)
P0(t)
Meshed 
Part
C1
R1
P1(t)
 
Figure 7-4.  WTYPE = 9 and 10 circuit 

================================================================================
PAGE 572
================================================================================

*ICFD 
*ICFD_CONTROL_ADAPT 
7-40 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_ADAPT 
Purpose:  Activate the adaptive mesh reﬁnement feature.  The solver uses an a-posteriori 
error estimator to compute a new mesh size bounded by the user to satisfy a maximum 
perceptual global error. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MINH 
MAXH 
ERR 
MTH 
NIT 
VAR 
 
KIS 
Type 
F 
F 
F 
I 
I 
I 
 
I 
Default 
none 
none 
1. 
1 
0 
0 
 
0 
 
Optional Card.   
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
0.0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MINH 
Minimum mesh size allowed to the mesh generator.  The resulting 
mesh will not have an element smaller than MINH even if the min-
imum size does not satisfy the maximum error. 
MAXH 
Maximum mesh size 
ERR 
Maximum perceptual error allowed in the whole domain 
MTH 
Specify if the mesh size is computed based on function error or gra-
dient error: 
EQ.1: Function error (default) 
EQ.2: Gradient error 
EQ.3: Relative error 
EQ.4: Gradient relative error 

================================================================================
PAGE 573
================================================================================

*ICFD_CONTROL_ADAPT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-41 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
NIT 
Number of iterations before a remeshing is forced: 
LT.0: |NIT| is a load curve ID giving the number of iterations 
before a remeshing as a function of time. 
EQ.0: Do not remesh. 
GT.0: Number of iterations before a forced remeshing. 
VAR 
Specify which variable is taken into account for the error calcula-
tion: 
LT.0: Adaptive meshing is based only on the level-set function. 
Elements of size MINH are targeted over a length |VAR|
on each side of the interface. 
EQ.0: Velocity, pressure, and level-set function are taken into ac-
count. 
EQ.1: Remove the level-set function from the error calculation.
EQ.2: Remove the pressure from the error calculation. 
EQ.3: Remove both the pressure and the level-set function from 
the error calculation.  Only the ﬂuid velocity will, there-
fore, remain. 
EQ.5: For immersed interface methods, adapt the mesh only at 
the interface of the immersed surfaces. 
KIS 
Keep initial mesh size: 
EQ.0: Turned oﬀ.  The remeshing process will ignore the initial 
mesh size in the volume.  
EQ.1: Turned on.  Whenever a remeshing occurs, the new local
mesh size will not be allowed to be substantially coarser 
than the one from the previous mesh.  The object is to di-
minish the excessive coarsening that can occur between 
two remeshings. 
DT 
Optional time step to control the remeshing frequency.  A negative 
value points to a load curve ID giving the remeshing time step as a 
function of time. 

================================================================================
PAGE 574
================================================================================

*ICFD 
*ICFD_CONTROL_ADAPT_SIZE 
7-42 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_ADAPT_SIZE 
Purpose:  Control the remeshing of elements.  This keyword enables considering the ele-
ment quality and distortion instead of only checking for inverted elements. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ASIZE 
NIT 
KIS 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
none 
0 
 
 
 
 
 
 
Optional Card. When including ICFD during the dynamic relaxation phase, this second 
line enables applying diﬀerent parameters during that phase.  See IDR of *ICFD_CON-
TROL_GENERAL. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DRASIZE 
DRNIT 
DRKIS 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
optional
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ASIZE 
Remesh criteria ﬂag: 
EQ.0: Only remesh in cases where elements invert. 
EQ.1: Remesh if elements invert or if element quality deterio-
rates. 
NIT 
Number of iterations before a remeshing is forced.  If a negative 
integer is entered, then a load curve function of time deﬁnes NIT.
KIS 
Keep initial mesh size: 
EQ.0: Turned oﬀ.  The remeshing process will ignore the initial 
mesh size in the volume.  
EQ.1: Turned on.  Whenever a remeshing occurs, the new local 
mesh size will not be allowed to be substantially coarser 

================================================================================
PAGE 575
================================================================================

*ICFD_CONTROL_ADAPT_SIZE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-43 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
than the one from the previous mesh.  The object is to di-
minish the excessive coarsening that can occur between 
two remeshes. 
DRASIZE 
Same as ASIZE but for dynamic relaxation 
DRNIT 
Same as NIT but for dynamic relaxation 
DRKIS 
Same as KIS but for dynamic relaxation 

================================================================================
PAGE 576
================================================================================

*ICFD 
*ICFD_CONTROL_ADAPT 
7-44 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_ADVECTION 
Purpose:  Modify the default advection schemes for diﬀerent parts of the solver like Na-
vier Stokes, Level Set, thermal, etc. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
 
 
 
SLLS 
SLNS 
SLT 
SLST 
SLRT 
Type 
 
 
 
I 
I 
I 
I 
I 
Default 
 
 
 
0 
0 
0 
0 
0 
 
 VARIABLE  
 
DESCRIPTION 
SLLS 
Advection scheme for the Level Set solver: 
EQ.0: Default advection scheme 
EQ.1: Changes the default advection scheme in the Level Set 
solver to use a linear semi-Lagrangian approach (Min and 
Gibou [2006]). 
EQ.2: Changes the default advection scheme in the Level Set 
solver to use a higher-order semi-Lagrangian approach. 
SLNS 
Advection scheme for the Navier-Stokes solver: 
EQ.0: Default advection scheme 
EQ.1: Changes the default advection scheme in the Navier-
Stokes solver to use a semi-Lagrangian approach (Min 
and Gibou [2006]). 
SLT 
Advection scheme for the Thermal solver: 
EQ.0: Default advection scheme 
EQ.1: Changes the default advection scheme in the Thermal 
solver to use a semi-Lagrangian approach. 
SLST 
Advection scheme for the Species Transport solver: 
EQ.0: Default advection scheme 
EQ.1: Changes the default advection scheme in the Species 
Transport solver to use a semi-Lagrangian approach. 

================================================================================
PAGE 577
================================================================================

*ICFD_CONTROL_ADVECTION 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-45 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
SLRT 
Advection scheme for the Residence Time solver: 
EQ.0: Default advection scheme 
EQ.1: Changes the default advection scheme in the Residence 
Time solver to use a semi-Lagrangian approach. 
References: 
Min, Chohong, and Frédéric Gibou.  "A second order accurate projection method for the 
incompressible Navier–Stokes equations on non-graded adaptive grids." Journal of Com-
putational Physics 219.2 (2006): 912-929.

================================================================================
PAGE 578
================================================================================

*ICFD 
*ICFD_CONTROL_BACKFLOW 
7-46 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_BACKFLOW 
Purpose:  Modify default values for backﬂow stabilization. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
BFOR 
SF 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
1.0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
BFOR 
Set the backﬂow stabilization formulation: 
EQ.0: Default stabilization dependent on spatial velocity gradi-
ents.  
EQ.1: The stabilization adds a temporal velocity gradient which
could be necessary for added stabilization. 
SF 
Scale factor to increase the stabilization if needed.  A very small
value larger than zero minimizes the eﬀect. 

================================================================================
PAGE 579
================================================================================

*ICFD_CONTROL_CONJ 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-47 (ICFD) 
*ICFD_CONTROL_CONJ 
Purpose:  This keyword allows to pick between the diﬀerent coupling methods for con-
jugate heat transfer applications 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CTYPE 
 
 
 
 
 
 
TSF 
Type 
I 
 
 
 
 
 
 
F 
Default 
0 
 
 
 
 
 
 
none 
 
 VARIABLE  
 
DESCRIPTION 
CTYPE 
Indicates the thermal coupling type. 
EQ.0: Robust and accurate monolithic coupling where the tem-
perature ﬁeld are solved simultaneously between the 
ﬂuid and the structure.  
EQ.1: Weak thermal coupling.  The ﬂuid passes the heat ﬂux to 
the solid at the ﬂuid-structure interface and the solid re-
turns the temperature which is applied as a Dirichlet con-
dition. 
TSF 
Thermal Speedup Factor.  This factor multiplies all thermal pa-
rameters present in the heat equation with  units  of  time  in  the  
denominator  (e.g.,  thermal  conductivity,  convection  heat  
transfer  coeﬃcients).    It  is  used  to artiﬁcially  time  scale  the 
thermal problem.  A negative value will refer to a time dependent 
load curve. 
Remarks: 
1.The keyword ICFD_BOUNDARY_CONJ_HEAT is ignored if CTYPE = 1 but the 
keyword ICFD_BOUNDARY_FSI is needed in all thermal coupling cases.

================================================================================
PAGE 580
================================================================================

*ICFD 
*ICFD_CONTROL_DEM_COUPLING 
7-48 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_DEM_COUPLING 
Purpose:  Activate coupling between the ICFD and DEM solvers. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CTYPE 
BT 
DT 
SF 
MAXVEL 
DTYPE 
SFF 
FORM 
Type 
I 
F 
F 
F 
F 
I 
F 
I 
Default 
0 
0. 
1028 
1. 
none 
0 
1.0 
0 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NITBS 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
↓ 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
CTYPE 
Indicates the coupling direction of the solvers: 
EQ.0: Two-way coupling between the ﬂuid and the solid parti-
cles. 
EQ.1: One-way coupling.  The DEM particles transfer their loca-
tion to the ﬂuid solver. 
EQ.2: One-way coupling.  The ﬂuid solver transfers forces to the 
DEM particles. 
BT 
Birth time for the DEM coupling 
DT 
Death time for the DEM coupling 
SF 
Scale factor applied to the force transmitted by the ﬂuid to the 
structure 
MAXVEL 
Maximal ﬂuid velocity that can be used for the calculation of the 
ﬂuid force passed on to the DEM particle.  This is to avoid having 
spurious velocities in the ﬂuid causing very high and unrealistic 

================================================================================
PAGE 581
================================================================================

*ICFD_CONTROL_DEM_COUPLING 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-49 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
forces on the DEM particles which may lead to a crash. 
DTYPE 
Drag calculation type: 
EQ.0: Constant 퐶푑 value 0.5 scaled by SF 
EQ.1: Formula for 퐶푑 calculation from Cheng [2009] based on 
the local Reynolds number value scaled by SF. See Re-
mark 1. 
SFF 
Scale factor applied to the force transmitted by the structure to the 
ﬂuid 
FORM 
Type of formulation used in the coupling: 
EQ.0: The force at the particle is based on a velocity drag value.
EQ.2: The force is computed using the ﬂuid pressure gradient. 
NITBS 
Number of time steps between particle searches.  The default is 50 
in explicit analysis and 1 in implicit.  Increasing this number can
reduce the computational time at the expense of possible less accu-
rate particle tracking. 
Remarks: 
1. 
Coefﬁcient of drag by Cheng [2009]. The calculation for 퐶푑 is: 
퐶푑= 24
Re × (1 + 0.27 × Re)0.43 + 0.47 × (1 −exp(−0.04 × Re0.38)) 
See Cheng [2009] for details. 
References: 
 [1]  
Cheng, N.-S., “Comparison of formulas for drag coefficient and settling velocity of spherical parti-
cles,” Powder Technology, 189, 395-398 (2009).

================================================================================
PAGE 582
================================================================================

*ICFD 
*ICFD_CONTROL_DEM_COUPLING 
7-50 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_EMBEDSHELL 
Purpose:  This keyword allows the user to control speciﬁc options related to the use of 
the keyword MESH_EMBEDSHELL. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
GTYPE 
DIST 
TPS 
 
 
 
 
 
Type 
I 
F 
I 
 
 
 
 
 
Default 
0 
0.1 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
GTYPE 
Gap type.  Deﬁnes the criteria for selecting a distance to build the 
gap between the embedded nodes and the newly generated : 
EQ.0: Automatic and based on the surface mesh size multiplied
by a scale factor given by DIST. Default method. 
EQ.1: Speciﬁc gap size given by the user and deﬁned by DIST. 
DIST 
Distance value if GTYPE = 1 or scale factor value if GTYPE = 0. 
TPS 
Triple Point Seal.  Allows to control the ﬂuid escape through triple
points 
EQ.0: Oﬀ. 
EQ.1: On.  The triple points of embedded shells in contact to 
walls or among each other are sealed and no ﬂow goes
through them. 

================================================================================
PAGE 583
================================================================================

*ICFD_CONTROL_FSI 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-51 (ICFD) 
*ICFD_CONTROL_FSI 
Purpose:  This keyword modiﬁes default values for the ﬂuid-structure interaction cou-
pling algorithm. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OWC 
BT 
DT 
IDC 
LDICSF 
XPROJ 
 
 
Type 
I 
F 
F 
F 
I 
I 
 
 
Default 
0 
0 
1028 
0.25 
0 
0 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NSUB 
 
 
 
VFORC 
 
 
 
Type 
I 
 
 
 
I 
 
 
 
Default 
none 
 
 
 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OWC 
Indicates the coupling direction to the solver: 
EQ.0: Two-way coupling.  Loads and displacements are trans-
ferred across the FSI interface, and the full non-linear 
problem is solved.  It gives weak FSI coupling when cou-
pled to explicit mechanical solver and strong FSI coupling
when coupled to implicit mechanical solver. 
EQ.1: One-way coupling.  The solid mechanics solver transfers 
displacements to the ﬂuid solver. 
EQ.2: One-way coupling.  The ﬂuid solver transfers stresses to
the solid mechanics solver. 
EQ.3: Two-way coupling.  It causes weak coupling (no sub-step-
ping) with the implicit mechanical solver. 
BT 
Birth time for the FSI coupling.  Before BT the ﬂuid solver will not 
pass any loads to the structure, but it will receive displacements 

================================================================================
PAGE 584
================================================================================

*ICFD 
*ICFD_CONTROL_FSI 
7-52 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
from the solid mechanics solver. 
DT 
Death time for the FSI coupling.  After DT the ﬂuid solver will not 
transfer any loads to the solid mechanics solver, but the ﬂuid will 
continue to deform with the solid. 
IDC 
Interaction detection coeﬃcient.  See Remark 1. 
LCIDSF 
Optional load curve ID to apply a scaling factor on the forces trans-
ferred to the solid: 
GT.0: Load curve ID for scale factor as a function of iterations 
LT.0: |LCIDSF| is a load curve ID for scale factor as a function of 
time. 
XPROJ 
Projection of the nodes of the CFD domain that are at the FSI inter-
face onto the structural mesh (see Remark 2): 
EQ.0: No projection  
EQ.1: Projection 
NSUB 
Optional limit on the number of FSI ﬂuid subiterations.  This 
avoids the sometimes unneeded excessive number of FSI subitera-
tions when the ﬂuid and very light structures (like parachutes) de-
velop a resonance-like mode inside the FSI subiterations (coupling 
iterations). 
VFORC 
Add viscous tangential forces to the FSI coupling: 
EQ.0: Only normal pressure forces are used. 
EQ.1: Viscous forces are added to normal forces. 
EQ.2: Viscous forces are recomputed at every sub-step during 
the nonlinear iterations and added to normal forces. 
Remarks: 
1. 
Detecting ﬂuid-solid interaction. One of the criteria to automatically detect the 
ﬂuid and solid surfaces that will interact in FSI problems is the distance 푑 be-
tween a ﬂuid (solid) node and a solid (ﬂuid) element, respectively: 
푑≤IDC × min(ℎ, 퐻) , 
where ℎ is the size of the ﬂuid mesh, 퐻 is the size of the solid mechanics mesh, 
and IDC is a detection coeﬃcient criteria with IDC = 0.25 by default.  In the 

================================================================================
PAGE 585
================================================================================

*ICFD_CONTROL_FSI 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-53 (ICFD) 
majority of cases, this default value is suﬃcient to ensure FSI interaction.  How-
ever, it can happen in special cases that the ﬂuid and solid geometries have cur-
vatures that diﬀer too much (such as pipe ﬂows in conjugate heat transfer 
applications).  In such cases, a bigger IDC value may be needed.  This ﬂag should 
be handled with care. 
2. 
Rotation and projection of nodes. XPROJ = 1 is recommended for cases with 
rotation.
d
H
h
Fluid Nodes
Solid Nodes
 
Figure 0-1.  Geometry of FSI contact. 

================================================================================
PAGE 586
================================================================================

*ICFD 
*ICFD_CONTROL_GAP 
7-54 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_GAP 
Purpose:  Activate the gap closure treatment that deals with ﬂow blockage when surfaces 
come into contact.  In ICFD, surface meshes are not allowed to collide or penetrate each 
other.  Rather, activation of the gap closure feature triggers a ﬂow blockage between two 
surfaces in close proximity based on a user deﬁned contact distance.  There are two types 
of ﬂow treatment available.  The default is a strong exclusion of the ﬂuid elements within 
the gap.  The second option is a porous media description for the ﬂuid nodes inside the 
contact gap.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
HGAP 
PGAP 
PERM 
 
 
 
 
 
Type 
F 
I 
F 
 
 
 
 
 
Default 
none 
0 
1.e-5 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
PID7 
PID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
HGAP 
Threshold distance.  If the distance between surfaces is less than 
this value, the ﬂow motion is blocked in the gap.  Currently there 
is only one universal value of HGAP for all the surfaces listed in 
Card 2. 
PGAP 
Flag for ﬂow treatment of ﬂuid elements in the gap: 
EQ.0: Element exclusion contact treatment 
EQ.1: Porous media description 
PERM 
Permeability coeﬃcient.  Its value determines the ratio between the 
ﬂuid and porous representation in the contact region.  Low values 
induce a Darcy description.   

================================================================================
PAGE 587
================================================================================

*ICFD_CONTROL_GAP 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-55 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
PIDn 
Part IDs of the surfaces involved in the gap closure treatment 

================================================================================
PAGE 588
================================================================================

*ICFD 
*ICFD_CONTROL_GENERAL 
7-56 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_GENERAL 
Purpose:  Specify the type of ICFD analysis. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ATYPE 
MTYPE 
DVCL 
RDVCL 
SOLCL 
 
IDR 
 
Type 
I 
I 
I 
I 
I 
 
I 
 
Default 
0 
0 
0 
0 
0 
 
0 
 
 
 VARIABLE  
 
DESCRIPTION 
ATYPE 
Analysis type: 
EQ.-2: Turn oﬀ the ICFD solver but leave level set, thermal, etc. 
Velocities can be set using the deﬁne function.  It is useful 
for debugging models or for simple thermal / level set 
cases that do not need a full ICFD solution. 
EQ.-1: Turn oﬀ the ICFD solver after the initial keyword reading
EQ.0: Transient analysis (default) 
EQ.1: Steady-state analysis 
MTYPE 
Solving method type: 
EQ.0: Fractional step method 
EQ.1: Monolithic solve 
EQ.2: Potential ﬂow solve  
DVCL 
Divergence cleaning ﬂag: 
EQ.0: Initialize the solution with divergence cleaning (default)
EQ.1: No divergence cleaning 
EQ.2: Initial divergence cleaning using potential ﬂow 
EQ.4: Initial divergence cleaning using steady-state solver 
RDVCL 
Remeshing divergence cleaning: 
EQ.0: No divergence cleaning after remesh (default) 
EQ.1: Divergence cleaning after each remeshing step 

================================================================================
PAGE 589
================================================================================

*ICFD_CONTROL_GENERAL 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-57 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
SOLCL 
Solver control: 
EQ.0: The solver automatically detects if the analysis is 2D or 3D 
based on element connectivity (default). 
EQ.1: Turns on the 2D axisymmetric solver.  
EQ.2: 2D axisymmetric solver for FSI cases that use section shell
type 15 for solid parts. 
IDR 
Flag to include ICFD during the structural dynamic relaxation 
phase: 
EQ.0: Oﬀ 
EQ.1: Include the ICFD solver during the dynamic relaxation 
phase.  The solver only computes the mesh displacement. 
It does not ﬁnd pressure/velocity, but the mesh adapts 
and follows the displacement of the FSI parts. 

================================================================================
PAGE 590
================================================================================

*ICFD 
*ICFD_CONTROL_IMPOSED_MOVE 
7-58 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_IMPOSED_MOVE 
Purpose:  Impose a velocity on speciﬁc ICFD parts or on the whole volume mesh.  Global 
translation, global rotation, and local rotation components can be deﬁned and combined.  
This keyword can be used to save calculation time in certain applications, such as slosh-
ing, where the modeling of the whole ﬂuid box and the solving of the consequent FSI 
problem are not necessarily needed. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
LCVX 
LCVY 
LCVZ 
VADT 
IDR 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
Default 
none 
none 
none 
none 
0 
0 
 
 
 
Optional Card. Rotational velocity components using Euler or Tait-Bryan angles (see 
Remark 1). 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ALPHAL 
BETAL 
GAMMAL
ALPHAG 
BETAG 
GAMMAG
VADR 
IANG 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
0 
0 
0 
0 
0 
0 
0 
0 
 
Optional Card. Local reference frame deﬁnition if ALPHAL, BETAL or GAMMAL used.
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PTID 
X1 
Y1 
Z1 
X2 
Y2 
Z2 
 
Type 
I 
F 
F 
F 
F 
F 
F 
 
Default 
0 
1. 
0. 
0. 
0. 
1. 
0. 
 
 

================================================================================
PAGE 591
================================================================================

*ICFD_CONTROL_IMPOSED_MOVE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-59 (ICFD) 
Optional Card. When deﬁned, Cards 2 and 3 are ignored.  With this card, rotation is 
imposed around a point using the velocity of a second point. 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PTIDO 
AXE 
NID 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
0 
0 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID. This can be any part ID referenced in *ICFD_PART 
or *ICFD_PART_VOL. If PID = 0, then the whole volume 
mesh will be used. 
LCVX, LCVY, 
LCVZ 
Load curve IDs for the velocity/displacements in the three 
global directions (푋, 푌, 푍). To use a *DEFINE_FUNCTION, 
see Remark 4. 
VADT 
Velocity/displacements ﬂag for translation components: 
EQ.0: Prescribe velocity  
EQ.1: Prescribe displacements 
IDR 
Flag determining whether to only impose mesh displacement 
during dynamic relaxation phase (see IDR of *ICFD_CON-
TROL_GENERAL): 
EQ.0: Oﬀ. 
EQ.1: On.  Apply imposed mesh movement only during 
the dynamic relaxation phase. 
ALPHAL, BETAL, 
GAMMAL 
Load curves IDs for the three angle rotational velocities/dis-
placements in the local reference frame (see Remarks 1 and 
2). To use a *DEFINE_FUNCTION, see Remark 4. 
ALPHAG, BE-
TAG, GAMMAG 
Load curve IDs for the three angle rotational velocities/dis-
placements in the global reference frame (see Remarks 1 and 
2). To use a *DEFINE_FUNCTION, see Remark 4. 

================================================================================
PAGE 592
================================================================================

*ICFD 
*ICFD_CONTROL_IMPOSED_MOVE 
7-60 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
VADR 
Velocity/displacements ﬂag for rotation components: 
EQ.0: Prescribe velocity  
EQ.1: Prescribe displacements 
IANG 
Rotation matrix type: 
EQ.0: Euler angles using  퐙(훼)퐗(훽)퐙(훾) intrinsic rotations.
EQ.1: Tait-Bryan angles using 퐙(훼)퐗(훽)퐘(훾) intrinsic rota-
tions. 
PTID 
Point ID for the origin of the local reference frame.  If not de-
ﬁned, the barycenter of the volume mesh will be used 
X1, Y1, Z1 
Three components of the local reference X1 axis.  If not de-
ﬁned, the global 푋 axis will be used.  See Remark 2. 
X2, Y2, Z2 
Three components of the local reference X2 axis.  If not de-
ﬁned, the global 푌 axis will be used.  See Remark 2. 
PTIDO 
Point ID (See *ICFD_DEFINE_POINT) for the center of rota-
tion. 
AXE 
Rotation axis: 
EQ.1: 푋-axis 
EQ.2: 푌-axis 
EQ.3: 푍-axis 
NID 
ICFD surface node ID for the rotational velocity.  If the node 
is static, no rotation will occur.  See Remark 3. 
Remarks: 
1. 
Rotations.  Any target orientation can be reached starting from a known refer-
ence orientation using a speciﬁc sequence of intrinsic rotations whose magni-
tudes are the Euler or Tait Bryan angles (훼, 훽, 훾). Equivalently, any rotation 
matrix 퐑 can be decomposed as a product of three elemental rotation matrices.  
For instance: 
퐑= 퐗(훼)퐘(훽)퐙(훾) 

================================================================================
PAGE 593
================================================================================

*ICFD_CONTROL_IMPOSED_MOVE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-61 (ICFD) 
However, a diﬀerent deﬁnition of the elemental rotation matrices and their mul-
tiplication order can be adopted.  The ICFD solver uses the following approach 
and rotation matrix for the Euler angles: 
퐙(훼)퐗(훽)퐙(훾) =
⎣
⎢⎢⎢⎢⎡
푐훼푐γ −푐훽푠훼푠훾
−푐훽푐훾푠훼−푐훼푠훾
푠훼푠훽
푐γ푠훼+ 푐훼푐훽푠훾
푐훼푐훽푐훾−푠훼푠훾
−푐훼푠훽
푠훽푠훾
푐훾푠훽
푐훽
⎦
⎥⎥⎥⎥⎤
 
Here, 푠훼= sin(훼), and 푐훽= cos(훽). 
For the Tait-Bryan approach, the following rotation matrix is used: 
퐙(훼)퐗(훽)퐘(훾) =
⎣
⎢⎢⎢⎢⎡
푐훼푐γ −푠훼푠훽푠훾
−푐훽푠훼
푐훼푠훾+ 푐γ푠훼푠훽
푐γ푠훼+ 푐훼푠훽푠훾
푐훼푐훽
푠훼푠훾−푐훼푐γ푠훽
−푐훽푠훾
푠훽
푐훽푐γ
⎦
⎥⎥⎥⎥⎤
 
2. 
Local coordinate systems.  It is possible to have the ICFD parts or ICFD_-
PART_VOLs rotate around the global reference frame but also to deﬁne and use 
a local reference frame by deﬁning its point of origin and two of its vectors 퐯1 =
(X1, Y1, Z1) and 퐯2 = (X2, Y2, Z2) (note that 퐯1 and 퐯2 should be orthogonal).  
The third vector is, then, in the direction of 퐯1 × 퐯2.  See Figure 7-5. 
3. 
Purpose of NID.  We developed this feature for rotating problems involving FSI 
and sliding mesh.  For example, the airﬂow can push the blades of a wind tur-
bine and the rotation of the sliding mesh can be prescribed as function of the 
blade rotation speed. 
Y
X
Z
x
y
z
Y
X
Z
Y
X
Z
Y
X
Z
x
y
z
x
z
α
β
γ
y
x
y
z
Figure 7-5.  A rotation represented by Euler angles (훼, 훽, 훾) using 퐙(훼)퐗(훽)퐙(훾)
intrinsic rotations. 
Y
X
Z
x
y
z
Y
X
Z
Y
X
Z
Y
X
Z
x
y
z
x
z
α
β
γ
y
z
y
x
Figure 7-6.  A rotation represented by Tait-Bryan angles (훼, 훽, 훾) using 
퐙(훼)퐗(훽)퐘(훾) intrinsic rotations 

================================================================================
PAGE 594
================================================================================

*ICFD 
*ICFD_CONTROL_IMPOSED_MOVE 
7-62 (ICFD) 
R16@bdccd6d07 (03/10/25) 
4. 
*DEFINE_FUNCTION. For each of the load curves, a *DEFINE_FUNCTION can 
be used.  If a *DEFINE_FUNCTION is used, the following parameters are al-
lowed: f(x, y, z, vx, vy, vz, temp, visc, pres, time, dt).

================================================================================
PAGE 595
================================================================================

*ICFD_CONTROL_LEVELSET 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-63 (ICFD) 
*ICFD_CONTROL_LEVELSET 
Purpose:  Modify default values for the level set solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LSRST 
LSINL 
 
LSMTH 
 
 
SGC 
AST 
Type 
I 
I 
 
F 
 
 
I 
I 
Default 
20 
0 
 
0.0 
 
 
0 
0 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SRL 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
LSRST 
Frequency the level set distance function is re-initialized.  The de-
fault value is every 20 time steps. 
LSINL 
Set the level set to be positive at a velocity inlet: 
EQ.0: Let the level set algorithm compute the value (default). 
EQ.1: Force a positive level set value at the inlet. 
LSMTH 
Scale factor for level set smoothness.  
GT.0.0: Add smoothness to the free surface.  Small values like 
0.1 are reasonable.  The optimal value could be problem 
dependent. 
SGC 
Smoother approximate of gradient and curvature: 
EQ.0: No smoothing added 
EQ.1: Linear gradient and curvature 
EQ.-1: Least-squares-based gradient and curvature 

================================================================================
PAGE 596
================================================================================

*ICFD 
*ICFD_CONTROL_LEVELSET 
7-64 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.2: Least-squares gradient smoothing 
AST 
Advanced formulation for surface tension: 
EQ.0: Smoothed Dirac 
EQ.1: Smoothed Heaviside 
EQ.2: Laplace-Beltrami 
SRL 
Smoother reinitialization method for the level set: 
EQ.0: Standard, geometric-based 
EQ.1: Linear closest point algorithm 
EQ.2: Higher-order closest point algorithm 

================================================================================
PAGE 597
================================================================================

*ICFD_CONTROL_LOAD 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-65 (ICFD) 
*ICFD_CONTROL_LOAD 
Purpose:  This keyword resets the body load in the ICFD solver to zero, while leaving the 
body load unchanged for the solid mechanics solver.  It is useful in problems where the 
gravity acceleration may be neglected for the ﬂuid problem, but not for the solid mechan-
ics problem. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ABL 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
1 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ABL 
EQ.0: the body load provided in *LOAD_BODY is reset to zero 
only for the ﬂuid analysis. 

================================================================================
PAGE 598
================================================================================

*ICFD 
*ICFD_CONTROL_MESH 
7-66 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_MESH 
Purpose:  Modify default values for automatic volume mesh generation.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MGSF 
 
MSTRAT 2DSTRUC
NRMSH 
 
 
 
Type 
F 
 
I 
I 
I 
 
 
 
Default 
1.41 
 
0 
0 
0 
 
 
 
 
Optional card. This card is optional. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
AVER 
SFBL 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
14 
1.0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MGSF 
Mesh Growth Scale Factor.  It speciﬁes the maximum mesh size
that the volume mesher is allowed to use when generating the vol-
ume mesh based on the mesh surface element sizes deﬁned in 
*MESH_SURFACE_ELEMENT.  See Remark 1. 
MSTRAT 
Mesh generation strategy (see Remark 2): 
EQ.0: Mesh generation based on Delaunay criteria  
EQ.1: Mesh generation based on octree  
2DSTRUC 
Flag to decide between an unstructured mesh generation strategy 
in 2D or a structured mesh strategy: 
EQ.0: Structured mesh  
EQ.1: Unstructured mesh 

================================================================================
PAGE 599
================================================================================

*ICFD_CONTROL_MESH 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-67 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
NRMSH 
Flag to turn oﬀ any remeshing (see Remark 3): 
EQ.0: Remeshing possible 
EQ.1: Remeshing not allowed 
AVER 
Automatic Volume Mesher version (see Remark 4): 
EQ.14: Version 14 
EQ.16: Version 16  
SFBL 
Scale factor that controls the speed of boundary layer inﬂation.  If 
the boundary layer is much larger in size than the surface mesh, 
we recommend a value less than one. 
Remarks: 
1. 
MGSF. For MGSF, values between 1 and 2 are allowed.  Values closer to 1 will 
result in a ﬁner volume mesh (1 means the volume mesh is not allowed to be 
coarser than the element size from the closest surface meshes) and values closer 
to 2 will result in a coarser volume mesh (2 means the volume can use elements 
as much as twice as coarse as those from the closest surface mesh).  MGSF has a 
ﬁxed value of 1 in 2D. 
2. 
Mesh Generation Strategy. The default mesh generation strategy (based on 
Delaunay criteria) yields a linear interpolation of the mesh size between two 
surfaces facing each other whereas the octree-based generation strategy allows 
for the sizes of the elements to remain close to the element surface mesh size 
over a longer distance.  This octree strategy can be useful for creating a smoother 
transition in conﬁgurations where two surface meshes facing each other have 
very distinct sizes. 
3. 
NRMSH.  If you know in advance that no remeshing will occur during the anal-
ysis, then setting NRMSH to 1 may be useful as it will free up space used to back 
up the mesh and consequently lower memory consumption. 
4. 
Version.  Version 14 is the default version used for the ICFD solver automatic 
volume mesher.  Version 16 is now supported and available as option.  In some 
cases, it can yield an approximatively 20% mesh generation speed gain.

================================================================================
PAGE 600
================================================================================

*ICFD 
*ICFD_CONTROL_MESH_MOV 
7-68 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_MESH_MOV 
Purpose:  Choose the type of algorithm for mesh movement. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MMSH 
LIM_ITER
RELTOL 
 
 
 
 
 
Type 
I 
I 
F 
 
 
 
 
 
Default 
2 
100 
10-3 
 
 
 
 
 
 
VARIABLE 
 
DESCRIPTION 
MMSH 
Mesh motion selector: 
EQ.-1: Completely shuts oﬀ any mesh movement 
EQ.1: Mesh moves based on the distance to moving walls. 
EQ.2: Mesh moves by solving a linear elasticity problem using 
the element sizes as stiﬀness (default). 
EQ.3: Mesh uses a Laplacian smoothing with stiﬀness on edges 
and from node to opposite faces.  Very robust, but costly.
EQ.4: Full Lagrangian.  The mesh moves with the velocity of
the ﬂow. 
EQ.11: Mesh moves using an implicit ball-vertex spring 
method. 
EQ.20: Mesh moves by solving a linear elasticity problem using 
a constant size.  This can be useful to avoid large distor-
tions in rotating problems that involve large discrepan-
cies in mesh sizes (typically in cases involving boundary 
layer mesh). 
LIM_ITER 
Maximum number of linear solver iterations for the ball-vertex lin-
ear system 
RELTOL 
Relative tolerance to use as a stopping criterion for the ball-vertex 
method iterative linear solver (conjugate gradient solver with di-
agonal scaling preconditioner) 

================================================================================
PAGE 601
================================================================================

*ICFD_CONTROL_MONOLITHIC 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-69 (ICFD) 
*ICFD_CONTROL_MONOLITHIC 
Purpose:  This keyword allows to choose between the Fractional Step Solver and the Mon-
olithic Solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SID 
Solver ID : 
EQ.0: Fractional Step Solver.  Default. 
EQ.1: Monolithic Solver. 

================================================================================
PAGE 602
================================================================================

*ICFD 
*ICFD_CONTROL_OUTPUT 
7-70 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_OUTPUT 
Purpose:  This keyword modiﬁes default values for screen and ﬁle outputs related to this 
ﬂuid solver only. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSGL 
OUTL 
DTOUT 
LSPPOUT
 
ITOUT 
 
 
Type 
I 
I 
F 
I 
 
I 
 
 
Default 
0 
0 
0 
0 
 
0 
 
 
 
Optional Card.  
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PITOUT 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSGL 
Message level. 
EQ.0: only time step information is output. 
EQ.1: ﬁrst level solver information. 
EQ.2: full output information with details about linear algebra 
and convergence steps. 
EQ.4: full output information is also copied to the messag ﬁle. 

================================================================================
PAGE 603
================================================================================

*ICFD_CONTROL_OUTPUT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-71 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
OUTL 
Output the ﬂuid results in other ﬁle formats apart from d3plot. 
EQ.0: only d3plot output 
EQ.2: output a ﬁle with mesh statistics and the ﬂuid results in 
OpenDX format.  A directory named dx will be created in 
the work directory where the output ﬁles will be written.
EQ.6: output a ﬁle with mesh statistics and the ﬂuid results in 
VTK format readable by Paraview.  A directory named vtk
will be created in the work directory where the output 
ﬁles will be written. 
EQ.7: output a ﬁle with mesh statistic and the ﬂuid results in 
VTU format readable by Paraview.  A directory named vtk
will be created in the work directory where the output 
ﬁles will be written. 
EQ.10: output a ﬁle with mesh statistic and the ﬂuid results in 
Fieldview ASCII format.  . A directory named fv will be 
created in the work directory where the output ﬁles will
be written.  Only available in 3D. 
EQ.11: output a ﬁle with mesh statistic and the ﬂuid results in 
Fieldview binary format.  . A directory named fv will be 
created in the work directory where the output ﬁles will
be written.  Only available in 3D. 
DTOUT 
Time interval to print the output when OUTL is diﬀerent than 0. 
LSPPOUT 
EQ.0: no LSPP output is produced. 
EQ.1: outputs a ﬁle with the automatically created ﬂuid volume 
mesh in a format compatible for LSPP at each remesh. 
Also outputs the ﬂuid volume mesh in a format compati-
ble with a subsequent ICFD analysis. 
EQ.3: Outputs the ﬂuid volume mesh in a format compatible 
with a subsequent ICFD analysis at each DTOUT. 
ITOUT 
Iteration interval to print the output, including the d3plot ﬁles when 
the steady state solver is selected (See ICFD_CONTROL_GENER-
AL). 

================================================================================
PAGE 604
================================================================================

*ICFD 
*ICFD_CONTROL_OUTPUT 
7-72 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
PITOUT 
Pressure iteration limit output.  If the number of pressure iterations 
in the fractional step solve goes above PITOUT, an extra d3plot 
will be dumped.  This is mainly a debugging feature which can help 
the user identify problematic areas in the model which often pre-
cede a divergence. 
.

================================================================================
PAGE 605
================================================================================

*ICFD_CONTROL_OUTPUT_SUBDOM 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-73 (ICFD) 
*ICFD_CONTROL_OUTPUT_SUBDOM 
Purpose:  Deﬁnes a speciﬁc zone that should be output in the format speciﬁed by the 
ICFD_CONTROL_OUTPUT card rather than the whole domain.  
 
Shape Control. First card speciﬁes the shape of the output sub domain. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SNAME 
 
 
 
 
 
 
 
Type 
A 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Box Case. Card 2 for Sname = box 
 Cards 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PMINX 
PMINY 
PMINZ 
PMAXX 
PMAXY 
PMAXZ 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
Sphere Case. Card 2 for Sname = sphere 
 Cards 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RADIUS 
CENTERX
CENTERY  CENTERZ
 
 
 
 
Type 
F 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 

================================================================================
PAGE 606
================================================================================

*ICFD 
*ICFD_CONTROL_OUTPUT_SUBDOM 
7-74 (ICFD) 
R16@bdccd6d07 (03/10/25) 
Cylinder Case. Card 2 for Sname = cylinder 
 Cards 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Radius 
PMINX 
PMINY 
PMAXZ 
PMAXX 
PMAXY 
PMAXZ 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
SNAME 
Shape name.  Possibilities include ‘box’, ‘cylinder’ and ‘sphere’ 
PMINX, Y, Z] 
X, Y, Z for the point of minimum coordinates 
PMAX[X, Y, Z] 
X, Y, Z for the point of maximum coordinates 
CEN-
TER[X, Y, Z] 
Coordinates of the sphere center in cases where Sname is Sphere
RADIUS 
Radius of the sphere if SNAME  is sphere or of the cross section 
disk if SNAME is cylinder. 

================================================================================
PAGE 607
================================================================================

*ICFD_CONTROL_OUTPUT_VAR 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-75 (ICFD) 
*ICFD_CONTROL_OUTPUT_VAR 
Purpose:  This keyword allows the user to turn oﬀ the output of certain CFD variables to 
reduce the size of the d3plot ﬁles. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VEL 
AVGVEL 
VORT 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
0 
0 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PRE 
PREAVG 
LSET 
QC 
CFL 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
0 
0 
0 
0 
0 
 
 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TEMP 
TEMPAVG
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
0 
0 
 
 
 
 
 
 
 

================================================================================
PAGE 608
================================================================================

*ICFD 
*ICFD_CONTROL_OUTPUT_SUBDOM 
7-76 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
KP 
EP 
MUT 
INT 
CMU 
 
 
 
Type 
I 
I 
I 
I 
I 
 
 
 
Default 
0 
0 
0 
0 
0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
VEL/AVGVEL/ 
VORT 
Velocity, average velocity, vorticity : 
EQ.0: Is output. 
EQ.1: Is not output. 
PRE/PREAVG/ 
LSET/QC/CFL 
Pressure, average pressure, levelset, Q criterion, CFL number :
EQ.0: Is output. 
EQ.1: Is not output. 
TEMP/ 
TEMPAVG 
Temperature, average temperature : 
EQ.0: Is output. 
EQ.1: Is not output. 
KP/EP/MUT 
/INT/CMU 
RANS output variables, kinetic energy, diﬀusion, turbulent vis-
cosity, turbulent intensity, Cmu variable : 
EQ.0: Is output. 
EQ.1: Is not output. 
.

================================================================================
PAGE 609
================================================================================

*ICFD_CONTROL_PARTITION 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-77 (ICFD) 
*ICFD_CONTROL_PARTITION 
Purpose:  This keyword changes the default option for the partition in MPP, thus it is 
only valid in MPP. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PTECH 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
1 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PTECH 
Indicates the type of partition: 
EQ.1: the library Metis is used. 
EQ.2: partition along the axis with higher aspect ratio 
EQ.3: partition along 푋-axis 
EQ.4: partition along 푌-axis 
EQ.5: partition along 푍-axis 

================================================================================
PAGE 610
================================================================================

*ICFD 
*ICFD_CONTROL_PARTITION 
7-78 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_POROUS 
Purpose:  This keyword modiﬁes the porous media solve.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PMSTYPE VELMETH
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
0 
0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PMSTYPE 
Indicates the porous media solve type. 
EQ.0: Anisotropic Generalized Navier-Stokes model for porous 
media (See *ICFD_MODEL_POROUS) using Fractional 
step method. 
EQ.1: Anisotropic Darcy-Forcheimer model using a Monolithic 
approach for the solve.  This method is better suited for 
very low Reynolds ﬂows through porous media (fre-
quently encountered in Resin Transfer Molding (RTM) 
applications).  See Remark 1. 
VELMETH 
Method for determining advection velocity: 
EQ.0: Uses FEM approximation for advection velocity 
EQ.1: Uses PFEM2 for advection velocity 
Remarks: 
1. 
Anisotropic Darcy-Forcheimer Model. When using the Anisotropic Darcy-
Forcheimer model, the convective term in the Navier Stokes formulation is ne-
glected.

================================================================================
PAGE 611
================================================================================

*ICFD_CONTROL_STEADY 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-79 (ICFD) 
*ICFD_CONTROL_STEADY 
Purpose:  This keyword allows to specify convergence options for the steady state solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ITS 
TOL1 
TOL2 
TOL3 
REL1 
REL2 
UREL 
ORDER 
Type 
I 
F 
F 
F 
F 
F 
F 
I 
Default 
1e6 
1.e-3 
1.e-3 
1.e-3 
0.3 
0.7 
1. 
0 
 
 VARIABLE  
 
DESCRIPTION 
    ITS 
Maximum number of iterations to reach convergence. 
TOL1/2/3 
Tolerance limits for the momentum pressure and temperature
equations respectfully. 
REL1/2 
Relaxation parameters for the velocity and pressure respectfully. 
Decreasing those values may add stability but more iterations may
be needed to reach convergence. 
UREL 
Under relaxation parameter.  Lowering this value may improve the
ﬁnal accuracy of the solution but more iterations may be needed to 
achieve convergence. 
ORDER 
Analysis order : 
EQ.0: Second order.  More accurate but more time consuming.
EQ.1: First order: More stable and faster but may be less accu-
rate. 

================================================================================
PAGE 612
================================================================================

*ICFD 
*ICFD_CONTROL_SURFMESH 
7-80 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_SURFMESH 
Purpose:  Enable automatic surface remeshing.  The objective of the remeshing is to im-
prove the mesh quality on the boundaries.  It should not be used on a regular basis. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RSRF 
SADAPT 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
0 
0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
RSRF 
Indicates whether or not to perform a surface remeshing: 
EQ.0: Do not perform surface remeshing. 
EQ.1: Perform Laplacian smoothing surface remeshing. 
EQ.2: Perform curvature-preserving surface remeshing. 
SADAPT 
Indicates whether or not to trigger adaptive surface remeshing: 
EQ.0: Do not apply adaptive surface remeshing. 
EQ.1: Apply automatic surface remeshing when quality deteri-
orates. 
EQ.2: Apply automatic surface remeshing when quality deteri-
orates.  Keep the initial element size in the case of adaptive 
mesh 
reﬁnement 
using 
*ICFD_CONTROL_ADAPT 
throughout the computation. 
.

================================================================================
PAGE 613
================================================================================

*ICFD_CONTROL_TAVERAGE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-81 (ICFD) 
*ICFD_CONTROL_TAVERAGE 
Purpose:  This keyword controls the restarting time for computing the time average val-
ues.  By default, there is no restarting and the average quantities are given starting from 
푡= 0. This keyword can be useful in turbulent problems that admit a steady state. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
DT 
Over each DT time interval, the average quantities are reset. 

================================================================================
PAGE 614
================================================================================

*ICFD 
*ICFD_CONTROL_TIME 
7-82 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_TIME 
Purpose:  Change the default values related to time parameters for the ﬂuid problem. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TTM 
DT 
CFL 
LCIDSF 
DTMIN 
DTMAX 
DTINIT 
TDEATH 
Type 
F 
F 
F 
I 
F 
F 
F 
F 
Default 
1028 
0.0 
1.0 
0 
10-9 
1028 
↓ 
1028 
 
Optional card 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DTT 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
Rem 2 
 
 
 
 
 
 
 
 
Optional card 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DTBL 
DTST 
DTVISC 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
0 
0 
 
 
 
 
 
 

================================================================================
PAGE 615
================================================================================

*ICFD_CONTROL_TIME 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-83 (ICFD) 
Optional card 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
IDR 
DTDR 
CFLDR 
LCIDSFDR DTMINDR DTMAXDR DTINITDR
 
Type 
I 
F 
F 
I 
F 
F 
F 
 
Default 
0 
0.0 
1.0 
0 
10-9 
1028 
0.0 
 
 
 VARIABLE  
 
DESCRIPTION 
TTM 
Total time of simulation for the ﬂuid problem 
DT 
Time step for the ﬂuid problem.  If nonzero, the time step will be 
constant and equal to this value.  If set to 0.0, then the time step is
automatically computed based on the ﬂuid advection CFL condi-
tion.  See Remark 1. 
CFL 
CFL number for DT = 0.0.  In general, CFL speciﬁes a scale factor 
that is applied to the time step.  When DT = 0.0, the time step is 
set to the maximum value satisfying the CFL condition, in which
case this scale factor is equal to the CFL number. 
LCIDSF 
Load curve ID specifying the CFL number when DT = 0.0 as a 
function of time, and more generally LCIDSF speciﬁes the time 
step scale factor as a function of time. 
DTMIN 
Minimum time step.  When an automatic time step is used and
DTMIN is deﬁned, the time step cannot drop below DTMIN. A 
negative value will refer to a time dependent load curve. 
DTMAX 
Maximum time step.  When an automatic time step is used and 
DTMAX is deﬁned, the time step cannot increase beyond DT-
MAX. A negative value will refer to a time dependent load curve.
DTINIT 
Initial time step.  If not deﬁned, the solver will automatically de-
termine an initial time step based on the ﬂow velocity or dimen-
sions of the problem in cases where there is no inﬂow. 
TDEATH 
Death time for the Navier Stokes solve.  After TDEATH, the ve-
locity and pressure will no longer be updated.  But the tempera-
ture and other similar quantities still can. 
DTT 
Thermal time step.  See Remark 2. 

================================================================================
PAGE 616
================================================================================

*ICFD 
*ICFD_CONTROL_TIME 
7-84 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
DTBL 
Flag to include boundary layer elements in the automatic time 
step calculation. 
EQ.0: Exclude boundary layer elements (default). 
EQ.1: Include boundary layer elements. 
DTST 
Flag to include surface tension eﬀects (when present) in the auto-
matic time step calculation: 
EQ.0: Do not take it into account (default). 
EQ.1: Add surface tension eﬀects.  See Remark 3. 
DTVISC 
Flag to include viscous eﬀects in the automatic time step calcula-
tion: 
EQ.0: Do not take it into account (default). 
EQ.1: Add viscous term eﬀects.  See Remark 4. 
IDR 
Temporarily overwrite time step settings during dynamic relaxa-
tion (DR) phase (see ﬁeld IDR of *ICFD_CONTROL_GENERAL)
EQ.0: Oﬀ 
EQ.1: Overwrite timesteps settings during DR phase  
DTDR/[..]/ 
DTINITDR 
Time step parameters equivalent to the ﬁelds 2 through 7 on Card 
1 used during DR phase. 
Remarks: 
1. 
Courant friedrichs lewy (CFL) condition.  When an automatic time step is se-
lected, the default behavior is to use the following Courant condition: 
∆푡≤∆푡adv ≤푙
푉 
Here, 푉 is the ﬂuid velocity, and 푙 is the characteristic mesh size.  When using 
an automatic time step, it is recommended to deﬁne a minimum and maximum 
acceptable value.  It is also recommended to give an initial value, especially in 
cases where no velocity boundary condition exists. 
2. 
Thermal time step.  By default, the heat equation is solved using the same time 
step as that for the velocity/pressure system.  This option allows you to assign 
a speciﬁc time step for the thermal solve.  It can be useful in cases where the time 

================================================================================
PAGE 617
================================================================================

*ICFD_CONTROL_TIME 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-85 (ICFD) 
scales are very diﬀerent between the two domains.  When deﬁned, we recom-
mend DTT to always be greater than or equal to the regular CFD time step. 
3. 
Surface tension effects.  For free surface or bi-phasic cases where surface ten-
sion is present and is the dominant force, using DTST = 1 in combination with 
an automatic time step may be convenient.  In such cases, the automatic time 
step is limited by the following Courant condition:  
∆푡≤∆푡st ≤√휌̃푙3
2휋휎 
In this condition, 휌̃ is the average density between the two ﬂuids, 푙 is the mesh 
size, and 휎 isthe surface tension value. 
4. 
Diffusive effects.  In advection-driven ﬂows, the default criteria to estimate an 
automatic time step is suﬃcient.  However, in applications where the advection 
term is small compared to the viscous forces (usually cases that combine low 
Reynolds number with high viscosity value), adding the diﬀusion Courant con-
dition as an additional constraint may be justiﬁed: 
∆푡≤∆푡diff ≤푙2
휈 
Here, 푙 is the mesh size, and 휈 is the kinematic viscosity.

================================================================================
PAGE 618
================================================================================

*ICFD 
*ICFD_CONTROL_TIME 
7-86 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_CONTROL_TRANSIENT 
Purpose:  This keyword allows to specify diﬀerent integration scheme options for the 
transient solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TORD 
FSORD 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
0 
0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
TORD 
Time integration order : 
EQ.0: Second order. 
EQ.1: First order. 
FSORD 
Fractional step integration order : 
EQ.0: Second order. 
EQ.1: First order. 

================================================================================
PAGE 619
================================================================================

*ICFD_CONTROL_TURBULENCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-87 (ICFD) 
*ICFD_CONTROL_TURBULENCE 
Purpose:  Modify the default values for the turbulence model.  
Card Summary: 
Card 1.  This card is required. 
TMOD 
SUBMOD 
WLAW 
KS 
CS 
 
TWLAW 
TYPLUS 
Card 2a.  This card is read if TMOD = 1. It is optional. 
CE1 
CE2 
SIGMAEPS
SIGMAK 
CMU 
CCUT 
 
 
Card 2b.  This card is read if TMOD = 2 or 3. It is optional. 
Cs 
 
 
 
 
 
 
 
Card 2c.1.  This card is read if TMOD = 4. It is optional. 
GAMMA 
BETA01 
SIGMAW1 
SIGMAK1 
BETA0ST 
CCUT 
 
 
Card 2c.2.  This card is read if TMOD = 4. It is optional. 
A1 
BETA02 
SIGMAW2 
SIGMAK2 
CL 
 
 
 
Card 2d.  This card is read if TMOD = 5. It is optional. 
CB1 
CB2 
SIGMANU 
CNU1 
CW1 
CW2 
 
 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TMOD 
SUBMOD
WLAW 
KS 
CS 
 
TWLAW 
TYPLUS 
Type 
I 
I 
I 
F 
F 
 
I 
F 
Default 
0 
1 
1 
0. 
0. 
 
none 
none 
 
 VARIABLE  
 
DESCRIPTION
TMOD 
Indicates what turbulence model will be used. 

================================================================================
PAGE 620
================================================================================

*ICFD 
*ICFD_CONTROL_TURBULENCE 
7-88 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION
EQ.0: Turbulence model based on a variational multiscale ap-
proach is used by default. 
EQ.1: RANS 푘 - 휀 approach (see Remark 1) 
EQ.2: LES Smagorinsky or dynamic sub-grid scale model 
EQ.3: LES Wall adapting local eddy-viscosity (WALE) model 
EQ.4: RANS 푘 - 푤 approach (see Remark 2) 
EQ.5: RANS Spalart-Allmaras approach 
SUBMOD 
Turbulence sub-model.  
For RANS 푘 - 휀 approach (TMOD = 1): 
EQ.1: Standard model 
EQ.2: Realizable model 
For LES Smagorinsky or dynamic sub-grid model (TMOD = 2): 
EQ.1: Smagorinsky model (see Remark 6) 
EQ.2: Dynamic model (see Remark 7). 
For RANS 푘 - 휔 approach (TMOD = 4): 
EQ.1: Standard Wilcox 98 model. 
EQ.2: Standard Wilcox 06 model. 
EQ.3: SST Menter 2003. 
WLAW 
Law of the wall ID if a RANS turbulence model is selected (see
Remark 4): 
EQ.1: Standard classic law of the wall (default for TMOD = 1)
with linear blending between the log and linear regions.
EQ.2: Standard Launder and Spalding law of the wall 
EQ.4: Nonequilibrium Launder and Spalding law of the wall 
EQ.5: Automatic classic law of the wall 
KS 
Roughness physical height, only used for RANS turbulence mod-
els. 
CS 
Roughness constant, only used for RANS turbulence models. 
TWLAW 
Thermal law of the wall ﬂag (see Remark 8): 
EQ.0: No thermal law of the wall activated. 

================================================================================
PAGE 621
================================================================================

*ICFD_CONTROL_TURBULENCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-89 (ICFD) 
 VARIABLE  
 
DESCRIPTION
EQ.1: Thermal law of the wall 
TYPLUS 
Thermal Y+ value (푌+푡). If 푌+푡 is not deﬁned, the solver will auto-
matically estimate its value using 푌+푡푐= 푌+푐Pr1./3.
⁄
 with 푌+푐=
11.225 the critical 푌+ value and Pr the Prandtl number.  
 
RANS 푘 – 휺 Card.  Optional card if TMOD = 1.  Optional card read if TMOD = 1. See 
Remark 1. 
 Card 2a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CE1 
CE2 
SIGMAE 
SIGMAK 
CMU 
CCUT 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
1.44 
1.92 
1.3 
1.0 
0.09 
-1. 
 
 
 
 VARIABLE  
 
DESCRIPTION
CEPS1 
푘 - 휀 model constant, 퐶1휀  
CEPS2 
푘 - 휀 model constant, 퐶2휀 
SIGMAEPS 
푘 - 휀 model constant, 휎휀 
SIGMAK 
푘 - 휀 model constant, 휎푘 
CMU 
푘 - 휀 model constant, 퐶휇 
CCUT 
푘 - 휀 model constant, 퐶cut 
 
LES Card. Optional card read if TMOD = 2 or 3. 
 Card 2b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
Cs 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
0.18 
 
 
 
 
 
 
 
 

================================================================================
PAGE 622
================================================================================

*ICFD 
*ICFD_CONTROL_TURBULENCE 
7-90 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION
Cs 
Smagorinsky constant if TMOD = 2 and SUBMOD = 1 or WALE
constant if TMOD = 3 
 
RANS 푘 – 흎 Card.  Optional card read if TMOD = 4. See Remark 2. 
Card 2c.1
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
GAMMA 
BETA01 SIGMAW1 SIGMAK1
BETA0ST
CCUT 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
1.44 
0.072 
2. 
2. 
0.09 
-1. 
 
 
 
RANS 푘 – 흎 Card.  Optional card read if TMOD = 4. See Remark 2. 
Card 2c.2
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
A1 
BETA02 SIGMAW2 SIGMAK2
CL 
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
0.31 
0.0828 
2 
2 
0.875 
 
 
 
 
 VARIABLE  
 
DESCRIPTION
GAMMA 
푘 -휔 model constant, 훾 
BETA01 
푘 -휔 model constant, 훽01 
SIGMAW1 
푘 -휔 model constant, 휎휔1 
SIGMAK1 
푘 -휔 model constant, 휎푘1 
BETA0ST 
푘 -휔 model constant, 훽0
∗ 
CCUT 
푘 -휔 model constant, 퐶cut 
A1 
푘 -휔 model constant, 푎1 
BETA02 
푘 -휔 model constant, 훽02 
SIGMAW2 
푘 -휔 model constant, 휎휔2 

================================================================================
PAGE 623
================================================================================

*ICFD_CONTROL_TURBULENCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-91 (ICFD) 
 VARIABLE  
 
DESCRIPTION
SIGMAK2 
푘 -휔 model constant, 휎푘2 
CL 
푘 -휔 model constant, 퐶푙 
 
RANS Spalart-Allmaras Card.  Optional card read if TMOD = 5.  
 Card 2d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
CB1 
CB2 
SIGMANU
CNU1 
CW1 
CW2 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
0.1355 
0.622 
0.66 
7.2 
0.3 
2.0 
 
 
 
 VARIABLE  
 
DESCRIPTION
CB1 
Spalart-Allmaras constant, 퐶푏1 
CB2 
Spalart-Allmaras constant, 퐶푏2 
SIGMANU 
Spalart-Allmaras constant, 휎휈 
CNU1 
Spalart-Allmaras constant, 퐶휈1 
CW1 
Spalart-Allmaras constant, 퐶푤1 
CW2 
Spalart-Allmaras constant, 퐶푤2 
Remarks: 
1. 
풌 -휺 model (TMOD = 1). For the Standard 푘 - 휀 model, the following two equa-
tions are solved for the turbulent kinetic energy (푘) and the turbulent dissipation 
(휀): 
휕푘
휕푡+ 휕(푘푢푖)
휕푥푖
= 휕
휕푥푗
[(휇
휌+ 휇푡
휌휎푘
) 휕푘
휕푥푗
] + 푃푘+ 푃푏−휀+ 푆푘 
휕휀
휕푡+ 휕(휀푢푖)
휕푥푖
= 휕
휕푥푗
[(휇
휌+ 휇푡
휌휎휀
) 휕휀
휕푥푗
] + 퐶1휀
휀
푘푃푘−퐶2휀
휀2
푘+ 푆푒 
Here 푃푘 is the 푘 production term (see Remark 3), 푃푏 is the production term due 
to buoyancy and 푆푘 and 푆푒 are the user deﬁned source terms. 푃푘 and 푃푏 are ex-
pressed as: 

================================================================================
PAGE 624
================================================================================

*ICFD 
*ICFD_CONTROL_TURBULENCE 
7-92 (ICFD) 
R16@bdccd6d07 (03/10/25) 
푃푘= 휇푡
휌푆2 
푃푏= 훽휇푡
휌Pr푡
푔푖
휕푇
휕푥푖
 
where 푆 is the modulus of the mean rate of strain tensor (푆2 = 2푆푖푗푆푖푗), 훽 is the 
coeﬃcient of thermal expansion, and Pr푡 is the turbulent Prandtl number.  The 
turbulent viscosity is then expressed as: 
휇푡= 휌퐶휇
푘2
휀 
For the realizable 푘 - 휀 model, the equation for the turbulent kinetic energy does 
not change, but the equation for the turbulent dissipation is now expressed as: 
휕휀
휕푡+ 휕(휀푢푖)
휕푥푖
= 휕
휕푥푗
[(휇
휌+ 휇푡
휌 휎휀
) 휕휀
휕푥푗
] + 퐶1푆휀−퐶2휀
휀2
푘+ √휇
휌휀
−휀+ 푆푒  . 
Here 퐶1 = max[0.43,
휂
휂+5] with 휂= 푆푘
휀. 
Furthermore, while the turbulent viscosity is still expressed the same way, 퐶휇 is 
no longer a constant: 
퐶휇=
1
퐴0 + 퐴푠푘푈∗
휖
  . 
In the above,  
푈∗= √Ω푖푗Ω푖푗+ 푆푖푗푆푖푗 
퐴0 = 4.04 
퐴푠= √6푐표푠
⎝
⎜⎜⎛1
3 푐표푠−1 (√6
푆푖푗푆푗푘푆푘푖
(푆푖푗푆푖푗)3/2)
⎠
⎟⎟⎞ 
Note that in this case, the constant value 퐶휇 that can be input by you serves as 
the limiting value that 퐶휇 can take.  By default, 퐶휇= 0.09 so: 
0.0009 < 퐶휇< 0.09 
2. 
풌 - 흎 model (TMOD = 4). For the Standard Wilcox 06 푘 - 휔 model, the following 
two equations are solved for the turbulent kinetic energy and the speciﬁc turbu-
lent dissipation rate, respectively 푘 and 휔: 
휕푘
휕푡+ 휕(푘푢푖)
휕푥푖
= 휕
휕푥푗
[(휇
휌+ 휇푡
휌휎푘1
) 휕푘
휕푥푗
] + 푃푘−훽∗푘휔+ 푆푘 
휕휔
휕푡+ 휕(휔푢푖)
휕푥푖
= 휕
휕푥푗
[(휇
휌+
휇푡
휌휎휔1
) 휕휀
휕푥푗
] + 훾휔
푘푃푘−훽휔2 + 휎푑푋푘휔2 + 푆휔 

================================================================================
PAGE 625
================================================================================

*ICFD_CONTROL_TURBULENCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-93 (ICFD) 
Here 푃푘 is the 푘 production term (see Remark 3) and 푆푘 and 푆휔 are the user de-
ﬁned source terms. 푃푘, 훽∗, 훽 and 휎푑 are expressed as: 
푃푘= 휇푡
휌푆2 
훽∗= 훽0
∗푓훽∗ 
훽= 훽01푓훽 
휎푑= {0.     푋푘≤0.
1/8  푋푘> 0. 
where 
푓훽= 1 + 85푋휔
1 + 100푋휔
 
푓훽∗= 1.   
푋푘= 1
휔3
휕푘
휕푥푗
휕휔
휕푥푗
 
푋휔= ∣
Ω푖푗Ω푗푘S푘푖
(훽0
∗휔)3 ∣ 
The turbulent viscosity is then: 
휇푡= 휌
푘
푚푎푥
⎣
⎢⎡휔, 퐶푙√2푆푖푗푆푖푗
훽0
∗
⎦
⎥⎤
 
For the Standard Wilcox 98 model, the following terms are modiﬁed: 
푓훽= 1 + 70푋휔
1 + 80푋휔
푓훽∗=
⎩{{⎨
{{⎧
1
if  푋푘≤0.
1 + 680 푋푘
2
1 + 400  푋푘
2 
if  푋푘> 0.
휎푑= 0.
 
The turbulent viscosity is then: 
휇푡= 휌푘
휔 
For the Menter SST 2003 model, the following equations are solved: 
휕푘
휕푡+ 휕(푘푢푖)
휕푥푖
= 휕
휕푥푗
[(휇
휌+ 휇푡
휌 휎푘
) 휕푘
휕푥푗
] + 푃푘−훽0
∗푘휔+ 푆푘 
휕휔
휕푡+ 휕(휔푢푖)
휕푥푖
= 휕
휕푥푗
[(휇
휌+ 휇푡
휌 휎휔
) 휕휀
휕푥푗
] + 훾
휇푡
푃푘−훽휔2 + 2(1 −퐹1) 휎휔2푋푘휔2 + 푆휔 
Each of the constants, 훾, 훽, 휎푘, and 휎휔 are now computed by a blend of two 
constants with a blending function through: 

================================================================================
PAGE 626
================================================================================

*ICFD 
*ICFD_CONTROL_TURBULENCE 
7-94 (ICFD) 
R16@bdccd6d07 (03/10/25) 
훼= 훼1퐹1 + 훼2(1 −퐹1) 
The blending function 퐹1 is deﬁned by: 
퐹1 = tanh ⟨
⎣
⎢⎡min
⎝
⎜⎜⎛max
⎝
⎜⎜⎛√푘
훽0
∗휔푦, 500휈
푦2휔⎠
⎟⎟⎞, 4휌휎휔2푘
CD × 푦2⎠
⎟⎟⎞
⎦
⎥⎤
4
⟩ 
With 푦 the distance to the nearest wall and: 
CD = max(2휌휎휔2푋푘휔2, 10−10) 
The turbulent viscosity is then: 
휇푡= 휌
푎1푘
max(푎1휔, 푆 퐹2) 
with: 
퐹2 = tanh
⎣
⎢⎢⎡
⎝
⎜⎜⎜⎜⎛max
⎝
⎜⎜⎛2√푘
훽0
∗휔푦, 500휈
푦2휔⎠
⎟⎟⎞
⎠
⎟⎟⎟⎟⎞
2
⎦
⎥⎥⎤
 
3. 
Production term.  You can activate a limiter on the production term,  푃푘, for 
TMOD =1 and 4. If 퐶cut ≥0 (CCUT), then: 
푃푘= {min(푃푘, 퐶cut휀)
    if  TMOD = 1
min(푃푘, 퐶cut훽0
∗푘휔)   if  TMOD = 4 
This is especially common when using the Menter SST 2003 model. 
4. 
Laws of the wall for RANS models.  For RANS models, the following laws of 
the wall are available: 
a) Standard Classic (WLAW = 1) with linear blending when 5 ≤푌+ ≤60. 
푈푏푙푒푛푑
+
(푌+) = (1 −α(푌+)) × 푌+ + α(푌+) × (1/푘ln(퐸푌+)) 
α(푌+) = 푌+ −5
60 −5 
푌+ = 휌푦푈휏
휇
 
푈+ = 푈
푈휏
 
푈휏= √휏푤
휌 
This is the default for TMOD = 1. 
b) Standard Launder and Spalding (WLAW = 2). 

================================================================================
PAGE 627
================================================================================

*ICFD_CONTROL_TURBULENCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-95 (ICFD) 
푈∗=
⎩{⎨
{⎧1
휅ln(퐸푌∗)    if  푌∗> 11.225
푌∗   
otherwise 
 
푌∗=
휌퐶휇
1/4푘1/2푦
휇
 
푈∗=
푈퐶휇
1/4푘1/2
푈휏
2
 
푈휏= √휏푤
휌 
c) Nonequilibrium Launder and Spalding (WLAW = 4).  The nonequilibrium laws 
of the wall modify the expression of the velocity at the wall making it sen-
sitive to the pressure gradient : 
푈̃ = 푈−1
2
푑푝
푑푥⎣
⎢⎡푦푣
휌휅√푘
푙푛( 푦
푦푣
) + 푦−푦푣
휌휅√푘
+ 푦푣
2
휇⎦
⎥⎤ 
with: 
푦푣= 11.225
푦∗
푦 
This law is recommended with TMOD = 1 and in cases of complex ﬂows 
involving separation, reattachment and recirculation. 
d) Automatic Classic (WLAW = 5). The automatic wall law attempts to blend 
the viscous and log layers to better account for the transition zone.  In the 
buﬀer region, we have : 
푈+ = 푈
푈휏
 
푈휏=
⎷
√√
√
(푈
푦+)4 + (
푈
1
휅ln (퐸푦+)
)4
4
 
This is the recommended approach for TMOD = 4. 
5. 
RANS turbulence model with roughness included.  When a RANS turbulence 
model is selected, it is possible to deﬁne extra parameters to account for rough-
ness eﬀects.  In such cases, an extra term will be added to the logarithmic part of 
the diﬀerent laws of the wall: 
푈+ = 1
휅ln(퐸 푌+) −∆퐵 
If we introduce the non-dimensional roughness height: 
 퐾+ =
휌퐾푠퐶휇
1/4푘1/2
휇
  , 

================================================================================
PAGE 628
================================================================================

*ICFD 
*ICFD_CONTROL_TURBULENCE 
7-96 (ICFD) 
R16@bdccd6d07 (03/10/25) 
we have: 
∆퐵=
⎩{{{⎨
{{{⎧0  
for 퐾+ ≤2.25 
1
휅ln (퐾±2.25
87.75 + 퐶푠퐾+) × sin(0.4258(ln 퐾+ −0.811))  for 2.25 < 퐾+ ≤90.0
1
휅ln(1 + 퐶푠퐾+)
for 90. < 퐾+
 
6. 
LES Smagorinksy. The LES Smagorinsky turbulence model uses the Van Driest 
damping function close to the wall: 
푓푣= 1 −푒
−푦+
퐴+ 
7. 
LES dynamic model. The LES dynamic model is based on the model originally 
proposed by Germano et.  al. (1991) and improved by Lilly (1992), with localiza-
tion on Cs by Piomelli and Liu (1995). 
8. 
Thermal law of the wall.  When the thermal law of the wall is activated, the 
turbulent heat ﬂux will be calculated as an additional output variable: 
푄푡= 휌퐶푝
푈휏
푇+
 (푇푠−푇푐) 
푇+ =
⎩{{⎨
{{⎧Pr푡푌+  
if 푌+푡≤푌+푡푐
Pr푡
휗log(푌+) + (3.85Pr푡
1. 3 . −1.3)
2
+ 2.12 log(Pr푡)    otherwise

================================================================================
PAGE 629
================================================================================

*ICFD_CONTROL_TURB_SYNTHESIS 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-97 (ICFD) 
*ICFD_CONTROL_TURB_SYNTHESIS 
Purpose:  This keyword enables the user impose a divergence-free turbulent ﬁeld on in-
lets.  
 
Card must be used jointly with VAD = 4 of keyword *ICFD_BOUNDARY_PRE-
SCRIBED_VEL. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
IU 
IV 
IW 
LS 
 
 
 
Type 
I 
F 
F 
F 
F 
 
 
 
Default 
0 
10-3 
10-3 
10-3 
ℎ푚푖푛 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the surface with the turbulent velocity inlet condition. 
IU, IV, IW 
Intensity of ﬁeld ﬂuctuations over 푥, 푦, and 푧 directions, 
IU = 푢′
푢avg
. 
LS 
Integral length scale of turbulence 
Remarks: 
1. 
If this card is not deﬁned but a turbulent ﬁeld inlet has been activated.  See 
VAD = 4 of *ICFD_BOUNDARY_PRESCRIBED_VEL, the default parameters 
will be used.

================================================================================
PAGE 630
================================================================================

*ICFD 
*ICFD_DATABASE_DRAG 
7-98 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_AVERAGE 
Purpose:  This keyword enables the computation of time average variables at given time 
intervals. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
DT 
Over each DT time interval, an average of the diﬀerent ﬂuid varia-
bles will be calculated and then reset when moving to the next DT 
interval. 
Remarks: 
1. 
The ﬁle name for this database is icfdavg.*.dat with the diﬀerent averaged vari-
able values copied in a ASCII format.

================================================================================
PAGE 631
================================================================================

*ICFD_DATABASE_DRAG 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-99 (ICFD) 
*ICFD_DATABASE_DRAG_{OPTION}  
Available options include 
VOL 
Purpose:  This keyword enables the computation of drag forces over given surface parts 
of the model.  If multiple keywords are given, the forces over the PID surfaces are given 
in separate ﬁles and are also added and output in a separate ﬁle. 
 
For the VOL option, drag calculation can also be applied on a volume deﬁned by ICFD_-
PART_VOL. This is mostly useful in porous media applications to output the pressure 
drag of the porous media domain. 
 
Surface Drag Cards.  Include one card for each surface on which drag is applied.  This 
input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
CPID 
DTOUT 
PEROUT 
DIVI 
ELOUT 
SSOUT 
 
Type 
I 
I 
F 
I 
I 
I 
I 
 
Default 
none 
none 
0. 
0 
10 
0 
0 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the surface where the drag force will be computed. 
CPID 
Center point ID used for the calculation of the force’s moment.  By 
default the reference frame center is used is ퟎ= (0, 0, 0). 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the ICFD timestep will be used. 
PEROUT 
Outputs the contribution of the diﬀerent elements on the total drag 
in fractions of the total drag in the d3plots. 
DIVI 
Number of drag divisions for PEROUT. Default is 10 which means 
the contributions will be grouped in 10 deciles.  
ELOUT 
Outputs the drag value of each element in the d3plots. 
SSOUT 
Outputs the pressure loads caused by the ﬂuid on each solid seg-
ment set in keyword format.  FSI needs to be activated. 

================================================================================
PAGE 632
================================================================================

*ICFD 
*ICFD_DATABASE_DRAG 
7-100 (ICFD) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
1. 
The ﬁle name for this database is icfdragi for instantaneous drag and icfdraga 
for the drag computed using average values of pressure and velocities. 
2. 
The output contains: 
a) “Fpx” , “Fpy”, and “Fpz” refer to the three components of the pressure drag 
force 
퐅푝= ∫푃푑푨, 
where 푃 is the pressure and 퐴 the surface area. 
b) “Fvx”, “Fxy”, and “Fvz” refer to the three components of the viscous drag 
force 
퐅푣= ∫휇휕u
휕y d푨. 
where  휕u
휕y is the shear velocity at the wall, 휇 is the viscosity and 퐴 is the 
surface area. 
c) “Mpx”, “Mpy”, “Mpz”, “Mvx”, “Mvy”, and “Mvz” refer to the three compo-
nents of the pressure and viscous force moments respectively.

================================================================================
PAGE 633
================================================================================

*ICFD_DATABASE_FLUX 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-101 (ICFD) 
*ICFD_DATABASE_FLUX 
Purpose:  This keyword enables the computation of the ﬂow rate and average pressure 
over given parts of the model.  If multiple keywords are given, separate ﬁles are output. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
↓ 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the surface where the ﬂow rates will be computed 
DTOUT 
Output frequency.  Default is at every ﬂuid timestep. 
Remarks: 
1. 
Database Name.  The ﬁle name for this database is icfd_ﬂux.dat. 
2. 
Database Components.  The ﬂux database contains the ﬂow rate through a 
section, called “output ﬂux,” 
훷= ∑(퐕푖⋅퐧푖)퐴푖
푖
  , 
the average pressure, called “Pre-avg,” 
푃avg =
∑푃푖퐴푖
푖
∑퐴푖
푖
  , 
and the total area, called “Areatot.”

================================================================================
PAGE 634
================================================================================

*ICFD 
*ICFD_DATABASE_FLUX_SURF 
7-102 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_FLUX_SURF 
Purpose:  Enable the computation of the ﬂow rate and average pressure over a given 
surface (icfd part) of the model which is not necessary part of the analysis but lies in the 
ﬂuid volume by mapping and interpolating volume results on the given surface. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
↓ 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the surface where the ﬂow rates will be computed 
DTOUT 
Output frequency.  Default is at every ﬂuid timestep. 
Remarks: 
1. 
Database Name.  The ﬁle name for this database is icfd_ﬂuxsurf.dat.

================================================================================
PAGE 635
================================================================================

*ICFD_DATABASE_FORCE_DEM 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-103 (ICFD) 
*ICFD_DATABASE_FORCE_DEM 
Purpose:  Enable the computation of the total ﬂuid force that is transferred to the DEM 
particles over time.  The output is in icfd_force_dem.dat. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUT 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUT 
Flag to enable computing the ﬂuid forces and generating output: 
EQ.0: No output is generated. 
EQ.1: Output is generated. 

================================================================================
PAGE 636
================================================================================

*ICFD 
*ICFD_DATABASE_GOA 
7-104 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_GOA 
Purpose:  Enable the computation of the geometric oriﬁce area (GOA), a quantity of in-
terest used to evaluate valve performance.  The GOA surface connects the free edges of 
the leaﬂets.  It is deﬁned in the ﬂuid mesh as surface mesh.  If multiple keywords exist in 
the input deck, separate ﬁles are output.  It must be used with *MESH_SURFACE_NULL 
which deﬁnes parts where no physics is computed.  These parts are only used for geo-
metrical computations or post-processing.   
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
↓ 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Fluid part ID of the ﬂuid surface mesh where the GOA will be com-
puted (see *MESH_SURFACE_NULL)  
DTOUT 
Output frequency.  The default is at every ﬂuid time step. 
Remarks: 
1. 
Database name.  The ﬁle name for this database is icfd_goa.dat. 
2. 
GOA surface.  Deﬁne the GOA surface in the ﬂuid mechanics problem with 
*MESH_SURFACE_NULL. It is unnecessary to deﬁne *ICFD_PART for any 
*MESH_SURFACE_NULL part IDs.  The surface is automatically excluded from 
the FSI coupling.

================================================================================
PAGE 637
================================================================================

*ICFD_DATABASE_HTC 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-105 (ICFD) 
*ICFD_DATABASE_HTC 
Purpose:  This keyword allows the user to trigger the calculation of the Heat transfer 
coeﬃcient using diﬀerent methods and to control the output options. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUT 
HTC 
TB 
 
 
 
 
OUTDT 
Type 
I 
I 
F 
 
 
 
 
F 
Default 
0 
0. 
0. 
 
 
 
 
0. 
 
 VARIABLE  
 
DESCRIPTION 
OUT 
Determines if the solver should calculate the heat transfer coeﬃ-
cient and how to output it : 
EQ.0: No HTC calculation 
EQ.1: HTC calculated and output in LSPP as a surface variable.
EQ.2: The solver will also look for FSI boundaries and output 
the HTC value at the solid nodes in an ASCII ﬁle called 
icfdhtci.dat. 
EQ.3: The solver will also look for FSI boundaries that are part 
of SEGMENT_SETS and output the HTC for those seg-
ments in an ASCII ﬁle called icfd_convseg.****.key in a 
format that can directly read by LS-DYNA for a subse-
quent pure structural thermal analysis. 
HTC 
Determines how the HTC is calculated. 
EQ.0: Automatically calculated by the solver based on the aver-
age temperature ﬂowing through the pipe section (See Re-
mark 1). 
EQ.1: User imposed value (See Remark 2). 
TB 
Value of the bulk temperature if HTC = 1. 
OUTDT 
Output frequency of the HTC in the various ASCII ﬁles.  If left to 
0., the solver will output the HTC at every timestep. 

================================================================================
PAGE 638
================================================================================

*ICFD 
*ICFD_DATABASE_HTC 
7-106 (ICFD) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
1. 
The heat transfer coeﬃcient is frequently used in thermal applications to esti-
mate the eﬀect of the ﬂuid cooling and it derived from a CFD calculation. 
2. 
The heat transfer coeﬃcient is deﬁned as follows: 
ℎ=
푞
푇푠−푇푏
 
with 푞 the heat ﬂux, 푇푠 the surface temperature and 푇푏 the so called “bulk” tem-
perature.  For external aerodynamic applications, this bulk temperature is often 
deﬁned as a constant (ambient or far ﬁeld conditions, HTC = 1).  However, for 
internal aerodynamic application, this temperature is often deﬁned as an average 
temperature ﬂowing through the pipe section with the ﬂow velocity being used 
as a weighting factor (HTC = 0).

================================================================================
PAGE 639
================================================================================

*ICFD_DATABASE_NODEAVG 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-107 (ICFD) 
*ICFD_DATABASE_NODEAVG 
Purpose:  This keyword enables the computation of the average quantities on surface 
nodes deﬁned in *ICFD_DATABASE_NODOUT.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ON 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ON 
If equal to 1, the average quantities will be computed. 
Remarks: 
1. 
The ﬁle name for this database is icfd_nodeavg.dat.

================================================================================
PAGE 640
================================================================================

*ICFD 
*ICFD_DATABASE_HTC 
7-108 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_NODOUT 
Purpose:  This keyword enables the output of ICFD data on surface nodes.  For data in 
the ﬂuid volume, it is advised to use points or tracers (See *ICFD_DATABASE_-
POINTOUT). 
  
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID1 
NID2 
NID3 
NID4 
NID5 
NID6 
NID7 
NID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be dumped. 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle is generated. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the ICFD timestep will be used. 
NID.. 
Node IDs. 
Remarks: 
1. 
The ﬁle name for this database is icfd_nodout.dat.

================================================================================
PAGE 641
================================================================================

*ICFD_DATABASE_NTEMPOUT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-109 (ICFD) 
*ICFD_DATABASE_NTEMPOUT 
Purpose:  Output the temperature at individual nodes in a format consistent with *ICFD_-
INITIAL_TEMPNODE to initialize a subsequent ICFD problem. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
0.0 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID 
Internal ICFD node ID 
DTOUT 
Output frequency 
EQ.0.0: The ICFD timestep will be used. 

================================================================================
PAGE 642
================================================================================

*ICFD 
*ICFD_DATABASE_NTEMPOUT 
7-110 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_POINTAVG 
Purpose:  This keyword enables the computation of the average quantities on point sets 
using the parameters deﬁned in *ICFD_DATABASE_POINTOUT. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ON 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ON 
If equal to 1, the average quantities will be computed. 
Remarks: 
1. 
The ﬁle name for this database is icfd_psavg.dat.

================================================================================
PAGE 643
================================================================================

*ICFD_DATABASE_POINTOUT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-111 (ICFD) 
*ICFD_DATABASE_POINTOUT 
Purpose:  This keyword enables the output of ICFD data on points.  
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PSID 
DTOUT 
PSTYPE 
VX 
VY 
VZ 
 
 
Type 
I 
F 
I 
F 
F 
F 
 
 
Default 
0 
0. 
0 
0. 
0. 
0. 
 
 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
X 
Y 
Z 
 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PSID 
Point Set ID. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the ICFD timestep will be used. 
PSTYPE 
Point Set type : 
EQ.0: Fixed points. 
EQ.1: Tracer points using prescribed velocity. 
EQ.2: Tracer points using ﬂuid velocity. 
EQ.3: Tracer points using mesh velocity.. 
VX, VY, VZ 
Constant velocities to be used when PSTYPE = 1 
PID 
Point ID 

================================================================================
PAGE 644
================================================================================

*ICFD 
*ICFD_DATABASE_NTEMPOUT 
7-112 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
X, Y, Z 
Point initial coordinates 
Remarks: 
1. 
The ﬁle name for this database is icfd_pointout.dat.

================================================================================
PAGE 645
================================================================================

*ICFD_DATABASE_RESIDUALS 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-113 (ICFD) 
*ICFD_DATABASE_RESIDUALS 
Purpose:  This keyword allows the user to output the residuals of the various systems. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RLVL 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
RLVL 
Residual output level : 
EQ.0: No output. 
EQ.1: Only outputs the number of iterations needed for solving 
the pressure Poisson equation. 
EQ.2: Outputs the number of iterations for the momentum,
pressure, mesh movement and temperature equations. 
EQ.3: Also gives the residual for each iteration during the solve 
of the momentum, pressure, mesh movement and temper-
ature equations. 
Remarks: 
1. 
The ﬁle names for the momentum, pressure, mesh movement and temperature 
equations are called icfd_residuals.moms.dat, icfd_residuals.pres.dat, icfd_re-
siduals.mmov.dat, and icfd_residuals.temp.dat respectively.

================================================================================
PAGE 646
================================================================================

*ICFD 
*ICFD_DATABASE_SSOUT 
7-114 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_SSOUT 
Purpose:  Output the pressure load on a structure from the ﬂuid.  It can be useful for 
linear FSI applications, where the structure is made static, and the loads applied by the 
ﬂuid are retrieved. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUT 
OUTDT 
LCIDSF 
 
 
 
 
POFF 
Type 
I 
I 
I 
 
 
 
 
F 
Default 
0 
0. 
0 
 
 
 
 
0. 
 
 VARIABLE  
 
DESCRIPTION 
OUT 
Determines if the solver should retrieve the pressure loads and 
how to output it: 
EQ.0: Inactive 
EQ.1: The ﬂuid solver will collect the segment sets (see *SET_-
SEGMENT) that are part of a FSI boundary and retrieve 
the pressure for subsequent print out in an icfd_presseg
and icfd_lcsegid pair of ﬁles. 
EQ.2: Same as 1 except the results are collected in a single 
icfd_presseg / icfd_plcsegid pair of ﬁles and the load
curves associated with each segment are made functions 
of time, thus taking the transient nature of the CFD anal-
ysis into account. 
EQ.3: Same as 2 except uses a more memory eﬃcient way of 
handling and outputting the data.  
OUTDT 
Frequency of the pressure extraction.  If left as 0., the solver will
extract the pressure of the ﬂuid on the FSI boundary at every time
step.  This can lead to additional memory and calculation cost. 
LCIDSF 
Optional load curve ID to apply a scale factor on the ﬂuid pressure 
output 
POFF 
Optional pressure oﬀset on the ﬂuid pressure output 

================================================================================
PAGE 647
================================================================================

*ICFD_DATABASE_SSOUT_EXCLUDE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-115 (ICFD) 
*ICFD_DATABASE_SSOUT_EXCLUDE 
Purpose:  This keyword deﬁnes which segment set IDs are excluded from the SSOUT 
search.  No forces coming from the ﬂuid will be transmitted on those segment sets for 
output (see ICFD_DATABASE_SSOUT). 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SSOUTID
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SSOUTID 
Segment Set ID of the solid mechanics problem which is to be ex-
cluded from the output of the ﬂuid forces on the solid boundaries.

================================================================================
PAGE 648
================================================================================

*ICFD 
*ICFD_DATABASE_TEMP 
7-116 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_TEMP 
Purpose:  This keyword enables the computation of the average temperature and the heat 
ﬂux over given parts of the model.  If multiple keywords are given, separate ﬁles are 
output. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID of the surface where the average temperature and heat ﬂux
will be computed. 
DTOUT 
Output frequency.  Default is at every ﬂuid timestep. 
Remarks: 
1. 
The ﬁle name for this database is icfd_thermal.dat. 
2. 
Two average temperature are given in the icfd_thermal.dat ﬁle: “Temp-avg” and 
“Temp-sum”.  The average temperature is calculated using the local node area 
as weighting factor, 
푇avg =
∑
푇푖퐴푖
푁
푖
∑
퐴푖
푁
푖
, 
whereas, the sum is not weighted by area 
푇sum =
∑
푇푖
푁
푖
푁
 
If the mesh is regular, the two values will be of similar value.  The icfd_ther-
mal.dat output ﬁle also includes the average heat ﬂux, the total surface area, and 
the average heat transfer coeﬃcients (See *ICFD_DATABASE_HTC).

================================================================================
PAGE 649
================================================================================

*ICFD_DATABASE_TIMESTEP 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-117 (ICFD) 
*ICFD_DATABASE_TIMESTEP 
Purpose:  This keyword enables the output of ICFD data regarding the ICFD timestep. 
 
Output Options Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTLV 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUTLV 
Determines if the output ﬁle should be dumped. 
EQ.0: No output ﬁle is generated. 
EQ.1: The output ﬁle is generated. 
Remarks: 
1. 
The ﬁle name for this database is icfd_tsout.dat.  
2. 
Outputs the run’s ICFD timestep versus the timestep calculated using the ICFD 
CFL condition as criteria (autotimestep).  This can be useful in cases using a ﬁxed 
timestep where big mesh deformations and/or big ﬂuid velocity changes occur 
in order to track how that ﬁxed timestep value compares to the reference auto-
timestep.

================================================================================
PAGE 650
================================================================================

*ICFD 
*ICFD_DATABASE_TPD 
7-118 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_TPD 
Purpose:  Enable the output of the transvalvular pressure diﬀerence (TPD) data.  The TPD 
is computed by averaging the ﬂuid pressure at two spheres upstream and downstream 
of a valve and computing the diﬀerence between them.   
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
X1 
Y1 
Z1 
X2 
Y2 
Z2 
 
Type 
I 
F 
F 
F 
F 
F 
F 
 
Default 
none 
0. 
0. 
0. 
0. 
0. 
0. 
 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DTOUT 
RAD1 
RAD2 
  
  
  
  
  
Type 
F 
F 
F 
 
 
 
 
 
Default 
↓ 
0. 
0. 
  
  
  
  
  
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID used to plot multiple ﬁles if multiple *ICFD_DATABASE_-
TPD keywords are deﬁned.  
X1, X2, X3 
Coordinates of the center of the upstream sphere where the up-
stream average pressure is computed. 
Y1, Y2, Y3 
Coordinates of the center of the downstream sphere where the 
downstream average pressure is computed. 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the ICFD time step is used. 
R1 
Radius of the upstream sphere 
R2 
Radius of the downstream sphere  

================================================================================
PAGE 651
================================================================================

*ICFD_DATABASE_TPD 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-119 (ICFD) 
Remarks: 
1. 
Output ﬁlename. The ﬁlename for this database is icfd_tpd.dat.  
2. 
Computing TPD.  The TPD is computed as:  
TPD(푡푛) = 푃up(푡푛) −푃down(푡푛)

================================================================================
PAGE 652
================================================================================

*ICFD 
*ICFD_DATABASE_TWINBUILDER 
7-120 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_TWINBUILDER 
Purpose:  Enable the output of ICFD data to be consumed by the Ansys Twin Builder 
static or dynamic ROM module.  If this keyword is active, the solver automatically creates 
a directory tree compatible with the ROM module.  If the model is transient, the dynamic 
ROM format is used.  If the model is steady, the static ROM format is used.  In the dy-
namic case, DTOUT in *ICFD_CONTROL_OUTPUT determines the output frequency.  
The output scenarios are identiﬁed using the job ID for each run.  The job IDs should go 
from 1 to the number of scenarios used to train the ROM. See Remark 1. 
 
Include as many cards as desired.  This input ends at the next keyword (“*”) card.
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTRP 
INEX1 
INEX2 
INEX3 
INEX4 
INEX5 
INEX6 
INEX7 
Type 
A 
A 
A 
A 
A 
A 
A 
A 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
OUTRP 
Name of the output variable or response.  All the ﬁelds are nodal.
EQ.pres: 
Pressure 
EQ.apres: Time average pressure 
EQ.vel: 
Velocity 
EQ.avel: 
Time average velocity 
EQ.lset: 
Level set 
EQ.temp: Temperature 
EQ.atemp: Time average temperature 
INEX1-7 
Name of the input variables or excitations.  Field values like pres-
sure, velocity, and temperature are nodal arrays of boundary con-
ditions.  In the case of material properties, the values written to the
excitation’s ﬁles are scalars.  A combination of up to seven excita-
tions can be used for each output. 
EQ.pres: Pressure values at imposed pressure boundary condi-
tions. 
EQ.vel: 
Velocity values at inﬂow boundary conditions.  

================================================================================
PAGE 653
================================================================================

*ICFD_DATABASE_TWINBUILDER 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-121 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
EQ.temp: Temperature values at imposed temperature bound-
ary conditions. 
EQ.rho: 
Fluid density  
EQ.mu: 
Fluid viscosity 
EQ.hc: 
Heat capacity 
EQ.tc: 
Thermal conductivity 
Remarks: 
1. 
Output structure. This database creates a tree structure of directories that con-
tain the diﬀerent scenarios to be used to train the ROMs.  The root directory 
name is tb_s for a static ROM and tb_d for a dynamic ROM. They are created 
in the location where the executable ﬁle is.  The scenarios are numbered accord-
ing to the job ID of the process.  The user is responsible for providing numerical 
job IDs which are recommended to start from 1 and increase to the number of 
scenarios.

================================================================================
PAGE 654
================================================================================

*ICFD 
*ICFD_DATABASE_UINDEX 
7-122 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DATABASE_UINDEX 
Purpose:  This keyword allows the user to have the solver calculate the uniformity index 
(See Remark 1). 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUT 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
0 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
OUT 
Determines if the solver should calculate the uniformity index. 
EQ.0: Oﬀ. 
EQ.1: On. 
Remarks: 
1. 
Uniformity Index.  The uniformity index is a post treatment quantity which 
measures how uniform the ﬂow is through a given section.  It is especially useful 
in internal aerodynamics cases.  It is expressed as : 
훾= 1 −
1
2푛퐴∑
⎣
⎢⎢⎡√(푢푖−푢̅)2
푢̅
퐴푖
⎦
⎥⎥⎤
푛
푖=1
 
with 퐴푖, the local cell area, 퐴 the total section area, 푢푖 the local velocity, 푢̅ the 
average velocity through the section, and 푛 the number of cells.  
Values close to 0 means that the ﬂow is very unevenly distributed.  This can be 
used to identify bends, corners or turbulent eﬀects.  Values close to 1 imply 
smooth or equally distributed ﬂow through the surface.

================================================================================
PAGE 655
================================================================================

*ICFD_DATABASE_WETNESS 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-123 (ICFD) 
*ICFD_DATABASE_WETNESS 
Purpose:  For free surface problems, output the wetted area as a function of time for a 
given surface part.  It is output to an ASCII ﬁle beginning with icfd_wetness. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SPID 
DTOUT 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
0. 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SPID 
Part ID of the surface where the wetted area will be computed 
DTOUT 
Time interval to print the output.  If DTOUT is equal to 0.0, then 
the ICFD time step will be used. 
Remarks: 
1. 
Wetted Area.  The ICFD solver identiﬁes a surface as wet if its level set value is 
positive.

================================================================================
PAGE 656
================================================================================

*ICFD 
*ICFD_DEFINE_HEATSOURCE 
7-124 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DEFINE_HEATSOURCE 
Purpose:  Deﬁne a volumetric heat source for evaluating the heat equation.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
HSID 
LCID 
ISHAPE 
R 
PTID1 
PTID2 
 
 
Type 
I 
I 
I 
F 
I 
I 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
HSID 
Heat source ID 
LCID 
Load curve ID specifying the evolution of the heat source 
term function of time for the 푋, 푌, and 푍 degrees-of-free-
dom (see *DEFINE_CURVE,*DEFINE_CURVE_FUNC-
TION, or *DEFINE_FUNCTION).  If using a *DEFINE_-
FUNCTION, the following arguments are allowed: f(x, y, 
z, vx, vy, vz, temp, pres, time). 
ISHAPE 
Shape of the volumetric heat source: 
EQ.1: Box shape 
EQ.2: Cylinder shape 
EQ.3: Sphere shape 
R 
Radius of the cylinder if ISHAPE = 2 or radius of the 
sphere if ISHAPE = 3 
PTID1 
Point ID (see *ICFD_DEFINE_POINT) whose meaning de-
pends on ISHAPE: 
ISHAPE.EQ.1: Minimum coordinates of the box  
ISHAPE.EQ.2: Point in the center of one base of the cyl-
inder 
ISHAPE.EQ.3: Center of the sphere 
PTID2 
Point ID (see *ICFD_DEFINE_POINT) whose meaning de-
pends on ISHAPE: 

================================================================================
PAGE 657
================================================================================

*ICFD_DEFINE_HEATSOURCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-125 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
ISHAPE.EQ.1: Maximum coordinates of the box  
ISHAPE.EQ.2: Point in the center of the other base of the 
cylinder 
.

================================================================================
PAGE 658
================================================================================

*ICFD 
*ICFD_DEFINE_POROUS_REGION 
7-126 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DEFINE_POROUS_REGION 
Purpose:  Deﬁne moving isotropic porous regions.  The permeability can be a constant 
value or deﬁned through a time-dependent load curve or *DEFINE_FUNCTION. Alter-
natively (using SENSFLG ≠ 0), this keyword optionally enables pressure sensors to spec-
ify the permeability as a function of the pressure drop across the porous domain length 
(see Remark 1). *ICFD_DEFINE_POINTs determine the locations of the sensors.  The ﬁrst 
sensor is upstream of the region, and the second sensor downstream.  The primary ap-
plication of this feature is modeling the closing and opening of pressure-driven valves 
without the need for more complex moving parts (like leaﬂets).  If points PTID1 and 
PTID2 (and sensors SENSID1 and SENSID2) are attached to a moving part, the points 
move accordingly.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PRID 
ISHAPE 
R 
PTID1 
PTID2 
PERM 
LCID 
SENSFLG
Type 
I 
I 
F 
I 
I 
F 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
0 
0 
 
Sensor Card. Deﬁne only if SENSFLG ≠ 0 on Card 1. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SENSID1 SENSID2 
KMIN 
KMAX 
DLTAPREF
SLOPE 
 
 
Type 
I 
I 
F 
F 
F 
F 
 
 
Default 
none 
none 
none 
none 
0 
0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PRID 
Porous region ID 
ISHAPE 
Shape of the volumetric porous region: 
EQ.1: Box shape, 
EQ.2: Cylinder shape, 
EQ.3: Sphere shape, 

================================================================================
PAGE 659
================================================================================

*ICFD_DEFINE_POROUS_REGION 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-127 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
R 
Radius of the cylinder if ISHAPE = 2. Radius of the sphere if 
ISHAPE = 3. 
PTID1 
Point ID (see *ICFD_DEFINE_POINT) with meaning depending 
on ISHAPE: 
ISHAPE.EQ.1: Minimum coordinates of the box 
ISHAPE.EQ.2: Tail point of the cylinder 
ISHAPE.EQ.3: Center of the sphere 
PTID2 
Point ID with meaning depending on ISHAPE (ignored for 
ISHAPE = 3):  
ISHAPE.EQ.1: Maximum coordinates of the box 
ISHAPE.EQ.2: Head point of the cylinder. 
PERM 
Isotropic permeability, 푘, of the region.  PERM is ignored if LCID 
≠ 0 or SENSFLG = 1. 
LCID 
Load curve ID specifying the evolution of the permeability as a 
function of time for the 푋, 푌, and 푍 degrees of freedom; see *DE-
FINE_CURVE, *DEFINE_CURVE_FUNCTION, or *DEFINE_-
FUNCTION. If a using a *DEFINE_FUNCTION, the following 
parameters are allowed: f(x, y, z, vx, vy, vz, temp, pres, time). Ig-
nored if SENSFLG = 1. 
SENSFLG 
Sensor ﬂag determining whether the permeability is a function of 
the pressure drop computed between the sensors: 
EQ.0: Not a function of pressure drop 
EQ.1: Function of a pressure drop between sensors.  See Re-
mark 1. 
SENSID1 
Sensor (*ICFD_DEFINE_POINT ID) upstream of the porous region
SENSID2 
Sensor (ICFD_DEFINE_POINT ID) downstream of the porous re-
gion 
KMIN 
Minimum permeability for the valve (closed position), 푘min 
KMAX 
Maximum permeability for the valve (open position), 푘max 
DLTAPREF 
Pressure drop that opens/closes the valve, ∆푝ref 

================================================================================
PAGE 660
================================================================================

*ICFD 
*ICFD_DEFINE_POROUS_REGION 
7-128 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
SLOPE 
Slope of the transition from 푘max to 푘min, 푚. See Remark 1. 
Remarks: 
1. 
Permeability as a function of pressure drop.  When SENSFLG = 1, the pres-
sure drop, ∆푝, between two sensors determines the permeability, 푘: 
푘= (푘max −푘min)
2
× (1 + tanh ((∆푝−∆푝ref)
푚
)) + 푘min 
This feature is intended for using the porous region to model the opening and 
closing of a valve.  At a given ∆푝ref, the permeability switches from 푘min to 푘max 
as ∆푝 increases, modeling opening the valve.  The valve closes when the opposite 
occurs.  See Figure 7-7. 
 
k
Δp
Δpref
kmin
kmax
 
Figure 7-7.  Pressure-driven valve law 

================================================================================
PAGE 661
================================================================================

*ICFD_DEFINE_RESIDENCETIMESOURCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-129 (ICFD) 
*ICFD_DEFINE_RESIDENCETIMESOURCE 
Purpose:  Specify a volumetric residence time (RT) source.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RTSID 
ISHAPE 
R 
PTID1 
PTID2 
MASSDIFF
DEATHT 
IRT0PBC 
Type 
I 
I 
F 
I 
i 
F 
F 
I 
Default 
none 
none 
none 
none 
none 
10-6 
↓ 
0 
 
 VARIABLE  
 
DESCRIPTION 
RTSID 
RT source ID 
ISHAPE 
Shape of the volumetric RT source: 
EQ.1: Box 
EQ.2: Cylinder 
EQ.3: Sphere 
R 
Radius of the cylinder if ISHAPE = 2 or radius of the sphere if 
ISHAPE = 3 
PTID1 
ID of a point (see *ICFD_DEFINE_POINT) giving the minimum 
coordinate of the box if ISHAPE = 1, the tail point for the cylinder 
if ISHAPE = 2, or the origin of the sphere if ISHAPE = 3 
PTID2 
ID of a point giving the maximum coordinate of the box if 
ISHAPE = 1 or the head point of the cylinder if ISHAPE = 2.  
MASSDIFF 
Mass diﬀusion for the transport equation 
DEATHT 
End time for the source.  
EQ.0.0: End time of the simulation 
IRT0PBC 
Flag for which prescribed boundaries RT = 0 is imposed: 
EQ.0: Imposed only on boundaries with prescribed velocity 
EQ.1: Imposed on boundaries with either prescribed velocity or
prescribed pressure 

================================================================================
PAGE 662
================================================================================

*ICFD 
*ICFD_DEFINE_SOURCE 
7-130 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DEFINE_SOURCE 
Purpose:  Deﬁne a volumetric external force for the momentum equation solve.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SID 
LCIDX 
LCIDY 
LCIDZ 
SHAPE 
R 
PTID1 
PTID2 
Type 
I 
I 
I 
I 
I 
F 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
SID 
Source ID 
LCIDX/Y/Z 
Load curve IDs specifying the evolution of the volumetric force as 
a function of time for the three global components 
SHAPE 
Shape to which the volumetric force is applied: 
EQ.1: Box  
EQ.2: Cylinder  
EQ.3: Sphere 
R 
Radius of the cylinder or sphere if SHAPE = 2 or 3 
PTID1 
Point ID (see *ICFD_DEFINE_POINT) whose meaning depends on 
SHAPE: 
SHAPE.EQ.1: Minimum coordinates of the box 
SHAPE.EQ.2: Tail point of the cylinder 
SHAPE.EQ.3: Origin of the sphere 
PTID2 
Point ID (see *ICFD_DEFINE_POINT) whose meaning depends on 
SHAPE: 
SHAPE.EQ.1: Maximum coordinates of the box 
SHAPE.EQ.2: Head point of the cylinder 

================================================================================
PAGE 663
================================================================================

*ICFD_DEFINE_SPTRANSPSOURCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-131 (ICFD) 
*ICFD_DEFINE_SPTRANSPSOURCE 
Purpose:  Specify a volumetric species source for the species transport solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SPTRSID 
LCID 
ISHAPE 
R 
PTID1 
PTID2 
MASSDIFF
DEATHT 
Type 
I 
I 
I 
F 
I 
i 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
10-6 
↓ 
 
 VARIABLE  
 
DESCRIPTION 
SPTRSID 
Species transport source ID 
LCID 
Load curve ID specifying the evolution of the species source term 
as a function of time for the 푋, 푌, and 푍 degrees of freedom (see 
*DEFINE_CURVE, *DEFINE_CURVE_FUNCTION, and *DE-
FINE_FUNCTION).  If a *DEFINE_FUNCTION is used, the follow-
ing parameters are allowed: f(x, y,z, vx, vy, vz, temp, pres, time). 
ISHAPE 
Shape of the volumetric species source: 
EQ.1: Box 
EQ.2: Cylinder 
EQ.3: Sphere 
R 
Radius of the cylinder if ISHAPE = 2 or radius of the sphere if 
ISHAPE = 3 
PTID1 
ID of a point (see *ICFD_DEFINE_POINT) giving the minimum 
coordinate of the box if ISHAPE = 1, the tail point for the cylinder 
if ISHAPE = 2, or the origin of the sphere if ISHAPE = 3 
PTID2 
ID of a point giving the maximum coordinate of the box if 
ISHAPE = 1 or the head point of the cylinder if ISHAPE = 2.  
MASSDIFF 
Mass diﬀusion for the transport equation 
DEATHT 
End time for the source.  
EQ.0.0: End time of the simulation 

================================================================================
PAGE 664
================================================================================

*ICFD 
*ICFD_DEFINE_TRANSFORM 
7-132 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_DEFINE_TRANSFORM 
Purpose:  Enable applying translations, rotations, and scaling on the initial surface mesh 
before generating the volume mesh.  This feature makes possible quick changes (such as 
when switching between unit systems) on the geometry without having to manually edit 
the case. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
TRX 
TRY 
TRZ 
SF 
 
 
 
Type 
I 
F 
F 
F 
F 
 
 
 
Default 
none 
0.0 
0.0 
0.0 
1.0 
 
 
 
 
Optional card 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ORX 
ORY 
ORZ 
NX 
NY 
NZ 
ANGLE 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
0. 
0. 
0. 
0. 
0. 
0. 
0. 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Surface PID on which to apply the transformation.  
EQ.0: Apply the transformation to the entire model. 
TRX/TRY/TRZ 
Translation oﬀset in the global 푋, 푌, and 푍-directions 
SF 
Scale factor to be applied on the 푋, 푌, and 푍 coordinates 
ORX/ORY/ORZ 
Origin point of the rotation 
NX/NY/NZ 
Normal for the rotation 
ANGLE 
Angle of rotation (in degrees) 

================================================================================
PAGE 665
================================================================================

*ICFD_DEFINE_TURBSOURCE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-133 (ICFD) 
*ICFD_DEFINE_TURBSOURCE 
Purpose:  Deﬁne an external source for the RANS turbulence equations.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TSID 
LCIDK 
LCIDEP 
LCIDNU 
ISHAPE 
R 
PTID1 
PTID2 
Type 
I 
I 
I 
I 
I 
F 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
TSID 
Turbulent external source ID 
LCIDK 
Load curve ID specifying the evolution of the external 
source term function of time for the turbulent kinetic en-
ergy, 푘, equation (see *DEFINE_CURVE,*DEFINE_-
CURVE_FUNCTION, or *DEFINE_FUNCTION).  If using 
a *DEFINE_FUNCTION, the following arguments are al-
lowed: f(x, y, z, vx, vy, vz, temp, pres, time). 
LCIDEP 
Load curve ID specifying the evolution of the external 
source term function of time for the turbulent diﬀusion, 휀,
or speciﬁc rate of dissipation, 푤, equation (see *DEFINE_-
CURVE,*DEFINE_CURVE_FUNCTION, or *DEFINE_-
FUNCTION).  If using a *DEFINE_FUNCTION, the 
following arguments are allowed: f(x, y, z, vx, vy, vz, temp, 
pres, time). 
LCIDNU 
Load curve ID specifying the evolution of the external 
source term function of time for the kinematic eddy turbu-
lent viscosity equation used in the Spalart-Allmaras model 
(see 
*DEFINE_CURVE,*DEFINE_CURVE_FUNCTION, 
or *DEFINE_FUNCTION).  If using a *DEFINE_FUNC-
TION, the following arguments are allowed: f(x, y, z, vx, 
vy, vz, temp, pres, time). 
ISHAPE 
Shape of the external source: 
EQ.1: Box shape 
EQ.2: Cylinder shape 

================================================================================
PAGE 666
================================================================================

*ICFD 
*ICFD_DEFINE_TURBSOURCE 
7-134 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.3: Sphere shape 
R 
Radius of the cylinder if ISHAPE = 2 or radius of the 
sphere if ISHAPE = 3 
PTID1 
Point ID (see *ICFD_DEFINE_POINT) whose meaning de-
pends on ISHAPE: 
ISHAPE.EQ.1: Minimum coordinates of the box  
ISHAPE.EQ.2: Point in the center of one base of the cyl-
inder 
ISHAPE.EQ.3: Center of the sphere 
PTID2 
Point ID (see *ICFD_DEFINE_POINT) whose meaning de-
pends on ISHAPE: 
ISHAPE.EQ.1: Maximum coordinates of the box  
ISHAPE.EQ.2: Point in the center of the other base of the 
cylinder 
.

================================================================================
PAGE 667
================================================================================

*ICFD_DEFINE_POINT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-135 (ICFD) 
*ICFD_DEFINE_POINT 
Purpose:  This keyword deﬁnes a point in space that could be used for multiple purposes. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
POID 
X 
Y 
Z 
CONSTPID
 
 
 
Type 
I 
F 
F 
F 
I 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
Optional Card 2. Load curve IDS specifying velocity components of translating point 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LCIDX 
LCIDY 
LCIDZ 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
0 
0 
0 
 
 
 
 
 
 
Optional Card 3. Load curve IDS and rotation axis of rotating point 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
LCIDW 
XT 
YT 
ZT 
XH 
YH 
ZH 
 
Type 
I 
F 
F 
F 
F 
F 
F 
 
Default 
0 
none 
none 
none 
none 
none 
none 
 
 
 
 VARIABLE  
 
DESCRIPTION 
POID 
Point ID. 
X/Y/Z 
x, y ,z coordinates for the point. 

================================================================================
PAGE 668
================================================================================

*ICFD 
*ICFD_DEFINE_POINT 
7-136 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
CONSTPID 
Surface Part ID to which the point is constrained.  This 
means that if the selected surface moves, then the locali-
zation of the point will update as well. 
LCIDX/LCIDY/LCIDZ 
The point can be made to translate.  Those are the three 
load curve IDs for the three translation components.  
LCIDW 
The point can also be made to rotate.  This load curve 
speciﬁes the angular velocity. 
XT/YT/ZT 
Rotation axis tail point coordinates. 
XH/YH/ZH 
Rotation axis head point coordinates. 
.

================================================================================
PAGE 669
================================================================================

*ICFD_DEFINE_NONINERTIAL 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-137 (ICFD) 
*ICFD_DEFINE_NONINERTIAL 
Purpose:  Deﬁne a non-inertial reference frame to avoid heavy mesh distortions and 
remeshing associated with large-scale rotations.  This frame helps when modeling spin-
ning cylinders, wind turbines, and turbomachinery. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
W1 
W2 
W3 
R 
PTID 
L 
LCID 
RELV 
Type 
F 
F 
F 
F 
I 
F 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
0 
 
 VARIABLE  
 
DESCRIPTION 
W1, W2, W3 
Rotational velocity, 훚, along the 푋, 푌, and 푍-axes 
R 
Radius of the rotating reference frame.  
GT.0.0: Constant value 
LT.0.0: |R| refers to a *DEFINE_FUNCTION ID. The function 
supports the following arguments: f(x, y, z, vx, vy, vz, 
temp, pres, time). 
 
L
R
+
PTID

 
Figure 7-8.  Example of using a non-inertial reference frame 

================================================================================
PAGE 670
================================================================================

*ICFD 
*ICFD_DEFINE_NONINERTIAL 
7-138 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
PTID 
Starting point ID for the reference frame (See *ICFD_DEFINE_-
POINT) 
L 
Length of the rotating reference frame 
LCID 
Load curve for scaling factor of 훚.  
GT.0: Load curve ID (see *DEFINE_CURVE) for the curve giv-
ing the scale factor as a function of time 
LT.0: |LCID| refers to a *DEFINE_FUNCTION ID. The func-
tion supports the following arguments: f(x, y, z, vx, vy, vz, 
temp, pres, time). 
RELV 
Velocities computed and displayed: 
EQ.0: Relative velocity, only the non-rotating components of the 
velocity are used and displayed. 
EQ.1: Absolute velocity.  All the components of the velocity are
used.  Useful in cases where several or at least one non-
inertial reference frame is combined with an inertial “clas-
sical” reference frame. 

================================================================================
PAGE 671
================================================================================

*ICFD_DEFINE_WAVE_DAMPING 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-139 (ICFD) 
*ICFD_DEFINE_WAVE_DAMPING 
Purpose:  This keyword deﬁnes a damping zone for free surface waves. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
NID 
L 
F1 
F2 
N 
LCID 
 
Type 
I 
I 
F 
F 
F 
I 
I 
 
Default 
none 
none 
 
10 
10 
1 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Point ID deﬁning the start of the damping layer. 
NID 
Normal ID deﬁned using ICFD_DEFINE_POINT and 
pointing to the outgoing direction of the damping layer. 
L 
Length of damping layer.  If no is value speciﬁed, the 
damping layer will have a length corresponding to ﬁve el-
ement lengths.  
F1/F2 
Linear and quadratic damping factor terms. 
N 
Damping term factor. 
LCID 
Load curve ID acting as temporal scale factor on damping 
term. 
 
 

================================================================================
PAGE 672
================================================================================

*ICFD 
*ICFD_DEFINE_WAVE_DAMPING 
7-140 (ICFD) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
1. 
The damping is achieved by adding a source term to the momentum equations 
: 
푠푑= 푤 (푓1 + 푓2|푢|) 푢 
with 푤 the weight function : 
푤= 푒훾−1
푒−1  
 
and γ the blending function which allows a smooth insertion of the source term in 
the damping layer : 
 
훾= ( 푥−푥푠푑
푥푒푑−푥푠푑
)
푛
 
 
푥푠푑 and 푥푒푑 representing the start and end coordinates of the damping zone.

================================================================================
PAGE 673
================================================================================

*ICFD_INITIAL 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-141 (ICFD) 
*ICFD_INITIAL 
Purpose:  Simple initialization of velocity and temperature within a volume. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
Vx 
Vy 
Vz 
T 
P 
 
DFUNC 
Type 
I 
F 
F 
F 
F 
F 
 
I 
Default 
none 
none 
none 
none 
none 
none 
 
0 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID for the volume elements or the surface elements where the 
values are initialized (see *ICFD_PART_VOL and *ICFD_PART). 
PID = 0 to assign the initial condition to all nodes at once. 
Vx 
x coordinate for the velocity. 
Vy 
y coordinate for the velocity. 
Vz 
z coordinate for the velocity. 
T 
Initial temperature. 
P 
Initial Pressure. 
DFUNC 
Option to deﬁne initial conditions using *DEFINE_FUNCTION 
EQ.0: Turned oﬀ. 
EQ.1: Turned on.  All previous ﬂags for initial velocity, pressure
and temperature now refer to *DEFINE_FUNCTION IDs. 
The following parameters are allowed : 푓(푥, 푦, 푧), allowing 
to deﬁne initial proﬁles function of coordinates. 

================================================================================
PAGE 674
================================================================================

*ICFD 
*ICFD_INITIAL_LEVELSET 
7-142 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_INITIAL_LEVELSET 
Purpose:  Deﬁne an initial level set surface instead of a multi-ﬂuid domain (replaces the 
need for *MESH_INTERF).  
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
STYPE 
NX 
NY 
NZ 
X 
Y 
Z 
INVERT 
Type 
I 
F 
F 
F 
F 
F 
F 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
0 
 
 VARIABLE  
 
DESCRIPTION 
STYPE 
Initial surface type: 
EQ.0/1: Generated by a section plane. 
EQ.2: 
Generated by a box.  See Remark 1. 
EQ.3: 
Generated by a sphere. 
EQ.4: 
Generated by a cylinder. 
NX, NY, NZ 
푋, 푌 and 푍 components of the section plane normal if STYPE = 1. 
Minimum coordinates of the box, 푃min, if STYPE = 2. NX is the 
sphere/cylinder radius if STYPE = 3 and STYPE = 4. NY is the cyl-
inder length if STYPE = 4. NZ is the global axis if STYPE = 4 
(NZ = 1, 2, or 3 means 푋-axis, 푌-axis, or 푍-axis, respectively). 
X, Y, Z 
푋, 푌 and 푍 components of the section plane origin point if 
STYPE = 1 and 4. Maximum coordinates of the box, 푃max, if 
STYPE = 2. Coordinates of the sphere origin point if STYPE = 3. 
INVERT 
Inversion of initial level set: 
EQ.0: No inversion.  Positive level set values are assigned to 
nodes contained within the volume deﬁned by STYPE. 
EQ.1: The sign of the initial level set values is reversed. 

================================================================================
PAGE 675
================================================================================

*ICFD_INITIAL_LEVELSET 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-143 (ICFD) 
Remarks: 
1. 
Box Adjacent to Fluid Boundaries.  When STYPE = 2 is used and the box is 
adjacent to the ﬂuid boundaries such as during a dam break simulation, the dis-
tance from any point in the ﬂuid to the ﬂuid boundary must remain smaller than 
the distance to the deﬁned box.  Therefore, the 푃min coordinates need to be de-
ﬁned far outside the initial ﬂuid domain.  
2. 
Multiple Keyword Deﬁnitions. Multiple deﬁnitions of this keyword are possi-
ble, but the diﬀerent shapes generated must not intersect for a correct initializa-
tion. 
 
x
y
water
Pmin
Pmax
Figure 7-9.  2D Dam breaking example with initial levelset surface deﬁned us-
ing STYPE = 2. 푃min is deﬁned suﬃciently far away from the ﬂuid surface
boundaries. 

================================================================================
PAGE 676
================================================================================

*ICFD 
*ICFD_INITIAL_SPTRANSP 
7-144 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_INITIAL_SPTRANSP 
Purpose:  Initialize the concentration of the species being transported within a volume. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
CONC1 
IDFUNC1 
CONC2 
IDFUNC2 
 
 
 
Type 
I 
F 
I 
F 
I 
 
 
 
Default 
0 
none 
0 
none 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID for the volume elements or surface elements where the val-
ues are initialized.  
EQ.0: Assign the initial condition to all nodes at once. 
CONCi 
Initial concentration of species i. CONCi is a *DEFINE_FUNC-
TION ID if IDFUNCi = 1. 
IDFUNCi 
Flag to deﬁne initial conditions using a *DEFINE_FUNCTION: 
EQ.0: Turned oﬀ. 
EQ.1: Turned on.  CONCi is a *DEFINE_FUNCTION ID. The 
following parameters are allowed: f(x, y, z). This allows for 
deﬁning initial proﬁles as a function of coordinates. 

================================================================================
PAGE 677
================================================================================

*ICFD_INITIAL_TEMPNODE 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-145 (ICFD) 
*ICFD_INITIAL_TEMPNODE 
Purpose:  Allow the solver to initialize the temperature at individual nodes. 
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID 
TEMP 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID 
Internal ICFD node ID 
TEMP 
Initial temperature value 

================================================================================
PAGE 678
================================================================================

*ICFD 
*ICFD_INITIAL_TURBULENCE 
7-146 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_INITIAL_TURBULENCE 
Purpose:  Modify the default initial values of the turbulence quantities for a RANS tur-
bulence model.  
 
Include as many cards as needed.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
I 
R 
K 
EW 
 
 
 
Type 
I 
F 
F 
F 
F 
 
 
 
Default 
none 
none 
none 
optional optional
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part ID for the volume elements or the surface elements where the 
values are initialized (see *ICFD_PART_VOL and *ICFD_PART). 
Set PID to 0 to assign the initial condition to all nodes at once. 
I 
Initial turbulence intensity, 퐼 
R 
Initial turbulence viscosity to laminar viscosity ratio (푟= 휇turb 휇
⁄ ).
K 
Initial kinetic energy.  When deﬁned, it replaces the choice of I.  
LT.0.0: |K| refers to a *DEFINE_FUNCTION ID. The following 
parameters are allowed: 푓(푥, 푦, 푧), allowing you to deﬁne 
initial proﬁles as a function of coordinates. 
EW 
Initial turbulence speciﬁc dissipation rate or dissipation rate de-
pending on the choice of turbulence model.  When deﬁned, it re-
places the choice of R.  
LT.0.0: |EW| refers to a *DEFINE_FUNCTION ID. The follow-
ing parameters are allowed: 푓(푥, 푦, 푧), allowing you to 
deﬁne initial proﬁles as a function of coordinates. 
Remarks: 
1. 
Default Initial Conditions.  If no initial conditions have been assigned to a spe-
ciﬁc PID, the solver will automatically pick I = 0.05 (5%) and R = 10000.

================================================================================
PAGE 679
================================================================================

*ICFD_MAT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-147 (ICFD) 
*ICFD_MAT_{OPTION} 
Available options include 
TITLE 
Purpose:  Specify physical properties for the ﬂuid material. 
Fluid Material Card Sets: 
The Material Fluid Parameters Card is required.  If a second card is given, it must be a 
Thermal Fluid Parameters Card.  If the ﬂuid thermal properties are not needed, the sec-
ond card can be a blank card.  With the third card, you can associate the ﬂuid material to 
a non-Newtonian model, to a porous media model, to a species transport model, and/or 
to a viscoelastic model (see *ICFD_MODEL_NONNEWT, *ICFD_MODEL_POROUS, 
*ICFD_MODEL_SPECIES_TRANSPORT, and *ICFD_MODEL_VISCOELASTIC). 
 
Material Fluid Parameters Card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MID 
FLG 
RO 
VIS 
ST 
STSFLCID
CA 
 
Type 
I 
I 
F 
F 
F 
I 
F 
 
Default 
none 
none 
0. 
0. 
0. 
none 
0. 
 
 
Thermal Fluid Parameters Card. Only to be deﬁned if the thermal problem is solved. 
Otherwise include a blank card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
HC 
TC 
BETA 
PRT 
HCSFLCID TCSFLCID
 
 
Type 
F 
F 
F 
F 
I 
I 
 
 
Default 
0. 
0. 
0. 
0.85 
none 
none 
 
 
 

================================================================================
PAGE 680
================================================================================

*ICFD 
*ICFD_MAT 
7-148 (ICFD) 
R16@bdccd6d07 (03/10/25) 
Additional ﬂuid models. Only to be deﬁned if the ﬂuid is non-Newtonian, there is a 
porous media, and/or a species is being transported. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NNMOID 
PMMOID 
 
SPTRID 
 
VID 
 
 
Type 
I 
I 
 
I 
 
I 
 
 
Default 
optional optional
 
optional
 
optional
 
 
 
 VARIABLE  
 
DESCRIPTION 
MID 
Material ID 
FLG 
Flag to choose between fully incompressible, slightly compressible,
or barotropic ﬂows: 
EQ.0: Vacuum (free surface problems only) 
EQ.1: Fully incompressible ﬂuid. 
RO 
Flow density 
VIS 
Dynamic viscosity 
ST 
Surface tension coeﬃcient 
STSFLCID 
Load curve ID for scale factor applied on ST as a function of time. 
See *DEFINE_CURVE, *DEFINE_CURVE_FUNCTION, or *DE-
FINE_FUNCTION.  If a *DEFINE_FUNCTION is used, the follow-
ing parameters are allowed: f( x, y, z, vx, vy, vz, temp, pres, time).
CA 
Contact angle 
HC 
Heat capacity 
TC 
Thermal conductivity 
BETA 
Thermal expansion coeﬃcient used in the Boussinesq approxima-
tion for buoyancy 
PRT 
Turbulent Prandlt number.  Only used if K-Epsilon turbulence 
model selected. 

================================================================================
PAGE 681
================================================================================

*ICFD_MAT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-149 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
HCSFLCID 
Load curve ID for scale factor applied on HC function of time.  See 
*DEFINE_CURVE, *DEFINE_CURVE_FUNCTION, or *DEFINE_-
FUNCTION.  If a *DEFINE_FUNCTION is used, the following pa-
rameters are allowed: f( x, y, z, vx, vy, vz, temp, pres, time). 
TCSFLCID 
Load curve ID for scale factor applied on TC function of time.  See 
*DEFINE_CURVE, *DEFINE_CURVE_FUNCTION, or *DEFINE_-
FUNCTION.  If a *DEFINE_FUNCTION is used, the following pa-
rameters are allowed: f( x, y, z, vx, vy, vz, temp, pres, time). 
NNMOID 
Non-Newtonian model ID. This refers to a non-Newtonian ﬂuid 
model deﬁned using *ICFD_MODEL_NONNEWT. 
PMMOID 
Porous media model ID. This refers to a porous media model de-
ﬁned using *ICFD_MODEL_POROUS. 
SPTRID 
Species transport model ID. This refers to a species transport model
deﬁned using *ICFD_MODEL_SPECIES_TRANSPORT. 
VID 
Viscoelastic model ID. This refers to a viscoelastic model deﬁned
using *ICFD_MODEL_VISCOELASTIC. 

================================================================================
PAGE 682
================================================================================

*ICFD 
*ICFD_MAT 
7-150 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_MODEL_NONNEWT 
Purpose:  Specify a non-newtonian model or a viscosity law that can associated to a ﬂuid 
material. 
 
Non-Newtonian Model ID and type. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NNMOID 
NNID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
Non-Newtonian Fluid Parameters Card.  
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
K 
N 
MUMIN 
LAMBDA 
ALPHA 
TALPHA 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
Default 
0.0 
0.0 
0.0 
1.e30 
0.0 
0.0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NNMOID 
Non-Newtonian Model ID. 
NNID 
Non-Newtonian ﬂuid model type : 
EQ.1 : Power-Law model 
EQ.2 : Carreau model 
EQ.3 : Cross model 
EQ.4 : Herschel-Bulkley model 
EQ.5 : Cross II model 
EQ.6 : Sutherland formula for temperature dependent viscosity
EQ.7 : Power-Law for temperature dependent viscosity 
EQ.8 : Viscosity deﬁned by Load Curve ID or Function ID 

================================================================================
PAGE 683
================================================================================

*ICFD_MODEL_NONNEWT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-151 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
K 
Consistency index if NNID = 1 and 4. Zero shear Viscosity if 
NNID = 2,3 and 5.Reference viscosity if NNID = 6 and NNID = 7. 
Load curve ID or function ID if NNID = 8. 
N 
Measure of the deviation of the ﬂuid from Newtonian (Power Law 
index) for NNID = 1,2,3,4,5,7. Not used for NNID = 6 and 8. 
MUMIN 
Minimum acceptable viscosity value if NNID = 1. Inﬁnite Shear 
Viscosity if NNID = 2,5.Yielding viscosity if NNID = 4.Not used if 
NNID = 3,6,7,8. 
LAMBDA 
Maximum acceptable viscosity value if NNID = 1. Time constant if 
NNID = 2, 3, 5. Yield Stress Threshold if NNID = 4.Sutherland con-
stant if NNID = 6. Not used if NNID = 7,8. 
ALPHA 
Activation energy if NNID = 1, 2. Not used if NNID = 3,4,5,6,7,8. 
TALPHA 
Reference 
temperature 
if 
NNID = 2. 
Not 
used 
if 
NNID = 1,3,4,5,6,7,8 
Remarks: 
1. 
For the Non-Newtonian models, the viscosity is expressed as : 
a) POWER-LAW : 
휇= 푘훾̇푛−1푒훼푇0 푇
⁄  
휇푚푖푛< 휇< 휇푚푎푥 
With 푘 the consistency index, 푛 the power law index, 훼 the activation energy, 푇0 
the initial temperature, 푇 the temperature at any given time 푡, 휇푚푖푛 the mini-
mum acceptable viscosity and 휇푚푎푥 the maximum acceptable viscosity. 
b) CARREAU : 
휇= 휇∞+ (휇0 −휇∞)[1 + (퐻(푇)훾̇휆)2]
(푛−1) 2
⁄  
퐻(푇) = 푒푥푝[훼(
1
푇−푇0
−
1
푇훼−푇0
)] 
With 휇∞ the inﬁnite shear viscosity, 휇0 the zero shear viscosity, 푛 the power law 
index, 휆 a time constant, 훼 the activation energy, 푇0 the initial temperature, 푇 

================================================================================
PAGE 684
================================================================================

*ICFD 
*ICFD_MAT 
7-152 (ICFD) 
R16@bdccd6d07 (03/10/25) 
the temperature at any given time 푡 and 푇훼 the reference temperature at which 
퐻(푇) = 1. 
c) CROSS : 
휇=
휇0
1 + (휆훾̇)1−푛 
With 휇0 the zero shear viscosity, 푛 the power law index and 휆 a time constant. 
d) HERSCHEL-BULKLEY : 
휇= 휇0 푖푓 (훾̇ < 휏0 휇0
⁄
) 
휇= 휏0 + 푘[훾̇푛−(휏0 휇0
⁄
)푛]
훾̇
 
With 푘 the consistency index, 휏0 the Yield stress threshold, 휇0 the yielding vis-
cosity and 푛 the power law index. 
e) CROSS II : 
휇= 휇∞+ 휇0 −휇∞
1 + (휆훾̇)푛 
With 휇0 the zero shear viscosity, 휇∞ the inﬁnite shear viscosity, 푛 the power law 
index and 휆 a time constant. 
2. 
For the temperature dependent viscosity models, the viscosity is expressed as : 
a) SUTHERLAND’s LAW : 
휇= 휇0( 푇
푇0
)3/2 푇0 + 푆
푇+ 푆 
With 휇0 a reference viscosity, 푇0 the initial temperature (which therefore must 
not be 0.), 푇 the temperature at any given time 푡 and 푆 Sutherland’s constant. 
b) POWER LAW : 
휇= 휇0( 푇
푇0
)푛 
With 휇0 a reference viscosity, 푇0 the initial temperature (which therefore must 
not be 0.), 푇 the temperature at any given time 푡 and 푛 the power law index. 

================================================================================
PAGE 685
================================================================================

*ICFD_MODEL_NONNEWT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-153 (ICFD) 
3. 
For NNID = 8, a load curve function of time, a curve function or a function can 
be used.  If it references a DEFINE_FUNCTION, the following arguments are 
allowed 푓(푥, 푦, 푧, 푣푥, 푣푦, 푣푧, 푡푒푚푝 , 푝푟푒푠, 푠ℎ푒푎푟, 푡푖푚푒).

================================================================================
PAGE 686
================================================================================

*ICFD 
*ICFD_MODEL_POROUS 
7-154 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_MODEL_POROUS 
Purpose:  Specify a porous media model. 
Card Summary: 
Card 1.  This card is required. 
PMMOID 
PMMTYPE 
FORM 
RHOCP 
KAPPA 
 
 
 
Card 2a.  This card is included if PMMTYPE = 1, 2, or 8. 
POR 
PER 
FF 
 
PSFLCID 
 
 
 
Card 2b.  This card is included if PMMTYPE = 3 or 10. 
POR 
TH 
 
FABTH 
PVLCID 
 
 
 
Card 2c.  This card is included if PMMTYPE = 4, 6, or 7. 
POR 
 
 
 
 
 
 
 
Card 2d.  This card is included if PMMTYPE = 5. 
POR 
THX 
THY 
THZ 
PVLCIDX 
PVLCIDY 
PVLCIDZ 
 
Card 2e.  This card is included if PMMTYPE = 11. 
POR 
ALPHA 
BETA 
 
 
 
 
 
Card 3.  This card is included if PMMTYPE = 4, 5, 6, or 7 
KXP 
KYP 
KZP 
 
 
 
 
 
Card 4a.  This card is included if PMMTYPE = 4 or 6. 
PROJXPX 
PROJXPY 
PROJXPZ 
PROJYPX 
PROJYPY 
PROJYPZ 
 
 
Card 4b.  This card is included if PMMTYPE = 5 or 7. 
PID1REF 
PID2REF 
 
 
 
 
 
 

================================================================================
PAGE 687
================================================================================

*ICFD_MODEL_POROUS 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-155 (ICFD) 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PMMOID PMMTYPE
FORM 
RHOCP 
KAPPA 
 
 
 
Type 
I 
I 
I 
F 
F 
 
 
 
Default 
none 
none 
0 
0.0 
0.0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PMMOID 
Porous media model ID 
PMMTYPE 
Porous media model type: 
EQ.1: Isotropic porous media - Ergun correlation 
EQ.2: Isotropic porous media - Darcy-Forchheimer model 
EQ.3: Isotropic porous media - permeability deﬁned through 
pressure-velocity data 
EQ.4: Anisotropic porous media.  Fixed local reference frame 
(see Figure 7-10). 
EQ.5: Anisotropic porous media model - moving local refer-
ence frame and permeability vector in local reference 
frame (푥’, 푦’, 푧’)  deﬁned by three pressure-velocity 
curves. 
EQ.6: Anisotropic porous media model - moving local refer-
ence frame and permeability vector constant. 
EQ.7: Anisotropic porous media model - moving local refer-
ence frame and permeability vector constant.  This 
model diﬀers from PMMTYPE = 6 in the way the local 
reference frame is moved. 
EQ.8: Main parachute model to be used jointly with *MESH_-
EMBEDSHELL for the parachute surface.  Similar to 
PMMTYPE = 2.  
EQ.10: Parachute model to be used jointly with *MESH_EM-
BEDSHELL where the fabric permeability and Forchhei-
mer factor are computed from the pressure-velocity 
curves of experimental data given by a *LOAD_CURVE. 
Similar to PMMTYPE = 3. 

================================================================================
PAGE 688
================================================================================

*ICFD 
*ICFD_MODEL_POROUS 
7-156 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.11: Parachute model similar to PMMTYPE = 8, but pressure 
gradient is directly deﬁned by coeﬃcients 훼 and 훽 as:  
훥푃(푢푥)
∆푥
= 훼푢푥+ 훽푢푥
2 . 
FORM 
Porous media formulation: 
EQ.0: Classical (default) 
EQ.2: Interstitial velocity 
RHOCP 
Density of the structure multiplied by the speciﬁc heat of the struc-
ture 
KAPPA 
Thermal conductivity of the structure 
 
Porous Media Parameters Card (PMMTYPE = 1, 2, and 8). This card is included PMM-
TYPE = 1, 2, or 8. 
 Card 2a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
POR 
PER 
FF 
 
PSFLCID 
 
 
 
Type 
F 
F 
F 
 
I 
 
 
 
Default 
0. 
0. 
0. 
 
optional
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
POR 
Porosity, 휀 
PER 
Permeability, 휅 
FF 
Forchheimer factor to be deﬁned if PMMTYPE = 2 or 8.  
PSFLCID 
Optional permeability scale factor load curve ID, *DEFINE_-
CURVE_FUNCTION ID or *DEFINE_FUNCTION ID. If a *DE-
FINE_FUNCTION is used, the following parameters are allowed: 
f( x, y, z, vx, vy, vz, temp, pres, time). 
 

================================================================================
PAGE 689
================================================================================

*ICFD_MODEL_POROUS 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-157 (ICFD) 
Porous Media Parameters Card (PMMTYPE = 3 and 10).  This card is included if 
PMMTYPE = 3 or 10. 
 Card 2b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
POR 
TH 
 
FABTH 
PVLCID 
 
 
 
Type 
F 
F 
 
F 
I 
 
 
 
Default 
0. 
0. 
 
0. 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
POR 
Porosity, 휀 
TH 
Probe thickness if PMMTYPE = 3 
FABTH 
Fabric thickness if PMMTYPE = 10 
PVLCID 
Pressure as a function of velocity load curve ID 
 
Porous Media Parameters Card (PMMTYPE = 4, 6, and 7). This card is included if 
PMMTYPE = 4, 6, or 7. 
 Card 2c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
POR 
 
 
 
 
 
 
 
Type 
F 
 
 
 
 
 
 
 
Default 
0. 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
POR 
Porosity, 휀 
 

================================================================================
PAGE 690
================================================================================

*ICFD 
*ICFD_MODEL_POROUS 
7-158 (ICFD) 
R16@bdccd6d07 (03/10/25) 
Porous Media Parameters Card (PMMTYPE = 5). This card is included if PMM-
TYPE = 5. 
 Card 2d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
POR 
THX 
THY 
THZ 
PVLCIDX 
PVLCIDY 
PVLCIDZ 
 
Type 
F 
F 
F 
F 
I 
I 
I 
 
Default 
0. 
0. 
0. 
0. 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
POR 
Porosity, 휀 
THX 
Probe thickness, ∆푥  
THY 
Probe thickness, ∆푦 
THZ 
Probe thickness, ∆푧  
PVLCIDX 
Load curve ID for pressure as a function of velocity in the global 
푋-direction 
PVLCIDY 
Load curve ID for pressure as a function of velocity in the global 
푌-direction  
PVLCIDZ 
Load curve ID for pressure as a function of velocity in the global 
푍-direction 
 
Porous Media Parameters Card (PMMTYPE = 11). This card is included if PMM-
TYPE = 11. 
 Card 2e 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
POR 
ALPHA 
BETA 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
0. 
0. 
0. 
 
 
 
 
 
 

================================================================================
PAGE 691
================================================================================

*ICFD_MODEL_POROUS 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-159 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
POR 
Porosity, 휀 
ALPHA 
Coeﬃcient, 훼 
BETA 
Coeﬃcient, 훽 
 
Permeability Vector Card in local reference frame. Only to be deﬁned if the porous 
media is anisotropic (PMMTYPE = 4, 5, 6, 7). 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
KXP 
KYP 
KZP 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
0. 
0. 
0. 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
KXP, KYP, 
KZP 
Permeability vector in local reference frame (푥’, 푦’, 푧’). Those values 
become scale factors if PMMTYPE = 5. 
 
Projection of Local Vectors in Global Reference Frame. This card is deﬁned if PMM-
TYPE = 4 or 6. 
 Card 4a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PROJXPX
PROJXPY
PROJXPZ
PROJYPX
PROJYPY
PROJYPZ
 
 
Type 
F/I 
F/I 
F/I 
F/I 
F/I 
F/I 
 
 
Default 
0./0 
0./0 
0./0 
0./0 
0./0 
0./0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PROJXPX, 
PROJXPY, 
PROJXPZ 
Projection of the local permeability vector, 퐱’, in the global refer-
ence frame, (푥, 푦, 푧). If PMMTYPE = 6, PROJXPX, PROJXPY, and 
PRPJXPZ become load curve IDs, so the coordinates of the local 퐱’
vector can change in time. 

================================================================================
PAGE 692
================================================================================

*ICFD 
*ICFD_MODEL_POROUS 
7-160 (ICFD) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
PROJYPX, 
PROJYPY, 
PROJYPZ 
Projection of the local permeability vector, 퐲’, in the global refer-
ence frame, (푥, 푦, 푧). If PMMTYPE = 6, PROJYPX, PROJYPY, and 
PRPJYPZ become load curve IDs, so the coordinates of the local 퐲’
vector can change in time. 
 
Local Reference Frame Vectors. This card is deﬁned if PMMTYPE = 5 or 7. 
 Card 4b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1REF 
PID2REF 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
0 
0. 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID1REF, 
PID2REF 
Two local reference frame vectors are deﬁned by the coordinates 
of the two-point IDs deﬁned by PID1REF and PID2REF. (See 
*ICFD_DEFINE_POINT).  Since those points can be made to move, 
it is therefore possible to deﬁne a moving reference frame for the
anisotropic porous media domain. 
Remarks: 
1. 
Generalized Flow Equations in a Porous Media.  Let 휀 be the porosity and 휅 
be the permeability of the porous media.  Then, 
휀= void volume
total volume  . 
푢푖, the volume averaged velocity ﬁeld, can then be deﬁned in terms of the ﬂuid 
velocity ﬁeld, 푢푖푓, as: 
푢푖= 휀푢푖푓  . 
The generalized ﬂow equations of momentum and mass conservation can be ex-
pressed as:  
휕푢푖
휕푥푖
= 0 
휌
휀[휕푢푖
휕푡+ 휕
휕푥푗
(
푢푖푢푗
휀)] = −1
휀
휕(푃휀)
휕푥푖
+ 휇
휀( 휕2푢푖
휕푥푗휕푥푗
) + 휌푔푖−퐷푖 

================================================================================
PAGE 693
================================================================================

*ICFD_MODEL_POROUS 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-161 (ICFD) 
where 퐷푖 are the forces exerted on the ﬂuid by the porous matrix (see Remarks 2 
and 3).  
2. 
Porous Forces for Isotropic Models.  For the isotropic model, the porous 
forces are a function of the matrix porosity and its permeability.  For the isotropic 
case, three models are available: 
a) Model 1 (Ergun correlation). 
퐷푖= 휇푢푖
휅+
1.75휌|푈|
√150√휅휀3/2 푢푖 
b) Model 2 (Darcy-Forcheimer).  
퐷푖= 휇푢푖
휅+ 퐹휀휌|푈|
√휅
푢푖 
c) Model 3. Using the 훥푃−푉 experimental data.  In this case, it is assumed that 
the pressure-velocity curve was obtained by applying a pressure diﬀerence 
or pressure drop on both ends of a porous slab of thickness 훥푥 with porous 
properties 휅 and 휀. It then becomes possible for the solver to ﬁt that experi-
mental curve with a quadratic polynomial of the form 훥푃(푢푥) = 훼푢푥
2 + 훽푢푥. 
Once 훼 and 훽 are known, it is possible to estimate 퐷푖. 
3. 
Anisotropic Darcy-Forcheimer Term. The anisotropic (see Figure 7-10) ver-
sion of the Darcy-Forcheimer term can be written as: 
퐷푖= 휇퐵푖푗휇푗+ 퐹휀|푈|퐶푖푗푢푗 
퐵푖푗= (퐾푖푗)
−1 
퐶푖푗= (퐾푖푗)
−1/2 
x'
y'
X
Y
u
Figure 7-10.  Anisotropic porous media vectors deﬁnition (PMMTYPE = 4, 5, 6, 
and 7).  The vectors 퐗 and 퐘 are the global axes; 퐱′ and 퐲′ deﬁne the system for 
the primed coordinate(푥′, 푦′, 푧′). 

================================================================================
PAGE 694
================================================================================

*ICFD 
*ICFD_MODEL_POROUS 
7-162 (ICFD) 
R16@bdccd6d07 (03/10/25) 
Here 퐾푖푗 is the anisotropic permeability tensor.

================================================================================
PAGE 695
================================================================================

*ICFD_MODEL_SPECIES_TRANSPORT 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-163 (ICFD) 
*ICFD_MODEL_SPECIES_TRANSPORT 
Purpose:  Specify a species transport model that can be associated with a ﬂuid material. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SPTRID SPTRTYPE
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable MASSDIF1 LCIDDIF1 MASSDIF2 LCIDDIF1
 
 
 
 
Type 
F 
I 
F 
I 
 
 
 
 
Default 
none 
0 
none 
0 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SPTRID 
Species transport model ID 
SPTRTYPE 
Species transport model type: 
EQ.1: Passive species transport 
EQ.2: Passive two-species transport 
MASSDIFi 
Mass diﬀusion of the ith species for the transport equation.  Ignored 
if LCIDDIFi is deﬁned. 
LCIDDIFi 
Load curve ID for the curve giving the mass diﬀusion of the ith spe-
cies as a function of time.  It is optional. 

================================================================================
PAGE 696
================================================================================

*ICFD 
*ICFD_MODEL_VISCOELASTIC 
7-164 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_MODEL_VISCOELASTIC 
Purpose:  Specify a viscoelastic model that can be associated with a ﬂuid material. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VID 
VTYPE 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PVISC 
RTIME 
 
 
 
 
 
 
Type 
F 
F 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
VID 
Viscoelastic model ID 
VTYPE 
Viscoelastic model type: 
EQ.1: Oldroyd-B model 
PVISC 
Polymeric viscosity 
RTIME 
Relaxation time 

================================================================================
PAGE 697
================================================================================

*ICFD_PART 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-165 (ICFD) 
*ICFD_PART_{OPTION} 
Available options include 
TITLE 
Purpose:  Deﬁne parts for this incompressible ﬂow solver. 
 
The TITLE option allows the user to deﬁne an additional optional line with a HEADING 
in order to associate a name to the part. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
HEADING 
Type 
A 
Default 
none 
 
Part Material Card. Include as many cards as needed.  This input ends at the next 
keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
SECID 
MID 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part identiﬁer for ﬂuid surfaces. 
SECID 
Section identiﬁer deﬁned with the *ICFD_SECTION card. 
MID 
Material identiﬁer deﬁned with the *ICFD_MAT card. 

================================================================================
PAGE 698
================================================================================

*ICFD 
*ICFD_PART_VOL 
7-166 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_PART_VOL_{OPTION} 
Available options include 
TITLE 
Purpose:  This keyword assigns material properties to the nodes enclosed by surface 
ICFD parts. 
 
The TITLE option allows the user to deﬁne an additional optional line with a HEADING 
in order to associate a name to the part. 
 
Title 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
HEADING 
Type 
A 
Default 
none 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
SECID 
MID 
 
 
 
 
 
Type 
I 
I 
I 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
Provide as many cards as necessary.  This input ends at the next keyword (“*”) card 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SPID1 
SPID2 
SPID3 
SPID4 
SPID5 
SPID6 
SPID7 
SPID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 

================================================================================
PAGE 699
================================================================================

*ICFD_PART_VOL 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-167 (ICFD) 
 VARIABLE  
 
DESCRIPTION 
PID 
Part identiﬁer for ﬂuid volumes. 
SECID 
Section identiﬁer deﬁned by the *ICFD_SECTION card. 
MID 
Material identiﬁer. 
SPID1, … 
Part IDs for the surface elements that deﬁne the volume mesh. 
 
 
 
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 
$$$$  *ICFD_PART_VOL 
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 
$ 
$ PART ID 5 is defined by the surfaces that enclose it. 
$ 
*ICFD_PART_VOL 
$ 
$...>....1....>....2....>....3....>....4....>....5....>....6....>....7....>....8 
$      pid       secid       mid 
        5          1          1 
$...>....1....>....2....>....3....>....4....>....5....>....6....>....7....>....8 
$      pid1      pid2      pid3      pid4      pid5      pid6      pid7      pid8 
         1         2         3         4
PID 3
PID 1
PID 2
PID 3
PID 4
PID 5

================================================================================
PAGE 700
================================================================================

*ICFD 
*ICFD_SECTION 
7-168 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_SECTION 
Purpose:  Deﬁne a section for the incompressible ﬂow solver. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SID 
Section identiﬁer. 

================================================================================
PAGE 701
================================================================================

*ICFD_SET_NODE_LIST 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-169 (ICFD) 
*ICFD_SET_NODE_LIST 
Purpose:  Only used in cases where the mesh is speciﬁed by the user (See *MESH_VOL-
UME_ELEMENT).  Deﬁnes a set of nodes associated with a part ID on which boundary 
conditions can be applied. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SID 
PID 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
none 
 
 
 
 
 
 
 
Node List Card. Provide as many cards as necessary.  This input ends at the next 
keyword (“*”) card 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NID1 
NID2 
NID3 
NID4 
NID5 
NID6 
NID7 
NID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
SID 
Set ID 
PID 
Associated Part ID.  
NID1, … 
Node IDs 
Remarks: 
1. 
The convention is the similar to the one used by the keyword *SET_NODE_LIST 
and serves a similar purpose.

================================================================================
PAGE 702
================================================================================

*ICFD 
*ICFD_SOLVER_SPLIT 
7-170 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_SOLVER_SPLIT 
Purpose:  This keyword provides an option to trigger an iterative procedure on the ﬂuid 
system.  This procedure aims to bring more precision to the ﬁnal pressure and velocity 
values but is often very time consuming.  It must therefore be used with caution.  It is 
intended only for special cases.  For stability purposes, this method is automatically used 
for the ﬁrst ICFD time step. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
NIT 
TOL 
 
 
 
 
 
 
Type 
I 
F 
 
 
 
 
 
 
Default 
1 
10-3 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NIT 
Maximum Number of iterations of the system for each ﬂuid time 
step.  If TOL criteria is not reached after NIT iterations, the run will 
proceed. 
TOL 
Tolerance Criteria for the pressure residual during the ﬂuid system 
solve. 

================================================================================
PAGE 703
================================================================================

*ICFD_SOLVER_TOL_FSI 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-171 (ICFD) 
*ICFD_SOLVER_TOL_FSI 
Purpose:  This keyword allows the user to change the default tolerance values for the 
Newton Raphson loop in the strong FSI analysis.  Care should be taken when deviating from 
the default values. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ATOL 
RTOL 
 
MAXIT 
 
 
 
 
Type 
F 
F 
 
I 
 
 
 
 
Default 
10-5 
10-5 
 
1000 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ATOL 
Absolute convergence criteria.  Convergence is achieved when 
Residual푖+1 −Residual푖≤ATOL. If a negative integer is entered, 
then that value will be used as a load curve ID for ATOL. 
RTOL 
Relative convergence criteria.  Convergence is achieved when 
(Residual푖+1 −Residual푖) Residualinitial
⁄
≤푅푇푂퐿. If a negative in-
teger is entered, then that value will be used as a load curve ID for 
RTOL. 
MAXIT 
Maximum number of iterations allowed to achieve convergence.  If 
a negative integer is entered, then that value will be used as a load 
curve ID for MAXIT. 

================================================================================
PAGE 704
================================================================================

*ICFD 
*ICFD_SOLVER_TOL_LSET 
7-172 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_SOLVER_TOL_LSET 
Purpose:  This keyword allows the user to change the default tolerance values for the 
advection equation for levelset.  Care should be taken when deviating from the default values. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ATOL 
RTOL 
 
MAXIT 
 
 
 
 
Type 
F 
F 
 
I 
 
 
 
 
Default 
10-8 
10-8 
 
1000 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ATOL 
Absolute convergence criteria.  Convergence is achieved when 
Residual푖+1 −Residual푖≤ATOL. If a negative integer is entered, 
then that value will be used as a load curve ID for ATOL. 
RTOL 
Relative convergence criteria.  Convergence is achieved when 
(Residual푖+1 −Residual푖) Residualinitial
⁄
≤푅푇푂퐿. If a negative in-
teger is entered, then that value will be used as a load curve ID for 
RTOL. 
MAXIT 
Maximum number of iterations allowed to achieve convergence.  If 
a negative integer is entered, then that value will be used as a load
curve ID for MAXIT. 

================================================================================
PAGE 705
================================================================================

*ICFD_SOLVER_TOL_MMOV 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-173 (ICFD) 
*ICFD_SOLVER_TOL_MMOV 
Purpose:  This keyword allows the user to change the default tolerance values for the 
mesh movement algorithm. Care should be taken when deviating from the default values. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ATOL 
RTOL 
 
MAXIT 
 
DISPTOL 
 
 
Type 
F 
F 
 
I 
 
F 
 
 
Default 
1e-8 
1e-8 
 
1000 
 
0. 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ATOL 
Absolute convergence criteria.  Convergence is achieved when 
Residual푖+1 −Residual푖≤ATOL. If a negative integer is entered, 
then that value will be used as a load curve ID for ATOL. 
RTOL 
Relative convergence criteria.  Convergence is achieved when 
(Residual푖+1 −Residual푖) Residualinitial
⁄
≤RTOL. If a negative in-
teger is entered, then that value will be used as a load curve ID for 
RTOL. 
MAXIT 
Maximum number of iterations allowed to achieve convergence.  If 
a negative integer is entered, then that value will be used as a load
curve ID for MAXIT. 
DISPTOL 
Element deformation tolerance before a matrix reassembly is trig-
gered.  Default is 0. which means any element deformation de-
tected will automatically trigger a matrix reassembly.  Higher 
values will potentially save calculation times at the expense of ac-
curacy.  

================================================================================
PAGE 706
================================================================================

*ICFD 
*ICFD_SOLVER_TOL_MOM 
7-174 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_SOLVER_TOL_MOM 
Purpose:  This keyword allows the user to change the default tolerance values for the 
momentum equation solve. Care should be taken when deviating from the default values. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ATOL 
RTOL 
 
MAXIT 
 
 
 
 
Type 
F 
F 
 
I 
 
 
 
 
Default 
10-8 
10-8 
 
1000 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ATOL 
Absolute convergence criteria.  Convergence is achieved when 
Residual푖+1 −Residual푖≤ATOL. If a negative integer is entered, 
then that value will be used as a load curve ID for ATOL. 
RTOL 
Relative convergence criteria.  Convergence is achieved when 
(Residual푖+1 −Residual푖) Residualinitial
⁄
≤RTOL. If a negative in-
teger is entered, then that value will be used as a load curve ID for 
RTOL. 
MAXIT 
Maximum number of iterations allowed to achieve convergence.  If 
a negative integer is entered, then that value will be used as a load
curve ID for MAXIT. 

================================================================================
PAGE 707
================================================================================

*ICFD_SOLVER_TOL_MONOLITHIC 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-175 (ICFD) 
*ICFD_SOLVER_TOL_MONOLITHIC 
Purpose:  This keyword allows the user to change the default tolerance values for the 
monolithic solver. Care should be taken when deviating from the default values. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ATOL 
RTOL 
 
MAXIT 
 
 
 
 
Type 
F 
F 
 
I 
 
 
 
 
Default 
10-8 
10-8 
 
1000 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ATOL 
Absolute convergence criteria.  Convergence is achieved when 
Residual푖+1 −Residual푖≤ATOL. If a negative integer is entered, 
then that value will be used as a load curve ID for ATOL. 
RTOL 
Relative convergence criteria.  Convergence is achieved when 
(Residual푖+1 −Residual푖) Residualinitial
⁄
≤RTOL. If a negative in-
teger is entered, then that value will be used as a load curve ID for 
RTOL. 
MAXIT 
Maximum number of iterations allowed to achieve convergence.  If 
a negative integer is entered, then that value will be used as a load
curve ID for MAXIT. 

================================================================================
PAGE 708
================================================================================

*ICFD 
*ICFD_SOLVER_TOL_PRE 
7-176 (ICFD) 
R16@bdccd6d07 (03/10/25) 
*ICFD_SOLVER_TOL_PRE 
Purpose:  Change the default tolerance values for the Poisson equation for pressure.  Care 
should be taken when deviating from the default values. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ATOL 
RTOL 
 
MAXIT 
PREID 
PTOL 
 
 
Type 
F 
F 
 
I 
I 
F 
 
 
Default 
10-8 
10-8 
 
1000 
2 
10-3 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ATOL 
Absolute convergence criteria.  Convergence is achieved when 
Residual푖+1 −Residual푖≤ATOL. If a negative integer is entered, 
then that value will be used as a load curve ID for ATOL. 
RTOL 
Relative convergence criteria.  Convergence is achieved when 
(Residual푖+1 −Residual푖) Residualinitial
⁄
≤RTOL. If a negative in-
teger is entered, then that value will be used as a load curve ID for 
RTOL. 
MAXIT 
Maximum number of iterations allowed to achieve convergence.  If 
a negative integer is entered, then that value will be used as a load
curve ID for MAXIT. 
PREID 
Choice of Preconditioner for the Conjugate Gradient Solve: 
EQ.1: Diagonal Preconditioner 
EQ.2: Incomplete LU factorization 
EQ.5: Global MUMPS factorization 
PTOL 
Preconditioner tolerance (a.k.a Drop Tolerance if PREID = 2) 

================================================================================
PAGE 709
================================================================================

*ICFD_SOLVER_TOL_TEMP 
*ICFD 
R16@bdccd6d07 (03/10/25) 
7-177 (ICFD) 
*ICFD_SOLVER_TOL_TEMP 
Purpose:  This keyword allows the user to change the default tolerance values for the heat 
equation.  To be handled with great care. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ATOL 
RTOL 
 
MAXIT 
 
 
 
 
Type 
F 
F 
 
I 
 
 
 
 
Default 
1e-8 
1e-8 
 
1000 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
ATOL 
Absolute convergence criteria.  Convergence is achieved when 
푅푒푠푖푑푢푎푙푖+1 −푅푒푠푖푑푢푎푙푖≤퐴푇푂퐿. If a negative integer is entered, 
then that value will be used as a load curve ID for ATOL. 
RTOL 
Relative convergence criteria.  Convergence is achieved when 
(푅푒푠푖푑푢푎푙푖+1 −푅푒푠푖푑푢푎푙푖) 푅푒푠푖푑푢푎푙푖푛푖푡푖푎푙
⁄
≤푅푇푂퐿. If a negative inte-
ger is entered, then that value will be used as a load curve ID for 
RTOL. 
MAXIT 
Maximum number of iterations allowed to achieve convergence.  If 
a negative integer is entered, then that value will be used as a load
curve ID for MAXIT. 

================================================================================
PAGE 710
================================================================================


================================================================================
PAGE 711
================================================================================

 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-1 (MESH) 
*MESH 
The keyword *MESH is used to create a mesh that will be used in the analysis.  So far 
only tetrahedral (or triangular in 2D) elements can be generated.  The keyword cards in 
this section are deﬁned in alphabetical order: 
*MESH_BL 
*MESH_BL_SYM 
*MESH_EMBEDSHELL 
*MESH_INTERF 
*MESH_NODE 
*MESH_SIZE 
*MESH_SIZE_SHAPE 
*MESH_SURFACE_ELEMENT 
*MESH_SURFACE_NODE 
*MESH_SURFACE_NULL 
*MESH_VOLUME 
*MESH_VOLUME_ELEMENT 
*MESH_VOLUME_NODE 
*MESH_VOLUME_PART

================================================================================
PAGE 712
================================================================================

*MESH 
*MESH_BL 
8-2 (MESH) 
R16@bdccd6d07 (03/10/25) 
*MESH_BL 
Purpose:  Deﬁne a boundary-layer mesh as a reﬁnement on the volume-mesh.  The 
boundary layer mesh is constructed by subdividing elements near the surface. 
 
Boundary Layer Cards.  Deﬁne as many cards as are necessary.  The next keyword (“*”) 
card terminates this input. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID 
NELTH 
BLTH 
BLFE 
BLST 
BLDR 
 
 
Type 
I 
I 
F 
F 
I 
I 
 
 
Default 
none 
none 
0. 
0. 
0 
0 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PID 
Part identiﬁer for the surface element 
NELTH 
Number of elements normal to the surface (in the boundary layer) 
is NELTH + 1. See Remark 5. 
BLTH 
Boundary layer mesh thickness if BLST = 1 or 2. Growth scale fac-
tor if BLST = 3. Ignored if BLST = 0. See Remark 5. 
BLFE 
Distance between the wall and the ﬁrst volume mesh node if 
BLST = 3. Scaling coeﬃcient if BLST = 1 or 2. Ignored if BLST =0. 
See Remark 5. 
BLST 
Boundary layer mesh generation strategy: 
EQ.0: 2NELTH+1 subdivisions based on surface mesh size (de-
fault).  See Remark 1. 
EQ.1: Power law using BLTH and NELTH with BLFE as a scale
factor.  See Remark 2 and Figure 8-1. 
EQ.2: Geometric series based on BLTH and BLFE.  See Remark 3
and Figure 8-2. 
EQ.3: Repartition following a growth scale factor (BLTH).  See 
Remark 4 and Figure 8-3. 
BLDR 
Boundary layer mesh generation during the dynamic relaxation 
phase when present (see *ICFD_CONTROL_GENERAL): 

================================================================================
PAGE 713
================================================================================

*MESH_BL 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-3 (MESH) 
 VARIABLE  
 
DESCRIPTION 
EQ.0: On.  No distinction for boundary layer mesh generation 
between the dynamic relaxation and transient phases. 
EQ.1: Oﬀ.  Boundary layer mesh is not generated during the dy-
namic relaxation phase. 
Remarks: 
1. 
BLST = 0. For BLST = 0, for every additional NELTH, the automatic volume 
mesher will divide the elements closest to the surface by two so that the smallest 
element in the boundary layer mesh will have an aspect ratio of 2NELTH+1. A 
default boundary layer mesh thickness based on the surface mesh size will be 
chosen. 
2. 
BLST = 1. For a constant repartition of the nodes in the boundary layer, use 
BLST = 1 with BLFE = 1. For BLST = 1, starting from the wall, the position of 
node 푛 in the normal direction is given by: 
푋푛= (
푛
NELTH + 1)
[5×(1−BLFE)]
BLTH
∑
[푖(NELTH + 1)
⁄
][5×(1−BLFE)]
NELTH+1
푖=1
 
3. 
BLST = 2. Setting BLFE = 1 makes BLST = 2 equivalent to BLST = 0 except that 
BLST = 2 allows you to specify the boundary layer thickness instead of automat-
ically using the local surface mesh size.  For BLST = 2, starting from BLTH from 
the wall, each newly inserted node will have its location closer to the wall, fol-
lowing this law: 
푋푛= (0.5 × BLFE)푛× BLTH(1 −0.5 × BLFE) 
4. 
BLST = 3. For BLST = 3, starting from the wall, the position of node 푛 in the 
normal direction is given by: 
푋푛= ∑BLFE × BLTH푖
푛
푖=0
 with 0 ≤푛≤NELTH 
5. 
Dynamically changing boundary layer.  For NELTH, BLTH, and BLFE, setting 
a negative value will point to a time-dependent load curve which enables dy-
namically changing the boundary layer settings in cases involving remeshing 
(including returning a 0 value for the number of elements which eﬀectively dis-
ables the boundary layer).  NELTH and BLTH also accept a *DEFINE_FUNC-
TION as input with time and the x, y, and z coordinates accepted as arguments. 
 
 

================================================================================
PAGE 714
================================================================================

*MESH 
*MESH_BL 
8-4 (MESH) 
R16@bdccd6d07 (03/10/25) 
 
 
 
 
 
 
Figure 8-1.  BLST = 1 example 
 
Figure 8-2.  BLST = 2 example 

================================================================================
PAGE 715
================================================================================

*MESH_BL 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-5 (MESH) 
 
 
Figure 8-3.  BLST = 3 example 

================================================================================
PAGE 716
================================================================================

*MESH 
*MESH_BL_SYM 
8-6 (MESH) 
R16@bdccd6d07 (03/10/25) 
*MESH_BL_SYM 
Purpose:  Specify the part IDs that will have symmetry conditions for the boundary layer.  
On these surfaces, the boundary layer mesh follows the surface tangent.  
 
Boundary Layer with Symmetry Condition Cards. Deﬁne as many cards as necessary. 
The next “*” card terminates the input. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
PID7 
PID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
PID1, … 
Part identiﬁers for the surface element.  This is the surface with 
symmetry. 

================================================================================
PAGE 717
================================================================================

*MESH_EMBEDSHELL 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-7 (MESH) 
*MESH_EMBEDSHELL 
Purpose:  Deﬁne surfaces that the mesher will embed inside the volume mesh.  These 
surfaces will have no thickness and will conform to the rest of the volume mesh having 
matching nodes on the interface.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VOLID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Deﬁne as many cards as are necessary based on the number of PIDs (the next “*” card 
terminates the input.) 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
PID7 
PID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
VOLID 
ID assigned to the new volume in the keyword *MESH_VOLUME. 
The surface mesh size will be applied to this volume. 
PIDn 
Part IDs for the surface elements that will be embedded in the vol-
ume mesh. 

================================================================================
PAGE 718
================================================================================

*MESH 
*MESH_INTERF 
8-8 (MESH) 
R16@bdccd6d07 (03/10/25) 
*MESH_INTERF 
Purpose:  Deﬁne the surfaces that will be used by the mesher to specify ﬂuid interfaces in 
multi-ﬂuid simulations.  
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VOLID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Deﬁne as many cards as are necessary based on the number of PIDs.  This input ends at 
the next keyword (“*”) card. 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
PID7 
PID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
VOLID 
ID assigned to the new volume in the keyword *MESH_VOLUME. 
The interface meshes will be applied to this volume. 
PIDn 
Part IDs for the surface elements. 

================================================================================
PAGE 719
================================================================================

*MESH_NODE 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-9 (MESH) 
*MESH_NODE 
Purpose:  Deﬁne a ﬂuid node and its coordinates.  These nodes are used in the mesh 
generation process by the *MESH_SURFACE_ELEMENT keyword, or as user deﬁned 
volume nodes by the *MESH_VOLUME_ELEMENT keyword. 
 
Node Cards.  Include one additional card for each node.  This input ends at the next 
keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
NID 
X 
Y 
Z 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID 
Node ID. A unique number with respect to the other surface nodes.
X 
푥 coordinate. 
Y 
푦 coordinate. 
Z 
푧 coordinate. 
Remarks: 
1. 
The data card format for the *MESH_NODE keyword is identical to *NODE. 
2. 
The *MESH_NODE keyword supersedes *MESH_SURFACE_NODE, which 
was for surfaces nodes as well as *MESH_VOLUME_NODE for, which was for 
volume nodes in user deﬁned.

================================================================================
PAGE 720
================================================================================

*MESH 
*MESH_SIZE 
8-10 (MESH) 
R16@bdccd6d07 (03/10/25) 
*MESH_SIZE 
Purpose:  Deﬁne the surfaces that will be used by the mesher to specify a local mesh size 
inside the volume.  If no internal mesh is used to specify the size, the mesher will use a 
linear interpolation of the surface sizes that deﬁne the volume enclosure. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VOLID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Deﬁne as many cards as are necessary based on the number of PIDs (the next “*” card 
terminates the input.). 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
PID7 
PID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
VOLID 
ID assigned to the new volume in the keyword *MESH_VOLUME. 
The mesh sizing will be applied to this volume. 
PIDn 
Part IDs for the surface elements that are used to deﬁne the mesh 
size next to the surface mesh. 

================================================================================
PAGE 721
================================================================================

*MESH_SIZE_SHAPE 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-11 (MESH) 
*MESH_SIZE_SHAPE 
Purpose:  Deﬁnes a local mesh size in speciﬁc zones corresponding to given geometrical 
shapes (box, sphere, cylinder, and polynomial).  The solver automatically applies the con-
ditions speciﬁed during the generation of the volume mesh.  This zone does not need to 
be entirely deﬁned in the volume mesh.  In the polynomial case, we recommend deﬁning 
several zones for better mesh size control. 
Card Summary: 
Card Sets. Add as many sets of these cards as needed.  This input ends with the next 
keyword (“*”) card.  
Card 1.  This card is required. 
SNAME 
FORCE 
METHOD 
BT 
DT 
 
 
 
Card 2a.  Include this card if SNAME = box and METHOD = 0.  
MSIZE 
PMINX 
PMINY 
PMINZ 
PMAXX 
PMAXY 
PMAXZ 
 
Card 2b.  Include this card if SNAME = sphere and METHOD = 0. 
MSIZE 
RADIUS 
CENTERX 
CENTERY 
CENTERZ 
 
 
 
Card 2c.  Include this card if SNAME = cylinder and METHOD = 0. 
MSIZE 
RADIUS 
PMINX 
PMINY 
PMINZ 
PMAXX 
PMAXY 
PMAXZ 
Card 2d.  Include this card if SNAME = pol and METHOD = 0. 
MSIZE 
X 
Y 
Z 
NX 
NY 
NZ 
 
Card 2e.  Include this card if METHOD = 1. 
MSIZE 
RADIUS 
PTID1 
PTID2 
 
RMIN 
 
 
Card 2f.  Include this card if METHOD = 2. 
MSIZE 
RADIUS 
NID1 
NID2 
 
 
 
 

================================================================================
PAGE 722
================================================================================

*MESH 
*MESH_SIZE_SHAPE 
8-12 (MESH) 
R16@bdccd6d07 (03/10/25) 
Data Card Deﬁnitions: 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SNAME 
FORCE 
METHOD 
BT 
DT 
 
 
 
Type 
A 
I 
I 
F 
F 
 
 
 
Default 
none 
0 
0 
0. 
1012 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SNAME 
Shape name.  Possibilities include box, cylinder, pol, and sphere. 
FORCE 
Flag to keep the mesh size criteria even after performing remesh-
ing: 
EQ.0: Exclude boundary layer elements (default). 
EQ.1: Include boundary layer elements. 
METHOD 
Speciﬁes which method to use when deﬁning the second card:  
EQ.0: Default, directly input the coordinates. 
EQ.1: Deﬁne the coordinates with *ICFD_DEFINE_POINT IDs. 
See Remark 1. 
EQ.2: Deﬁne the coordinates by using user node IDs from solid 
mechanics.  This method is only available when a solid 
mechanics problem is present.  See Remark 1. 
BT/DT 
Birth and death time of the mesh size area in cases where remesh-
ing occurs. 
 
Box Case. Card 2 for SNAME = box and METHOD = 0 
Cards 2a 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSIZE 
PMINX 
PMINY 
PMINZ 
PMAXX 
PMAXY 
PMAXZ 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 

================================================================================
PAGE 723
================================================================================

*MESH_SIZE_SHAPE 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-13 (MESH) 
 
 VARIABLE  
 
DESCRIPTION 
MSIZE 
Mesh size that needs to be applied in the zone of the shape.  A neg-
ative value points to a *DEFINE_FUNCTION.  If using a *DE-
FINE_FUNCTION, the following parameters are allowed: f(x, y, z, 
time). 
PMINi 
푥, 푦, or 푧 value for the point of minimum coordinates 
PMAXi 
푥, 푦, or 푧 value for the point of maximum coordinates 
 
Sphere Case. Card 2 for SNAME = sphere and METHOD = 0 
Cards 2b 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSIZE 
RADIUS 
CENTERX
CENTERY
CENTERZ
 
 
 
Type 
F 
F 
F 
F 
F 
 
 
 
Default 
none 
none 
none 
none 
none 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSIZE 
Mesh size that needs to be applied in the zone of the shape  
RADIUS 
Radius of the sphere  
CENTERi 
푥, 푦, and 푧 coordinates of the sphere’s center  
 
Cylinder Case. Card 2 for SNAME = cylinder and METHOD = 0 
Cards 2c 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSIZE 
RADIUS 
PMINX 
PMINY 
PMINZ 
PMAXX 
PMAXY 
PMAXZ 
Type 
F 
F 
F 
F 
F 
F 
F 
F 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 

================================================================================
PAGE 724
================================================================================

*MESH 
*MESH_SIZE_SHAPE 
8-14 (MESH) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
MSIZE 
Mesh size that needs to be applied in the zone of the shape  
RADIUS 
Radius of the cylinder 
PMINi 
푥, 푦, or 푧 value for the point of minimum coordinates 
PMAXi 
푥, 푦, or 푧 value for the point of maximum coordinates 
 
Polynomial Case. Card 2 for SNAME = pol and METHOD = 0 
Cards 2d 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSIZE 
X 
Y 
Z 
NX 
NY 
NZ 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
none 
none 
none 
none 
 
 
 VARIABLE  
 
DESCRIPTION 
MSIZE 
Mesh size that needs to be applied in the zone of the shape  
X/Y/Z 
Coordinates of starting point  
NX/NY/NZ 
Direction in which the mesh size will be applied  
 
METHOD = 1 Case.  Card 2 for METHOD = 1. 
Cards 2e 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSIZE 
RADIUS 
PTID1 
PTID2 
 
RMIN 
 
 
Type 
F 
F 
I 
I 
 
F 
 
 
Default 
none 
none 
none 
none 
 
0. 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSIZE 
Mesh size that needs to be applied in the zone of the shape deﬁned
by SNAME 

================================================================================
PAGE 725
================================================================================

*MESH_SIZE_SHAPE 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-15 (MESH) 
 VARIABLE  
 
DESCRIPTION 
RADIUS 
Radius of the sphere if SNAME is sphere or radius of the cylinder
if SNAME is cylinder.  Ignored otherwise. 
PTID1 
Point ID 1, referring to a *ICFD_DEFINE_POINT. It replaces 
PMINi for box and cylinder, X/Y/Z for pol, and CENTER for 
sphere. 
PTID2 
Point ID 2. It is ignored if SNAME is sphere.  It replaces PMAXi for 
box and cylinder and NX/NY/NZ for pol. 
RMIN 
Optional radius available if SNAME is sphere or cylinder to deﬁne
an internal sphere/cylinder where the *MESH_SIZE_SHAPE does 
not apply.  When deﬁned, RMIN should be smaller than RADIUS.
 
METHOD = 2 Case. Card 2 for METHOD=2 
 Cards 2f 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
MSIZE 
RADIUS 
NID1 
NID2 
 
 
 
 
Type 
F 
F 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
MSIZE 
Mesh size that needs to be applied in the zone of the shape deﬁned 
by SNAME 
RADIUS 
Radius of the sphere if SNAME is sphere or radius of the cylinder
if SNAME is cylinder.  Ignored otherwise. 
NID1/NID2 
User node IDs that come from the solid mechanics problem. 
Equivalent usage to PTID1 and PTID2. NID1 replaces PMINi for 
box and cylinder, X/Y/Z for pol, and CENTER for sphere.  NID2 
is ignored if SNAME is sphere.  It replaces PMAXi for box and cyl-
inder and NX/NY/NZ for pol. 
Remarks: 
1. 
Moving coordinates.  METHOD = 2 and 3 have the advantage of allowing the 
region to move since the regions move with *ICFD_DEFINE_POINTs and nodes 

================================================================================
PAGE 726
================================================================================

*MESH 
*MESH_SIZE_SHAPE 
8-16 (MESH) 
R16@bdccd6d07 (03/10/25) 
from the solid mechanics' problem, respectively.  Thus, these methods provide 
control over how the mesh size area evolves as a function of time (in cases where 
remeshing occurs).

================================================================================
PAGE 727
================================================================================

*MESH_SURFACE_ELEMENT 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-17 (MESH) 
*MESH_SURFACE_ELEMENT 
Purpose:  Specify a set of surface elements (quadrilateral or triangular in 3D and linear 
segments in 2D) that will be used by the mesher to construct a volume mesh.  These sur-
face elements may deﬁne the enclosed volume to be meshed, or alternatively they can be 
used to specify diﬀerent mesh sizes inside the volume (see card *MESH_SIZE). 
 
Each solver that supports the *MESH volume mesher for building its volume mesh uses 
the PID given for each surface element specified with this keyword differently. 
1. 
For the *ICFD solver, the *ICFD_PART keyword references the surface mesh 
PIDs. 
2. 
For the *DUALCESE solver, the MSPIDs in *DUALCESE_BOUNDARY_... key-
words cards reference the surface element PIDs.  Note that when the dual CESE 
solver uses *MESH_SURFACE_ELEMENT, this card deﬁnes which boundary 
faces belong to each mesh surface PID. In this case, no other mechanism exists 
for deﬁning these PIDs.  Also, when the dual CESE solver is deﬁned with *MESH 
cards, there should not be any *DUALCESE_SEGMENTSET cards related to the 
dual CESE mesh. 
 
Surface Element Card. Deﬁne as many cards as necessary.  The next keyword (“*”) card 
terminates this input. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
EID 
PID 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EID 
Element ID. A unique number with respect to all *MESH_SUR-
FACE_ELEMENTS cards. 
PID 
Mesh surface part ID. A unique identiﬁer for the surface to which
this mesh surface element belongs. 
N1 
Nodal point 1 
N2 
Nodal point 2 

================================================================================
PAGE 728
================================================================================

*MESH 
*MESH_SURFACE_ELEMENT 
8-18 (MESH) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
N3 
Nodal point 3 
N4 
Nodal point 4 
Remarks: 
1. 
Deﬁning Surface Elements. The convention for deﬁning surface elements is 
the same as for *ELEMENT_SHELL. In the case of a triangular face, N3 = N4. In 
2D N2 = N3 = N4. Note that the accepted card format is 6i8 (not 6i10).

================================================================================
PAGE 729
================================================================================

*MESH_SURFACE_NODE 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-19 (MESH) 
*MESH_SURFACE_NODE 
Purpose:  Deﬁne a node and its coordinates.  These nodes will be used in the mesh gen-
eration process by the *MESH_SURFACE_ELEMENT keyword.  
 
*MESH_NODE supersedes this card; so please use *MESH_NODE instead of this card. 
 
Surface Node Cards.  Include one card for each node.  Include as many cards a 
necessary.  This input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
NID 
X 
Y 
Z 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID 
Node ID.  This NID must be unique within the set of surface nodes.
X 
푥 coordinate. 
Y 
푦 coordinate. 
Z 
푧 coordinate. 

================================================================================
PAGE 730
================================================================================

*MESH 
*MESH_SURFACE_NULL 
8-20 (MESH) 
R16@bdccd6d07 (03/10/25) 
*MESH_SURFACE_NULL 
Purpose:  Specify a set of surface part IDs to be used during post-processing.  The part 
IDs are deﬁned with the *MESH_SURFACE_ELEMENT keyword.  Elements from 
*MESH_SURFACE_ELEMENT that belong to a *MESH_SURFACE_NULL part are not 
used by the mesher to construct a volume mesh.  These surface elements are not involved 
in any physics computation.  
For the *ICFD solver, the *ICFD_PART keyword referencing the null surface mesh PIDs 
is not necessary.  
 
Null Surface Element Card. Deﬁne as many cards as necessary.  The next keyword (“*”) 
card terminates this input. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
 
 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
PIDi 
Mesh surface part ID i 

================================================================================
PAGE 731
================================================================================

*MESH_VOLUME 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-21 (MESH) 
*MESH_VOLUME 
Purpose:  This keyword deﬁnes the volume space that will be meshed.  The boundaries 
of the volume are the surfaces deﬁned by *MESH_SURFACE_ELEMENT. The surfaces 
listed have to be non-overlapping, and should not leave any gaps or open spaces between 
the surface boundaries.  On the boundary between two neighbor surfaces, nodes have to 
be in common (no duplicate nodes) and should match exactly on the interface.  They are 
deﬁned by the keyword *MESH_SURFACE_NODE. This card will be ignored if the vol-
ume mesh is speciﬁed by the user and not generated automatically. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VOLID 
 
 
 
 
 
 
 
Type 
I 
 
 
 
 
 
 
 
Default 
none 
 
 
 
 
 
 
 
 
Deﬁne as many cards as are necessary based on the number of PIDs (the next “*” card 
terminates the input.)
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PID1 
PID2 
PID3 
PID4 
PID5 
PID6 
PID7 
PID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
VOLID 
ID assigned to the new volume. 
PIDn 
Part IDs for the surface elements that are used to deﬁne the volume.

================================================================================
PAGE 732
================================================================================

*MESH 
*MESH_VOLUME_ELEMENT 
8-22 (MESH) 
R16@bdccd6d07 (03/10/25) 
*MESH_VOLUME_ELEMENT 
Purpose:  Specify a set of volume elements for the ﬂuid volume mesh in cases where the 
volume mesh is speciﬁed by the user and not generated automatically.  The nodal point 
are speciﬁed in the *MESH_VOLUME_NODE keyword.  Only tetrahedral elements are 
supported (triangles in 2D). 
 
Volume Element Card. Deﬁne as many cards as necessary.  The next “*” card terminates 
the input. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
EID 
PID 
N1 
N2 
N3 
N4 
 
 
 
 
Type 
I 
I 
I 
I 
I 
I 
 
 
 
 
Default 
none 
none 
none 
none 
none 
none 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
EID 
Element ID. A unique number with respect to all *MESH_VOL-
UME_ELEMENTS cards. 
PID 
Part ID. A unique part identiﬁcation number. 
N1 
Nodal point 1. 
N2 
Nodal point 2. 
N3 
Nodal point 3. 
N4 
Nodal point 4. 
Remarks: 
1. 
The convention is the same used by the keyword *ELEMENT_SOLID.

================================================================================
PAGE 733
================================================================================

*MESH_VOLUME_NODE 
*MESH 
R16@bdccd6d07 (03/10/25) 
8-23 (MESH) 
*MESH_VOLUME_NODE 
Purpose:  Deﬁne a node and its coordinates.  This keyword is only used in cases where 
the ﬂuid volume mesh is provided by the user and is not automatically generated.  It 
serves the same purpose as the *NODE keyword for solid mechanics.  Only tetrahedral 
elements are supported.  
 
*MESH_NODE supersedes this card; so please use *MESH_NODE instead of this card. 
 
Volume Node Cards. Include as many cards in the following format as desired.  This
input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
Variable 
NID 
X 
Y 
Z 
 
 
 
Type 
I 
F 
F 
F 
 
 
 
Default 
none 
0 
0 
0 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
NID 
Node ID. A unique number with respect to the other volume
nodes. 
X 
푥 coordinate. 
Y 
푦 coordinate. 
Z 
푧 coordinate. 

================================================================================
PAGE 734
================================================================================

*MESH 
*MESH_VOLUME_PART 
8-24 (MESH) 
R16@bdccd6d07 (03/10/25) 
*MESH_VOLUME_PART 
Purpose:  Associate a volume part number created by a *MESH_VOLUME card with the 
part number of a part card from a selected solver (designated by the SOLVER ﬁeld). 
 
Mesh Volume Part Card. Include as many cards in the following format as desired.  This 
input ends at the next keyword (“*”) card. 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VOLPRT 
SOLPRT 
SOLVER 
 
 
 
 
 
Type 
I 
I 
A 
 
 
 
 
 
Default 
 
 
 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
VOLPRT 
Part ID of a volume part created by a *MESH_VOLUME card. 
SOLPRT 
Part ID of a part created using SOLVER’s part card. 
SOLVER 
Name of a solver using a mesh created with *MESH cards. 

================================================================================
PAGE 735
================================================================================

 
*STOCHASTIC 
R16@bdccd6d07 (03/10/25) 
9-1 (STOCHASTIC) 
*STOCHASTIC 
 
The keyword *STOCHASTIC is used to describe the particles and numerical details for 
solving a set of stochastic PDEs.  Currently, there are two types of stochastic PDE models 
in the code: a spray model and a model of embedded particles in TBX explosives.  The 
keyword cards for using these models are: 
*STOCHASTIC_SPRAY_PARTICLES 
*STOCHASTIC_TBX_PARTICLES 
 
An additional option “_TITLE” may be appended to all *STOCHASTIC keywords.  If this 
option is used, then an 80 character string is read as a title from the ﬁrst card of that 
keyword's input.  At present, LS-DYNA does not make use of the title.  Inclusion of titles 
gives greater clarity to input decks.

================================================================================
PAGE 736
================================================================================

*STOCHASTIC 
*STOCHASTIC_SPRAY_PARTICLES 
9-2 (STOCHASTIC) 
R16@bdccd6d07 (03/10/25) 
*STOCHASTIC_SPRAY_PARTICLES 
Purpose:  Specify particle and other model details for spray modeling using stochastic 
PDEs that approximate such processes.  A pair of cards is required to specify the charac-
teristics of each nozzle (cards 3 and 4 describe the ﬁrst nozzle). 
 
Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
INJDIST 
IBRKUP 
ICOLLDE 
IEVAP 
IPULSE 
LIMPR 
IDFUEL 
 
Type 
I 
I 
I 
I 
I 
I 
I 
 
Default 
1 
none 
none 
0 
none 
none 
1 
 
 
Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
RHOP 
TIP 
PMASS 
PRTRTE 
STRINJ 
DURINJ 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
 
Nozzle card 1: Provide as many pairs of nozzle cards 1 and 2 as necessary.  This input 
ends at the next keyword (“*”) card (following a nozzle card 2). 
Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
XORIG 
YORIG 
ZORIG 
SMR 
VELINJ 
DRNOZ 
DTHNOZ 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
 

================================================================================
PAGE 737
================================================================================

*STOCHASTIC_SPRAY_PARTICLES 
*STOCHASTIC 
R16@bdccd6d07 (03/10/25) 
9-3 (STOCHASTIC) 
Nozzle card 2: Provide as many pairs of nozzle cards 1 and 2 as necessary.  This input 
ends at the next keyword (“*”) card. 
Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
TILTXY 
TILTXZ 
CONE 
DCONE 
ANOZ 
AMP0 
 
 
Type 
F 
F 
F 
F 
F 
F 
 
 
 
 VARIABLE  
 
DESCRIPTION 
INJDIST 
Spray particle size distribution: 
EQ.1: 
uniform 
EQ.2: 
Rosin-Rammler (default) 
EQ.3: 
Chi-squared degree of 2 
EQ.4: 
Chi-squared degree of 6 
IBRKUP 
Type of particle breakup model: 
EQ.0: 
oﬀ (no breakup) 
EQ.1: 
TAB 
EQ.2: 
KHRT 
ICOLLDE 
Turn collision modeling on or oﬀ 
IEVAP 
Evaporation ﬂag: 
EQ.0: 
oﬀ (no evaporation) 
EQ.1: 
Turn evaporation on (see Remark 1) 
IPULSE 
Type of injection: 
EQ.0: 
continuous injection 
EQ.1: 
sine wave 
EQ.2: 
square wave 
LIMPRT 
Upper limit on the number of parent particles modeled in this 
spray.  This is not used with the continuous injection case (IP-
ULSE = 0). 

================================================================================
PAGE 738
================================================================================

*STOCHASTIC 
*STOCHASTIC_SPRAY_PARTICLES 
9-4 (STOCHASTIC) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
IDFUEL 
Selected spray liquid fuels: 
EQ.1: 
(Default), H2O 
EQ.2: 
Benzene, C6H6 
EQ.3: 
Diesel # 2, C12H26 
EQ.4: 
Diesel # 2, C13H13 
EQ.5: 
Ethanol, C2H5OH 
EQ.6: 
Gasoline, C8H18 
EQ.7: 
Jet-A, C12H23 
EQ.8: 
Kerosene, C12H23 
EQ.9: 
Methanol, CH3OH 
EQ.10: 
N-dodecane, C12H26 
RHOP 
Particle density 
TIP 
Initial particle temperature. 
PMASS 
Total particle mass 
PRTRTE 
Number of particles injected per second for continuous injection. 
STRINJ 
Start of injection(s) 
DURINJ 
Duration of injection(s) 
XORIG 
X-coordinate of center of a nozzle’s exit plane 
YORIG 
Y-coordinate of center of a nozzle’s exit plane 
ZORIG 
Z-coordinate of center of a nozzle’s exit plane 
SMR 
Sauter mean radius 
VELINJ 
Injection velocity 
DRNOZ 
Nozzle radius 
DTHNOZ 
Azimuthal angle (in degrees measured counterclockwise) of the in-
jector nozzle from the j = 1 plane. 

================================================================================
PAGE 739
================================================================================

*STOCHASTIC_SPRAY_PARTICLES 
*STOCHASTIC 
R16@bdccd6d07 (03/10/25) 
9-5 (STOCHASTIC) 
 VARIABLE  
 
DESCRIPTION 
TILTXY 
Rotation angle (in degrees) of the injector in the x-y plane, where 
0.0 points towards the 3 o’clock position (j = 1 line), and the angle 
increases counterclockwise from there. 
TILTXZ 
Inclination angle (in degrees) of the injection in the x-z plane, 
where 0.0 points straight down, x > 0.0 points in the positive x di-
rection, and x < 0.0 points in the negative x direction. 
CONE 
Spray mean cone angle (in degrees) for hollow cone spray; spray 
cone angle (in degrees) for solid cone spray. 
DCONE 
Injection liquid jet thickness in degrees. 
ANOZ 
Area of injector 
AMP0 
Initial amplitude of droplet oscillation at injector 
Remarks: 
1. 
When IEVAP = 1, the keyword input ﬁle must be modiﬁed in a fashion similar 
to a chemistry problem.  This is illustrated in a portion of an example keyword 
ﬁle below.  That is, the following keywords need to be used, along with the in-
clusion of other chemistry-related ﬁles (i.e. evap.inp and the corresponding ther-
modynamics data ﬁle):   
*CHEMISTRY_MODEL 
*CHEMISTRY_COMPOSITION 
*CHEMISTRY_CONTROL_FULL 
*CESE_INITIAL_CHEMISTRY 
 
 
 
$ Setup stochastic particles 
$ 
*STOCHASTIC_SPRAY_PARTICLES 
$  injdist    ibrkup  icollide     ievap    ipulse    limprt    fuelid 
         3         1         0         1         0    100000         1 
$     rhop       tip pmass[Kg]    prtrte   str_inj   dur_inj 
    1000.0      300.      0.01     1.0e7       0.0      10.0 
$  the next card is needed for fireball position and max.  particle velocity: 
$    XORIG     YORIG     ZORIG       SMR   Velinj      Drnoz    Dthnoz 
     0.005     0.005    1.0e-5    5.0e-6    200.0     9.0e-5 
$   TILTXY    TILTXZ      CONE     DCONE     ANOZ       AMP0 
       0.0       0.0      15.0      15.0   2.5e-8        0.0 
$ 
*CHEMISTRY_MODEL 
$ model_id    jacsel    errlim 

================================================================================
PAGE 740
================================================================================

*STOCHASTIC 
*STOCHASTIC_SPRAY_PARTICLES 
9-6 (STOCHASTIC) 
R16@bdccd6d07 (03/10/25) 
        10         1       0.0 
  evap.inp 
 therm.dat 
  tran.dat 
$ 
*CHEMISTRY_COMPOSITION 
$  comp_id  model_id 
        11        10 
$  molefra   Species 
       1.0        O2 
      3.76        N2 
$ 
*CHEMISTRY_CONTROL_FULL 
$   sol_id    errlim 
         5 
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 
$ 
$ Set global initial conditions for fluid 
$ 
*CESE_INITIAL_CHEMISTRY 
$   sol_id   comp_id 
         5        11 
$INITIAL CONDITIONS  
$      uic       vic       wic       ric       pic       tic       hic    
       0.0       0.0       0.0       1.2   101325.     300.0       0.0

================================================================================
PAGE 741
================================================================================

*STOCHASTIC_TBX_PARTICLES 
*STOCHASTIC 
R16@bdccd6d07 (03/10/25) 
9-7 (STOCHASTIC) 
*STOCHASTIC_TBX_PARTICLES 
Purpose:  Specify particle and other model details for stochastic PDEs that model embed-
ded particles in TBX explosives.  Note that the components listed on the corresponding 
*CHEMISTRY_COMPOSITION card are in terms of molar concentrations of the species 
(in units of moles/[length]3, where [length] is the user’s length unit). 
 
For further information on the theory of the TBX model that has been implemented, a 
document on this topic can be found at this URL: 
https://lsdyna.ansys.com/cese-cfd-documentation/ 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
PCOMB 
NPRTCL 
MXCNT 
PMASS 
SMR 
RHOP 
TICP 
T_IGNIT 
Type 
I 
I 
I 
F 
F 
F 
F 
F 
Default 
0 
none 
none 
none 
none 
none 
none 
none 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
INITDST 
AZIMTH 
ALTITD 
CPS/CVS 
HVAP 
EMISS 
BOLTZ 
 
Type 
I 
F 
F 
F 
F 
F 
F 
 
Default 
1 
none 
none 
none 
none 
optional optional
 
Remarks 
 
 
 
 
 
1 
1 
 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
XORIG 
YORIG 
ZORIG 
XVEL 
YVEL 
ZVEL 
FRADIUS 
 
Type 
F 
F 
F 
F 
F 
F 
F 
 
Default 
none 
none 
none 
0.0 
0.0 
0.0 
none 
 
 

================================================================================
PAGE 742
================================================================================

*STOCHASTIC 
*STOCHASTIC_TBX_PARTICLES 
9-8 (STOCHASTIC) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
PCOMB 
Particle combustion model: 
EQ.0: No burning 
EQ.1: K-model 
NPRTCL 
Initial total number of parent particles (discrete particles for calcu-
lation) 
MXCNT 
Maximum allowed number of parent particles (during the simula-
tion) 
PMASS 
Total particle mass 
SMR 
Sort mean particle radius 
RHOP 
Particle density 
TICP 
Initial particle temperature 
T_IGNIT 
Particle ignition temperature 
INITDST 
Initial particle distribution: 
EQ.1: Spatially uniform 
EQ.2: Rosin-Rammler 
EQ.3: Chi-squared 
AZIMTH 
Angle in degrees from the 푥-axis in the 푥푦-plane of the reference 
frame of the TBX explosive (0 < AZMITH < 360) 
ALTITD 
Angle in degrees from the 푧-axis of the reference frame of the TBX 
explosive (0 < ALTITD < 180) 
CPS/CVS 
Heat coeﬃcient 
HVAP 
Latent heat of vaporization 
EMISS 
Particle emissivity 
BOLTZ 
Boltzmann coeﬃcient 
XORIG 
푥-coordinate of the origin of the initial reference frame of the TBX 
explosive 

================================================================================
PAGE 743
================================================================================

*STOCHASTIC_TBX_PARTICLES 
*STOCHASTIC 
R16@bdccd6d07 (03/10/25) 
9-9 (STOCHASTIC) 
 VARIABLE  
 
DESCRIPTION 
YORIG 
푦-coordinate of the origin of the initial reference frame of the TBX 
explosive 
ZORIG 
푧-coordinate of the origin of the initial reference frame of the TBX
explosive 
XVEL 
푥-component of the initial particle velocity of the TBX explosive 
YVEL 
푦-component of the initial particle velocity of the TBX explosive 
ZVEL 
푧-component of the initial particle velocity of the TBX explosive 
FRADIUS 
Radius of the explosive area 
Remarks: 
1. 
Radiation heat transfer.  If radiation heat transfer is being modeled, then 
EMISS and BOLTZ are required.

================================================================================
PAGE 744
================================================================================


================================================================================
PAGE 745
================================================================================

 
*LSO 
R16@bdccd6d07 (03/10/25) 
10-1 (LSO) 
*LSO 
 
These cards provide a general data output mechanism, causing the creation of a sequence 
of LSDA ﬁles.  This facility is intended to allow several diﬀerent time sequences of data 
to be output in the same simulation.  In addition, any number of domains (and any num-
ber of variables on those domains) may be speciﬁed within each time sequence.  The key-
word cards in this section are deﬁned in alphabetical order: 
*LSO_DOMAIN 
*LSO_ID_SET (not available in the single-precision version of LS-DYNA) 
*LSO_POINT_SET 
*LSO_TIME_SEQUENCE 
*LSO_VARIABLE_GROUP 
 
Note that only the mechanics solver is available in the single-precision version of LS-
DYNA, and therefore, only LSO mechanics variables are available for output from single 
precision LS-DYNA.   These mechanics variables are listed by domain type in a separate 
document.  This document (LSO_VARIABLES.TXT) is created by running the command: 
LS-DYNA print_lso_doc.  Contrary to LSO_VARIABLES.TXT,   element quantities such 
as stress are not available for output from the mechanics solver to the “lso” database. 
 
An additional option “_TITLE” may be appended to all *LSO keywords.  If this option is 
used, then an 80 character string is read as a title from the ﬁrst card of that keyword's 
input.  At present, LS-DYNA does not make use of the title.  Inclusion of titles gives 
greater clarity to input decks.

================================================================================
PAGE 746
================================================================================

*LSO 
*LSO_DOMAIN 
10-2 (LSO) 
R16@bdccd6d07 (03/10/25) 
*LSO_DOMAIN 
Purpose: This command provides a way to specify variables on a subset of the domain 
for a given solver.  This domain can be a subset of the mesh used by that solver, a set of 
output points created with *LSO_POINT_SET, or a set of objects created with *LSO_ID_-
SET. The frequency and duration of the output for any given domain is determined by 
each *LSO_TIME_SEQUENCE card that references this *LSO_DOMAIN card. Note that 
for the single-precision version of LS-DYNA, the only allowed value of SOLVER_-
NAME = MECH. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DOMAIN_TYPE 
Type 
A 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SOLVER_NAME 
Type 
A 
 
Special Domains Card. Card 3 when DOMAIN_TYPE is one of ROGO, CIRCUIT, 
THIST_POINT or TRACER_POINT. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTID 
REFID 
 
REDUCT 
 
 
 
 
Type 
I 
I 
 
I 
 
 
 
 
Default 
none 
none 
 
none 
 
 
 
 
 

================================================================================
PAGE 747
================================================================================

*LSO_DOMAIN 
*LSO 
R16@bdccd6d07 (03/10/25) 
10-3 (LSO) 
Miscellaneous Domain Card. Card 3 when DOMAIN_TYPE is one of NODE, PART, 
SEGMENT, SURFACE_NODE, SURFACE_ELEMENT, VOLUME_ELEMENT, SUR-
FACE_PART, VOLUME_PART. 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
OUTID 
REFID 
OVERRIDE
REDUCT 
 
 
 
 
Type 
I 
I 
I 
I 
 
 
 
 
Default 
none 
0 
0 
none 
 
 
 
 
 
Variable Name Card. Provide as many cards as necessary.  This input ends at the next 
keyword (“*”) card 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VARIABLE_NAME 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
DOMAIN_TYPE 
The type of domain for which LSO output may be generated. 
SOLVER_NAME 
Selects the solver from which data is output on this domain.
Accepted entries so far are “MECH”, “EM”, “CESE”, and 
“ICFD”. 
OUTID 
LSO domain ID associated with this domain, and used by 
*LSO_TIME_SEQUENCE cards. 
REFID 
Support set ID. This can be a set deﬁned by a *SET card, a 
*LSO_ID_SET, card, or a *LSO_POINT_SET card.  Unless 
OVERRIDE is speciﬁed, this set must be of the same type as 
DOMAIN_TYPE. 
OVERRIDE 
If non-zero, then REFID is interpreted as: 
EQ.1: a PART set for SOLVER_NAME 
EQ.2: a PART set of volume parts created with a *LSO_ID_-
SET card (volume parts are deﬁned with *MESH_-
VOLUME cards). 

================================================================================
PAGE 748
================================================================================

*LSO 
*LSO_DOMAIN 
10-4 (LSO) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
EQ.3: a PART set of surface parts created with a *LSO_ID_-
SET card (surface parts are deﬁned with *MESH_SUR-
FACE_ELEMENT cards). 
EQ.4: a set of segment sets created with a *LSO_ID_SET card.
REDUCT 
A function that operates on the entire domain and returns a sin-
gle value for scalar variables, three values for vector variables,
or 6 values for symmetric tensor variables.  For RE-
DUCT=“range”, the number of returned values doubles.  The 
following are the supported functions: 
EQ.BLANK: 
no reduction (default) 
EQ.“none”: 
Same as above 
EQ.“avg”: 
the average by component 
EQ.“average”: 
Same as above 
EQ.“min”: 
the minimum by component 
EQ.“minimum”: Same as above 
EQ.“max”: 
the maximum by component 
EQ.“maximum”: Same as above 
EQ.“sum”: 
the sum by component 
EQ.“range”: 
the minimum by component followed by
the maximum by component 
VARIA-
BLE_NAME 
Either the name of a single output variable or a variable group. 
See remarks. 
Remarks: 
1. 
Supported choices for VARIABLE_NAME are listed by DOMAIN_TYPE for 
each SOLVER_NAME in a separate document.  This document (LSO_VARIA-
BLES.TXT) is created by running the command: LS-DYNA print_lso_doc.  The 
following table shows  a sample of the point output variables available when 
DOMAIN_TYPE = THIST_POINT:
 
EM
VECTORS 
magneticF
electricFie
vecpotFie
currentDens
SCALARS 
ScalarPoten
 

================================================================================
PAGE 749
================================================================================

*LSO_ID_SET 
*LSO 
R16@bdccd6d07 (03/10/25) 
10-5 (LSO) 
*LSO_ID_SET 
Purpose:  Provides a way to create a set of existing sets (segment sets), or to deﬁne a set 
that is not available with other set-related keyword cards.  These are then used in other 
*LSO cards to specify LSO output.  This card is not available in the single precision ver-
sion of LS-DYNA. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SETID 
TYPE 
SOLVER 
 
 
 
 
 
Type 
I 
A 
A 
 
 
 
 
 
Default 
none 
none 
MECH 
 
 
 
 
 
 
Referenced IDs. Provide as many cards as necessary.  This input ends at the next 
keyword (“*”) card 
 
Card 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
ID1 
ID2 
ID3 
ID4 
ID5 
ID6 
ID7 
ID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
 VARIABLE  
 
DESCRIPTION 
SETID 
Identiﬁer for this ID set. 

================================================================================
PAGE 750
================================================================================

*LSO 
*LSO_ID_SET 
10-6 (LSO) 
R16@bdccd6d07 (03/10/25) 
 VARIABLE  
 
DESCRIPTION 
TYPE 
The kind of IDs in this set: 
EQ.’SEG_SETS’: 
Each ID is a segment set connected with 
SOLVER. 
EQ.’CIRCUIT’: 
Each ID is a circuit ID (from *EM cards) 
EQ.’SURF_PARTS’: Each ID is a surface part number (See 
*MESH_SURFACE_ELEMENT) 
EQ.’VOL_PARTS’: 
Each ID is a volume part number (See 
*MESH_VOLUME) 
EQ.’SURF_ELES’: 
Each ID is a surface element number (See 
*MESH_SURFACE_ELEMENT) 
SOLVER 
Name of the solver (MECH, ICFD, CESE, EM, …) 
ID1, … 
IDs of the TYPE kind. 

================================================================================
PAGE 751
================================================================================

*LSO_POINT_SET 
*LSO 
R16@bdccd6d07 (03/10/25) 
10-7 (LSO) 
*LSO_POINT_SET 
Purpose:  Deﬁne a list of points used to sample variables in time.  Of the diﬀerent sam-
pling methods, the most common one is to specify points for time history output. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SETID 
USE 
 
 
 
 
 
 
Type 
I 
I 
 
 
 
 
 
 
Default 
none 
1 
 
 
 
 
 
 
Remarks 
 
1 
 
 
 
 
 
 
 
Point Cards.  Provide as many cards as necessary.  This input ends at the next keyword 
(“*”) card 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
X 
Y 
Z 
 
 
 
 
 
Type 
F 
F 
F 
 
 
 
 
 
Default 
none 
none 
none 
 
 
 
 
 
 
 VARIABLE  
 
DESCRIPTION 
SETID 
Identiﬁer for this point set which is used by *LSO_DOMAIN 
USE 
Points in this set are used as: 
EQ.1: ﬁxed time history points (default) 
EQ.2: positions of tracer particles 
X, Y, Z 
Coordinates of a point.  As many points as desired can be speciﬁed.

================================================================================
PAGE 752
================================================================================

*LSO 
*LSO_POINT_SET 
10-8 (LSO) 
R16@bdccd6d07 (03/10/25) 
Remarks: 
1. 
USE.  For USE = 1, with the ICFD and CESE solvers, the ﬁxed points must re-
main inside the ﬂuid mesh or a zero result is returned, while for the EM solver, 
the points can be deﬁned inside the conductors or in the air.  In the latter case, 
the ﬁelds will be computed using a Biot-Savart type integration. For USE = 2, a 
massless tracer particle is tracked for the ICFD and CESE solvers using their lo-
cal velocity ﬁeld to integrate the position of each particle in time.

================================================================================
PAGE 753
================================================================================

*LSO_TIME_SEQUENCE 
*LSO 
R16@bdccd6d07 (03/10/25) 
10-9 (LSO) 
*LSO_TIME_SEQUENCE 
Purpose:  This command provides users with maximum ﬂexibility in specifying exactly 
what they want to have appear in the output LSO binary database.  Each instance of the 
*LSO_TIME_SEQUENCE command creates a new time sequence with an independent 
output frequency and duration.  Furthermore, while the default domain for each output 
variable will be the entire mesh on which that variable is deﬁned, at all selected snapshot 
times, the *LSO_DOMAIN keyword commands can be used to specify that output will 
only occur on a portion of SOLVER_NAME’s mesh, and for a limited time interval, or 
that it will occur at a set of points (see *LSO_POINT_SET), or over a set of object IDs (see 
*LSO_ID_SET).  Note that for the single-precision version of LS-DYNA, the only allowed 
value of SOLVER_NAME = MECH. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SOLVER_NAME 
Type 
A 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DT 
LCDT 
LCOPT 
NPLTC 
TBEG 
TEND 
 
 
Type 
F 
I 
I 
I 
F 
F 
 
 
Default 
0.0 
0 
1 
0 
0.0 
0.0 
 
 
Remarks 
1 
1 
1 
1 
 
 
 
 
 

================================================================================
PAGE 754
================================================================================

*LSO 
*LSO_TIME_SEQUENCE 
10-10 (LSO) 
R16@bdccd6d07 (03/10/25) 
Domain IDs.  Provide as many cards as necessary.  This input ends at the next keyword 
(“*”) card, or when a global variable name card appears 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DOMID1 
DOMID2 
DOMID3 
DOMID4 
DOMID5 
DOMID6 
DOMID7 
DOMID8 
Type 
I 
I 
I 
I 
I 
I 
I 
I 
Default 
none 
none 
none 
none 
none 
none 
none 
none 
 
Global variable names.  Provide as many cards as necessary.  This input ends at the next 
keyword (“*”) card 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
GLOBAL_VAR 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
SOLVER_NAM
E 
Selects the solver from which data is output in this time se-
quence.  Accepted entries so far are ‘MECH’, ‘EM’, ‘CESE’ and 
‘ICFD’ 
DT 
Time interval between outputs. 
LCDT 
Optional load curve ID specifying the time interval between 
dumps. 
LCOPT 
Flag to govern behavior of plot frequency load curve: 
EQ.1: At the time each plot is generated, the load curve value
is added to the current time to determine the next plot 
time (this is the default behavior). 
EQ.2: At the time each plot is generated, the next plot time T 
is computed so that T = the current time plus the load 
curve value at the time T. 
EQ.3: A plot is generated for each ordinate point in the load
curve deﬁnition.  The actual value of the load curve is
ignored. 

================================================================================
PAGE 755
================================================================================

*LSO_TIME_SEQUENCE 
*LSO 
R16@bdccd6d07 (03/10/25) 
10-11 (LSO) 
 VARIABLE  
 
DESCRIPTION 
NPLTC 
DT = ENDTIM/NPLTC overrides DT speciﬁed in the ﬁrst ﬁeld.
TBEG 
The problem time at which to begin writing output to this time
sequence 
TEND 
The problem time at which to terminate writing output to this 
time sequence 
DOMID1, … 
Output set ID deﬁning the domain over which variable output 
is to be performed in this time sequence.  Each DOMID refers to 
the domain identiﬁer in an *LSO_DOMAIN keyword card. 
GLOBAL_VAR 
The name of a global output variable computed by SOLVER_-
NAME. This variable must have a single value (scalar, vector, or 
tensor), and therefore does not depend upon any DOMID. Any 
number of such variables may be speciﬁed with a given time se-
quence.  These variables are listed as having “global” domain for 
SOLVER_NAME in a separate document.  This document 
(LSO_VARIABLES.TXT) is created by running the command: LS-
DYNA print_lso_doc. 
Remarks: 
1. 
If LCDT is nonzero, then it is used and DT and NPLTC are ignored.  If LCDT is 
zero and NPLTC is non-zero, then NPLTC determines the snapshot time incre-
ment.  If LCDT and NPLTC are both zero, then the minimum non-zero time in-
crement speciﬁed by DT is used to determine the snapshot times.

================================================================================
PAGE 756
================================================================================

*LSO 
*LSO_VARIABLE_GROUP 
10-12 (LSO) 
R16@bdccd6d07 (03/10/25) 
*LSO_VARIABLE_GROUP 
Purpose:  To provide a means of deﬁning a shorthand name for a group of variables.  That 
is, wherever the given group name is used, it is replaced by the list of variables given in 
this command.  Note that for the single-precision version of LS-DYNA, the only allowed 
value of SOLVER_NAME = MECH. 
 
 Card 1 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
SOLVER_NAME 
Type 
A 
 
 Card 2 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
DOMAIN_TYPE 
Type 
A 
 
 Card 3 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
GROUP_NAME 
Type 
A 
 
List Of Variables In Group. Provide as many cards as necessary.  This input ends at the 
next keyword (“*”) card 
 Card 4 
1 
2 
3 
4 
5 
6 
7 
8 
Variable 
VAR_NAME 
Type 
A 
 
 VARIABLE  
 
DESCRIPTION 
SOLVER_NAME 
Selects the solver for which data is output in a time sequence. 

================================================================================
PAGE 757
================================================================================

*LSO_VARIABLE_GROUP 
*LSO 
R16@bdccd6d07 (03/10/25) 
10-13 (LSO) 
 VARIABLE  
 
DESCRIPTION 
DOMAIN_TYPE 
Name of the type of domain on which each VAR_NAME is de-
ﬁned. 
GROUP_NAME 
Name of (or alias for) the group of names given by the listed 
VAR_NAMEs 
VAR_NAME 
The name of an output variable computed by SOLVER_NAME
Remarks: 
1. 
Valid VAR_NAMEs depend both upon the SOLVER_NAME and the DO-
MAIN_TYPE. These variables are listed by DOMAIN_TYPE for each SOLVER_-
NAME in a separate document.  This document (LSO_VARIABLES.TXT) is 
created by running the command: LS-DYNA print_lso_doc.

================================================================================
PAGE 758
================================================================================

*LSO 
*LSO_VARIABLE_GROUP 
10-14 (LSO) 
R16@bdccd6d07 (03/10/25) 
 
