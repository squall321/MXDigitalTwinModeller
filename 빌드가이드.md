# 빌드 가이드

## VSCode에서 빌드하기

### 방법 1: Build Task 사용 (추천)

1. **`Ctrl+Shift+B`** 누르기
2. 빌드 옵션 선택:
   - `Build (Default - V252)` - 기본 빌드 (V252)
   - `Build All (V251 + V252)` - 모든 버전
   - `Build V251 Only` - V251만
   - `Build V252 Only` - V252만
   - `Clean` - 정리

### 방법 2: 터미널에서 build.bat 사용

```bash
# 기본 빌드 (V252)
.\build.bat

# 모든 버전 빌드
.\build.bat all

# V251만 빌드
.\build.bat v251

# V252만 빌드
.\build.bat v252

# 정리
.\build.bat clean

# 도움말
.\build.bat help
```

### 방법 3: VSCode 디버깅

1. **F5** 누르기
2. 디버그 구성 선택:
   - `SpaceClaim V252 Debug` (기본)
   - `SpaceClaim V251 Debug`

자동으로 빌드하고 SpaceClaim을 실행합니다.

---

## Visual Studio 2022에서 빌드하기

### 방법 1: GUI

1. 빌드 구성 선택 (상단 드롭다운)
   - `Debug-V251`
   - `Release-V251`
   - `Debug-V252` (기본)
   - `Release-V252`

2. **`Ctrl+Shift+B`** 또는 **F5**

### 방법 2: 배치 빌드

1. **빌드 > 배치 빌드** 메뉴
2. 원하는 구성 체크
3. **빌드** 버튼

---

## 커맨드라인에서 빌드하기

### MSBuild 직접 사용

```bash
# MSBuild 경로 설정
set MSBUILD="D:\Program Files\Microsoft Visual Studio\2022\Community\MSBuild\Current\Bin\MSBuild.exe"

# 기본 빌드 (V252)
%MSBUILD% MXDigitalTwinModeller.csproj /p:Configuration=Debug-V252

# V251 빌드
%MSBUILD% MXDigitalTwinModeller.csproj /p:Configuration=Debug-V251

# Release 빌드
%MSBUILD% MXDigitalTwinModeller.csproj /p:Configuration=Release-V252

# 정리
%MSBUILD% MXDigitalTwinModeller.csproj /t:Clean
```

---

## build.bat 옵션

| 옵션 | 설명 |
|------|------|
| (없음) | 기본 빌드 (Debug-V252) |
| `all` | V251 + V252 모두 빌드 (Debug + Release) |
| `v251` | V251만 빌드 (Debug + Release) |
| `v252` | V252만 빌드 (Debug + Release) |
| `clean` | 빌드 결과물 정리 |
| `help` | 도움말 표시 |

---

## 빌드 출력 경로

빌드 구성에 따라 자동으로 출력 경로가 설정됩니다:

| 구성 | 출력 경로 |
|------|-----------|
| Debug-V251 | `C:\ProgramData\SpaceClaim\AddIns\MXDigitalTwinModeller\V251` |
| Release-V251 | `C:\ProgramData\SpaceClaim\AddIns\MXDigitalTwinModeller\V251` |
| Debug-V252 | `C:\ProgramData\SpaceClaim\AddIns\MXDigitalTwinModeller\V252` |
| Release-V252 | `C:\ProgramData\SpaceClaim\AddIns\MXDigitalTwinModeller\V252` |

---

## 트러블슈팅

### MSBuild를 찾을 수 없음

**증상**: `build.bat` 실행 시 "MSBuild를 찾을 수 없습니다" 오류

**해결**:
1. Visual Studio 2022가 설치되어 있는지 확인
2. `build.bat` 파일의 `MSBUILD` 경로 확인:
   ```batch
   set MSBUILD="D:\Program Files\Microsoft Visual Studio\2022\Community\MSBuild\Current\Bin\MSBuild.exe"
   ```
3. 경로가 다르면 수정

### 빌드 실패

**증상**: 빌드 중 오류 발생

**확인 사항**:
1. `.env` 파일의 경로가 올바른지 확인
2. SpaceClaim API DLL이 존재하는지 확인
3. 프로젝트를 Clean 후 다시 빌드

### VSCode 디버깅 안 됨

**증상**: F5 눌러도 디버거가 연결되지 않음

**해결**:
1. C# 확장 설치: `ms-dotnettools.csharp`
2. `.NET Framework Debugging` 지원 확인
3. 또는 Visual Studio 2022 사용 (더 안정적)

---

## 추천 워크플로우

### 일반 개발
```bash
# VSCode에서
Ctrl+Shift+B → "Build (Default - V252)"
```

### 양쪽 버전 테스트
```bash
# 터미널에서
.\build.bat all
```

### 디버깅
```bash
# VSCode에서
F5 → "SpaceClaim V252 Debug"
```

### 배포용 빌드
```bash
# 터미널에서
.\build.bat all
```
→ 모든 버전의 Debug + Release가 빌드됩니다.
